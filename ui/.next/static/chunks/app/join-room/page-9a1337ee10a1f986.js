(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6079],{3176:function(e,t,r){Promise.resolve().then(r.bind(r,3568))},4962:function(e,t,r){"use strict";r.d(t,{Z:function(){return l}});var s=r(7621);let n=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),a=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&r.indexOf(e)===t).join(" ")};var o={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let i=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:n=24,strokeWidth:i=2,absoluteStrokeWidth:l,className:d="",children:c,iconNode:u,...m}=e;return(0,s.createElement)("svg",{ref:t,...o,width:n,height:n,stroke:r,strokeWidth:l?24*Number(i)/Number(n):i,className:a("lucide",d),...m},[...u.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(c)?c:[c]])}),l=(e,t)=>{let r=(0,s.forwardRef)((r,o)=>{let{className:l,...d}=r;return(0,s.createElement)(i,{ref:o,iconNode:t,className:a("lucide-".concat(n(e)),l),...d})});return r.displayName="".concat(e),r}},8574:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(4962).Z)("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]])},727:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(4962).Z)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]])},6038:function(e,t,r){"use strict";r.d(t,{Z:function(){return s}});let s=(0,r(4962).Z)("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},8005:function(e,t,r){"use strict";r.d(t,{h:function(){return s}});let s=r(9397).qL},3568:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return j}});var s=r(9571),n=r(4377),a=r(2218),o=r(1297),i=r(5337),l=r(934),d=r(6276),c=r(8005),u=r(8730),m=r(1408),f=r(2521),p=r(8574),h=r(727),x=r(6038),g=r(3727),v=r(7621),b=r(652),y=r(5285);function j(e){var t;let{searchParams:r}=e;(0,g.useRouter)();let n=r.roomId,a=r.groupId;(0,d.B)();let[o,i]=(0,v.useState)(!1),l=(0,f.aM)(c.h.escrow.getRoomStatus,a&&n?{groupId:a,roomId:n}:"skip");return(0,s.jsxs)("main",{className:"w-screen h-screen",children:[(0,s.jsx)(k,{}),(0,s.jsxs)("div",{className:" h-full flex flex-col pt-10 items-center bg-gradient-to-r from-blue-100 to-purple-100",children:[l&&(null===(t=l.data)||void 0===t?void 0:t.payment_status)==="pending"&&(0,s.jsx)(w,{roomId:n,groupId:a,initialTimeInSeconds:25,startEscrow:o}),l&&l.data&&"default"===l.data.payment_status&&(0,s.jsx)(_,{amount:l.data.amount,asset:l.data.asset,terms:l.data.terms,roomId:n,groupId:a})]})]})}function w(e){let{startEscrow:t,groupId:r,roomId:o,initialTimeInSeconds:i=15}=e,[l,d]=(0,v.useState)(i),[u,m]=(0,v.useState)(!1),x=(0,f.Db)(c.h.escrow.refusePayment);return(0,v.useEffect)(()=>{if(l>0){let e=setTimeout(()=>d(l-1),1e3);return()=>clearTimeout(e)}t?m(!1):m(!0)},[l,t]),(0,s.jsxs)(a.Zb,{className:"w-full max-w-md",children:[(0,s.jsx)(a.Ol,{children:(0,s.jsx)(a.ll,{className:"text-2xl font-bold text-center",children:"Escrow Service"})}),(0,s.jsxs)(a.aY,{className:"text-center",children:[(0,s.jsx)(p.Z,{className:"w-16 h-16 mx-auto mb-4 text-blue-500 animate-pulse"}),(0,s.jsx)("p",{className:"text-xl mb-4",children:"Please pay within the stipulated time"}),(0,s.jsx)("div",{className:"text-4xl font-bold mb-4","aria-live":"polite",children:"".concat(Math.floor(l/60).toString().padStart(2,"0"),":").concat((l%60).toString().padStart(2,"0"))}),u&&(0,s.jsxs)("p",{className:"text-red-500 flex items-center justify-center",children:[(0,s.jsx)(h.Z,{className:"w-5 h-5 mr-2"}),"Payment time has expired"]})]}),(0,s.jsx)(a.eW,{className:"flex justify-center",children:(0,s.jsx)(n.z,{onClick:async()=>{x({groupId:r,roomId:o})},className:"bg-red-500 hover:bg-red-600 text-white font-bold py-2 px-4 rounded transition-colors duration-200",children:"Refuse to pay"})})]})}let N=y.z.object({username:y.z.string().min(2,{message:"Username is short."}),amount_to_recieve:y.z.string(),asset_to_recieve:y.z.string(),terms:y.z.string()});function _(e){let t=(0,d.B)(),r=(0,f.Db)(c.h.escrow.joinEscrowRoom),u=(0,b.cI)({resolver:(0,m.F)(N),defaultValues:{username:"",amount_to_recieve:"0",asset_to_recieve:"USDT",terms:""}});async function p(s){if(!e.roomId||!e.groupId||!t.visitorId){console.log("RoomId, GroupId and VisitorId is undefined.");return}await r({roomId:e.roomId,groupId:e.groupId,payment_status:"pending",reciever:{username:s.username,visitorId:t.visitorId}})}return(0,v.useEffect)(()=>{e&&(u.setValue("terms",e.terms),u.setValue("asset_to_recieve",e.asset),u.setValue("amount_to_recieve",e.amount))},[e]),(0,s.jsxs)(a.Zb,{className:"w-full max-w-xl",children:[(0,s.jsxs)(a.Ol,{children:[(0,s.jsx)(a.ll,{children:"Accept Escrow"}),(0,s.jsx)(a.SZ,{children:"Someone is hoping to create an escrow with you."})]}),(0,s.jsx)(a.aY,{children:(0,s.jsxs)("form",{className:"grid gap-4",onSubmit:u.handleSubmit(p),children:[(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i._,{htmlFor:"user_name",children:"Username"}),(0,s.jsx)(o.I,{id:"user_name",type:"text",placeholder:"Your username",...u.register("username")}),u.formState.errors.username&&(0,s.jsx)("span",{className:"p-4 text-red-400 text-sm tracking-tighter",children:u.formState.errors.username.message})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i._,{htmlFor:"amount",children:"Amount to send"}),(0,s.jsx)(o.I,{id:"amount",type:"number",placeholder:"0.00",...u.register("amount_to_recieve"),disabled:!0})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i._,{htmlFor:"token-types",children:"Asset to recieve"}),(0,s.jsx)(o.I,{id:"asset",type:"text",placeholder:"Tether (USDT)",disabled:!0,...u.register("asset_to_recieve")})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(i._,{htmlFor:"terms",children:"Additional Terms"}),(0,s.jsx)(l.g,{id:"terms",rows:2,...u.register("terms"),disabled:!0,placeholder:"Enter any additional terms or conditions..."})]}),(0,s.jsx)(n.z,{className:"ml-auto",children:"Accept Escrow and Terms"})]})})]})}function k(){let{toast:e}=(0,u.pm)(),t=(0,v.useCallback)(()=>{console.log("Close button clicked")},[]);return(0,s.jsx)("div",{className:"sticky top-0 px-3 z-50 w-full border-b bg-background/95  backdrop-blur supports-[backdrop-filter]:bg-background/60",children:(0,s.jsxs)("div",{className:"flex h-14 items-center",children:[(0,s.jsx)("div",{className:"hidden md:flex flex-1",children:(0,s.jsx)("a",{className:" flex items-center space-x-2",href:"/",children:(0,s.jsx)("span",{className:"hidden font-bold sm:inline-block",children:"Escrow"})})}),(0,s.jsx)("div",{className:"flex items-center space-x-2 md:justify-end",children:(0,s.jsx)("nav",{className:"flex items-center space-x-2",children:(0,s.jsxs)(n.z,{variant:"outline",size:"sm",className:"",onClick:t,children:[(0,s.jsx)("span",{className:"sr-only",children:"Close"}),(0,s.jsx)(x.Z,{className:"h-4 w-4"}),(0,s.jsx)("span",{className:"",children:"Close"})]})})})]})})}},4377:function(e,t,r){"use strict";r.d(t,{z:function(){return d}});var s=r(9571),n=r(7621),a=r(8759),o=r(340),i=r(4027);let l=(0,o.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),d=n.forwardRef((e,t)=>{let{className:r,variant:n,size:o,asChild:d=!1,...c}=e,u=d?a.g7:"button";return(0,s.jsx)(u,{className:(0,i.cn)(l({variant:n,size:o,className:r})),ref:t,...c})});d.displayName="Button"},2218:function(e,t,r){"use strict";r.d(t,{Ol:function(){return i},SZ:function(){return d},Zb:function(){return o},aY:function(){return c},eW:function(){return u},ll:function(){return l}});var s=r(9571),n=r(7621),a=r(4027);let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("rounded-xl border bg-card text-card-foreground shadow",r),...n})});o.displayName="Card";let i=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("flex flex-col space-y-1.5 p-6",r),...n})});i.displayName="CardHeader";let l=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("h3",{ref:t,className:(0,a.cn)("font-semibold leading-none tracking-tight",r),...n})});l.displayName="CardTitle";let d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("p",{ref:t,className:(0,a.cn)("text-sm text-muted-foreground",r),...n})});d.displayName="CardDescription";let c=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("p-6 pt-0",r),...n})});c.displayName="CardContent";let u=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("div",{ref:t,className:(0,a.cn)("flex items-center p-6 pt-0",r),...n})});u.displayName="CardFooter"},1297:function(e,t,r){"use strict";r.d(t,{I:function(){return o}});var s=r(9571),n=r(7621),a=r(4027);let o=n.forwardRef((e,t)=>{let{className:r,type:n,...o}=e;return(0,s.jsx)("input",{type:n,className:(0,a.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...o})});o.displayName="Input"},5337:function(e,t,r){"use strict";r.d(t,{_:function(){return d}});var s=r(9571),n=r(7621),a=r(5976),o=r(340),i=r(4027);let l=(0,o.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)(a.f,{ref:t,className:(0,i.cn)(l(),r),...n})});d.displayName=a.f.displayName},934:function(e,t,r){"use strict";r.d(t,{g:function(){return o}});var s=r(9571),n=r(7621),a=r(4027);let o=n.forwardRef((e,t)=>{let{className:r,...n}=e;return(0,s.jsx)("textarea",{className:(0,a.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...n})});o.displayName="Textarea"},6276:function(e,t,r){"use strict";r.d(t,{B:function(){return s}});let s=(0,r(483).U)(e=>({group:null,participant:null,roomId:void 0,visitorId:void 0,setGroup:t=>e({group:t}),setParticipant:t=>e({participant:t}),setRoomId:t=>e({roomId:t}),setVisitorId:t=>e({visitorId:t})}))},8730:function(e,t,r){"use strict";r.d(t,{pm:function(){return m}});var s=r(7621);let n=0,a=new Map,o=e=>{if(a.has(e))return;let t=setTimeout(()=>{a.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);a.set(e,t)},i=(e,t)=>{switch(t.type){case"ADD_TOAST":return{...e,toasts:[t.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===t.toast.id?{...e,...t.toast}:e)};case"DISMISS_TOAST":{let{toastId:r}=t;return r?o(r):e.toasts.forEach(e=>{o(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===r||void 0===r?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===t.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==t.toastId)}}},l=[],d={toasts:[]};function c(e){d=i(d,e),l.forEach(e=>{e(d)})}function u(e){let{...t}=e,r=(n=(n+1)%Number.MAX_SAFE_INTEGER).toString(),s=()=>c({type:"DISMISS_TOAST",toastId:r});return c({type:"ADD_TOAST",toast:{...t,id:r,open:!0,onOpenChange:e=>{e||s()}}}),{id:r,dismiss:s,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:r}})}}function m(){let[e,t]=s.useState(d);return s.useEffect(()=>(l.push(t),()=>{let e=l.indexOf(t);e>-1&&l.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},4027:function(e,t,r){"use strict";r.d(t,{CG:function(){return l},Ox:function(){return d},PE:function(){return i},cn:function(){return o}});var s=r(9213),n=r(6605),a=r(5045);function o(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,a.m6)((0,s.W)(t))}let i=e=>new Promise((t,r)=>{let s=new FileReader;s.onload=()=>{t(s.result)},s.onerror=e=>{r(Error("Error reading file: ".concat(e)))},s.readAsDataURL(e)}),l=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0,r=await Promise.all(t.map(async(e,t)=>({imageUrl:{url:e.base64,detail:""},type:"image_url"})));return r.length>0&&(r[0].imageUrl.detail=void 0,r[r.length-1].imageUrl.detail=e),{content:r[0],role:"user"}},d=(0,n.kP)("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",8)}},function(e){e.O(0,[5600,4996,1672,4250,7652,1744],function(){return e(e.s=3176)}),_N_E=e.O()}]);