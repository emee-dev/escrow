(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8469],{6713:function(e,s,t){Promise.resolve().then(t.bind(t,1693))},8005:function(e,s,t){"use strict";t.d(s,{h:function(){return a}});let a=t(9397).qL},1693:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return T}});var a=t(9571),r=t(7621),n=t(5829),l=t(4027);let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.fC,{ref:s,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...r})});i.displayName=n.fC.displayName;let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.Ee,{ref:s,className:(0,l.cn)("aspect-square h-full w-full",t),...r})});d.displayName=n.Ee.displayName;let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(n.NY,{ref:s,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...r})});o.displayName=n.NY.displayName;var c=t(4377),m=t(2218),u=t(3752),f=t(2425);let p=u.fC,x=u.xz;u.ZA,u.Uv,u.Tr,u.Ee,r.forwardRef((e,s)=>{let{className:t,inset:r,children:n,...i}=e;return(0,a.jsxs)(u.fF,{ref:s,className:(0,l.cn)("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",r&&"pl-8",t),...i,children:[n,(0,a.jsx)(f.XCv,{className:"ml-auto h-4 w-4"})]})}).displayName=u.fF.displayName,r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(u.tu,{ref:s,className:(0,l.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})}).displayName=u.tu.displayName;let h=r.forwardRef((e,s)=>{let{className:t,sideOffset:r=4,...n}=e;return(0,a.jsx)(u.Uv,{children:(0,a.jsx)(u.VY,{ref:s,sideOffset:r,className:(0,l.cn)("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md","data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})})});h.displayName=u.VY.displayName;let g=r.forwardRef((e,s)=>{let{className:t,inset:r,...n}=e;return(0,a.jsx)(u.ck,{ref:s,className:(0,l.cn)("relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&>svg]:size-4 [&>svg]:shrink-0",r&&"pl-8",t),...n})});g.displayName=u.ck.displayName,r.forwardRef((e,s)=>{let{className:t,children:r,checked:n,...i}=e;return(0,a.jsxs)(u.oC,{ref:s,className:(0,l.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:n,...i,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(u.wU,{children:(0,a.jsx)(f.nQG,{className:"h-4 w-4"})})}),r]})}).displayName=u.oC.displayName,r.forwardRef((e,s)=>{let{className:t,children:r,...n}=e;return(0,a.jsxs)(u.Rk,{ref:s,className:(0,l.cn)("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[(0,a.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,a.jsx)(u.wU,{children:(0,a.jsx)(f.jXb,{className:"h-4 w-4 fill-current"})})}),r]})}).displayName=u.Rk.displayName;let j=r.forwardRef((e,s)=>{let{className:t,inset:r,...n}=e;return(0,a.jsx)(u.__,{ref:s,className:(0,l.cn)("px-2 py-1.5 text-sm font-semibold",r&&"pl-8",t),...n})});j.displayName=u.__.displayName;let N=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)(u.Z0,{ref:s,className:(0,l.cn)("-mx-1 my-1 h-px bg-muted",t),...r})});N.displayName=u.Z0.displayName;var v=t(1297),b=t(934),y=t(6276),w=t(8005),R=t(249),k=t(2521),z=t(5317),C=t(4363),I=t(3378),_=t(170),U=t(8204),E=t(6038),Z=t(8797),P=t(3727);function T(e){let{searchParams:s}=e,t=s.roomId,n=s.groupId,i=s.userType,d=(0,r.useRef)(null),o=(0,k.aM)(w.h.store.fetchRoomMessages,t&&n?{roomId:t,groupId:n}:"skip"),m=(0,k.aM)(w.h.escrow.getRoomStatus,t&&n?{groupId:n,roomId:t}:"skip"),u=(0,R.iL)(),f=(0,y.B)(),_=(0,r.useRef)(!1),U=(0,r.useRef)(null),E=(0,k.Db)(w.h.store.storeMessage),{subscribe:T,isReady:Y,publish:F}=(0,R.rM)("default"),[O,S]=(0,r.useState)([]),G=async e=>{if(!f.participant){console.log("User is not defined.");return}if(e.data.participantId===f.participant.id){let s=e.data.message;if(O.length>0){let e="#".concat(f.participant.name,": ").concat(s),a=await (0,l.CG)(e,O);await E({groupId:n,roomId:t,newMessage:{role:"user",content:[a.content],id:(0,l.Ox)(),uploadType:"image-prompt"}}),S([])}else await E({groupId:n,roomId:t,newMessage:{role:"user",id:(0,l.Ox)(),content:"#".concat(f.participant.name,": ").concat(s),uploadType:"text-prompt"}});console.log("Sub: ",e)}};if((0,r.useEffect)(()=>{if(m&&m.data){let e=m.data,s="creator"===i?e.creator:e.reciever;f.setRoomId(e.roomId),f.setGroup({id:"group-".concat(e.roomId),name:"group-".concat(e.roomId)}),f.setParticipant({id:"participant-".concat(s.visitorId),name:"participant-".concat(s.username)})}},[m]),(0,r.useEffect)(()=>{f.roomId&&f.group&&u.startRoom()},[f]),(0,r.useEffect)(()=>{Y&&!_.current&&(T("dispute_message",G),_.current=!0)},[Y]),!t||!n)return(0,P.notFound)();let B=async e=>{let s=e.target.files;if(s){let e=await Promise.all(Array.from(s).map(async e=>{let s=await (0,l.PE)(e);return{name:e.name,base64:s}}));S(s=>[...s,...e])}};return(0,a.jsxs)("div",{className:"grid h-screen w-full grid-cols-[300px_1fr] bg-background",children:[(0,a.jsxs)("div",{className:"flex flex-col border-r bg-muted/40 p-4",children:[(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)(Z.default,{href:"#",className:"flex items-center gap-2 font-semibold",prefetch:!1,children:[(0,a.jsx)(z.Z,{className:"h-6 w-6"}),(0,a.jsx)("span",{children:"AI Chat"})]}),(0,a.jsxs)(p,{children:[(0,a.jsx)(x,{asChild:!0,children:(0,a.jsxs)(c.z,{variant:"ghost",size:"icon",className:"rounded-full",children:[(0,a.jsx)("img",{src:"/placeholder.svg",width:"32",height:"32",className:"rounded-full",alt:"Avatar",style:{aspectRatio:"32/32",objectFit:"cover"}}),(0,a.jsx)("span",{className:"sr-only",children:"Toggle user menu"})]})}),(0,a.jsxs)(h,{align:"end",children:[(0,a.jsx)(j,{children:"My Account"}),(0,a.jsx)(N,{}),(0,a.jsx)(g,{children:"Settings"}),(0,a.jsx)(g,{children:"Support"}),(0,a.jsx)(N,{}),(0,a.jsx)(g,{children:"Logout"})]})]})]}),(0,a.jsx)(A,{})]}),(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsx)(D,{}),(0,a.jsxs)("div",{className:"flex-1 overflow-auto p-4 sm:p-6",children:[(0,a.jsx)("div",{className:"flex items-center",children:O.map((e,s)=>(0,a.jsxs)("div",{style:{margin:"8px",textAlign:"center"},children:[(0,a.jsx)("h4",{children:e.name}),(0,a.jsx)("img",{src:e.base64,alt:e.name,style:{maxWidth:"150px",maxHeight:"150px"}})]},s))}),o&&o.data.length>0?(0,a.jsx)(M,{messages:o.data}):(0,a.jsx)("div",{children:(0,a.jsx)("span",{children:"There are no messages"})}),(0,a.jsx)(v.I,{multiple:!0,id:"picture",type:"file",ref:d,accept:"image/*",onChange:B,className:"hidden cursor-none invisible",placeholder:"Click here"})]}),(0,a.jsx)("div",{className:"sticky bottom-0 z-10 bg-background p-4 sm:p-6",children:(0,a.jsxs)("form",{onSubmit:e=>{e.preventDefault(),e.stopPropagation(),U.current=e,f.participant&&(F("dispute_message",{message:new FormData(e.currentTarget).get("message"),participantId:f.participant.id,participantName:f.participant.name}),console.log("Published"))},className:"relative",children:[(0,a.jsxs)(c.z,{type:"submit",size:"icon",variant:"outline",className:"absolute w-8 h-8 top-3 left-3",onClick:()=>{let e=d.current;e&&e.click()},children:[(0,a.jsx)(C.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Upload"})]}),(0,a.jsx)(b.g,{placeholder:"Type your message...",name:"message",id:"message",rows:1,className:"min-h-[48px] rounded-2xl resize-none p-4 pl-16 border border-neutral-400 shadow-sm pr-16"}),(0,a.jsxs)(c.z,{size:"icon",type:"submit",className:"absolute w-8 h-8 top-3 right-3",children:[(0,a.jsx)(I.Z,{className:"w-4 h-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Send"})]})]})})]})]})}function A(){return(0,a.jsx)(m.Zb,{className:"flex flex-col w-full mt-3",children:(0,a.jsxs)(m.aY,{className:"flex-1 grid gap-4 p-4   md:p-6",children:[(0,a.jsxs)("div",{className:"flex flex-col",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)("h1",{className:"text-sm font-semibold",children:"Your Balance"}),(0,a.jsxs)(c.z,{size:"icon",variant:"outline",className:"ml-auto rounded-full",children:[(0,a.jsx)(_.Z,{className:"size-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Refresh"})]})]}),(0,a.jsx)("div",{className:"text-lg font-semibold",children:"$700.00"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsx)("h2",{className:"text-sm",children:"Recent Transactions"})}),(0,a.jsxs)("div",{className:"flex flex-col space-y-3",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mt-2",children:[(0,a.jsx)(U.Z,{className:"size-4 text-green-500"}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"March 1, 2023"})}),(0,a.jsx)("div",{className:"text-right text-sm",children:"$500.00"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsx)(U.Z,{className:"size-4 text-green-500"}),(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsx)("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"February 25, 2023"})}),(0,a.jsx)("div",{className:"text-right text-sm",children:"$200.00"})]})]})]})]})})}let D=()=>(0,a.jsxs)("div",{className:"sticky top-0 z-10 flex h-14 items-center gap-4 border-b bg-background px-4 sm:h-16 sm:px-6",children:[(0,a.jsx)("div",{className:"flex-1",children:(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(i,{className:"w-10 h-10 border",children:[(0,a.jsx)(d,{src:"/placeholder-user.jpg",alt:"User"}),(0,a.jsx)(o,{children:"JD"})]}),(0,a.jsx)("div",{children:(0,a.jsx)("div",{className:"font-medium",children:"John Doe"})})]})}),(0,a.jsx)("div",{className:"flex items-center gap-2",children:(0,a.jsxs)(c.z,{variant:"ghost",size:"icon",children:[(0,a.jsx)(E.Z,{className:"h-5 w-5"}),(0,a.jsx)("span",{className:"sr-only",children:"Add emoji"})]})})]}),M=e=>{let{messages:s}=e;return(0,a.jsx)("div",{className:"grid gap-4",children:s.map(e=>"assistant"===e.role&&"string"==typeof e.content?(0,a.jsx)(Y,{content:e.content},e.id):"user"===e.role&&"string"==typeof e.content?(0,a.jsx)(F,{content:e.content},e.id):void 0)})},Y=e=>{let{content:s}=e;return(0,a.jsxs)("div",{className:"flex items-start gap-4",children:[(0,a.jsxs)(i,{className:"w-10 h-10 border",children:[(0,a.jsx)(d,{src:"/placeholder-user.jpg",alt:"User"}),(0,a.jsx)(o,{children:"JD"})]}),(0,a.jsxs)("div",{className:"grid gap-1 rounded-lg bg-muted p-3",children:[(0,a.jsx)("div",{className:"font-medium",children:"John Doe"}),(0,a.jsx)("div",{className:"text-sm leading-relaxed",children:s})]})]})},F=e=>{let{content:s}=e;return(0,a.jsxs)("div",{className:"flex items-start gap-4 justify-end",children:[(0,a.jsxs)("div",{className:"grid gap-1 rounded-lg bg-primary p-3 text-primary-foreground",children:[(0,a.jsx)("div",{className:"font-medium",children:"You"}),(0,a.jsx)("div",{className:"text-sm leading-relaxed",children:s})]}),(0,a.jsxs)(i,{className:"w-10 h-10 border",children:[(0,a.jsx)(d,{src:"/placeholder-user.jpg",alt:"User"}),(0,a.jsx)(o,{children:"YO"})]})]})}},4377:function(e,s,t){"use strict";t.d(s,{z:function(){return o}});var a=t(9571),r=t(7621),n=t(8759),l=t(340),i=t(4027);let d=(0,l.j)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),o=r.forwardRef((e,s)=>{let{className:t,variant:r,size:l,asChild:o=!1,...c}=e,m=o?n.g7:"button";return(0,a.jsx)(m,{className:(0,i.cn)(d({variant:r,size:l,className:t})),ref:s,...c})});o.displayName="Button"},2218:function(e,s,t){"use strict";t.d(s,{Ol:function(){return i},SZ:function(){return o},Zb:function(){return l},aY:function(){return c},eW:function(){return m},ll:function(){return d}});var a=t(9571),r=t(7621),n=t(4027);let l=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("rounded-xl border bg-card text-card-foreground shadow",t),...r})});l.displayName="Card";let i=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...r})});i.displayName="CardHeader";let d=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("h3",{ref:s,className:(0,n.cn)("font-semibold leading-none tracking-tight",t),...r})});d.displayName="CardTitle";let o=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("p",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",t),...r})});o.displayName="CardDescription";let c=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",t),...r})});c.displayName="CardContent";let m=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",t),...r})});m.displayName="CardFooter"},1297:function(e,s,t){"use strict";t.d(s,{I:function(){return l}});var a=t(9571),r=t(7621),n=t(4027);let l=r.forwardRef((e,s)=>{let{className:t,type:r,...l}=e;return(0,a.jsx)("input",{type:r,className:(0,n.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...l})});l.displayName="Input"},934:function(e,s,t){"use strict";t.d(s,{g:function(){return l}});var a=t(9571),r=t(7621),n=t(4027);let l=r.forwardRef((e,s)=>{let{className:t,...r}=e;return(0,a.jsx)("textarea",{className:(0,n.cn)("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...r})});l.displayName="Textarea"},6276:function(e,s,t){"use strict";t.d(s,{B:function(){return a}});let a=(0,t(483).U)(e=>({group:null,participant:null,roomId:void 0,visitorId:void 0,setGroup:s=>e({group:s}),setParticipant:s=>e({participant:s}),setRoomId:s=>e({roomId:s}),setVisitorId:s=>e({visitorId:s})}))},4027:function(e,s,t){"use strict";t.d(s,{CG:function(){return d},Ox:function(){return o},PE:function(){return i},cn:function(){return l}});var a=t(9213),r=t(6605),n=t(5045);function l(){for(var e=arguments.length,s=Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,n.m6)((0,a.W)(s))}let i=e=>new Promise((s,t)=>{let a=new FileReader;a.onload=()=>{s(a.result)},a.onerror=e=>{t(Error("Error reading file: ".concat(e)))},a.readAsDataURL(e)}),d=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,s=arguments.length>1?arguments[1]:void 0,t=await Promise.all(s.map(async(e,s)=>({imageUrl:{url:e.base64,detail:""},type:"image_url"})));return t.length>0&&(t[0].imageUrl.detail=void 0,t[t.length-1].imageUrl.detail=e),{content:t[0],role:"user"}},o=(0,r.kP)("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",8)}},function(e){e.O(0,[727,1023,7393,1302,2387,5798,5600,4996,9812,9602,846,4250,7652,1744],function(){return e(e.s=6713)}),_N_E=e.O()}]);