"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7393],{1589:function(t,i,r){let n,s,a,l,u,c,h,d,p,f,m,v,g,b,y,_,w,E,C,P,A,S,O,T,x,k,I,M,R,F,L,N,D,j,B,U;r.d(i,{B:function(){return aO},D:function(){return eu},E:function(){return ec},S:function(){return o7},a:function(){return eg},b:function(){return o8},e:function(){return eh},f:function(){return eM},i:function(){return eP},l:function(){return im},o:function(){return ak},w:function(){return et},x:function(){return er},y:function(){return en},z:function(){return es}});var z,W,$=r(4633),V=r(5324),Z=Object.create,G=Object.defineProperty,J=Object.defineProperties,q=Object.getOwnPropertyDescriptor,H=Object.getOwnPropertyDescriptors,K=Object.getOwnPropertyNames,Y=Object.getOwnPropertySymbols,Q=Object.getPrototypeOf,X=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable,et=Math.pow,ei=(t,i,r)=>i in t?G(t,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[i]=r,er=(t,i)=>{for(var r in i||(i={}))X.call(i,r)&&ei(t,r,i[r]);if(Y)for(var r of Y(i))ee.call(i,r)&&ei(t,r,i[r]);return t},en=(t,i)=>J(t,H(i)),es=(t,i)=>{var r={};for(var n in t)X.call(t,n)&&0>i.indexOf(n)&&(r[n]=t[n]);if(null!=t&&Y)for(var n of Y(t))0>i.indexOf(n)&&ee.call(t,n)&&(r[n]=t[n]);return r},eo=(t,i)=>()=>(i||t((i={exports:{}}).exports,i),i.exports),ea=(t,i,r,n)=>{if(i&&"object"==typeof i||"function"==typeof i)for(let s of K(i))X.call(t,s)||s===r||G(t,s,{get:()=>i[s],enumerable:!(n=q(i,s))||n.enumerable});return t},el=(t,i,r)=>(r=null!=t?Z(Q(t)):{},ea(t&&t.__esModule?r:G(r,"default",{value:t,enumerable:!0}),t)),eu=(t,i,r,n)=>{for(var s,a=i,l=t.length-1;l>=0;l--)(s=t[l])&&(a=s(a)||a);return a},ec=(t,i,r)=>new Promise((n,s)=>{var a=t=>{try{u(r.next(t))}catch(t){s(t)}},l=t=>{try{u(r.throw(t))}catch(t){s(t)}},u=t=>t.done?n(t.value):Promise.resolve(t.value).then(a,l);u((r=r.apply(t,i)).next())}),eh=(n=()=>{W={}},()=>(n&&(s=n(n=0)),s));eh();var ed=((a=ed||{}).MEETING_START="meeting.start",a.MEETING_LEAVE="meeting.leave",a.MEETING_PARTICIPANT_AMOUNT_UPDATE="meeting.amount-of-participants-update",a.MEETING_PARTICIPANT_LIST_UPDATE="meeting.participant-list-update",a.MEETING_PARTICIPANT_JOINED="meeting.participant-joined",a.MEETING_PARTICIPANT_LEFT="meeting.participant-left",a.MEETING_JOIN="meeting.join",a.MEETING_PARTICIPANT_PROPERTIES="meeting.participant-properties",a.MEETING_HOST_CHANGE="meeting.host-change",a.MEETING_HOST_AVAILABLE="meeting.host-available",a.MEETING_NO_HOST_AVAILABLE="meeting.no-host-available",a.MEETING_SAME_PARTICIPANT_ERROR="meeting.same-participant-error",a.MEETING_DEVICES_CHANGE="meeting.devices-change",a.MEETING_KICK_PARTICIPANTS="meeting.kick-all-participants",a.MEETING_STATE_UPDATE="meeting.state-update",a.MEETING_CONNECTION_STATUS_CHANGE="meeting.connection-status-change",a.MEETING_WAITING_FOR_HOST="meeting.waiting-for-host",a.MY_PARTICIPANT_UPDATED="my-participant.update",a.MY_PARTICIPANT_LEFT="my-participant.left",a.MY_PARTICIPANT_JOINED="my-participant.joined",a.MEETING_KICK_PARTICIPANT="meeting.kick-participant",a.DESTROY="destroy",a),ep=((l=ep||{}).FRAME_LOAD="frame.load",l.FRAME_DIMENSIONS_UPDATE="frame.dimensions-update",l.FRAME_PARENT_SIZE_UPDATE="frame.parent-window-size-update",l.FRAME_LOCALE_UPDATE="frame.locales-update",l.FRAME_AVATAR_LIST_UPDATE="frame.avatar-list-update",l.FRAME_COLOR_LIST_UPDATE="frame.color-list-update",l.FRAME_STYLES_UPDATE="frame.styles-update",l.FRAME_CALLBACKS_UPDATE="frame.callbacks-update",l),ef=((u=ef||{}).TOGGLE_MEETING_CHAT="meeting-controls.toggle-chat",u.TOGGLE_MEETING_SETUP="meeting-controls.toggle-setup",u.TOGGLE_MICROPHONE="meeting-controls.toggle-microphone",u.TOGGLE_CAM="meeting-controls.toggle-cam",u.TOGGLE_SCREENSHARE="meeting-controls.toggle-screenshare",u.TOGGLE_RECORDING="meeting-controls.toggle-recording",u.HANG_UP="hang-up",u.CALLBACK_CALLED="callback-called",u),em=((c=em||{}).REALTIME_PARTICIPANT_LIST_UPDATE="realtime.participant-list-update",c.REALTIME_HOST_CHANGE="realtime.host-change",c.REALTIME_GRID_MODE_CHANGE="realtime.grid-mode-change",c.REALTIME_WAIT_FOR_HOST="realtime.wait-for-host",c.REALTIME_AUTHENTICATION_FAILED="realtime.authentication-failed",c.REALTIME_GO_TO_PARTICIPANT="realtime.go-to-participant",c.REALTIME_GATHER="realtime.gather",c.REALTIME_FOLLOW_PARTICIPANT="realtime.follow-participant",c.REALTIME_LOCAL_FOLLOW_PARTICIPANT="realtime.local-follow-participant",c.REALTIME_SET_AVATAR="realtime.set-avatar",c.REALTIME_DRAWING_CHANGE="realtime.drawing-change",c.REALTIME_TRANSCRIPT_CHANGE="realtime.transcript-change",c.REALTIME_PRIVATE_MODE="realtime.private-mode",c),ev=((h=ev||{})[h.MEETING_FAILED=-1]="MEETING_FAILED",h[h.MEETING_DISCONNECTED=0]="MEETING_DISCONNECTED",h[h.MEETING_INITIALIZING=1]="MEETING_INITIALIZING",h[h.MEETING_READY_TO_JOIN=2]="MEETING_READY_TO_JOIN",h[h.MEETING_CONNECTING=3]="MEETING_CONNECTING",h[h.MEETING_CONNECTED=4]="MEETING_CONNECTED",h[h.MEETING_RECONNECT=5]="MEETING_RECONNECT",h[h.FRAME_INITIALIZING=6]="FRAME_INITIALIZING",h[h.FRAME_INITIALIZED=7]="FRAME_INITIALIZED",h[h.FRAME_UNINITIALIZED=8]="FRAME_UNINITIALIZED",h),eg=((d=eg||{}).JOINED="participant.joined",d.LOCAL_JOINED="participant.local-joined",d.LEFT="participant.left",d.LOCAL_LEFT="participant.local-left",d.LOCAL_UPDATED="participant.updated",d.LIST_UPDATED="participant.list-updated",d.SAME_ACCOUNT_ERROR="participant.same-account-error",d),eb=((p=eb||{})[p.NOT_AVAILABLE=0]="NOT_AVAILABLE",p[p.GOOD=1]="GOOD",p[p.BAD=2]="BAD",p[p.POOR=3]="POOR",p[p.DISCONNECTED=4]="DISCONNECTED",p[p.RECONNECTING=5]="RECONNECTING",p[p.LOST_CONNECTION=6]="LOST_CONNECTION",p),ey=((f=ey||{}).NO_CAM="devices.no-cam",f.NO_DEVICES="devices.no-devices",f.DEVICES_BLOCKED="devices.blocked",f.DEVICES_CAM_BLOCKED="devices.cam-blocked",f.DEVICES_INITIALIZATION_ERROR="devices.inititalization-error",f.DEVICES_UNKNOWN_ERROR="devices.unknown-error",f.DEVICES_ALLOWED="devices.allowed",f),e_=((m=e_||{}).PIN_ACTIVE="pin-mode.active",m.PIN_INACTIVE="pin-mode.inactive",m),ew=((v=ew||{}).MOUNT="mount",v.UNMOUNT="unmount",v),eE=((g=eE||{}).START_FOLLOWING_PARTICIPANT="who-is-online.start-following-participant",g.STOP_FOLLOWING_PARTICIPANT="who-is-online.stop-following-participant",g.ENTER_PRIVATE_MODE="who-is-online.enter-private-mode",g.LEAVE_PRIVATE_MODE="who-is-online.leave-private-mode",g.GATHER_ALL="who-is-online.gather-all",g.GO_TO_PARTICIPANT="who-is-online.go-to-participant",g.START_FOLLOW_ME="who-is-online.start-follow-me",g.STOP_FOLLOW_ME="who-is-online.stop-follow-me",g);eh();var eC=["rosybrown","red","saddlebrown","coral","orange","brown","goldenrod","olivegreen","darkolivegreen","seagreen","lightsea","teal","cadetblue","pastelblue","mediumslateblue","bluedark","navy","rebeccapurple","purple","vividorchid","darkmagenta","deepmagenta","fuchsia","violetred","pink","vibrantpink","paleredviolet","carmine","wine"],eP={turquoise:"#31E0B0",orange:"#FF5E10",blue:"#00ABF7",pink:"#FF00BB",purple:"#9C29FF",green:"#6FDD00",red:"#E30000",bluedark:"#304AFF",pinklight:"#FF89C4",purplelight:"#D597FF",greenlight:"#C6EC5C",orangelight:"#FFA115",bluelight:"#75DEFE",redlight:"#FAA291",brown:"#BB813F",yellow:"#FFEF33",olivegreen:"#93A000",lightyellow:"#FAE391",violetred:"#C03FA3",rosybrown:"#B58787",cadetblue:"#2095BB",lightsteelblue:"#ABB5FF",seagreen:"#04B45F",palegreen:"#8DE990",saddlebrown:"#964C42",pastelblue:"#77A1CC",palesilver:"#D2BABA",coral:"#DF6B6B",bisque:"#FFD9C4",goldenrod:"#DAA520",tan:"#D2BD93",darkolivegreen:"#536C27",mint:"#ADE6DF",lightsea:"#45AFAA",teal:"#036E6E",wine:"#760040",cyan:"#00FFFF",mediumslateblue:"#6674D7",navy:"#0013BB",rebeccapurple:"#663399",vividorchid:"#D429FF",darkmagenta:"#810E81",deepmagenta:"#C303C6",fuchsia:"#FA00FF",lavendermagenta:"#EE82EE",thistle:"#EEB4DD",vibrantpink:"#FF007A",cottoncandy:"#FFC0DE",paleredviolet:"#D96598",carmine:"#B50A52",gray:"#878291"};eh();var eA=((b=eA||{}).TOP_LEFT="top-left",b.TOP_RIGHT="top-right",b.BOTTOM_LEFT="bottom-left",b.BOTTOM_RIGHT="bottom-right",b);eh();var eS=((y=eS||{}).LEFT="left",y.RIGHT="right",y),eO=((_=eO||{}).TOP_LEFT="top-left",_.TOP_RIGHT="top-right",_.BOTTOM_LEFT="bottom-left",_.BOTTOM_RIGHT="bottom-right",_);eh();var eT=((w=eT||{}).ADD="add",w.SHOW="show",w),ex=eo((t,i)=>{eh(),(function(){var r,n="Expected a function",s="__lodash_hash_undefined__",a="__lodash_placeholder__",l=1/0,u=NaN,c=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],h="[object Arguments]",d="[object Array]",p="[object Boolean]",f="[object Date]",m="[object Error]",v="[object Function]",g="[object GeneratorFunction]",b="[object Map]",y="[object Number]",_="[object Object]",w="[object Promise]",E="[object RegExp]",C="[object Set]",P="[object String]",A="[object Symbol]",S="[object WeakMap]",O="[object ArrayBuffer]",T="[object DataView]",x="[object Float32Array]",k="[object Float64Array]",I="[object Int8Array]",M="[object Int16Array]",R="[object Int32Array]",F="[object Uint8Array]",L="[object Uint8ClampedArray]",N="[object Uint16Array]",D="[object Uint32Array]",j=/\b__p \+= '';/g,B=/\b(__p \+=) '' \+/g,U=/(__e\(.*?\)|\b__t\)) \+\n'';/g,z=/&(?:amp|lt|gt|quot|#39);/g,W=/[&<>"']/g,$=RegExp(z.source),V=RegExp(W.source),Z=/<%-([\s\S]+?)%>/g,G=/<%([\s\S]+?)%>/g,J=/<%=([\s\S]+?)%>/g,q=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,H=/^\w*$/,K=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Y=/[\\^$.*+?()[\]{}|]/g,Q=RegExp(Y.source),X=/^\s+/,ee=/\s/,et=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ei=/\{\n\/\* \[wrapped with (.+)\] \*/,er=/,? & /,en=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,es=/[()=,{}\[\]\/\s]/,eo=/\\(\\)?/g,ea=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,el=/\w*$/,eu=/^[-+]0x[0-9a-f]+$/i,ec=/^0b[01]+$/i,eh=/^\[object .+?Constructor\]$/,ed=/^0o[0-7]+$/i,ep=/^(?:0|[1-9]\d*)$/,ef=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,em=/($^)/,ev=/['\n\r\u2028\u2029\\]/g,eg="\ud800-\udfff",eb="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",ey="\\u2700-\\u27bf",e_="a-z\\xdf-\\xf6\\xf8-\\xff",ew="A-Z\\xc0-\\xd6\\xd8-\\xde",eE="\\ufe0e\\ufe0f",eC="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",eP="['’]",eA="["+eC+"]",eS="["+eb+"]",eO="["+e_+"]",eT="[^"+eg+eC+"\\d+"+ey+e_+ew+"]",ex="\ud83c[\udffb-\udfff]",ek="[^"+eg+"]",eI="(?:\ud83c[\udde6-\uddff]){2}",eM="[\ud800-\udbff][\udc00-\udfff]",eR="["+ew+"]",eF="\\u200d",eL="(?:"+eO+"|"+eT+")",eN="(?:"+eP+"(?:d|ll|m|re|s|t|ve))?",eD="(?:"+eP+"(?:D|LL|M|RE|S|T|VE))?",ej="(?:"+eS+"|"+ex+")?",eB="["+eE+"]?",eU="(?:"+eF+"(?:"+[ek,eI,eM].join("|")+")"+eB+ej+")*",ez=eB+ej+eU,eW="(?:"+["["+ey+"]",eI,eM].join("|")+")"+ez,e$="(?:"+[ek+eS+"?",eS,eI,eM,"["+eg+"]"].join("|")+")",eV=RegExp(eP,"g"),eZ=RegExp(eS,"g"),eG=RegExp(ex+"(?="+ex+")|"+e$+ez,"g"),eJ=RegExp([eR+"?"+eO+"+"+eN+"(?="+[eA,eR,"$"].join("|")+")","(?:"+eR+"|"+eT+")+"+eD+"(?="+[eA,eR+eL,"$"].join("|")+")",eR+"?"+eL+"+"+eN,eR+"+"+eD,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",eW].join("|"),"g"),eq=RegExp("["+eF+eg+eb+eE+"]"),eH=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,eK=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],eY=-1,eQ={};eQ[x]=eQ[k]=eQ[I]=eQ[M]=eQ[R]=eQ[F]=eQ[L]=eQ[N]=eQ[D]=!0,eQ[h]=eQ[d]=eQ[O]=eQ[p]=eQ[T]=eQ[f]=eQ[m]=eQ[v]=eQ[b]=eQ[y]=eQ[_]=eQ[E]=eQ[C]=eQ[P]=eQ[S]=!1;var eX={};eX[h]=eX[d]=eX[O]=eX[T]=eX[p]=eX[f]=eX[x]=eX[k]=eX[I]=eX[M]=eX[R]=eX[b]=eX[y]=eX[_]=eX[E]=eX[C]=eX[P]=eX[A]=eX[F]=eX[L]=eX[N]=eX[D]=!0,eX[m]=eX[v]=eX[S]=!1;var e0={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},e1=parseFloat,e3=parseInt,e2="object"==typeof window&&window&&window.Object===Object&&window,e9="object"==typeof self&&self&&self.Object===Object&&self,e6=e2||e9||Function("return this")(),e4="object"==typeof t&&t&&!t.nodeType&&t,e5=e4&&"object"==typeof i&&i&&!i.nodeType&&i,e7=e5&&e5.exports===e4,e8=e7&&e2.process,te=function(){try{return e5&&e5.require&&e5.require("util").types||e8&&e8.binding&&e8.binding("util")}catch{}}(),tt=te&&te.isArrayBuffer,ti=te&&te.isDate,tr=te&&te.isMap,tn=te&&te.isRegExp,ts=te&&te.isSet,to=te&&te.isTypedArray;function ta(t,i,r){switch(r.length){case 0:return t.call(i);case 1:return t.call(i,r[0]);case 2:return t.call(i,r[0],r[1]);case 3:return t.call(i,r[0],r[1],r[2])}return t.apply(i,r)}function tl(t,i,r,n){for(var s=-1,a=null==t?0:t.length;++s<a;){var l=t[s];i(n,l,r(l),t)}return n}function tu(t,i){for(var r=-1,n=null==t?0:t.length;++r<n&&!1!==i(t[r],r,t););return t}function tc(t,i){for(var r=-1,n=null==t?0:t.length;++r<n;)if(!i(t[r],r,t))return!1;return!0}function th(t,i){for(var r=-1,n=null==t?0:t.length,s=0,a=[];++r<n;){var l=t[r];i(l,r,t)&&(a[s++]=l)}return a}function td(t,i){return!!(null==t?0:t.length)&&tE(t,i,0)>-1}function tp(t,i,r){for(var n=-1,s=null==t?0:t.length;++n<s;)if(r(i,t[n]))return!0;return!1}function tf(t,i){for(var r=-1,n=null==t?0:t.length,s=Array(n);++r<n;)s[r]=i(t[r],r,t);return s}function tm(t,i){for(var r=-1,n=i.length,s=t.length;++r<n;)t[s+r]=i[r];return t}function tv(t,i,r,n){var s=-1,a=null==t?0:t.length;for(n&&a&&(r=t[++s]);++s<a;)r=i(r,t[s],s,t);return r}function tg(t,i,r,n){var s=null==t?0:t.length;for(n&&s&&(r=t[--s]);s--;)r=i(r,t[s],s,t);return r}function tb(t,i){for(var r=-1,n=null==t?0:t.length;++r<n;)if(i(t[r],r,t))return!0;return!1}var ty=tS("length");function t_(t,i,r){var n;return r(t,function(t,r,s){if(i(t,r,s))return n=r,!1}),n}function tw(t,i,r,n){for(var s=t.length,a=r+(n?1:-1);n?a--:++a<s;)if(i(t[a],a,t))return a;return -1}function tE(t,i,r){return i==i?function(t,i,r){for(var n=r-1,s=t.length;++n<s;)if(t[n]===i)return n;return -1}(t,i,r):tw(t,tP,r)}function tC(t,i,r,n){for(var s=r-1,a=t.length;++s<a;)if(n(t[s],i))return s;return -1}function tP(t){return t!=t}function tA(t,i){var r=null==t?0:t.length;return r?tx(t,i)/r:u}function tS(t){return function(i){return null==i?r:i[t]}}function tO(t){return function(i){return null==t?r:t[i]}}function tT(t,i,r,n,s){return s(t,function(t,s,a){r=n?(n=!1,t):i(r,t,s,a)}),r}function tx(t,i){for(var n,s=-1,a=t.length;++s<a;){var l=i(t[s]);l!==r&&(n=n===r?l:n+l)}return n}function tk(t,i){for(var r=-1,n=Array(t);++r<t;)n[r]=i(r);return n}function tI(t){return t&&t.slice(0,tJ(t)+1).replace(X,"")}function tM(t){return function(i){return t(i)}}function tR(t,i){return tf(i,function(i){return t[i]})}function tF(t,i){return t.has(i)}function tL(t,i){for(var r=-1,n=t.length;++r<n&&tE(i,t[r],0)>-1;);return r}function tN(t,i){for(var r=t.length;r--&&tE(i,t[r],0)>-1;);return r}var tD=tO({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),tj=tO({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function tB(t){return"\\"+e0[t]}function tU(t){return eq.test(t)}function tz(t){var i=-1,r=Array(t.size);return t.forEach(function(t,n){r[++i]=[n,t]}),r}function tW(t,i){return function(r){return t(i(r))}}function t$(t,i){for(var r=-1,n=t.length,s=0,l=[];++r<n;){var u=t[r];(u===i||u===a)&&(t[r]=a,l[s++]=r)}return l}function tV(t){var i=-1,r=Array(t.size);return t.forEach(function(t){r[++i]=t}),r}function tZ(t){return tU(t)?function(t){for(var i=eG.lastIndex=0;eG.test(t);)++i;return i}(t):ty(t)}function tG(t){return tU(t)?t.match(eG)||[]:t.split("")}function tJ(t){for(var i=t.length;i--&&ee.test(t.charAt(i)););return i}var tq=tO({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),tH=function t(i){var ee,eg,eb,ey,e_=(i=null==i?e6:tH.defaults(e6.Object(),i,tH.pick(e6,eK))).Array,ew=i.Date,eE=i.Error,eC=i.Function,eP=i.Math,eA=i.Object,eS=i.RegExp,eO=i.String,eT=i.TypeError,ex=e_.prototype,ek=eC.prototype,eI=eA.prototype,eM=i["__core-js_shared__"],eR=ek.toString,eF=eI.hasOwnProperty,eL=0,eN=(ee=/[^.]+$/.exec(eM&&eM.keys&&eM.keys.IE_PROTO||""))?"Symbol(src)_1."+ee:"",eD=eI.toString,ej=eR.call(eA),eB=e6._,eU=eS("^"+eR.call(eF).replace(Y,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ez=e7?i.Buffer:r,eW=i.Symbol,e$=i.Uint8Array,eG=ez?ez.allocUnsafe:r,eq=tW(eA.getPrototypeOf,eA),e0=eA.create,e2=eI.propertyIsEnumerable,e9=ex.splice,e4=eW?eW.isConcatSpreadable:r,e5=eW?eW.iterator:r,e8=eW?eW.toStringTag:r,te=function(){try{var t=nv(eA,"defineProperty");return t({},"",{}),t}catch{}}(),ty=i.clearTimeout!==e6.clearTimeout&&i.clearTimeout,tO=ew&&ew.now!==e6.Date.now&&ew.now,tK=i.setTimeout!==e6.setTimeout&&i.setTimeout,tY=eP.ceil,tQ=eP.floor,tX=eA.getOwnPropertySymbols,t0=ez?ez.isBuffer:r,t1=i.isFinite,t3=ex.join,t2=tW(eA.keys,eA),t9=eP.max,t6=eP.min,t4=ew.now,t5=i.parseInt,t7=eP.random,t8=ex.reverse,ie=nv(i,"DataView"),it=nv(i,"Map"),ii=nv(i,"Promise"),ir=nv(i,"Set"),is=nv(i,"WeakMap"),io=nv(eA,"create"),ia=is&&new is,il={},iu=nz(ie),ic=nz(it),ih=nz(ii),id=nz(ir),ip=nz(is),im=eW?eW.prototype:r,iv=im?im.valueOf:r,ig=im?im.toString:r;function ib(t){if(sq(t)&&!sD(t)&&!(t instanceof iE)){if(t instanceof iw)return t;if(eF.call(t,"__wrapped__"))return nW(t)}return new iw(t)}var iy=function(){function t(){}return function(i){if(!sJ(i))return{};if(e0)return e0(i);t.prototype=i;var n=new t;return t.prototype=r,n}}();function i_(){}function iw(t,i){this.__wrapped__=t,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}function iE(t){this.__wrapped__=t,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function iC(t){var i=-1,r=null==t?0:t.length;for(this.clear();++i<r;){var n=t[i];this.set(n[0],n[1])}}function iP(t){var i=-1,r=null==t?0:t.length;for(this.clear();++i<r;){var n=t[i];this.set(n[0],n[1])}}function iA(t){var i=-1,r=null==t?0:t.length;for(this.clear();++i<r;){var n=t[i];this.set(n[0],n[1])}}function iS(t){var i=-1,r=null==t?0:t.length;for(this.__data__=new iA;++i<r;)this.add(t[i])}function iO(t){var i=this.__data__=new iP(t);this.size=i.size}function iT(t,i){var r=sD(t),n=!r&&sN(t),s=!r&&!n&&sz(t),a=!r&&!n&&!s&&s3(t),l=r||n||s||a,u=l?tk(t.length,eO):[],c=u.length;for(var h in t)(i||eF.call(t,h))&&!(l&&("length"==h||s&&("offset"==h||"parent"==h)||a&&("buffer"==h||"byteLength"==h||"byteOffset"==h)||nC(h,c)))&&u.push(h);return u}function ix(t){var i=t.length;return i?t[rp(0,i-1)]:r}function ik(t,i,n){(n===r||sR(t[i],n))&&(n!==r||i in t)||iL(t,i,n)}function iI(t,i,n){var s=t[i];eF.call(t,i)&&sR(s,n)&&(n!==r||i in t)||iL(t,i,n)}function iM(t,i){for(var r=t.length;r--;)if(sR(t[r][0],i))return r;return -1}function iR(t,i,r,n){return iW(t,function(t,s,a){i(n,t,r(t),a)}),n}function iF(t,i){return t&&rZ(i,of(i),t)}function iL(t,i,r){"__proto__"==i&&te?te(t,i,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[i]=r}function iN(t,i){for(var n=-1,s=i.length,a=e_(s),l=null==t;++n<s;)a[n]=l?r:ou(t,i[n]);return a}function iD(t,i,n){return t==t&&(n!==r&&(t=t<=n?t:n),i!==r&&(t=t>=i?t:i)),t}function ij(t,i,n,s,a,l){var u,c=1&i,d=2&i,m=4&i;if(n&&(u=a?n(t,s,a,l):n(t)),u!==r)return u;if(!sJ(t))return t;var w=sD(t);if(w){if(S=t.length,j=new t.constructor(S),S&&"string"==typeof t[0]&&eF.call(t,"index")&&(j.index=t.index,j.input=t.input),u=j,!c)return rV(t,u)}else{var S,j,B,U,z,W=ny(t),$=W==v||W==g;if(sz(t))return rj(t,c);if(W==_||W==h||$&&!a){if(u=d||$?{}:nw(t),!c)return d?(B=(z=u)&&rZ(t,om(t),z),rZ(t,nb(t),B)):(U=iF(u,t),rZ(t,ng(t),U))}else{if(!eX[W])return a?t:{};u=function(t,i,r){var n,s,a=t.constructor;switch(i){case O:return rB(t);case p:case f:return new a(+t);case T:return n=r?rB(t.buffer):t.buffer,new t.constructor(n,t.byteOffset,t.byteLength);case x:case k:case I:case M:case R:case F:case L:case N:case D:return rU(t,r);case b:return new a;case y:case P:return new a(t);case E:return(s=new t.constructor(t.source,el.exec(t))).lastIndex=t.lastIndex,s;case C:return new a;case A:return iv?eA(iv.call(t)):{}}}(t,W,c)}}l||(l=new iO);var V=l.get(t);if(V)return V;l.set(t,u),sX(t)?t.forEach(function(r){u.add(ij(r,i,n,r,t,l))}):sH(t)&&t.forEach(function(r,s){u.set(s,ij(r,i,n,s,t,l))});var Z=m?d?nu:nl:d?om:of,G=w?r:Z(t);return tu(G||t,function(r,s){G&&(r=t[s=r]),iI(u,s,ij(r,i,n,s,t,l))}),u}function iB(t,i,n){var s=n.length;if(null==t)return!s;for(t=eA(t);s--;){var a=n[s],l=i[a],u=t[a];if(u===r&&!(a in t)||!l(u))return!1}return!0}function iU(t,i,s){if("function"!=typeof t)throw new eT(n);return nF(function(){t.apply(r,s)},i)}function iz(t,i,r,n){var s=-1,a=td,l=!0,u=t.length,c=[],h=i.length;if(!u)return c;r&&(i=tf(i,tM(r))),n?(a=tp,l=!1):i.length>=200&&(a=tF,l=!1,i=new iS(i));e:for(;++s<u;){var d=t[s],p=null==r?d:r(d);if(d=n||0!==d?d:0,l&&p==p){for(var f=h;f--;)if(i[f]===p)continue e;c.push(d)}else a(i,p,n)||c.push(d)}return c}ib.templateSettings={escape:Z,evaluate:G,interpolate:J,variable:"",imports:{_:ib}},ib.prototype=i_.prototype,ib.prototype.constructor=ib,iw.prototype=iy(i_.prototype),iw.prototype.constructor=iw,iE.prototype=iy(i_.prototype),iE.prototype.constructor=iE,iC.prototype.clear=function(){this.__data__=io?io(null):{},this.size=0},iC.prototype.delete=function(t){var i=this.has(t)&&delete this.__data__[t];return this.size-=i?1:0,i},iC.prototype.get=function(t){var i=this.__data__;if(io){var n=i[t];return n===s?r:n}return eF.call(i,t)?i[t]:r},iC.prototype.has=function(t){var i=this.__data__;return io?i[t]!==r:eF.call(i,t)},iC.prototype.set=function(t,i){var n=this.__data__;return this.size+=this.has(t)?0:1,n[t]=io&&i===r?s:i,this},iP.prototype.clear=function(){this.__data__=[],this.size=0},iP.prototype.delete=function(t){var i=this.__data__,r=iM(i,t);return!(r<0)&&(r==i.length-1?i.pop():e9.call(i,r,1),--this.size,!0)},iP.prototype.get=function(t){var i=this.__data__,n=iM(i,t);return n<0?r:i[n][1]},iP.prototype.has=function(t){return iM(this.__data__,t)>-1},iP.prototype.set=function(t,i){var r=this.__data__,n=iM(r,t);return n<0?(++this.size,r.push([t,i])):r[n][1]=i,this},iA.prototype.clear=function(){this.size=0,this.__data__={hash:new iC,map:new(it||iP),string:new iC}},iA.prototype.delete=function(t){var i=nf(this,t).delete(t);return this.size-=i?1:0,i},iA.prototype.get=function(t){return nf(this,t).get(t)},iA.prototype.has=function(t){return nf(this,t).has(t)},iA.prototype.set=function(t,i){var r=nf(this,t),n=r.size;return r.set(t,i),this.size+=r.size==n?0:1,this},iS.prototype.add=iS.prototype.push=function(t){return this.__data__.set(t,s),this},iS.prototype.has=function(t){return this.__data__.has(t)},iO.prototype.clear=function(){this.__data__=new iP,this.size=0},iO.prototype.delete=function(t){var i=this.__data__,r=i.delete(t);return this.size=i.size,r},iO.prototype.get=function(t){return this.__data__.get(t)},iO.prototype.has=function(t){return this.__data__.has(t)},iO.prototype.set=function(t,i){var r=this.__data__;if(r instanceof iP){var n=r.__data__;if(!it||n.length<199)return n.push([t,i]),this.size=++r.size,this;r=this.__data__=new iA(n)}return r.set(t,i),this.size=r.size,this};var iW=rq(iK),i$=rq(iY,!0);function iV(t,i){var r=!0;return iW(t,function(t,n,s){return r=!!i(t,n,s)}),r}function iZ(t,i,n){for(var s=-1,a=t.length;++s<a;){var l=t[s],u=i(l);if(null!=u&&(c===r?u==u&&!s1(u):n(u,c)))var c=u,h=l}return h}function iG(t,i){var r=[];return iW(t,function(t,n,s){i(t,n,s)&&r.push(t)}),r}function iJ(t,i,r,n,s){var a=-1,l=t.length;for(r||(r=nE),s||(s=[]);++a<l;){var u=t[a];i>0&&r(u)?i>1?iJ(u,i-1,r,n,s):tm(s,u):n||(s[s.length]=u)}return s}var iq=rH(),iH=rH(!0);function iK(t,i){return t&&iq(t,i,of)}function iY(t,i){return t&&iH(t,i,of)}function iQ(t,i){return th(i,function(i){return sV(t[i])})}function iX(t,i){i=rL(i,t);for(var n=0,s=i.length;null!=t&&n<s;)t=t[nU(i[n++])];return n&&n==s?t:r}function i0(t,i,r){var n=i(t);return sD(t)?n:tm(n,r(t))}function i1(t){return null==t?t===r?"[object Undefined]":"[object Null]":e8&&e8 in eA(t)?function(t){var i=eF.call(t,e8),n=t[e8];try{t[e8]=r;var s=!0}catch{}var a=eD.call(t);return s&&(i?t[e8]=n:delete t[e8]),a}(t):eD.call(t)}function i3(t,i){return t>i}function i2(t,i){return null!=t&&eF.call(t,i)}function i9(t,i){return null!=t&&i in eA(t)}function i6(t,i,n){for(var s=n?tp:td,a=t[0].length,l=t.length,u=l,c=e_(l),h=1/0,d=[];u--;){var p=t[u];u&&i&&(p=tf(p,tM(i))),h=t6(p.length,h),c[u]=!n&&(i||a>=120&&p.length>=120)?new iS(u&&p):r}p=t[0];var f=-1,m=c[0];e:for(;++f<a&&d.length<h;){var v=p[f],g=i?i(v):v;if(v=n||0!==v?v:0,!(m?tF(m,g):s(d,g,n))){for(u=l;--u;){var b=c[u];if(!(b?tF(b,g):s(t[u],g,n)))continue e}m&&m.push(g),d.push(v)}}return d}function i4(t,i,n){i=rL(i,t);var s=null==(t=nI(t,i))?t:t[nU(nX(i))];return null==s?r:ta(s,t,n)}function i5(t){return sq(t)&&i1(t)==h}function i7(t,i,n,s,a){return t===i||(null!=t&&null!=i&&(sq(t)||sq(i))?function(t,i,n,s,a,l){var u=sD(t),c=sD(i),v=u?d:ny(t),g=c?d:ny(i);v=v==h?_:v,g=g==h?_:g;var w=v==_,S=g==_,x=v==g;if(x&&sz(t)){if(!sz(i))return!1;u=!0,w=!1}if(x&&!w)return l||(l=new iO),u||s3(t)?no(t,i,n,s,a,l):function(t,i,r,n,s,a,l){switch(r){case T:if(t.byteLength!=i.byteLength||t.byteOffset!=i.byteOffset)break;t=t.buffer,i=i.buffer;case O:return!(t.byteLength!=i.byteLength||!a(new e$(t),new e$(i)));case p:case f:case y:return sR(+t,+i);case m:return t.name==i.name&&t.message==i.message;case E:case P:return t==i+"";case b:var u=tz;case C:var c=1&n;if(u||(u=tV),t.size!=i.size&&!c)break;var h=l.get(t);if(h)return h==i;n|=2,l.set(t,i);var d=no(u(t),u(i),n,s,a,l);return l.delete(t),d;case A:if(iv)return iv.call(t)==iv.call(i)}return!1}(t,i,v,n,s,a,l);if(!(1&n)){var k=w&&eF.call(t,"__wrapped__"),I=S&&eF.call(i,"__wrapped__");if(k||I){var M=k?t.value():t,R=I?i.value():i;return l||(l=new iO),a(M,R,n,s,l)}}return!!x&&(l||(l=new iO),function(t,i,n,s,a,l){var u=1&n,c=nl(t),h=c.length;if(h!=nl(i).length&&!u)return!1;for(var d=h;d--;){var p=c[d];if(!(u?p in i:eF.call(i,p)))return!1}var f=l.get(t),m=l.get(i);if(f&&m)return f==i&&m==t;var v=!0;l.set(t,i),l.set(i,t);for(var g=u;++d<h;){var b=t[p=c[d]],y=i[p];if(s)var _=u?s(y,b,p,i,t,l):s(b,y,p,t,i,l);if(!(_===r?b===y||a(b,y,n,s,l):_)){v=!1;break}g||(g="constructor"==p)}if(v&&!g){var w=t.constructor,E=i.constructor;w!=E&&"constructor"in t&&"constructor"in i&&!("function"==typeof w&&w instanceof w&&"function"==typeof E&&E instanceof E)&&(v=!1)}return l.delete(t),l.delete(i),v}(t,i,n,s,a,l))}(t,i,n,s,i7,a):t!=t&&i!=i)}function i8(t,i,n,s){var a=n.length,l=a,u=!s;if(null==t)return!l;for(t=eA(t);a--;){var c=n[a];if(u&&c[2]?c[1]!==t[c[0]]:!(c[0]in t))return!1}for(;++a<l;){var h=(c=n[a])[0],d=t[h],p=c[1];if(u&&c[2]){if(d===r&&!(h in t))return!1}else{var f=new iO;if(s)var m=s(d,p,h,t,i,f);if(!(m===r?i7(p,d,3,s,f):m))return!1}}return!0}function re(t){return!(!sJ(t)||eN&&eN in t)&&(sV(t)?eU:eh).test(nz(t))}function rt(t){return"function"==typeof t?t:null==t?oU:"object"==typeof t?sD(t)?ro(t[0],t[1]):rs(t):oH(t)}function ri(t){if(!nT(t))return t2(t);var i=[];for(var r in eA(t))eF.call(t,r)&&"constructor"!=r&&i.push(r);return i}function rr(t,i){return t<i}function rn(t,i){var r=-1,n=sB(t)?e_(t.length):[];return iW(t,function(t,s,a){n[++r]=i(t,s,a)}),n}function rs(t){var i=nm(t);return 1==i.length&&i[0][2]?nx(i[0][0],i[0][1]):function(r){return r===t||i8(r,t,i)}}function ro(t,i){var n;return nA(t)&&(n=i)==n&&!sJ(n)?nx(nU(t),i):function(n){var s=ou(n,t);return s===r&&s===i?oc(n,t):i7(i,s,3)}}function ra(t,i,n,s,a){t!==i&&iq(i,function(l,u){if(a||(a=new iO),sJ(l))(function(t,i,n,s,a,l,u){var c=nM(t,n),h=nM(i,n),d=u.get(h);if(d){ik(t,n,d);return}var p=l?l(c,h,n+"",t,i,u):r,f=p===r;if(f){var m=sD(h),v=!m&&sz(h),g=!m&&!v&&s3(h);p=h,m||v||g?sD(c)?p=c:sU(c)?p=rV(c):v?(f=!1,p=rj(h,!0)):g?(f=!1,p=rU(h,!0)):p=[]:sY(h)||sN(h)?(p=c,sN(c)?p=oe(c):(!sJ(c)||sV(c))&&(p=nw(h))):f=!1}f&&(u.set(h,p),a(p,h,s,l,u),u.delete(h)),ik(t,n,p)})(t,i,u,n,ra,s,a);else{var c=s?s(nM(t,u),l,u+"",t,i,a):r;c===r&&(c=l),ik(t,u,c)}},om)}function rl(t,i){var n=t.length;if(n)return nC(i+=i<0?n:0,n)?t[i]:r}function ru(t,i,r){i=i.length?tf(i,function(t){return sD(t)?function(i){return iX(i,1===t.length?t[0]:t)}:t}):[oU];var n=-1;return i=tf(i,tM(np())),function(t,i){var r=t.length;for(t.sort(i);r--;)t[r]=t[r].value;return t}(rn(t,function(t,r,s){return{criteria:tf(i,function(i){return i(t)}),index:++n,value:t}}),function(t,i){return function(t,i,r){for(var n=-1,s=t.criteria,a=i.criteria,l=s.length,u=r.length;++n<l;){var c=rz(s[n],a[n]);if(c){if(n>=u)return c;return c*("desc"==r[n]?-1:1)}}return t.index-i.index}(t,i,r)})}function rc(t,i,r){for(var n=-1,s=i.length,a={};++n<s;){var l=i[n],u=iX(t,l);r(u,l)&&rv(a,rL(l,t),u)}return a}function rh(t,i,r,n){var s=n?tC:tE,a=-1,l=i.length,u=t;for(t===i&&(i=rV(i)),r&&(u=tf(t,tM(r)));++a<l;)for(var c=0,h=i[a],d=r?r(h):h;(c=s(u,d,c,n))>-1;)u!==t&&e9.call(u,c,1),e9.call(t,c,1);return t}function rd(t,i){for(var r=t?i.length:0,n=r-1;r--;){var s=i[r];if(r==n||s!==a){var a=s;nC(s)?e9.call(t,s,1):rO(t,s)}}return t}function rp(t,i){return t+tQ(t7()*(i-t+1))}function rf(t,i){var r="";if(!t||i<1||i>9007199254740991)return r;do i%2&&(r+=t),(i=tQ(i/2))&&(t+=t);while(i);return r}function rm(t,i){return nL(nk(t,i,oU),t+"")}function rv(t,i,n,s){if(!sJ(t))return t;i=rL(i,t);for(var a=-1,l=i.length,u=l-1,c=t;null!=c&&++a<l;){var h=nU(i[a]),d=n;if("__proto__"===h||"constructor"===h||"prototype"===h)break;if(a!=u){var p=c[h];(d=s?s(p,h,c):r)===r&&(d=sJ(p)?p:nC(i[a+1])?[]:{})}iI(c,h,d),c=c[h]}return t}var rg=ia?function(t,i){return ia.set(t,i),t}:oU,rb=te?function(t,i){return te(t,"toString",{configurable:!0,enumerable:!1,value:oD(i),writable:!0})}:oU;function ry(t,i,r){var n=-1,s=t.length;i<0&&(i=-i>s?0:s+i),(r=r>s?s:r)<0&&(r+=s),s=i>r?0:r-i>>>0,i>>>=0;for(var a=e_(s);++n<s;)a[n]=t[n+i];return a}function r_(t,i){var r;return iW(t,function(t,n,s){return!(r=i(t,n,s))}),!!r}function rw(t,i,r){var n=0,s=null==t?n:t.length;if("number"==typeof i&&i==i&&s<=2147483647){for(;n<s;){var a=n+s>>>1,l=t[a];null!==l&&!s1(l)&&(r?l<=i:l<i)?n=a+1:s=a}return s}return rE(t,i,oU,r)}function rE(t,i,n,s){var a=0,l=null==t?0:t.length;if(0===l)return 0;i=n(i);for(var u=i!=i,c=null===i,h=s1(i),d=i===r;a<l;){var p=tQ((a+l)/2),f=n(t[p]),m=f!==r,v=null===f,g=f==f,b=s1(f);if(u)var y=s||g;else y=d?g&&(s||m):c?g&&m&&(s||!v):h?g&&m&&!v&&(s||!b):!v&&!b&&(s?f<=i:f<i);y?a=p+1:l=p}return t6(l,4294967294)}function rC(t,i){for(var r=-1,n=t.length,s=0,a=[];++r<n;){var l=t[r],u=i?i(l):l;if(!r||!sR(u,c)){var c=u;a[s++]=0===l?0:l}}return a}function rP(t){return"number"==typeof t?t:s1(t)?u:+t}function rA(t){if("string"==typeof t)return t;if(sD(t))return tf(t,rA)+"";if(s1(t))return ig?ig.call(t):"";var i=t+"";return"0"==i&&1/t==-l?"-0":i}function rS(t,i,r){var n=-1,s=td,a=t.length,l=!0,u=[],c=u;if(r)l=!1,s=tp;else if(a>=200){var h=i?null:ne(t);if(h)return tV(h);l=!1,s=tF,c=new iS}else c=i?[]:u;e:for(;++n<a;){var d=t[n],p=i?i(d):d;if(d=r||0!==d?d:0,l&&p==p){for(var f=c.length;f--;)if(c[f]===p)continue e;i&&c.push(p),u.push(d)}else s(c,p,r)||(c!==u&&c.push(p),u.push(d))}return u}function rO(t,i){return i=rL(i,t),null==(t=nI(t,i))||delete t[nU(nX(i))]}function rT(t,i,r,n){return rv(t,i,r(iX(t,i)),n)}function rx(t,i,r,n){for(var s=t.length,a=n?s:-1;(n?a--:++a<s)&&i(t[a],a,t););return r?ry(t,n?0:a,n?a+1:s):ry(t,n?a+1:0,n?s:a)}function rk(t,i){var r=t;return r instanceof iE&&(r=r.value()),tv(i,function(t,i){return i.func.apply(i.thisArg,tm([t],i.args))},r)}function rI(t,i,r){var n=t.length;if(n<2)return n?rS(t[0]):[];for(var s=-1,a=e_(n);++s<n;)for(var l=t[s],u=-1;++u<n;)u!=s&&(a[s]=iz(a[s]||l,t[u],i,r));return rS(iJ(a,1),i,r)}function rM(t,i,n){for(var s=-1,a=t.length,l=i.length,u={};++s<a;){var c=s<l?i[s]:r;n(u,t[s],c)}return u}function rR(t){return sU(t)?t:[]}function rF(t){return"function"==typeof t?t:oU}function rL(t,i){return sD(t)?t:nA(t,i)?[t]:nB(ot(t))}function rN(t,i,n){var s=t.length;return n=n===r?s:n,!i&&n>=s?t:ry(t,i,n)}var rD=ty||function(t){return e6.clearTimeout(t)};function rj(t,i){if(i)return t.slice();var r=t.length,n=eG?eG(r):new t.constructor(r);return t.copy(n),n}function rB(t){var i=new t.constructor(t.byteLength);return new e$(i).set(new e$(t)),i}function rU(t,i){var r=i?rB(t.buffer):t.buffer;return new t.constructor(r,t.byteOffset,t.length)}function rz(t,i){if(t!==i){var n=t!==r,s=null===t,a=t==t,l=s1(t),u=i!==r,c=null===i,h=i==i,d=s1(i);if(!c&&!d&&!l&&t>i||l&&u&&h&&!c&&!d||s&&u&&h||!n&&h||!a)return 1;if(!s&&!l&&!d&&t<i||d&&n&&a&&!s&&!l||c&&n&&a||!u&&a||!h)return -1}return 0}function rW(t,i,r,n){for(var s=-1,a=t.length,l=r.length,u=-1,c=i.length,h=t9(a-l,0),d=e_(c+h),p=!n;++u<c;)d[u]=i[u];for(;++s<l;)(p||s<a)&&(d[r[s]]=t[s]);for(;h--;)d[u++]=t[s++];return d}function r$(t,i,r,n){for(var s=-1,a=t.length,l=-1,u=r.length,c=-1,h=i.length,d=t9(a-u,0),p=e_(d+h),f=!n;++s<d;)p[s]=t[s];for(var m=s;++c<h;)p[m+c]=i[c];for(;++l<u;)(f||s<a)&&(p[m+r[l]]=t[s++]);return p}function rV(t,i){var r=-1,n=t.length;for(i||(i=e_(n));++r<n;)i[r]=t[r];return i}function rZ(t,i,n,s){var a=!n;n||(n={});for(var l=-1,u=i.length;++l<u;){var c=i[l],h=s?s(n[c],t[c],c,n,t):r;h===r&&(h=t[c]),a?iL(n,c,h):iI(n,c,h)}return n}function rG(t,i){return function(r,n){var s=sD(r)?tl:iR,a=i?i():{};return s(r,t,np(n,2),a)}}function rJ(t){return rm(function(i,n){var s=-1,a=n.length,l=a>1?n[a-1]:r,u=a>2?n[2]:r;for(l=t.length>3&&"function"==typeof l?(a--,l):r,u&&nP(n[0],n[1],u)&&(l=a<3?r:l,a=1),i=eA(i);++s<a;){var c=n[s];c&&t(i,c,s,l)}return i})}function rq(t,i){return function(r,n){if(null==r)return r;if(!sB(r))return t(r,n);for(var s=r.length,a=i?s:-1,l=eA(r);(i?a--:++a<s)&&!1!==n(l[a],a,l););return r}}function rH(t){return function(i,r,n){for(var s=-1,a=eA(i),l=n(i),u=l.length;u--;){var c=l[t?u:++s];if(!1===r(a[c],c,a))break}return i}}function rK(t){return function(i){var n=tU(i=ot(i))?tG(i):r,s=n?n[0]:i.charAt(0),a=n?rN(n,1).join(""):i.slice(1);return s[t]()+a}}function rY(t){return function(i){return tv(oF(oS(i).replace(eV,"")),t,"")}}function rQ(t){return function(){var i=arguments;switch(i.length){case 0:return new t;case 1:return new t(i[0]);case 2:return new t(i[0],i[1]);case 3:return new t(i[0],i[1],i[2]);case 4:return new t(i[0],i[1],i[2],i[3]);case 5:return new t(i[0],i[1],i[2],i[3],i[4]);case 6:return new t(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new t(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var r=iy(t.prototype),n=t.apply(r,i);return sJ(n)?n:r}}function rX(t){return function(i,n,s){var a=eA(i);if(!sB(i)){var l=np(n,3);i=of(i),n=function(t){return l(a[t],t,a)}}var u=t(i,n,s);return u>-1?a[l?i[u]:u]:r}}function r0(t){return na(function(i){var s=i.length,a=s,l=iw.prototype.thru;for(t&&i.reverse();a--;){var u=i[a];if("function"!=typeof u)throw new eT(n);if(l&&!c&&"wrapper"==nh(u))var c=new iw([],!0)}for(a=c?a:s;++a<s;){var h=nh(u=i[a]),d="wrapper"==h?nc(u):r;c=d&&nS(d[0])&&424==d[1]&&!d[4].length&&1==d[9]?c[nh(d[0])].apply(c,d[3]):1==u.length&&nS(u)?c[h]():c.thru(u)}return function(){var t=arguments,r=t[0];if(c&&1==t.length&&sD(r))return c.plant(r).value();for(var n=0,a=s?i[n].apply(this,t):r;++n<s;)a=i[n].call(this,a);return a}})}function r1(t,i,n,s,a,l,u,c,h,d){var p=128&i,f=1&i,m=2&i,v=24&i,g=512&i,b=m?r:rQ(t);return function y(){for(var _=arguments.length,w=e_(_),E=_;E--;)w[E]=arguments[E];if(v)var C=nd(y),P=function(t,i){for(var r=t.length,n=0;r--;)t[r]===i&&++n;return n}(w,C);if(s&&(w=rW(w,s,a,v)),l&&(w=r$(w,l,u,v)),_-=P,v&&_<d){var A=t$(w,C);return r7(t,i,r1,y.placeholder,n,w,A,c,h,d-_)}var S=f?n:this,O=m?S[t]:t;return _=w.length,c?w=function(t,i){for(var n=t.length,s=t6(i.length,n),a=rV(t);s--;){var l=i[s];t[s]=nC(l,n)?a[l]:r}return t}(w,c):g&&_>1&&w.reverse(),p&&h<_&&(w.length=h),this&&this!==e6&&this instanceof y&&(O=b||rQ(O)),O.apply(S,w)}}function r3(t,i){return function(r,n){var s,a;return s=i(n),a={},iK(r,function(i,r,n){t(a,s(i),r,n)}),a}}function r2(t,i){return function(n,s){var a;if(n===r&&s===r)return i;if(n!==r&&(a=n),s!==r){if(a===r)return s;"string"==typeof n||"string"==typeof s?(n=rA(n),s=rA(s)):(n=rP(n),s=rP(s)),a=t(n,s)}return a}}function r9(t){return na(function(i){return i=tf(i,tM(np())),rm(function(r){var n=this;return t(i,function(t){return ta(t,n,r)})})})}function r6(t,i){var n=(i=i===r?" ":rA(i)).length;if(n<2)return n?rf(i,t):i;var s=rf(i,tY(t/tZ(i)));return tU(i)?rN(tG(s),0,t).join(""):s.slice(0,t)}function r4(t){return function(i,n,s){return s&&"number"!=typeof s&&nP(i,n,s)&&(n=s=r),i=s4(i),n===r?(n=i,i=0):n=s4(n),s=s===r?i<n?1:-1:s4(s),function(t,i,r,n){for(var s=-1,a=t9(tY((i-t)/(r||1)),0),l=e_(a);a--;)l[n?a:++s]=t,t+=r;return l}(i,n,s,t)}}function r5(t){return function(i,r){return"string"==typeof i&&"string"==typeof r||(i=s8(i),r=s8(r)),t(i,r)}}function r7(t,i,n,s,a,l,u,c,h,d){var p=8&i,f=p?u:r,m=p?r:u,v=p?l:r,g=p?r:l;i|=p?32:64,4&(i&=~(p?64:32))||(i&=-4);var b=[t,i,a,v,f,g,m,c,h,d],y=n.apply(r,b);return nS(t)&&nR(y,b),y.placeholder=s,nN(y,t,i)}function r8(t){var i=eP[t];return function(t,r){if(t=s8(t),(r=null==r?0:t6(s5(r),292))&&t1(t)){var n=(ot(t)+"e").split("e");return+((n=(ot(i(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return i(t)}}var ne=ir&&1/tV(new ir([,-0]))[1]==l?function(t){return new ir(t)}:oZ;function nt(t){return function(i){var r,n,s=ny(i);return s==b?tz(i):s==C?(r=-1,n=Array(i.size),i.forEach(function(t){n[++r]=[t,t]}),n):tf(t(i),function(t){return[t,i[t]]})}}function ni(t,i,s,l,u,c,h,d){var p=2&i;if(!p&&"function"!=typeof t)throw new eT(n);var f=l?l.length:0;if(f||(i&=-97,l=u=r),h=h===r?h:t9(s5(h),0),d=d===r?d:s5(d),f-=u?u.length:0,64&i){var m=l,v=u;l=u=r}var g=p?r:nc(t),b=[t,i,s,l,u,m,v,c,h,d];if(g&&function(t,i){var r=t[1],n=i[1],s=r|n,l=s<131,u=128==n&&8==r||128==n&&256==r&&t[7].length<=i[8]||384==n&&i[7].length<=i[8]&&8==r;if(l||u){1&n&&(t[2]=i[2],s|=1&r?0:4);var c=i[3];if(c){var h=t[3];t[3]=h?rW(h,c,i[4]):c,t[4]=h?t$(t[3],a):i[4]}(c=i[5])&&(h=t[5],t[5]=h?r$(h,c,i[6]):c,t[6]=h?t$(t[5],a):i[6]),(c=i[7])&&(t[7]=c),128&n&&(t[8]=null==t[8]?i[8]:t6(t[8],i[8])),null==t[9]&&(t[9]=i[9]),t[0]=i[0],t[1]=s}}(b,g),t=b[0],i=b[1],s=b[2],l=b[3],u=b[4],(d=b[9]=b[9]===r?p?0:t.length:t9(b[9]-f,0))||!(24&i)||(i&=-25),i&&1!=i)8==i||16==i?(y=t,_=i,w=d,E=rQ(y),F=function t(){for(var i=arguments.length,n=e_(i),s=i,a=nd(t);s--;)n[s]=arguments[s];var l=i<3&&n[0]!==a&&n[i-1]!==a?[]:t$(n,a);return(i-=l.length)<w?r7(y,_,r1,t.placeholder,r,n,l,r,r,w-i):ta(this&&this!==e6&&this instanceof t?E:y,this,n)}):32!=i&&33!=i||u.length?F=r1.apply(r,b):(C=t,P=i,A=s,S=l,O=1&P,T=rQ(C),F=function t(){for(var i=-1,r=arguments.length,n=-1,s=S.length,a=e_(s+r),l=this&&this!==e6&&this instanceof t?T:C;++n<s;)a[n]=S[n];for(;r--;)a[n++]=arguments[++i];return ta(l,O?A:this,a)});else var y,_,w,E,C,P,A,S,O,T,x,k,I,M,R,F=(x=t,k=i,I=s,M=1&k,R=rQ(x),function t(){return(this&&this!==e6&&this instanceof t?R:x).apply(M?I:this,arguments)});return nN((g?rg:nR)(F,b),t,i)}function nr(t,i,n,s){return t===r||sR(t,eI[n])&&!eF.call(s,n)?i:t}function nn(t,i,n,s,a,l){return sJ(t)&&sJ(i)&&(l.set(i,t),ra(t,i,r,nn,l),l.delete(i)),t}function ns(t){return sY(t)?r:t}function no(t,i,n,s,a,l){var u=1&n,c=t.length,h=i.length;if(c!=h&&!(u&&h>c))return!1;var d=l.get(t),p=l.get(i);if(d&&p)return d==i&&p==t;var f=-1,m=!0,v=2&n?new iS:r;for(l.set(t,i),l.set(i,t);++f<c;){var g=t[f],b=i[f];if(s)var y=u?s(b,g,f,i,t,l):s(g,b,f,t,i,l);if(y!==r){if(y)continue;m=!1;break}if(v){if(!tb(i,function(t,i){if(!tF(v,i)&&(g===t||a(g,t,n,s,l)))return v.push(i)})){m=!1;break}}else if(!(g===b||a(g,b,n,s,l))){m=!1;break}}return l.delete(t),l.delete(i),m}function na(t){return nL(nk(t,r,nq),t+"")}function nl(t){return i0(t,of,ng)}function nu(t){return i0(t,om,nb)}var nc=ia?function(t){return ia.get(t)}:oZ;function nh(t){for(var i=t.name+"",r=il[i],n=eF.call(il,i)?r.length:0;n--;){var s=r[n],a=s.func;if(null==a||a==t)return s.name}return i}function nd(t){return(eF.call(ib,"placeholder")?ib:t).placeholder}function np(){var t=ib.iteratee||oz;return t=t===oz?rt:t,arguments.length?t(arguments[0],arguments[1]):t}function nf(t,i){var r,n=t.__data__;return("string"==(r=typeof i)||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==i:null===i)?n["string"==typeof i?"string":"hash"]:n.map}function nm(t){for(var i=of(t),r=i.length;r--;){var n=i[r],s=t[n];i[r]=[n,s,s==s&&!sJ(s)]}return i}function nv(t,i){var n=null==t?r:t[i];return re(n)?n:r}var ng=tX?function(t){return null==t?[]:th(tX(t=eA(t)),function(i){return e2.call(t,i)})}:oQ,nb=tX?function(t){for(var i=[];t;)tm(i,ng(t)),t=eq(t);return i}:oQ,ny=i1;function n_(t,i,r){i=rL(i,t);for(var n=-1,s=i.length,a=!1;++n<s;){var l=nU(i[n]);if(!(a=null!=t&&r(t,l)))break;t=t[l]}return a||++n!=s?a:!!(s=null==t?0:t.length)&&sG(s)&&nC(l,s)&&(sD(t)||sN(t))}function nw(t){return"function"!=typeof t.constructor||nT(t)?{}:iy(eq(t))}function nE(t){return sD(t)||sN(t)||!!(e4&&t&&t[e4])}function nC(t,i){var r=typeof t;return!!(i=i??9007199254740991)&&("number"==r||"symbol"!=r&&ep.test(t))&&t>-1&&t%1==0&&t<i}function nP(t,i,r){if(!sJ(r))return!1;var n=typeof i;return("number"==n?!!(sB(r)&&nC(i,r.length)):"string"==n&&i in r)&&sR(r[i],t)}function nA(t,i){if(sD(t))return!1;var r=typeof t;return!!("number"==r||"symbol"==r||"boolean"==r||null==t||s1(t))||H.test(t)||!q.test(t)||null!=i&&t in eA(i)}function nS(t){var i=nh(t),r=ib[i];if("function"!=typeof r||!(i in iE.prototype))return!1;if(t===r)return!0;var n=nc(r);return!!n&&t===n[0]}(ie&&ny(new ie(new ArrayBuffer(1)))!=T||it&&ny(new it)!=b||ii&&ny(ii.resolve())!=w||ir&&ny(new ir)!=C||is&&ny(new is)!=S)&&(ny=function(t){var i=i1(t),n=i==_?t.constructor:r,s=n?nz(n):"";if(s)switch(s){case iu:return T;case ic:return b;case ih:return w;case id:return C;case ip:return S}return i});var nO=eM?sV:oX;function nT(t){var i=t&&t.constructor;return t===("function"==typeof i&&i.prototype||eI)}function nx(t,i){return function(n){return null!=n&&n[t]===i&&(i!==r||t in eA(n))}}function nk(t,i,n){return i=t9(i===r?t.length-1:i,0),function(){for(var r=arguments,s=-1,a=t9(r.length-i,0),l=e_(a);++s<a;)l[s]=r[i+s];s=-1;for(var u=e_(i+1);++s<i;)u[s]=r[s];return u[i]=n(l),ta(t,this,u)}}function nI(t,i){return i.length<2?t:iX(t,ry(i,0,-1))}function nM(t,i){if(!("constructor"===i&&"function"==typeof t[i])&&"__proto__"!=i)return t[i]}var nR=nD(rg),nF=tK||function(t,i){return e6.setTimeout(t,i)},nL=nD(rb);function nN(t,i,r){var n,s,a=i+"";return nL(t,function(t,i){var r=i.length;if(!r)return t;var n=r-1;return i[n]=(r>1?"& ":"")+i[n],i=i.join(r>2?", ":" "),t.replace(et,`{
/* [wrapped with `+i+`] */
`)}(a,(n=(s=a.match(ei))?s[1].split(er):[],tu(c,function(t){var i="_."+t[0];r&t[1]&&!td(n,i)&&n.push(i)}),n.sort())))}function nD(t){var i=0,n=0;return function(){var s=t4(),a=16-(s-n);if(n=s,a>0){if(++i>=800)return arguments[0]}else i=0;return t.apply(r,arguments)}}function nj(t,i){var n=-1,s=t.length,a=s-1;for(i=i===r?s:i;++n<i;){var l=rp(n,a),u=t[l];t[l]=t[n],t[n]=u}return t.length=i,t}var nB=(eb=(eg=sO(function(t){var i=[];return 46===t.charCodeAt(0)&&i.push(""),t.replace(K,function(t,r,n,s){i.push(n?s.replace(eo,"$1"):r||t)}),i},function(t){return 500===eb.size&&eb.clear(),t})).cache,eg);function nU(t){if("string"==typeof t||s1(t))return t;var i=t+"";return"0"==i&&1/t==-l?"-0":i}function nz(t){if(null!=t){try{return eR.call(t)}catch{}try{return t+""}catch{}}return""}function nW(t){if(t instanceof iE)return t.clone();var i=new iw(t.__wrapped__,t.__chain__);return i.__actions__=rV(t.__actions__),i.__index__=t.__index__,i.__values__=t.__values__,i}var n$=rm(function(t,i){return sU(t)?iz(t,iJ(i,1,sU,!0)):[]}),nV=rm(function(t,i){var n=nX(i);return sU(n)&&(n=r),sU(t)?iz(t,iJ(i,1,sU,!0),np(n,2)):[]}),nZ=rm(function(t,i){var n=nX(i);return sU(n)&&(n=r),sU(t)?iz(t,iJ(i,1,sU,!0),r,n):[]});function nG(t,i,r){var n=null==t?0:t.length;if(!n)return -1;var s=null==r?0:s5(r);return s<0&&(s=t9(n+s,0)),tw(t,np(i,3),s)}function nJ(t,i,n){var s=null==t?0:t.length;if(!s)return -1;var a=s-1;return n!==r&&(a=s5(n),a=n<0?t9(s+a,0):t6(a,s-1)),tw(t,np(i,3),a,!0)}function nq(t){return(null==t?0:t.length)?iJ(t,1):[]}function nH(t){return t&&t.length?t[0]:r}var nK=rm(function(t){var i=tf(t,rR);return i.length&&i[0]===t[0]?i6(i):[]}),nY=rm(function(t){var i=nX(t),n=tf(t,rR);return i===nX(n)?i=r:n.pop(),n.length&&n[0]===t[0]?i6(n,np(i,2)):[]}),nQ=rm(function(t){var i=nX(t),n=tf(t,rR);return(i="function"==typeof i?i:r)&&n.pop(),n.length&&n[0]===t[0]?i6(n,r,i):[]});function nX(t){var i=null==t?0:t.length;return i?t[i-1]:r}var n0=rm(n1);function n1(t,i){return t&&t.length&&i&&i.length?rh(t,i):t}var n3=na(function(t,i){var r=null==t?0:t.length,n=iN(t,i);return rd(t,tf(i,function(t){return nC(t,r)?+t:t}).sort(rz)),n});function n2(t){return null==t?t:t8.call(t)}var n9=rm(function(t){return rS(iJ(t,1,sU,!0))}),n6=rm(function(t){var i=nX(t);return sU(i)&&(i=r),rS(iJ(t,1,sU,!0),np(i,2))}),n4=rm(function(t){var i=nX(t);return i="function"==typeof i?i:r,rS(iJ(t,1,sU,!0),r,i)});function n5(t){if(!(t&&t.length))return[];var i=0;return t=th(t,function(t){if(sU(t))return i=t9(t.length,i),!0}),tk(i,function(i){return tf(t,tS(i))})}function n7(t,i){if(!(t&&t.length))return[];var n=n5(t);return null==i?n:tf(n,function(t){return ta(i,r,t)})}var n8=rm(function(t,i){return sU(t)?iz(t,i):[]}),se=rm(function(t){return rI(th(t,sU))}),st=rm(function(t){var i=nX(t);return sU(i)&&(i=r),rI(th(t,sU),np(i,2))}),si=rm(function(t){var i=nX(t);return i="function"==typeof i?i:r,rI(th(t,sU),r,i)}),sr=rm(n5),sn=rm(function(t){var i=t.length,n=i>1?t[i-1]:r;return n="function"==typeof n?(t.pop(),n):r,n7(t,n)});function ss(t){var i=ib(t);return i.__chain__=!0,i}function so(t,i){return i(t)}var sa=na(function(t){var i=t.length,n=i?t[0]:0,s=this.__wrapped__,a=function(i){return iN(i,t)};return!(i>1)&&!this.__actions__.length&&s instanceof iE&&nC(n)?((s=s.slice(n,+n+(i?1:0))).__actions__.push({func:so,args:[a],thisArg:r}),new iw(s,this.__chain__).thru(function(t){return i&&!t.length&&t.push(r),t})):this.thru(a)}),sl=rG(function(t,i,r){eF.call(t,r)?++t[r]:iL(t,r,1)}),su=rX(nG),sc=rX(nJ);function sh(t,i){return(sD(t)?tu:iW)(t,np(i,3))}function sd(t,i){return(sD(t)?function(t,i){for(var r=null==t?0:t.length;r--&&!1!==i(t[r],r,t););return t}:i$)(t,np(i,3))}var sp=rG(function(t,i,r){eF.call(t,r)?t[r].push(i):iL(t,r,[i])}),sf=rm(function(t,i,r){var n=-1,s="function"==typeof i,a=sB(t)?e_(t.length):[];return iW(t,function(t){a[++n]=s?ta(i,t,r):i4(t,i,r)}),a}),sm=rG(function(t,i,r){iL(t,r,i)});function sv(t,i){return(sD(t)?tf:rn)(t,np(i,3))}var sg=rG(function(t,i,r){t[r?0:1].push(i)},function(){return[[],[]]}),sb=rm(function(t,i){if(null==t)return[];var r=i.length;return r>1&&nP(t,i[0],i[1])?i=[]:r>2&&nP(i[0],i[1],i[2])&&(i=[i[0]]),ru(t,iJ(i,1),[])}),sy=tO||function(){return e6.Date.now()};function s_(t,i,n){return i=n?r:i,i=t&&null==i?t.length:i,ni(t,128,r,r,r,r,i)}function sw(t,i){var s;if("function"!=typeof i)throw new eT(n);return t=s5(t),function(){return--t>0&&(s=i.apply(this,arguments)),t<=1&&(i=r),s}}var sE=rm(function(t,i,r){var n=1;if(r.length){var s=t$(r,nd(sE));n|=32}return ni(t,n,i,r,s)}),sC=rm(function(t,i,r){var n=3;if(r.length){var s=t$(r,nd(sC));n|=32}return ni(i,n,t,r,s)});function sP(t,i,s){var a,l,u,c,h,d,p=0,f=!1,m=!1,v=!0;if("function"!=typeof t)throw new eT(n);function g(i){var n=a,s=l;return a=l=r,p=i,c=t.apply(s,n)}function b(t){var n=t-d,s=t-p;return d===r||n>=i||n<0||m&&s>=u}function y(){var t,r,n,s=sy();if(b(s))return _(s);h=nF(y,(t=s-d,r=s-p,n=i-t,m?t6(n,u-r):n))}function _(t){return h=r,v&&a?g(t):(a=l=r,c)}function w(){var t,n=sy(),s=b(n);if(a=arguments,l=this,d=n,s){if(h===r)return p=t=d,h=nF(y,i),f?g(t):c;if(m)return rD(h),h=nF(y,i),g(d)}return h===r&&(h=nF(y,i)),c}return i=s8(i)||0,sJ(s)&&(f=!!s.leading,u=(m="maxWait"in s)?t9(s8(s.maxWait)||0,i):u,v="trailing"in s?!!s.trailing:v),w.cancel=function(){h!==r&&rD(h),p=0,a=d=l=h=r},w.flush=function(){return h===r?c:_(sy())},w}var sA=rm(function(t,i){return iU(t,1,i)}),sS=rm(function(t,i,r){return iU(t,s8(i)||0,r)});function sO(t,i){if("function"!=typeof t||null!=i&&"function"!=typeof i)throw new eT(n);var r=function(){var n=arguments,s=i?i.apply(this,n):n[0],a=r.cache;if(a.has(s))return a.get(s);var l=t.apply(this,n);return r.cache=a.set(s,l)||a,l};return r.cache=new(sO.Cache||iA),r}function sT(t){if("function"!=typeof t)throw new eT(n);return function(){var i=arguments;switch(i.length){case 0:return!t.call(this);case 1:return!t.call(this,i[0]);case 2:return!t.call(this,i[0],i[1]);case 3:return!t.call(this,i[0],i[1],i[2])}return!t.apply(this,i)}}sO.Cache=iA;var sx=rm(function(t,i){var r=(i=1==i.length&&sD(i[0])?tf(i[0],tM(np())):tf(iJ(i,1),tM(np()))).length;return rm(function(n){for(var s=-1,a=t6(n.length,r);++s<a;)n[s]=i[s].call(this,n[s]);return ta(t,this,n)})}),sk=rm(function(t,i){var n=t$(i,nd(sk));return ni(t,32,r,i,n)}),sI=rm(function(t,i){var n=t$(i,nd(sI));return ni(t,64,r,i,n)}),sM=na(function(t,i){return ni(t,256,r,r,r,i)});function sR(t,i){return t===i||t!=t&&i!=i}var sF=r5(i3),sL=r5(function(t,i){return t>=i}),sN=i5(function(){return arguments}())?i5:function(t){return sq(t)&&eF.call(t,"callee")&&!e2.call(t,"callee")},sD=e_.isArray,sj=tt?tM(tt):function(t){return sq(t)&&i1(t)==O};function sB(t){return null!=t&&sG(t.length)&&!sV(t)}function sU(t){return sq(t)&&sB(t)}var sz=t0||oX,sW=ti?tM(ti):function(t){return sq(t)&&i1(t)==f};function s$(t){if(!sq(t))return!1;var i=i1(t);return i==m||"[object DOMException]"==i||"string"==typeof t.message&&"string"==typeof t.name&&!sY(t)}function sV(t){if(!sJ(t))return!1;var i=i1(t);return i==v||i==g||"[object AsyncFunction]"==i||"[object Proxy]"==i}function sZ(t){return"number"==typeof t&&t==s5(t)}function sG(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=9007199254740991}function sJ(t){var i=typeof t;return null!=t&&("object"==i||"function"==i)}function sq(t){return null!=t&&"object"==typeof t}var sH=tr?tM(tr):function(t){return sq(t)&&ny(t)==b};function sK(t){return"number"==typeof t||sq(t)&&i1(t)==y}function sY(t){if(!sq(t)||i1(t)!=_)return!1;var i=eq(t);if(null===i)return!0;var r=eF.call(i,"constructor")&&i.constructor;return"function"==typeof r&&r instanceof r&&eR.call(r)==ej}var sQ=tn?tM(tn):function(t){return sq(t)&&i1(t)==E},sX=ts?tM(ts):function(t){return sq(t)&&ny(t)==C};function s0(t){return"string"==typeof t||!sD(t)&&sq(t)&&i1(t)==P}function s1(t){return"symbol"==typeof t||sq(t)&&i1(t)==A}var s3=to?tM(to):function(t){return sq(t)&&sG(t.length)&&!!eQ[i1(t)]},s2=r5(rr),s9=r5(function(t,i){return t<=i});function s6(t){if(!t)return[];if(sB(t))return s0(t)?tG(t):rV(t);if(e5&&t[e5])return function(t){for(var i,r=[];!(i=t.next()).done;)r.push(i.value);return r}(t[e5]());var i=ny(t);return(i==b?tz:i==C?tV:oC)(t)}function s4(t){return t?(t=s8(t))===l||t===-l?(t<0?-1:1)*17976931348623157e292:t==t?t:0:0===t?t:0}function s5(t){var i=s4(t),r=i%1;return i==i?r?i-r:i:0}function s7(t){return t?iD(s5(t),0,4294967295):0}function s8(t){if("number"==typeof t)return t;if(s1(t))return u;if(sJ(t)){var i="function"==typeof t.valueOf?t.valueOf():t;t=sJ(i)?i+"":i}if("string"!=typeof t)return 0===t?t:+t;t=tI(t);var r=ec.test(t);return r||ed.test(t)?e3(t.slice(2),r?2:8):eu.test(t)?u:+t}function oe(t){return rZ(t,om(t))}function ot(t){return null==t?"":rA(t)}var oi=rJ(function(t,i){if(nT(i)||sB(i)){rZ(i,of(i),t);return}for(var r in i)eF.call(i,r)&&iI(t,r,i[r])}),or=rJ(function(t,i){rZ(i,om(i),t)}),on=rJ(function(t,i,r,n){rZ(i,om(i),t,n)}),os=rJ(function(t,i,r,n){rZ(i,of(i),t,n)}),oo=na(iN),oa=rm(function(t,i){t=eA(t);var n=-1,s=i.length,a=s>2?i[2]:r;for(a&&nP(i[0],i[1],a)&&(s=1);++n<s;)for(var l=i[n],u=om(l),c=-1,h=u.length;++c<h;){var d=u[c],p=t[d];(p===r||sR(p,eI[d])&&!eF.call(t,d))&&(t[d]=l[d])}return t}),ol=rm(function(t){return t.push(r,nn),ta(og,r,t)});function ou(t,i,n){var s=null==t?r:iX(t,i);return s===r?n:s}function oc(t,i){return null!=t&&n_(t,i,i9)}var oh=r3(function(t,i,r){null!=i&&"function"!=typeof i.toString&&(i=eD.call(i)),t[i]=r},oD(oU)),od=r3(function(t,i,r){null!=i&&"function"!=typeof i.toString&&(i=eD.call(i)),eF.call(t,i)?t[i].push(r):t[i]=[r]},np),op=rm(i4);function of(t){return sB(t)?iT(t):ri(t)}function om(t){return sB(t)?iT(t,!0):function(t){if(!sJ(t))return function(t){var i=[];if(null!=t)for(var r in eA(t))i.push(r);return i}(t);var i=nT(t),r=[];for(var n in t)"constructor"==n&&(i||!eF.call(t,n))||r.push(n);return r}(t)}var ov=rJ(function(t,i,r){ra(t,i,r)}),og=rJ(function(t,i,r,n){ra(t,i,r,n)}),ob=na(function(t,i){var r={};if(null==t)return r;var n=!1;i=tf(i,function(i){return i=rL(i,t),n||(n=i.length>1),i}),rZ(t,nu(t),r),n&&(r=ij(r,7,ns));for(var s=i.length;s--;)rO(r,i[s]);return r}),oy=na(function(t,i){return null==t?{}:rc(t,i,function(i,r){return oc(t,r)})});function o_(t,i){if(null==t)return{};var r=tf(nu(t),function(t){return[t]});return i=np(i),rc(t,r,function(t,r){return i(t,r[0])})}var ow=nt(of),oE=nt(om);function oC(t){return null==t?[]:tR(t,of(t))}var oP=rY(function(t,i,r){return i=i.toLowerCase(),t+(r?oA(i):i)});function oA(t){return oR(ot(t).toLowerCase())}function oS(t){return(t=ot(t))&&t.replace(ef,tD).replace(eZ,"")}var oO=rY(function(t,i,r){return t+(r?"-":"")+i.toLowerCase()}),oT=rY(function(t,i,r){return t+(r?" ":"")+i.toLowerCase()}),ox=rK("toLowerCase"),ok=rY(function(t,i,r){return t+(r?"_":"")+i.toLowerCase()}),oI=rY(function(t,i,r){return t+(r?" ":"")+oR(i)}),oM=rY(function(t,i,r){return t+(r?" ":"")+i.toUpperCase()}),oR=rK("toUpperCase");function oF(t,i,n){var s;return t=ot(t),(i=n?r:i)===r?(s=t,eH.test(s))?t.match(eJ)||[]:t.match(en)||[]:t.match(i)||[]}var oL=rm(function(t,i){try{return ta(t,r,i)}catch(t){return s$(t)?t:new eE(t)}}),oN=na(function(t,i){return tu(i,function(i){iL(t,i=nU(i),sE(t[i],t))}),t});function oD(t){return function(){return t}}var oj=r0(),oB=r0(!0);function oU(t){return t}function oz(t){return rt("function"==typeof t?t:ij(t,1))}var oW=rm(function(t,i){return function(r){return i4(r,t,i)}}),o$=rm(function(t,i){return function(r){return i4(t,r,i)}});function oV(t,i,r){var n=of(i),s=iQ(i,n);null!=r||sJ(i)&&(s.length||!n.length)||(r=i,i=t,t=this,s=iQ(i,of(i)));var a=!(sJ(r)&&"chain"in r)||!!r.chain,l=sV(t);return tu(s,function(r){var n=i[r];t[r]=n,l&&(t.prototype[r]=function(){var i=this.__chain__;if(a||i){var r=t(this.__wrapped__);return(r.__actions__=rV(this.__actions__)).push({func:n,args:arguments,thisArg:t}),r.__chain__=i,r}return n.apply(t,tm([this.value()],arguments))})}),t}function oZ(){}var oG=r9(tf),oJ=r9(tc),oq=r9(tb);function oH(t){return nA(t)?tS(nU(t)):function(i){return iX(i,t)}}var oK=r4(),oY=r4(!0);function oQ(){return[]}function oX(){return!1}var o0=r2(function(t,i){return t+i},0),o1=r8("ceil"),o3=r2(function(t,i){return t/i},1),o2=r8("floor"),o9=r2(function(t,i){return t*i},1),o6=r8("round"),o4=r2(function(t,i){return t-i},0);return ib.after=function(t,i){if("function"!=typeof i)throw new eT(n);return t=s5(t),function(){if(--t<1)return i.apply(this,arguments)}},ib.ary=s_,ib.assign=oi,ib.assignIn=or,ib.assignInWith=on,ib.assignWith=os,ib.at=oo,ib.before=sw,ib.bind=sE,ib.bindAll=oN,ib.bindKey=sC,ib.castArray=function(){if(!arguments.length)return[];var t=arguments[0];return sD(t)?t:[t]},ib.chain=ss,ib.chunk=function(t,i,n){i=(n?nP(t,i,n):i===r)?1:t9(s5(i),0);var s=null==t?0:t.length;if(!s||i<1)return[];for(var a=0,l=0,u=e_(tY(s/i));a<s;)u[l++]=ry(t,a,a+=i);return u},ib.compact=function(t){for(var i=-1,r=null==t?0:t.length,n=0,s=[];++i<r;){var a=t[i];a&&(s[n++]=a)}return s},ib.concat=function(){var t=arguments.length;if(!t)return[];for(var i=e_(t-1),r=arguments[0],n=t;n--;)i[n-1]=arguments[n];return tm(sD(r)?rV(r):[r],iJ(i,1))},ib.cond=function(t){var i=null==t?0:t.length,r=np();return t=i?tf(t,function(t){if("function"!=typeof t[1])throw new eT(n);return[r(t[0]),t[1]]}):[],rm(function(r){for(var n=-1;++n<i;){var s=t[n];if(ta(s[0],this,r))return ta(s[1],this,r)}})},ib.conforms=function(t){var i,r;return r=of(i=ij(t,1)),function(t){return iB(t,i,r)}},ib.constant=oD,ib.countBy=sl,ib.create=function(t,i){var r=iy(t);return null==i?r:iF(r,i)},ib.curry=function t(i,n,s){n=s?r:n;var a=ni(i,8,r,r,r,r,r,n);return a.placeholder=t.placeholder,a},ib.curryRight=function t(i,n,s){n=s?r:n;var a=ni(i,16,r,r,r,r,r,n);return a.placeholder=t.placeholder,a},ib.debounce=sP,ib.defaults=oa,ib.defaultsDeep=ol,ib.defer=sA,ib.delay=sS,ib.difference=n$,ib.differenceBy=nV,ib.differenceWith=nZ,ib.drop=function(t,i,n){var s=null==t?0:t.length;return s?ry(t,(i=n||i===r?1:s5(i))<0?0:i,s):[]},ib.dropRight=function(t,i,n){var s=null==t?0:t.length;return s?ry(t,0,(i=s-(i=n||i===r?1:s5(i)))<0?0:i):[]},ib.dropRightWhile=function(t,i){return t&&t.length?rx(t,np(i,3),!0,!0):[]},ib.dropWhile=function(t,i){return t&&t.length?rx(t,np(i,3),!0):[]},ib.fill=function(t,i,n,s){var a=null==t?0:t.length;return a?(n&&"number"!=typeof n&&nP(t,i,n)&&(n=0,s=a),function(t,i,n,s){var a=t.length;for((n=s5(n))<0&&(n=-n>a?0:a+n),(s=s===r||s>a?a:s5(s))<0&&(s+=a),s=n>s?0:s7(s);n<s;)t[n++]=i;return t}(t,i,n,s)):[]},ib.filter=function(t,i){return(sD(t)?th:iG)(t,np(i,3))},ib.flatMap=function(t,i){return iJ(sv(t,i),1)},ib.flatMapDeep=function(t,i){return iJ(sv(t,i),l)},ib.flatMapDepth=function(t,i,n){return n=n===r?1:s5(n),iJ(sv(t,i),n)},ib.flatten=nq,ib.flattenDeep=function(t){return(null==t?0:t.length)?iJ(t,l):[]},ib.flattenDepth=function(t,i){return(null==t?0:t.length)?iJ(t,i=i===r?1:s5(i)):[]},ib.flip=function(t){return ni(t,512)},ib.flow=oj,ib.flowRight=oB,ib.fromPairs=function(t){for(var i=-1,r=null==t?0:t.length,n={};++i<r;){var s=t[i];n[s[0]]=s[1]}return n},ib.functions=function(t){return null==t?[]:iQ(t,of(t))},ib.functionsIn=function(t){return null==t?[]:iQ(t,om(t))},ib.groupBy=sp,ib.initial=function(t){return(null==t?0:t.length)?ry(t,0,-1):[]},ib.intersection=nK,ib.intersectionBy=nY,ib.intersectionWith=nQ,ib.invert=oh,ib.invertBy=od,ib.invokeMap=sf,ib.iteratee=oz,ib.keyBy=sm,ib.keys=of,ib.keysIn=om,ib.map=sv,ib.mapKeys=function(t,i){var r={};return i=np(i,3),iK(t,function(t,n,s){iL(r,i(t,n,s),t)}),r},ib.mapValues=function(t,i){var r={};return i=np(i,3),iK(t,function(t,n,s){iL(r,n,i(t,n,s))}),r},ib.matches=function(t){return rs(ij(t,1))},ib.matchesProperty=function(t,i){return ro(t,ij(i,1))},ib.memoize=sO,ib.merge=ov,ib.mergeWith=og,ib.method=oW,ib.methodOf=o$,ib.mixin=oV,ib.negate=sT,ib.nthArg=function(t){return t=s5(t),rm(function(i){return rl(i,t)})},ib.omit=ob,ib.omitBy=function(t,i){return o_(t,sT(np(i)))},ib.once=function(t){return sw(2,t)},ib.orderBy=function(t,i,n,s){return null==t?[]:(sD(i)||(i=null==i?[]:[i]),sD(n=s?r:n)||(n=null==n?[]:[n]),ru(t,i,n))},ib.over=oG,ib.overArgs=sx,ib.overEvery=oJ,ib.overSome=oq,ib.partial=sk,ib.partialRight=sI,ib.partition=sg,ib.pick=oy,ib.pickBy=o_,ib.property=oH,ib.propertyOf=function(t){return function(i){return null==t?r:iX(t,i)}},ib.pull=n0,ib.pullAll=n1,ib.pullAllBy=function(t,i,r){return t&&t.length&&i&&i.length?rh(t,i,np(r,2)):t},ib.pullAllWith=function(t,i,n){return t&&t.length&&i&&i.length?rh(t,i,r,n):t},ib.pullAt=n3,ib.range=oK,ib.rangeRight=oY,ib.rearg=sM,ib.reject=function(t,i){return(sD(t)?th:iG)(t,sT(np(i,3)))},ib.remove=function(t,i){var r=[];if(!(t&&t.length))return r;var n=-1,s=[],a=t.length;for(i=np(i,3);++n<a;){var l=t[n];i(l,n,t)&&(r.push(l),s.push(n))}return rd(t,s),r},ib.rest=function(t,i){if("function"!=typeof t)throw new eT(n);return rm(t,i=i===r?i:s5(i))},ib.reverse=n2,ib.sampleSize=function(t,i,n){return i=(n?nP(t,i,n):i===r)?1:s5(i),(sD(t)?function(t,i){return nj(rV(t),iD(i,0,t.length))}:function(t,i){var r=oC(t);return nj(r,iD(i,0,r.length))})(t,i)},ib.set=function(t,i,r){return null==t?t:rv(t,i,r)},ib.setWith=function(t,i,n,s){return s="function"==typeof s?s:r,null==t?t:rv(t,i,n,s)},ib.shuffle=function(t){return(sD(t)?function(t){return nj(rV(t))}:function(t){return nj(oC(t))})(t)},ib.slice=function(t,i,n){var s=null==t?0:t.length;return s?(n&&"number"!=typeof n&&nP(t,i,n)?(i=0,n=s):(i=null==i?0:s5(i),n=n===r?s:s5(n)),ry(t,i,n)):[]},ib.sortBy=sb,ib.sortedUniq=function(t){return t&&t.length?rC(t):[]},ib.sortedUniqBy=function(t,i){return t&&t.length?rC(t,np(i,2)):[]},ib.split=function(t,i,n){return n&&"number"!=typeof n&&nP(t,i,n)&&(i=n=r),(n=n===r?4294967295:n>>>0)?(t=ot(t))&&("string"==typeof i||null!=i&&!sQ(i))&&!(i=rA(i))&&tU(t)?rN(tG(t),0,n):t.split(i,n):[]},ib.spread=function(t,i){if("function"!=typeof t)throw new eT(n);return i=null==i?0:t9(s5(i),0),rm(function(r){var n=r[i],s=rN(r,0,i);return n&&tm(s,n),ta(t,this,s)})},ib.tail=function(t){var i=null==t?0:t.length;return i?ry(t,1,i):[]},ib.take=function(t,i,n){return t&&t.length?ry(t,0,(i=n||i===r?1:s5(i))<0?0:i):[]},ib.takeRight=function(t,i,n){var s=null==t?0:t.length;return s?ry(t,(i=s-(i=n||i===r?1:s5(i)))<0?0:i,s):[]},ib.takeRightWhile=function(t,i){return t&&t.length?rx(t,np(i,3),!1,!0):[]},ib.takeWhile=function(t,i){return t&&t.length?rx(t,np(i,3)):[]},ib.tap=function(t,i){return i(t),t},ib.throttle=function(t,i,r){var s=!0,a=!0;if("function"!=typeof t)throw new eT(n);return sJ(r)&&(s="leading"in r?!!r.leading:s,a="trailing"in r?!!r.trailing:a),sP(t,i,{leading:s,maxWait:i,trailing:a})},ib.thru=so,ib.toArray=s6,ib.toPairs=ow,ib.toPairsIn=oE,ib.toPath=function(t){return sD(t)?tf(t,nU):s1(t)?[t]:rV(nB(ot(t)))},ib.toPlainObject=oe,ib.transform=function(t,i,r){var n=sD(t),s=n||sz(t)||s3(t);if(i=np(i,4),null==r){var a=t&&t.constructor;r=s?n?new a:[]:sJ(t)&&sV(a)?iy(eq(t)):{}}return(s?tu:iK)(t,function(t,n,s){return i(r,t,n,s)}),r},ib.unary=function(t){return s_(t,1)},ib.union=n9,ib.unionBy=n6,ib.unionWith=n4,ib.uniq=function(t){return t&&t.length?rS(t):[]},ib.uniqBy=function(t,i){return t&&t.length?rS(t,np(i,2)):[]},ib.uniqWith=function(t,i){return i="function"==typeof i?i:r,t&&t.length?rS(t,r,i):[]},ib.unset=function(t,i){return null==t||rO(t,i)},ib.unzip=n5,ib.unzipWith=n7,ib.update=function(t,i,r){return null==t?t:rT(t,i,rF(r))},ib.updateWith=function(t,i,n,s){return s="function"==typeof s?s:r,null==t?t:rT(t,i,rF(n),s)},ib.values=oC,ib.valuesIn=function(t){return null==t?[]:tR(t,om(t))},ib.without=n8,ib.words=oF,ib.wrap=function(t,i){return sk(rF(i),t)},ib.xor=se,ib.xorBy=st,ib.xorWith=si,ib.zip=sr,ib.zipObject=function(t,i){return rM(t||[],i||[],iI)},ib.zipObjectDeep=function(t,i){return rM(t||[],i||[],rv)},ib.zipWith=sn,ib.entries=ow,ib.entriesIn=oE,ib.extend=or,ib.extendWith=on,oV(ib,ib),ib.add=o0,ib.attempt=oL,ib.camelCase=oP,ib.capitalize=oA,ib.ceil=o1,ib.clamp=function(t,i,n){return n===r&&(n=i,i=r),n!==r&&(n=(n=s8(n))==n?n:0),i!==r&&(i=(i=s8(i))==i?i:0),iD(s8(t),i,n)},ib.clone=function(t){return ij(t,4)},ib.cloneDeep=function(t){return ij(t,5)},ib.cloneDeepWith=function(t,i){return ij(t,5,i="function"==typeof i?i:r)},ib.cloneWith=function(t,i){return ij(t,4,i="function"==typeof i?i:r)},ib.conformsTo=function(t,i){return null==i||iB(t,i,of(i))},ib.deburr=oS,ib.defaultTo=function(t,i){return null==t||t!=t?i:t},ib.divide=o3,ib.endsWith=function(t,i,n){t=ot(t),i=rA(i);var s=t.length,a=n=n===r?s:iD(s5(n),0,s);return(n-=i.length)>=0&&t.slice(n,a)==i},ib.eq=sR,ib.escape=function(t){return(t=ot(t))&&V.test(t)?t.replace(W,tj):t},ib.escapeRegExp=function(t){return(t=ot(t))&&Q.test(t)?t.replace(Y,"\\$&"):t},ib.every=function(t,i,n){var s=sD(t)?tc:iV;return n&&nP(t,i,n)&&(i=r),s(t,np(i,3))},ib.find=su,ib.findIndex=nG,ib.findKey=function(t,i){return t_(t,np(i,3),iK)},ib.findLast=sc,ib.findLastIndex=nJ,ib.findLastKey=function(t,i){return t_(t,np(i,3),iY)},ib.floor=o2,ib.forEach=sh,ib.forEachRight=sd,ib.forIn=function(t,i){return null==t?t:iq(t,np(i,3),om)},ib.forInRight=function(t,i){return null==t?t:iH(t,np(i,3),om)},ib.forOwn=function(t,i){return t&&iK(t,np(i,3))},ib.forOwnRight=function(t,i){return t&&iY(t,np(i,3))},ib.get=ou,ib.gt=sF,ib.gte=sL,ib.has=function(t,i){return null!=t&&n_(t,i,i2)},ib.hasIn=oc,ib.head=nH,ib.identity=oU,ib.includes=function(t,i,r,n){t=sB(t)?t:oC(t),r=r&&!n?s5(r):0;var s=t.length;return r<0&&(r=t9(s+r,0)),s0(t)?r<=s&&t.indexOf(i,r)>-1:!!s&&tE(t,i,r)>-1},ib.indexOf=function(t,i,r){var n=null==t?0:t.length;if(!n)return -1;var s=null==r?0:s5(r);return s<0&&(s=t9(n+s,0)),tE(t,i,s)},ib.inRange=function(t,i,n){var s,a,l;return i=s4(i),n===r?(n=i,i=0):n=s4(n),(s=t=s8(t))>=t6(a=i,l=n)&&s<t9(a,l)},ib.invoke=op,ib.isArguments=sN,ib.isArray=sD,ib.isArrayBuffer=sj,ib.isArrayLike=sB,ib.isArrayLikeObject=sU,ib.isBoolean=function(t){return!0===t||!1===t||sq(t)&&i1(t)==p},ib.isBuffer=sz,ib.isDate=sW,ib.isElement=function(t){return sq(t)&&1===t.nodeType&&!sY(t)},ib.isEmpty=function(t){if(null==t)return!0;if(sB(t)&&(sD(t)||"string"==typeof t||"function"==typeof t.splice||sz(t)||s3(t)||sN(t)))return!t.length;var i=ny(t);if(i==b||i==C)return!t.size;if(nT(t))return!ri(t).length;for(var r in t)if(eF.call(t,r))return!1;return!0},ib.isEqual=function(t,i){return i7(t,i)},ib.isEqualWith=function(t,i,n){var s=(n="function"==typeof n?n:r)?n(t,i):r;return s===r?i7(t,i,r,n):!!s},ib.isError=s$,ib.isFinite=function(t){return"number"==typeof t&&t1(t)},ib.isFunction=sV,ib.isInteger=sZ,ib.isLength=sG,ib.isMap=sH,ib.isMatch=function(t,i){return t===i||i8(t,i,nm(i))},ib.isMatchWith=function(t,i,n){return n="function"==typeof n?n:r,i8(t,i,nm(i),n)},ib.isNaN=function(t){return sK(t)&&t!=+t},ib.isNative=function(t){if(nO(t))throw new eE("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return re(t)},ib.isNil=function(t){return null==t},ib.isNull=function(t){return null===t},ib.isNumber=sK,ib.isObject=sJ,ib.isObjectLike=sq,ib.isPlainObject=sY,ib.isRegExp=sQ,ib.isSafeInteger=function(t){return sZ(t)&&t>=-9007199254740991&&t<=9007199254740991},ib.isSet=sX,ib.isString=s0,ib.isSymbol=s1,ib.isTypedArray=s3,ib.isUndefined=function(t){return t===r},ib.isWeakMap=function(t){return sq(t)&&ny(t)==S},ib.isWeakSet=function(t){return sq(t)&&"[object WeakSet]"==i1(t)},ib.join=function(t,i){return null==t?"":t3.call(t,i)},ib.kebabCase=oO,ib.last=nX,ib.lastIndexOf=function(t,i,n){var s=null==t?0:t.length;if(!s)return -1;var a=s;return n!==r&&(a=(a=s5(n))<0?t9(s+a,0):t6(a,s-1)),i==i?function(t,i,r){for(var n=r+1;n--&&t[n]!==i;);return n}(t,i,a):tw(t,tP,a,!0)},ib.lowerCase=oT,ib.lowerFirst=ox,ib.lt=s2,ib.lte=s9,ib.max=function(t){return t&&t.length?iZ(t,oU,i3):r},ib.maxBy=function(t,i){return t&&t.length?iZ(t,np(i,2),i3):r},ib.mean=function(t){return tA(t,oU)},ib.meanBy=function(t,i){return tA(t,np(i,2))},ib.min=function(t){return t&&t.length?iZ(t,oU,rr):r},ib.minBy=function(t,i){return t&&t.length?iZ(t,np(i,2),rr):r},ib.stubArray=oQ,ib.stubFalse=oX,ib.stubObject=function(){return{}},ib.stubString=function(){return""},ib.stubTrue=function(){return!0},ib.multiply=o9,ib.nth=function(t,i){return t&&t.length?rl(t,s5(i)):r},ib.noConflict=function(){return e6._===this&&(e6._=eB),this},ib.noop=oZ,ib.now=sy,ib.pad=function(t,i,r){t=ot(t);var n=(i=s5(i))?tZ(t):0;if(!i||n>=i)return t;var s=(i-n)/2;return r6(tQ(s),r)+t+r6(tY(s),r)},ib.padEnd=function(t,i,r){t=ot(t);var n=(i=s5(i))?tZ(t):0;return i&&n<i?t+r6(i-n,r):t},ib.padStart=function(t,i,r){t=ot(t);var n=(i=s5(i))?tZ(t):0;return i&&n<i?r6(i-n,r)+t:t},ib.parseInt=function(t,i,r){return r||null==i?i=0:i&&(i=+i),t5(ot(t).replace(X,""),i||0)},ib.random=function(t,i,n){if(n&&"boolean"!=typeof n&&nP(t,i,n)&&(i=n=r),n===r&&("boolean"==typeof i?(n=i,i=r):"boolean"==typeof t&&(n=t,t=r)),t===r&&i===r?(t=0,i=1):(t=s4(t),i===r?(i=t,t=0):i=s4(i)),t>i){var s=t;t=i,i=s}if(n||t%1||i%1){var a=t7();return t6(t+a*(i-t+e1("1e-"+((a+"").length-1))),i)}return rp(t,i)},ib.reduce=function(t,i,r){var n=sD(t)?tv:tT,s=arguments.length<3;return n(t,np(i,4),r,s,iW)},ib.reduceRight=function(t,i,r){var n=sD(t)?tg:tT,s=arguments.length<3;return n(t,np(i,4),r,s,i$)},ib.repeat=function(t,i,n){return i=(n?nP(t,i,n):i===r)?1:s5(i),rf(ot(t),i)},ib.replace=function(){var t=arguments,i=ot(t[0]);return t.length<3?i:i.replace(t[1],t[2])},ib.result=function(t,i,n){i=rL(i,t);var s=-1,a=i.length;for(a||(a=1,t=r);++s<a;){var l=null==t?r:t[nU(i[s])];l===r&&(s=a,l=n),t=sV(l)?l.call(t):l}return t},ib.round=o6,ib.runInContext=t,ib.sample=function(t){return(sD(t)?ix:function(t){return ix(oC(t))})(t)},ib.size=function(t){if(null==t)return 0;if(sB(t))return s0(t)?tZ(t):t.length;var i=ny(t);return i==b||i==C?t.size:ri(t).length},ib.snakeCase=ok,ib.some=function(t,i,n){var s=sD(t)?tb:r_;return n&&nP(t,i,n)&&(i=r),s(t,np(i,3))},ib.sortedIndex=function(t,i){return rw(t,i)},ib.sortedIndexBy=function(t,i,r){return rE(t,i,np(r,2))},ib.sortedIndexOf=function(t,i){var r=null==t?0:t.length;if(r){var n=rw(t,i);if(n<r&&sR(t[n],i))return n}return -1},ib.sortedLastIndex=function(t,i){return rw(t,i,!0)},ib.sortedLastIndexBy=function(t,i,r){return rE(t,i,np(r,2),!0)},ib.sortedLastIndexOf=function(t,i){if(null==t?0:t.length){var r=rw(t,i,!0)-1;if(sR(t[r],i))return r}return -1},ib.startCase=oI,ib.startsWith=function(t,i,r){return t=ot(t),r=null==r?0:iD(s5(r),0,t.length),i=rA(i),t.slice(r,r+i.length)==i},ib.subtract=o4,ib.sum=function(t){return t&&t.length?tx(t,oU):0},ib.sumBy=function(t,i){return t&&t.length?tx(t,np(i,2)):0},ib.template=function(t,i,n){var s=ib.templateSettings;n&&nP(t,i,n)&&(i=r),t=ot(t),i=on({},i,s,nr);var a,l,u=on({},i.imports,s.imports,nr),c=of(u),h=tR(u,c),d=0,p=i.interpolate||em,f="__p += '",m=eS((i.escape||em).source+"|"+p.source+"|"+(p===J?ea:em).source+"|"+(i.evaluate||em).source+"|$","g"),v="//# sourceURL="+(eF.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++eY+"]")+`
`;t.replace(m,function(i,r,n,s,u,c){return n||(n=s),f+=t.slice(d,c).replace(ev,tB),r&&(a=!0,f+=`' +
__e(`+r+`) +
'`),u&&(l=!0,f+=`';
`+u+`;
__p += '`),n&&(f+=`' +
((__t = (`+n+`)) == null ? '' : __t) +
'`),d=c+i.length,i}),f+=`';
`;var g=eF.call(i,"variable")&&i.variable;if(g){if(es.test(g))throw new eE("Invalid `variable` option passed into `_.template`")}else f=`with (obj) {
`+f+`
}
`;f=(l?f.replace(j,""):f).replace(B,"$1").replace(U,"$1;"),f="function("+(g||"obj")+`) {
`+(g?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(a?", __e = _.escape":"")+(l?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+f+`return __p
}`;var b=oL(function(){return eC(c,v+"return "+f).apply(r,h)});if(b.source=f,s$(b))throw b;return b},ib.times=function(t,i){if((t=s5(t))<1||t>9007199254740991)return[];var r=4294967295,n=t6(t,4294967295);i=np(i),t-=4294967295;for(var s=tk(n,i);++r<t;)i(r);return s},ib.toFinite=s4,ib.toInteger=s5,ib.toLength=s7,ib.toLower=function(t){return ot(t).toLowerCase()},ib.toNumber=s8,ib.toSafeInteger=function(t){return t?iD(s5(t),-9007199254740991,9007199254740991):0===t?t:0},ib.toString=ot,ib.toUpper=function(t){return ot(t).toUpperCase()},ib.trim=function(t,i,n){if((t=ot(t))&&(n||i===r))return tI(t);if(!t||!(i=rA(i)))return t;var s=tG(t),a=tG(i),l=tL(s,a),u=tN(s,a)+1;return rN(s,l,u).join("")},ib.trimEnd=function(t,i,n){if((t=ot(t))&&(n||i===r))return t.slice(0,tJ(t)+1);if(!t||!(i=rA(i)))return t;var s=tG(t),a=tN(s,tG(i))+1;return rN(s,0,a).join("")},ib.trimStart=function(t,i,n){if((t=ot(t))&&(n||i===r))return t.replace(X,"");if(!t||!(i=rA(i)))return t;var s=tG(t),a=tL(s,tG(i));return rN(s,a).join("")},ib.truncate=function(t,i){var n=30,s="...";if(sJ(i)){var a="separator"in i?i.separator:a;n="length"in i?s5(i.length):n,s="omission"in i?rA(i.omission):s}var l=(t=ot(t)).length;if(tU(t)){var u=tG(t);l=u.length}if(n>=l)return t;var c=n-tZ(s);if(c<1)return s;var h=u?rN(u,0,c).join(""):t.slice(0,c);if(a===r)return h+s;if(u&&(c+=h.length-c),sQ(a)){if(t.slice(c).search(a)){var d,p=h;for(a.global||(a=eS(a.source,ot(el.exec(a))+"g")),a.lastIndex=0;d=a.exec(p);)var f=d.index;h=h.slice(0,f===r?c:f)}}else if(t.indexOf(rA(a),c)!=c){var m=h.lastIndexOf(a);m>-1&&(h=h.slice(0,m))}return h+s},ib.unescape=function(t){return(t=ot(t))&&$.test(t)?t.replace(z,tq):t},ib.uniqueId=function(t){var i=++eL;return ot(t)+i},ib.upperCase=oM,ib.upperFirst=oR,ib.each=sh,ib.eachRight=sd,ib.first=nH,oV(ib,(ey={},iK(ib,function(t,i){eF.call(ib.prototype,i)||(ey[i]=t)}),ey),{chain:!1}),ib.VERSION="4.17.21",tu(["bind","bindKey","curry","curryRight","partial","partialRight"],function(t){ib[t].placeholder=ib}),tu(["drop","take"],function(t,i){iE.prototype[t]=function(n){n=n===r?1:t9(s5(n),0);var s=this.__filtered__&&!i?new iE(this):this.clone();return s.__filtered__?s.__takeCount__=t6(n,s.__takeCount__):s.__views__.push({size:t6(n,4294967295),type:t+(s.__dir__<0?"Right":"")}),s},iE.prototype[t+"Right"]=function(i){return this.reverse()[t](i).reverse()}}),tu(["filter","map","takeWhile"],function(t,i){var r=i+1,n=1==r||3==r;iE.prototype[t]=function(t){var i=this.clone();return i.__iteratees__.push({iteratee:np(t,3),type:r}),i.__filtered__=i.__filtered__||n,i}}),tu(["head","last"],function(t,i){var r="take"+(i?"Right":"");iE.prototype[t]=function(){return this[r](1).value()[0]}}),tu(["initial","tail"],function(t,i){var r="drop"+(i?"":"Right");iE.prototype[t]=function(){return this.__filtered__?new iE(this):this[r](1)}}),iE.prototype.compact=function(){return this.filter(oU)},iE.prototype.find=function(t){return this.filter(t).head()},iE.prototype.findLast=function(t){return this.reverse().find(t)},iE.prototype.invokeMap=rm(function(t,i){return"function"==typeof t?new iE(this):this.map(function(r){return i4(r,t,i)})}),iE.prototype.reject=function(t){return this.filter(sT(np(t)))},iE.prototype.slice=function(t,i){t=s5(t);var n=this;return n.__filtered__&&(t>0||i<0)?new iE(n):(t<0?n=n.takeRight(-t):t&&(n=n.drop(t)),i!==r&&(n=(i=s5(i))<0?n.dropRight(-i):n.take(i-t)),n)},iE.prototype.takeRightWhile=function(t){return this.reverse().takeWhile(t).reverse()},iE.prototype.toArray=function(){return this.take(4294967295)},iK(iE.prototype,function(t,i){var n=/^(?:filter|find|map|reject)|While$/.test(i),s=/^(?:head|last)$/.test(i),a=ib[s?"take"+("last"==i?"Right":""):i],l=s||/^find/.test(i);a&&(ib.prototype[i]=function(){var i=this.__wrapped__,u=s?[1]:arguments,c=i instanceof iE,h=u[0],d=c||sD(i),p=function(t){var i=a.apply(ib,tm([t],u));return s&&f?i[0]:i};d&&n&&"function"==typeof h&&1!=h.length&&(c=d=!1);var f=this.__chain__,m=!!this.__actions__.length,v=l&&!f,g=c&&!m;if(!l&&d){i=g?i:new iE(this);var b=t.apply(i,u);return b.__actions__.push({func:so,args:[p],thisArg:r}),new iw(b,f)}return v&&g?t.apply(this,u):(b=this.thru(p),v?s?b.value()[0]:b.value():b)})}),tu(["pop","push","shift","sort","splice","unshift"],function(t){var i=ex[t],r=/^(?:push|sort|unshift)$/.test(t)?"tap":"thru",n=/^(?:pop|shift)$/.test(t);ib.prototype[t]=function(){var t=arguments;if(n&&!this.__chain__){var s=this.value();return i.apply(sD(s)?s:[],t)}return this[r](function(r){return i.apply(sD(r)?r:[],t)})}}),iK(iE.prototype,function(t,i){var r=ib[i];if(r){var n=r.name+"";eF.call(il,n)||(il[n]=[]),il[n].push({name:i,func:r})}}),il[r1(r,2).name]=[{name:"wrapper",func:r}],iE.prototype.clone=function(){var t=new iE(this.__wrapped__);return t.__actions__=rV(this.__actions__),t.__dir__=this.__dir__,t.__filtered__=this.__filtered__,t.__iteratees__=rV(this.__iteratees__),t.__takeCount__=this.__takeCount__,t.__views__=rV(this.__views__),t},iE.prototype.reverse=function(){if(this.__filtered__){var t=new iE(this);t.__dir__=-1,t.__filtered__=!0}else t=this.clone(),t.__dir__*=-1;return t},iE.prototype.value=function(){var t=this.__wrapped__.value(),i=this.__dir__,r=sD(t),n=i<0,s=r?t.length:0,a=function(t,i,r){for(var n=-1,s=r.length;++n<s;){var a=r[n],l=a.size;switch(a.type){case"drop":t+=l;break;case"dropRight":i-=l;break;case"take":i=t6(i,t+l);break;case"takeRight":t=t9(t,i-l)}}return{start:t,end:i}}(0,s,this.__views__),l=a.start,u=a.end,c=u-l,h=n?u:l-1,d=this.__iteratees__,p=d.length,f=0,m=t6(c,this.__takeCount__);if(!r||!n&&s==c&&m==c)return rk(t,this.__actions__);var v=[];e:for(;c--&&f<m;){h+=i;for(var g=-1,b=t[h];++g<p;){var y=d[g],_=y.iteratee,w=y.type,E=_(b);if(2==w)b=E;else if(!E){if(1==w)continue e;break e}}v[f++]=b}return v},ib.prototype.at=sa,ib.prototype.chain=function(){return ss(this)},ib.prototype.commit=function(){return new iw(this.value(),this.__chain__)},ib.prototype.next=function(){this.__values__===r&&(this.__values__=s6(this.value()));var t=this.__index__>=this.__values__.length,i=t?r:this.__values__[this.__index__++];return{done:t,value:i}},ib.prototype.plant=function(t){for(var i,n=this;n instanceof i_;){var s=nW(n);s.__index__=0,s.__values__=r,i?a.__wrapped__=s:i=s;var a=s;n=n.__wrapped__}return a.__wrapped__=t,i},ib.prototype.reverse=function(){var t=this.__wrapped__;if(t instanceof iE){var i=t;return this.__actions__.length&&(i=new iE(this)),(i=i.reverse()).__actions__.push({func:so,args:[n2],thisArg:r}),new iw(i,this.__chain__)}return this.thru(n2)},ib.prototype.toJSON=ib.prototype.valueOf=ib.prototype.value=function(){return rk(this.__wrapped__,this.__actions__)},ib.prototype.first=ib.prototype.head,e5&&(ib.prototype[e5]=function(){return this}),ib}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(e6._=tH,define(function(){return tH})):e5?((e5.exports=tH)._=tH,e4._=tH):e6._=tH}).call(t)});eh();var ek=((E=ek||{}).GLOBAL="global-store",E.COMMENTS="comments-store",E.WHO_IS_ONLINE="who-is-online-store",E.VIDEO="video-store",E.PRESENCE_3D="presence-3d-store",E.CORE="core-store",E);eh();var eI=el(ex()),eM=new class{setConfig(t){this.configuration=t}get(t,i){return this.configuration?(0,eI.get)(this.configuration,t,i):i}};function eR(){return{set value(e){this.instance=e,setTimeout(()=>Object.freeze(this))},get value(){return this.instance}}}eh(),eh(),eh(),eh(),eh(),eh(),eh();var eF=function(t,i){return(eF=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])})(t,i)};function eL(t,i){if("function"!=typeof i&&null!==i)throw TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}eF(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}function eN(t,i){var r,n,s,a,l={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(u){return function(c){return function(u){if(r)throw TypeError("Generator is already executing.");for(;a&&(a=0,u[0]&&(l=0)),l;)try{if(r=1,n&&(s=2&u[0]?n.return:u[0]?n.throw||((s=n.return)&&s.call(n),0):n.next)&&!(s=s.call(n,u[1])).done)return s;switch(n=0,s&&(u=[2&u[0],s.value]),u[0]){case 0:case 1:s=u;break;case 4:return l.label++,{value:u[1],done:!1};case 5:l.label++,n=u[1],u=[0];continue;case 7:u=l.ops.pop(),l.trys.pop();continue;default:if(!(s=(s=l.trys).length>0&&s[s.length-1])&&(6===u[0]||2===u[0])){l=0;continue}if(3===u[0]&&(!s||u[1]>s[0]&&u[1]<s[3])){l.label=u[1];break}if(6===u[0]&&l.label<s[1]){l.label=s[1],s=u;break}if(s&&l.label<s[2]){l.label=s[2],l.ops.push(u);break}s[2]&&l.ops.pop(),l.trys.pop();continue}u=i.call(t,l)}catch(t){u=[6,t],n=0}finally{r=s=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}([u,c])}}}function eD(t){var i="function"==typeof Symbol&&Symbol.iterator,r=i&&t[i],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")}function ej(t,i){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,s,a=r.call(t),l=[];try{for(;(void 0===i||i-- >0)&&!(n=a.next()).done;)l.push(n.value)}catch(t){s={error:t}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(s)throw s.error}}return l}function eB(t,i,r){if(2==arguments.length)for(var n,s=0,a=i.length;s<a;s++)!n&&s in i||(n||(n=Array.prototype.slice.call(i,0,s)),n[s]=i[s]);return t.concat(n||Array.prototype.slice.call(i))}function eU(t){return this instanceof eU?(this.v=t,this):new eU(t)}function ez(t){return"function"==typeof t}function eW(t){var i=t(function(t){Error.call(t),t.stack=Error().stack});return i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,i}eh(),eh(),eh(),eh();var e$=eW(function(t){return function(i){t(this),this.message=i?i.length+` errors occurred during unsubscription:
`+i.map(function(t,i){return i+1+") "+t.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=i}});function eV(t,i){if(t){var r=t.indexOf(i);0<=r&&t.splice(r,1)}}eh();var eZ=function(){var t;function i(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return i.prototype.unsubscribe=function(){var t,i,r,n,s;if(!this.closed){this.closed=!0;var a=this._parentage;if(a){if(this._parentage=null,Array.isArray(a))try{for(var l=eD(a),u=l.next();!u.done;u=l.next())u.value.remove(this)}catch(i){t={error:i}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(t)throw t.error}}else a.remove(this)}var c=this.initialTeardown;if(ez(c))try{c()}catch(t){s=t instanceof e$?t.errors:[t]}var h=this._finalizers;if(h){this._finalizers=null;try{for(var d=eD(h),p=d.next();!p.done;p=d.next()){var f=p.value;try{eq(f)}catch(t){s=s??[],t instanceof e$?s=eB(eB([],ej(s)),ej(t.errors)):s.push(t)}}}catch(t){r={error:t}}finally{try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}}if(s)throw new e$(s)}},i.prototype.add=function(t){var r;if(t&&t!==this){if(this.closed)eq(t);else{if(t instanceof i){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}}},i.prototype._hasParent=function(t){var i=this._parentage;return i===t||Array.isArray(i)&&i.includes(t)},i.prototype._addParent=function(t){var i=this._parentage;this._parentage=Array.isArray(i)?(i.push(t),i):i?[i,t]:t},i.prototype._removeParent=function(t){var i=this._parentage;i===t?this._parentage=null:Array.isArray(i)&&eV(i,t)},i.prototype.remove=function(t){var r=this._finalizers;r&&eV(r,t),t instanceof i&&t._removeParent(this)},i.EMPTY=((t=new i).closed=!0,t),i}(),eG=eZ.EMPTY;function eJ(t){return t instanceof eZ||t&&"closed"in t&&ez(t.remove)&&ez(t.add)&&ez(t.unsubscribe)}function eq(t){ez(t)?t():t.unsubscribe()}eh();var eH={Promise:void 0,useDeprecatedNextContext:!1};eh(),eh();var eK=function(t,i){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return setTimeout.apply(void 0,eB([t,i],ej(r)))};function eY(t){eK(function(){throw t})}function eQ(){}eh(),eh(),eh();var eX=function(t){function i(i){var r=t.call(this)||this;return r.isStopped=!1,i?(r.destination=i,eJ(i)&&i.add(r)):r.destination=e9,r}return eL(i,t),i.create=function(t,i,r){return new e2(t,i,r)},i.prototype.next=function(t){this.isStopped||this._next(t)},i.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},i.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},i.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},i.prototype._next=function(t){this.destination.next(t)},i.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},i.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},i}(eZ),e0=Function.prototype.bind;function e1(t,i){return e0.call(t,i)}var e3=function(){function t(t){this.partialObserver=t}return t.prototype.next=function(t){var i=this.partialObserver;if(i.next)try{i.next(t)}catch(t){eY(t)}},t.prototype.error=function(t){var i=this.partialObserver;if(i.error)try{i.error(t)}catch(t){eY(t)}else eY(t)},t.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(t){eY(t)}},t}(),e2=function(t){function i(i,r,n){var s,a,l=t.call(this)||this;return ez(i)||!i?a={next:i??void 0,error:r??void 0,complete:n??void 0}:l&&eH.useDeprecatedNextContext?((s=Object.create(i)).unsubscribe=function(){return l.unsubscribe()},a={next:i.next&&e1(i.next,s),error:i.error&&e1(i.error,s),complete:i.complete&&e1(i.complete,s)}):a=i,l.destination=new e3(a),l}return eL(i,t),i}(eX),e9={closed:!0,next:eQ,error:function(t){throw t},complete:eQ};eh();var e6="function"==typeof Symbol&&Symbol.observable||"@@observable";function e4(t){return t}eh(),eh();var e5=function(){function t(t){t&&(this._subscribe=t)}return t.prototype.lift=function(i){var r=new t;return r.source=this,r.operator=i,r},t.prototype.subscribe=function(t,i,r){var n,s,a,l=(n=t)&&n instanceof eX||n&&ez(n.next)&&ez(n.error)&&ez(n.complete)&&eJ(n)?t:new e2(t,i,r);return s=this.operator,a=this.source,l.add(s?s.call(l,a):a?this._subscribe(l):this._trySubscribe(l)),l},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(i){t.error(i)}},t.prototype.forEach=function(t,i){var r=this;return new(i=e7(i))(function(i,n){var s=new e2({next:function(i){try{t(i)}catch(t){n(t),s.unsubscribe()}},error:n,complete:i});r.subscribe(s)})},t.prototype._subscribe=function(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)},t.prototype[e6]=function(){return this},t.prototype.pipe=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return(0===t.length?e4:1===t.length?t[0]:function(i){return t.reduce(function(t,i){return i(t)},i)})(this)},t.prototype.toPromise=function(t){var i=this;return new(t=e7(t))(function(t,r){var n;i.subscribe(function(t){return n=t},function(t){return r(t)},function(){return t(n)})})},t.create=function(i){return new t(i)},t}();function e7(t){var i;return null!==(i=t??eH.Promise)&&void 0!==i?i:Promise}function e8(t){return function(i){if(ez(null==i?void 0:i.lift))return i.lift(function(i){try{return t(i,this)}catch(t){this.error(t)}});throw TypeError("Unable to lift unknown Observable type")}}function te(t,i,r,n,s){return new tt(t,i,r,n,s)}eh(),eh();var tt=function(t){function i(i,r,n,s,a,l){var u=t.call(this,i)||this;return u.onFinalize=a,u.shouldUnsubscribe=l,u._next=r?function(t){try{r(t)}catch(t){i.error(t)}}:t.prototype._next,u._error=s?function(t){try{s(t)}catch(t){i.error(t)}finally{this.unsubscribe()}}:t.prototype._error,u._complete=n?function(){try{n()}catch(t){i.error(t)}finally{this.unsubscribe()}}:t.prototype._complete,u}return eL(i,t),i.prototype.unsubscribe=function(){var i;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var r=this.closed;t.prototype.unsubscribe.call(this),r||null===(i=this.onFinalize)||void 0===i||i.call(this)}},i}(eX);eh(),eh();var ti=eW(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),tr=function(t){function i(){var i=t.call(this)||this;return i.closed=!1,i.currentObservers=null,i.observers=[],i.isStopped=!1,i.hasError=!1,i.thrownError=null,i}return eL(i,t),i.prototype.lift=function(t){var i=new tn(this,this);return i.operator=t,i},i.prototype._throwIfClosed=function(){if(this.closed)throw new ti},i.prototype.next=function(t){var i=this;(function(){var r,n;if(i._throwIfClosed(),!i.isStopped){i.currentObservers||(i.currentObservers=Array.from(i.observers));try{for(var s=eD(i.currentObservers),a=s.next();!a.done;a=s.next())a.value.next(t)}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}})()},i.prototype.error=function(t){var i=this;(function(){if(i._throwIfClosed(),!i.isStopped){i.hasError=i.isStopped=!0,i.thrownError=t;for(var r=i.observers;r.length;)r.shift().error(t)}})()},i.prototype.complete=function(){var t=this;(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var i=t.observers;i.length;)i.shift().complete()}})()},i.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(i.prototype,"observed",{get:function(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0},enumerable:!1,configurable:!0}),i.prototype._trySubscribe=function(i){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,i)},i.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},i.prototype._innerSubscribe=function(t){var i=this,r=this.hasError,n=this.isStopped,s=this.observers;return r||n?eG:(this.currentObservers=null,s.push(t),new eZ(function(){i.currentObservers=null,eV(s,t)}))},i.prototype._checkFinalizedStatuses=function(t){var i=this.hasError,r=this.thrownError,n=this.isStopped;i?t.error(r):n&&t.complete()},i.prototype.asObservable=function(){var t=new e5;return t.source=this,t},i.create=function(t,i){return new tn(t,i)},i}(e5),tn=function(t){function i(i,r){var n=t.call(this)||this;return n.destination=i,n.source=r,n}return eL(i,t),i.prototype.next=function(t){var i,r;null===(r=null===(i=this.destination)||void 0===i?void 0:i.next)||void 0===r||r.call(i,t)},i.prototype.error=function(t){var i,r;null===(r=null===(i=this.destination)||void 0===i?void 0:i.error)||void 0===r||r.call(i,t)},i.prototype.complete=function(){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===i||i.call(t)},i.prototype._subscribe=function(t){var i,r;return null!==(r=null===(i=this.source)||void 0===i?void 0:i.subscribe(t))&&void 0!==r?r:eG},i}(tr);eh();var ts=function(t){function i(i){var r=t.call(this)||this;return r._value=i,r}return eL(i,t),Object.defineProperty(i.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),i.prototype._subscribe=function(i){var r=t.prototype._subscribe.call(this,i);return r.closed||i.next(this._value),r},i.prototype.getValue=function(){var t=this.hasError,i=this.thrownError,r=this._value;if(t)throw i;return this._throwIfClosed(),r},i.prototype.next=function(i){t.prototype.next.call(this,this._value=i)},i}(tr);eh(),eh();var to={now:function(){return(to.delegate||Date).now()},delegate:void 0},ta=function(t){function i(i,r,n){void 0===i&&(i=1/0),void 0===r&&(r=1/0),void 0===n&&(n=to);var s=t.call(this)||this;return s._bufferSize=i,s._windowTime=r,s._timestampProvider=n,s._buffer=[],s._infiniteTimeWindow=!0,s._infiniteTimeWindow=r===1/0,s._bufferSize=Math.max(1,i),s._windowTime=Math.max(1,r),s}return eL(i,t),i.prototype.next=function(i){var r=this.isStopped,n=this._buffer,s=this._infiniteTimeWindow,a=this._timestampProvider,l=this._windowTime;r||(n.push(i),s||n.push(a.now()+l)),this._trimBuffer(),t.prototype.next.call(this,i)},i.prototype._subscribe=function(t){this._throwIfClosed(),this._trimBuffer();for(var i=this._innerSubscribe(t),r=this._infiniteTimeWindow,n=this._buffer,s=n.slice(),a=0;a<s.length&&!t.closed;a+=r?1:2)t.next(s[a]);return this._checkFinalizedStatuses(t),i},i.prototype._trimBuffer=function(){var t=this._bufferSize,i=this._timestampProvider,r=this._buffer,n=this._infiniteTimeWindow,s=(n?1:2)*t;if(t<1/0&&s<r.length&&r.splice(0,r.length-s),!n){for(var a=i.now(),l=0,u=1;u<r.length&&r[u]<=a;u+=2)l=u;l&&r.splice(0,l+1)}},i}(tr);eh(),eh();var tl=function(t){function i(i,r){return t.call(this)||this}return eL(i,t),i.prototype.schedule=function(t,i){return this},i}(eZ);eh();var tu={setInterval:function(t,i){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];var s=tu.delegate;return null!=s&&s.setInterval?s.setInterval.apply(s,eB([t,i],ej(r))):setInterval.apply(void 0,eB([t,i],ej(r)))},clearInterval:function(t){return clearInterval(t)},delegate:void 0},tc=function(t){function i(i,r){var n=t.call(this,i,r)||this;return n.scheduler=i,n.work=r,n.pending=!1,n}return eL(i,t),i.prototype.schedule=function(t,i){if(void 0===i&&(i=0),this.closed)return this;this.state=t;var r,n=this.id,s=this.scheduler;return null!=n&&(this.id=this.recycleAsyncId(s,n,i)),this.pending=!0,this.delay=i,this.id=null!==(r=this.id)&&void 0!==r?r:this.requestAsyncId(s,this.id,i),this},i.prototype.requestAsyncId=function(t,i,r){return void 0===r&&(r=0),tu.setInterval(t.flush.bind(t,this),r)},i.prototype.recycleAsyncId=function(t,i,r){if(void 0===r&&(r=0),null!=r&&this.delay===r&&!1===this.pending)return i;null!=i&&tu.clearInterval(i)},i.prototype.execute=function(t,i){if(this.closed)return Error("executing a cancelled action");this.pending=!1;var r=this._execute(t,i);if(r)return r;!1===this.pending&&null!=this.id&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},i.prototype._execute=function(t,i){var r,n=!1;try{this.work(t)}catch(t){n=!0,r=t||Error("Scheduled action threw falsy error")}if(n)return this.unsubscribe(),r},i.prototype.unsubscribe=function(){if(!this.closed){var i=this.id,r=this.scheduler,n=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,eV(n,this),null!=i&&(this.id=this.recycleAsyncId(r,i,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},i}(tl);eh(),eh();var th=function(){function t(i,r){void 0===r&&(r=t.now),this.schedulerActionCtor=i,this.now=r}return t.prototype.schedule=function(t,i,r){return void 0===i&&(i=0),new this.schedulerActionCtor(this,t).schedule(r,i)},t.now=to.now,t}(),td=function(t){function i(i,r){void 0===r&&(r=th.now);var n=t.call(this,i,r)||this;return n.actions=[],n._active=!1,n}return eL(i,t),i.prototype.flush=function(t){var i,r=this.actions;if(this._active){r.push(t);return}this._active=!0;do if(i=t.execute(t.state,t.delay))break;while(t=r.shift());if(this._active=!1,i){for(;t=r.shift();)t.unsubscribe();throw i}},i}(th);eh();var tp=new td(tc);eh(),eh(),eh();var tf=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};eh(),eh(),eh(),eh(),eh(),eh();var tm="function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator";function tv(t){if(t instanceof e5)return t;if(null!=t){if(ez(t[e6]))return new e5(function(i){var r=t[e6]();if(ez(r.subscribe))return r.subscribe(i);throw TypeError("Provided object does not correctly implement Symbol.observable")});if(tf(t))return new e5(function(i){for(var r=0;r<t.length&&!i.closed;r++)i.next(t[r]);i.complete()});if(ez(null==t?void 0:t.then))return new e5(function(i){t.then(function(t){i.closed||(i.next(t),i.complete())},function(t){return i.error(t)}).then(null,eY)});if(Symbol.asyncIterator&&ez(null==t?void 0:t[Symbol.asyncIterator]))return tg(t);if(ez(null==t?void 0:t[tm]))return new e5(function(i){var r,n;try{for(var s=eD(t),a=s.next();!a.done;a=s.next()){var l=a.value;if(i.next(l),i.closed)return}}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}i.complete()});if(ez(null==t?void 0:t.getReader))return tg(function(t){return function(t,i,r){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var n,s=r.apply(t,i||[]),a=[];return n={},l("next"),l("throw"),l("return"),n[Symbol.asyncIterator]=function(){return this},n;function l(t){s[t]&&(n[t]=function(i){return new Promise(function(r,n){a.push([t,i,r,n])>1||u(t,i)})})}function u(t,i){try{var r;(r=s[t](i)).value instanceof eU?Promise.resolve(r.value.v).then(c,h):d(a[0][2],r)}catch(t){d(a[0][3],t)}}function c(t){u("next",t)}function h(t){u("throw",t)}function d(t,i){t(i),a.shift(),a.length&&u(a[0][0],a[0][1])}}(this,arguments,function(){var i,r,n;return eN(this,function(s){switch(s.label){case 0:i=t.getReader(),s.label=1;case 1:s.trys.push([1,,9,10]),s.label=2;case 2:return[4,eU(i.read())];case 3:return n=(r=s.sent()).value,r.done?[4,eU(void 0)]:[3,5];case 4:return[2,s.sent()];case 5:return[4,eU(n)];case 6:return[4,s.sent()];case 7:return s.sent(),[3,2];case 8:return[3,10];case 9:return i.releaseLock(),[7];case 10:return[2]}})})}(t))}throw TypeError("You provided "+(null!==t&&"object"==typeof t?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function tg(t){return new e5(function(i){(function(t,i){var r,n,s,a,l,u,c;return l=this,u=void 0,c=function(){var l;return eN(this,function(u){switch(u.label){case 0:u.trys.push([0,5,6,11]),r=function(t){if(!Symbol.asyncIterator)throw TypeError("Symbol.asyncIterator is not defined.");var i,r=t[Symbol.asyncIterator];return r?r.call(t):(t=eD(t),i={},n("next"),n("throw"),n("return"),i[Symbol.asyncIterator]=function(){return this},i);function n(r){i[r]=t[r]&&function(i){return new Promise(function(n,s){(function(t,i,r,n){Promise.resolve(n).then(function(i){t({value:i,done:r})},i)})(n,s,(i=t[r](i)).done,i.value)})}}}(t),u.label=1;case 1:return[4,r.next()];case 2:if((n=u.sent()).done)return[3,4];if(l=n.value,i.next(l),i.closed)return[2];u.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return s={error:u.sent()},[3,11];case 6:return u.trys.push([6,,9,10]),n&&!n.done&&(a=r.return)?[4,a.call(r)]:[3,8];case 7:u.sent(),u.label=8;case 8:return[3,10];case 9:if(s)throw s.error;return[7];case 10:return[7];case 11:return i.complete(),[2]}})},new(u||(u=Promise))(function(t,i){function r(t){try{s(c.next(t))}catch(t){i(t)}}function n(t){try{s(c.throw(t))}catch(t){i(t)}}function s(i){var s;i.done?t(i.value):((s=i.value)instanceof u?s:new u(function(t){t(s)})).then(r,n)}s((c=c.apply(l,[])).next())})})(t,i).catch(function(t){return i.error(t)})})}function tb(t,i){return e8(function(r,n){var s=0;r.subscribe(te(n,function(r){n.next(t.call(i,r,s++))}))})}eh(),eh(),eh(),eh(),eh();var ty=Array.isArray;eh(),eh(),eh();var t_=["addListener","removeListener"],tw=["addEventListener","removeEventListener"],tE=["on","off"];function tC(t,i){return function(r){return function(n){return t[r](i,n)}}}function tP(t,i){return void 0===i&&(i=e4),t=t??tA,e8(function(r,n){var s,a=!0;r.subscribe(te(n,function(r){var l=i(r);(a||!t(s,l))&&(a=!1,s=l,n.next(r))}))})}function tA(t,i){return t===i}function tS(t,i){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];if(!0===i){t();return}if(!1!==i){var s=new e2({next:function(){s.unsubscribe(),t()}});return tv(i.apply(void 0,eB([],ej(r)))).subscribe(s)}}function tO(t,i,r){var n,s,a,l,u,c,h,d,p,f,m,v,g,b=!1;return t&&"object"==typeof t?(g=void 0===(f=t.bufferSize)?1/0:f,i=void 0===(m=t.windowTime)?1/0:m,b=void 0!==(v=t.refCount)&&v,r=t.scheduler):g=t??1/0,a=void 0===(s=(n={connector:function(){return new ta(g,i,r)},resetOnError:!0,resetOnComplete:!1,resetOnRefCountZero:b}).connector)?function(){return new tr}:s,u=void 0===(l=n.resetOnError)||l,h=void 0===(c=n.resetOnComplete)||c,p=void 0===(d=n.resetOnRefCountZero)||d,function(t){var i,r,n,s=0,l=!1,c=!1,d=function(){null==r||r.unsubscribe(),r=void 0},f=function(){d(),i=n=void 0,l=c=!1},m=function(){var t=i;f(),null==t||t.unsubscribe()};return e8(function(t,v){s++,c||l||d();var g=n=n??a();v.add(function(){0!=--s||c||l||(r=tS(m,p))}),g.subscribe(v),!i&&s>0&&(i=new e2({next:function(t){return g.next(t)},error:function(t){c=!0,d(),r=tS(f,u,t),g.error(t)},complete:function(){l=!0,d(),r=tS(f,h),g.complete()}}),tv(t).subscribe(i))})(t)}}eh(),eh(),eh(),eh(),eh(),eh();var tT=class{constructor(t,i){this.subscriptions=new Map,this.setValue=t=>{this.state=t,this.subject.next(this.state)},this.subscribe=(t,i)=>{let r=this.subject.subscribe(i);if(this.subscriptions.has(t)){this.subscriptions.get(t).push(r);return}this.subscriptions.set(t,[r])},this.state=t,this.firstState=t,this.subject=i.pipe(tP(),tO({bufferSize:1,refCount:!0}))}getValue(){return this.state}unsubscribe(t){var i;null==(i=this.subscriptions.get(t))||i.forEach(t=>t.unsubscribe()),this.subscriptions.delete(t)}destroy(){this.subscriptions.clear(),this.subject.complete(),this.restart()}restart(){this.state=this.firstState,this.subject=new ts(this.firstState).pipe(tP(),tO({bufferSize:1,refCount:!0}))}expose(){let t=this.subscribe.bind(this),i=this.unsubscribe.bind(this),r=this.getValue.bind(this),n=this.setValue.bind(this);return{get value(){return r()},set value(o){n(o)},subscribe:t,unsubscribe:i}}};function tx(t){let i=new ts(t);return new tT(t,i)}var tk=eR(),tI=new class{constructor(){if(this.localParticipant=tx({}),this.participants=tx({}),this.group=tx(null),this.isDomainWhitelisted=tx(!0),this.hasJoinedRoom=tx(!1),tk.value)throw Error("CommentsStore is a singleton. There can only be one instance of it.");tk.value=this}destroy(){this.localParticipant.destroy(),this.participants.destroy(),this.group.destroy(),this.isDomainWhitelisted.destroy(),this.hasJoinedRoom.destroy()}},tM=tI.destroy.bind(tI),tR=tI.group.expose(),tF=tI.participants.expose(),tL=tI.localParticipant.expose(),tN=tI.isDomainWhitelisted.expose(),tD=tI.hasJoinedRoom.expose();function tj(){return{localParticipant:tL,participants:tF,group:tR,isDomainWhitelisted:tN,hasJoinedRoom:tD,destroy:tM}}eh(),eh();var tB=eR(),tU=new class{constructor(){if(this.localParticipant=tx({}),this.participants=tx({}),tB.value)throw Error("CoreStore is a singleton. There can only be one instance of it.");tB.value=this}destroy(){this.localParticipant.destroy(),this.participants.destroy()}},tz=tU.destroy.bind(tU),tW=tU.localParticipant.expose(),t$=tU.participants.expose();eh();var tV=eR(),tZ=new class{constructor(){if(this.hasJoined3D=tx(!1),this.participants=tx([]),tV.value)throw Error("Presence3DStore is a singleton. There can only be one instance of it.");tV.value=this}destroy(){this.hasJoined3D.destroy(),this.participants.destroy()}},tG=tZ.destroy.bind(tZ),tJ=tZ.hasJoined3D.expose(),tq=tZ.participants.expose();eh(),eh();var tH=((C=tH||{})[C.DISCONNECTED=0]="DISCONNECTED",C[C.INITIALIZING=1]="INITIALIZING",C[C.READY_TO_JOIN=2]="READY_TO_JOIN",C[C.CONNECTING=3]="CONNECTING",C[C.CONNECTED=4]="CONNECTED",C[C.JOINED=5]="JOINED",C[C.FAILED=-1]="FAILED",C[C.RETRYING=-2]="RETRYING",C),tK=eR(),tY=new class{constructor(){if(this.meetingState=tx(0),this.gather=tx(!1),this.hostId=tx(""),this.isGridModeEnabled=tx(!1),this.followParticipantId=tx(""),this.drawing=tx(null),this.transcript=tx(null),tK.value)throw Error("VideoStore is a singleton. There can only be one instance of it.");tK.value=this}destroy(){this.meetingState.destroy(),this.gather.destroy(),this.hostId.destroy(),this.isGridModeEnabled.destroy(),this.followParticipantId.destroy(),this.drawing.destroy(),this.transcript.destroy()}},tQ=tY.destroy.bind(tY),tX=tY.meetingState.expose(),t0=tY.gather.expose(),t1=tY.hostId.expose(),t3=tY.isGridModeEnabled.expose(),t2=tY.followParticipantId.expose(),t9=tY.drawing.expose(),t6=tY.transcript.expose();eh();var t4=eR(),t5=new class{constructor(){if(this.disablePresenceControls=tx(!1),this.disableGoToParticipant=tx(!1),this.disableFollowParticipant=tx(!1),this.disablePrivateMode=tx(!1),this.disableGatherAll=tx(!1),this.disableFollowMe=tx(!1),this.participants=tx([]),this.extras=tx([]),this.joinedPresence=tx(void 0),this.everyoneFollowsMe=tx(!1),this.privateMode=tx(!1),this.following=tx(void 0),t4.value)throw Error("WhoIsOnlineStore is a singleton. There can only be one instance of it.");t4.value=this}destroy(){this.disableGoToParticipant.destroy(),this.disablePresenceControls.destroy(),this.disableFollowParticipant.destroy(),this.disablePrivateMode.destroy(),this.disableGatherAll.destroy(),this.disableFollowMe.destroy(),this.participants.destroy(),this.extras.destroy(),this.joinedPresence.destroy(),this.everyoneFollowsMe.destroy(),this.privateMode.destroy(),this.following.destroy()}},t7=t5.destroy.bind(t5),t8=t5.disablePresenceControls.expose(),ie=t5.disableGoToParticipant.expose(),it=t5.disableFollowParticipant.expose(),ii=t5.disablePrivateMode.expose(),ir=t5.disableGatherAll.expose(),is=t5.disableFollowMe.expose(),io=t5.joinedPresence.expose(),ia=t5.participants.expose(),il=t5.extras.expose(),iu=t5.everyoneFollowsMe.expose(),ic=t5.privateMode.expose(),ih=t5.following.expose(),id={"global-store":tj,"who-is-online-store":function(){return{disablePresenceControls:t8,disableGoToParticipant:ie,disableFollowParticipant:it,disablePrivateMode:ii,disableGatherAll:ir,disableFollowMe:is,participants:ia,extras:il,joinedPresence:io,everyoneFollowsMe:iu,privateMode:ic,following:ih,destroy:t7}},"video-store":function(){return{meetingState:tX,gather:t0,destroy:tQ,hostId:t1,isGridModeEnabled:t3,followParticipantId:t2,drawing:t9,transcript:t6}},"presence-3d-store":function(){return{hasJoined3D:tJ,participants:tq,destroy:tG}},"core-store":function(){return{localParticipant:tW,participants:t$,destroy:tz}}};function ip(t,i,r){i.subscribe(this,()=>{r?r(i.value):this[t]=i.value,this.requestUpdate&&this.requestUpdate()}),this.unsubscribeFrom||(this.unsubscribeFrom=[]),this.unsubscribeFrom.push(i.unsubscribe)}function im(t){let i=id[t](),r=ip.bind(this);return new Proxy(i,{get:(t,i)=>"destroy"===i?t.destroy:{subscribe(n){r(i,t[i],n)},subject:t[i],get value(){return this.subject.value},publish(t){this.subject.value=t}}})}var iv=eo((t,i)=>{function r(t,i,r,n){return Math.round(t/r)+" "+n+(i>=1.5*r?"s":"")}eh(),i.exports=function(t,i){i=i||{};var n,s,a=typeof t;if("string"===a&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(i){var r=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"weeks":case"week":case"w":return 6048e5*r;case"days":case"day":case"d":return 864e5*r;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*r;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*r;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}(t);if("number"===a&&isFinite(t))return i.long?(n=Math.abs(t))>=864e5?r(t,n,864e5,"day"):n>=36e5?r(t,n,36e5,"hour"):n>=6e4?r(t,n,6e4,"minute"):n>=1e3?r(t,n,1e3,"second"):t+" ms":(s=Math.abs(t))>=864e5?Math.round(t/864e5)+"d":s>=36e5?Math.round(t/36e5)+"h":s>=6e4?Math.round(t/6e4)+"m":s>=1e3?Math.round(t/1e3)+"s":t+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}}),ig=eo((t,i)=>{eh(),i.exports=function(t){function i(t){let n,s=null,a,l;function u(...t){if(!u.enabled)return;let r=Number(new Date),s=r-(n||r);u.diff=s,u.prev=n,u.curr=r,n=r,t[0]=i.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let a=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(r,n)=>{if("%%"===r)return"%";a++;let s=i.formatters[n];if("function"==typeof s){let i=t[a];r=s.call(u,i),t.splice(a,1),a--}return r}),i.formatArgs.call(u,t),(u.log||i.log).apply(u,t)}return u.namespace=t,u.useColors=i.useColors(),u.color=i.selectColor(t),u.extend=r,u.destroy=i.destroy,Object.defineProperty(u,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(a!==i.namespaces&&(a=i.namespaces,l=i.enabled(t)),l),set:t=>{s=t}}),"function"==typeof i.init&&i.init(u),u}function r(t,r){let n=i(this.namespace+(typeof r>"u"?":":r)+t);return n.log=this.log,n}function n(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return i.debug=i,i.default=i,i.coerce=function(t){return t instanceof Error?t.stack||t.message:t},i.disable=function(){let t=[...i.names.map(n),...i.skips.map(n).map(t=>"-"+t)].join(",");return i.enable(""),t},i.enable=function(t){i.save(t),i.namespaces=t,i.names=[],i.skips=[];let r,n=("string"==typeof t?t:"").split(/[\s,]+/),s=n.length;for(r=0;r<s;r++)n[r]&&("-"===(t=n[r].replace(/\*/g,".*?"))[0]?i.skips.push(RegExp("^"+t.slice(1)+"$")):i.names.push(RegExp("^"+t+"$")))},i.enabled=function(t){let r,n;if("*"===t[t.length-1])return!0;for(r=0,n=i.skips.length;r<n;r++)if(i.skips[r].test(t))return!1;for(r=0,n=i.names.length;r<n;r++)if(i.names[r].test(t))return!0;return!1},i.humanize=iv(),i.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach(r=>{i[r]=t[r]}),i.names=[],i.skips=[],i.formatters={},i.selectColor=function(t){let r=0;for(let i=0;i<t.length;i++)r=(r<<5)-r+t.charCodeAt(i)|0;return i.colors[Math.abs(r)%i.colors.length]},i.enable(i.load()),i}}),ib=eo((t,i)=>{let r;eh(),t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+i.exports.humanize(this.diff),!this.useColors)return;let r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,s=0;t[0].replace(/%[a-zA-Z%]/g,t=>{"%%"!==t&&(n++,"%c"===t&&(s=n))}),t.splice(s,0,r)},t.save=function(i){try{i?t.storage.setItem("debug",i):t.storage.removeItem("debug")}catch{}},t.load=function(){let i;try{i=t.storage.getItem("debug")}catch{}return!i&&"u">typeof V&&"env"in V&&(i=W.DEBUG),i},t.useColors=function(){let t;return"u">typeof window&&!!window.process&&("renderer"===window.process.type||!!window.process.__nwjs)||!("u">typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("u">typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"u">typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"u">typeof navigator&&navigator.userAgent&&(t=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(t[1],10)>=31||"u">typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch{}}(),t.destroy=(r=!1,()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),i.exports=ig()(t);var{formatters:n}=i.exports;n.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}),iy=eo((t,i)=>{eh(),i.exports=function(t){var i=typeof t;return null!=t&&("object"==i||"function"==i)}}),i_=eo((t,i)=>{eh();var r="object"==typeof window&&window&&window.Object===Object&&window;i.exports=r}),iw=eo((t,i)=>{eh();var r=i_(),n="object"==typeof self&&self&&self.Object===Object&&self,s=r||n||Function("return this")();i.exports=s}),iE=eo((t,i)=>{eh();var r=iw();i.exports=function(){return r.Date.now()}}),iC=eo((t,i)=>{eh();var r=/\s/;i.exports=function(t){for(var i=t.length;i--&&r.test(t.charAt(i)););return i}}),iP=eo((t,i)=>{eh();var r=iC(),n=/^\s+/;i.exports=function(t){return t&&t.slice(0,r(t)+1).replace(n,"")}}),iA=eo((t,i)=>{eh();var r=iw().Symbol;i.exports=r}),iS=eo((t,i)=>{eh();var r=iA(),n=Object.prototype,s=n.hasOwnProperty,a=n.toString,l=r?r.toStringTag:void 0;i.exports=function(t){var i=s.call(t,l),r=t[l];try{t[l]=void 0;var n=!0}catch{}var u=a.call(t);return n&&(i?t[l]=r:delete t[l]),u}}),iO=eo((t,i)=>{eh();var r=Object.prototype.toString;i.exports=function(t){return r.call(t)}}),iT=eo((t,i)=>{eh();var r=iA(),n=iS(),s=iO(),a=r?r.toStringTag:void 0;i.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":a&&a in Object(t)?n(t):s(t)}}),ix=eo((t,i)=>{eh(),i.exports=function(t){return null!=t&&"object"==typeof t}}),ik=eo((t,i)=>{eh();var r=iT(),n=ix();i.exports=function(t){return"symbol"==typeof t||n(t)&&"[object Symbol]"==r(t)}}),iI=eo((t,i)=>{eh();var r=iP(),n=iy(),s=ik(),a=NaN,l=/^[-+]0x[0-9a-f]+$/i,u=/^0b[01]+$/i,c=/^0o[0-7]+$/i,h=parseInt;i.exports=function(t){if("number"==typeof t)return t;if(s(t))return a;if(n(t)){var i="function"==typeof t.valueOf?t.valueOf():t;t=n(i)?i+"":i}if("string"!=typeof t)return 0===t?t:+t;t=r(t);var d=u.test(t);return d||c.test(t)?h(t.slice(2),d?2:8):l.test(t)?a:+t}}),iM=eo((t,i)=>{eh();var r=iy(),n=iE(),s=iI(),a=Math.max,l=Math.min;i.exports=function(t,i,u){var c,h,d,p,f,m,v=0,g=!1,b=!1,y=!0;if("function"!=typeof t)throw TypeError("Expected a function");function _(i){var r=c,n=h;return c=h=void 0,v=i,p=t.apply(n,r)}function w(t){var r=t-m,n=t-v;return void 0===m||r>=i||r<0||b&&n>=d}function E(){var t,r,s,a=n();if(w(a))return C(a);f=setTimeout(E,(t=a-m,r=a-v,s=i-t,b?l(s,d-r):s))}function C(t){return f=void 0,y&&c?_(t):(c=h=void 0,p)}function P(){var t,r=n(),s=w(r);if(c=arguments,h=this,m=r,s){if(void 0===f)return v=t=m,f=setTimeout(E,i),g?_(t):p;if(b)return clearTimeout(f),f=setTimeout(E,i),_(m)}return void 0===f&&(f=setTimeout(E,i)),p}return i=s(i)||0,r(u)&&(g=!!u.leading,d=(b="maxWait"in u)?a(s(u.maxWait)||0,i):d,y="trailing"in u?!!u.trailing:y),P.cancel=function(){void 0!==f&&clearTimeout(f),v=0,c=m=h=f=void 0},P.flush=function(){return void 0===f?p:C(n())},P}}),iR=eo((t,i)=>{eh();var r=iM(),n=iy();i.exports=function(t,i,s){var a=!0,l=!0;if("function"!=typeof t)throw TypeError("Expected a function");return n(s)&&(a="leading"in s?!!s.leading:a,l="trailing"in s?!!s.trailing:l),r(t,i,{leading:a,maxWait:i,trailing:l})}}),iF=eo((t,i)=>{var r;eh(),r=function(){return function(t){var i={};function r(n){if(i[n])return i[n].exports;var s=i[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,r),s.l=!0,s.exports}return r.m=t,r.c=i,r.d=function(t,i,n){r.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:n})},r.r=function(t){"u">typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,i){if(1&i&&(t=r(t)),8&i||4&i&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var s in t)r.d(n,s,(function(i){return t[i]}).bind(null,s));return n},r.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(i,"a",i),i},r.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},r.p="",r(r.s=90)}({17:function(t,i,r){i.__esModule=!0,i.default=void 0;var n=r(18),s=function(){function t(){}return t.getFirstMatch=function(t,i){var r=i.match(t);return r&&r.length>0&&r[1]||""},t.getSecondMatch=function(t,i){var r=i.match(t);return r&&r.length>1&&r[2]||""},t.matchAndReturnConst=function(t,i,r){if(t.test(i))return r},t.getWindowsVersionName=function(t){switch(t){case"NT":return"NT";case"XP":case"NT 5.1":return"XP";case"NT 5.0":return"2000";case"NT 5.2":return"2003";case"NT 6.0":return"Vista";case"NT 6.1":return"7";case"NT 6.2":return"8";case"NT 6.3":return"8.1";case"NT 10.0":return"10";default:return}},t.getMacOSVersionName=function(t){var i=t.split(".").splice(0,2).map(function(t){return parseInt(t,10)||0});if(i.push(0),10===i[0])switch(i[1]){case 5:return"Leopard";case 6:return"Snow Leopard";case 7:return"Lion";case 8:return"Mountain Lion";case 9:return"Mavericks";case 10:return"Yosemite";case 11:return"El Capitan";case 12:return"Sierra";case 13:return"High Sierra";case 14:return"Mojave";case 15:return"Catalina";default:return}},t.getAndroidVersionName=function(t){var i=t.split(".").splice(0,2).map(function(t){return parseInt(t,10)||0});if(i.push(0),!(1===i[0]&&i[1]<5))return 1===i[0]&&i[1]<6?"Cupcake":1===i[0]&&i[1]>=6?"Donut":2===i[0]&&i[1]<2?"Eclair":2===i[0]&&2===i[1]?"Froyo":2===i[0]&&i[1]>2?"Gingerbread":3===i[0]?"Honeycomb":4===i[0]&&i[1]<1?"Ice Cream Sandwich":4===i[0]&&i[1]<4?"Jelly Bean":4===i[0]&&i[1]>=4?"KitKat":5===i[0]?"Lollipop":6===i[0]?"Marshmallow":7===i[0]?"Nougat":8===i[0]?"Oreo":9===i[0]?"Pie":void 0},t.getVersionPrecision=function(t){return t.split(".").length},t.compareVersions=function(i,r,n){void 0===n&&(n=!1);var s=t.getVersionPrecision(i),a=t.getVersionPrecision(r),l=Math.max(s,a),u=0,c=t.map([i,r],function(i){var r=l-t.getVersionPrecision(i),n=i+Array(r+1).join(".0");return t.map(n.split("."),function(t){return Array(20-t.length).join("0")+t}).reverse()});for(n&&(u=l-Math.min(s,a)),l-=1;l>=u;){if(c[0][l]>c[1][l])return 1;if(c[0][l]===c[1][l]){if(l===u)return 0;l-=1}else if(c[0][l]<c[1][l])return -1}},t.map=function(t,i){var r,n=[];if(Array.prototype.map)return Array.prototype.map.call(t,i);for(r=0;r<t.length;r+=1)n.push(i(t[r]));return n},t.find=function(t,i){var r,n;if(Array.prototype.find)return Array.prototype.find.call(t,i);for(r=0,n=t.length;r<n;r+=1){var s=t[r];if(i(s,r))return s}},t.assign=function(t){for(var i,r,n=arguments.length,s=Array(n>1?n-1:0),a=1;a<n;a++)s[a-1]=arguments[a];if(Object.assign)return Object.assign.apply(Object,[t].concat(s));for(i=0,r=s.length;i<r;i+=1)(function(){var r=s[i];"object"==typeof r&&null!==r&&Object.keys(r).forEach(function(i){t[i]=r[i]})})();return t},t.getBrowserAlias=function(t){return n.BROWSER_ALIASES_MAP[t]},t.getBrowserTypeByAlias=function(t){return n.BROWSER_MAP[t]||""},t}();i.default=s,t.exports=i.default},18:function(t,i,r){i.__esModule=!0,i.ENGINE_MAP=i.OS_MAP=i.PLATFORMS_MAP=i.BROWSER_MAP=i.BROWSER_ALIASES_MAP=void 0,i.BROWSER_ALIASES_MAP={"Amazon Silk":"amazon_silk","Android Browser":"android",Bada:"bada",BlackBerry:"blackberry",Chrome:"chrome",Chromium:"chromium",Electron:"electron",Epiphany:"epiphany",Firefox:"firefox",Focus:"focus",Generic:"generic","Google Search":"google_search",Googlebot:"googlebot","Internet Explorer":"ie","K-Meleon":"k_meleon",Maxthon:"maxthon","Microsoft Edge":"edge","MZ Browser":"mz","NAVER Whale Browser":"naver",Opera:"opera","Opera Coast":"opera_coast",PhantomJS:"phantomjs",Puffin:"puffin",QupZilla:"qupzilla",QQ:"qq",QQLite:"qqlite",Safari:"safari",Sailfish:"sailfish","Samsung Internet for Android":"samsung_internet",SeaMonkey:"seamonkey",Sleipnir:"sleipnir",Swing:"swing",Tizen:"tizen","UC Browser":"uc",Vivaldi:"vivaldi","WebOS Browser":"webos",WeChat:"wechat","Yandex Browser":"yandex",Roku:"roku"},i.BROWSER_MAP={amazon_silk:"Amazon Silk",android:"Android Browser",bada:"Bada",blackberry:"BlackBerry",chrome:"Chrome",chromium:"Chromium",electron:"Electron",epiphany:"Epiphany",firefox:"Firefox",focus:"Focus",generic:"Generic",googlebot:"Googlebot",google_search:"Google Search",ie:"Internet Explorer",k_meleon:"K-Meleon",maxthon:"Maxthon",edge:"Microsoft Edge",mz:"MZ Browser",naver:"NAVER Whale Browser",opera:"Opera",opera_coast:"Opera Coast",phantomjs:"PhantomJS",puffin:"Puffin",qupzilla:"QupZilla",qq:"QQ Browser",qqlite:"QQ Browser Lite",safari:"Safari",sailfish:"Sailfish",samsung_internet:"Samsung Internet for Android",seamonkey:"SeaMonkey",sleipnir:"Sleipnir",swing:"Swing",tizen:"Tizen",uc:"UC Browser",vivaldi:"Vivaldi",webos:"WebOS Browser",wechat:"WeChat",yandex:"Yandex Browser"},i.PLATFORMS_MAP={tablet:"tablet",mobile:"mobile",desktop:"desktop",tv:"tv"},i.OS_MAP={WindowsPhone:"Windows Phone",Windows:"Windows",MacOS:"macOS",iOS:"iOS",Android:"Android",WebOS:"WebOS",BlackBerry:"BlackBerry",Bada:"Bada",Tizen:"Tizen",Linux:"Linux",ChromeOS:"Chrome OS",PlayStation4:"PlayStation 4",Roku:"Roku"},i.ENGINE_MAP={EdgeHTML:"EdgeHTML",Blink:"Blink",Trident:"Trident",Presto:"Presto",Gecko:"Gecko",WebKit:"WebKit"}},90:function(t,i,r){i.__esModule=!0,i.default=void 0;var n,s=(n=r(91))&&n.__esModule?n:{default:n},a=r(18),l=function(){function t(){}return t.getParser=function(t,i){if(void 0===i&&(i=!1),"string"!=typeof t)throw Error("UserAgent should be a string");return new s.default(t,i)},t.parse=function(t){return new s.default(t).getResult()},function(t,i){for(var r=0;r<i.length;r++){var n=i[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}(t,[{key:"BROWSER_MAP",get:function(){return a.BROWSER_MAP}},{key:"ENGINE_MAP",get:function(){return a.ENGINE_MAP}},{key:"OS_MAP",get:function(){return a.OS_MAP}},{key:"PLATFORMS_MAP",get:function(){return a.PLATFORMS_MAP}}]),t}();i.default=l,t.exports=i.default},91:function(t,i,r){i.__esModule=!0,i.default=void 0;var n=c(r(92)),s=c(r(93)),a=c(r(94)),l=c(r(95)),u=c(r(17));function c(t){return t&&t.__esModule?t:{default:t}}var h=function(){function t(t,i){if(void 0===i&&(i=!1),null==t||""===t)throw Error("UserAgent parameter can't be empty");this._ua=t,this.parsedResult={},!0!==i&&this.parse()}var i=t.prototype;return i.getUA=function(){return this._ua},i.test=function(t){return t.test(this._ua)},i.parseBrowser=function(){var t=this;this.parsedResult.browser={};var i=u.default.find(n.default,function(i){if("function"==typeof i.test)return i.test(t);if(i.test instanceof Array)return i.test.some(function(i){return t.test(i)});throw Error("Browser's test function is not valid")});return i&&(this.parsedResult.browser=i.describe(this.getUA())),this.parsedResult.browser},i.getBrowser=function(){return this.parsedResult.browser?this.parsedResult.browser:this.parseBrowser()},i.getBrowserName=function(t){return t?String(this.getBrowser().name).toLowerCase()||"":this.getBrowser().name||""},i.getBrowserVersion=function(){return this.getBrowser().version},i.getOS=function(){return this.parsedResult.os?this.parsedResult.os:this.parseOS()},i.parseOS=function(){var t=this;this.parsedResult.os={};var i=u.default.find(s.default,function(i){if("function"==typeof i.test)return i.test(t);if(i.test instanceof Array)return i.test.some(function(i){return t.test(i)});throw Error("Browser's test function is not valid")});return i&&(this.parsedResult.os=i.describe(this.getUA())),this.parsedResult.os},i.getOSName=function(t){var i=this.getOS().name;return t?String(i).toLowerCase()||"":i||""},i.getOSVersion=function(){return this.getOS().version},i.getPlatform=function(){return this.parsedResult.platform?this.parsedResult.platform:this.parsePlatform()},i.getPlatformType=function(t){void 0===t&&(t=!1);var i=this.getPlatform().type;return t?String(i).toLowerCase()||"":i||""},i.parsePlatform=function(){var t=this;this.parsedResult.platform={};var i=u.default.find(a.default,function(i){if("function"==typeof i.test)return i.test(t);if(i.test instanceof Array)return i.test.some(function(i){return t.test(i)});throw Error("Browser's test function is not valid")});return i&&(this.parsedResult.platform=i.describe(this.getUA())),this.parsedResult.platform},i.getEngine=function(){return this.parsedResult.engine?this.parsedResult.engine:this.parseEngine()},i.getEngineName=function(t){return t?String(this.getEngine().name).toLowerCase()||"":this.getEngine().name||""},i.parseEngine=function(){var t=this;this.parsedResult.engine={};var i=u.default.find(l.default,function(i){if("function"==typeof i.test)return i.test(t);if(i.test instanceof Array)return i.test.some(function(i){return t.test(i)});throw Error("Browser's test function is not valid")});return i&&(this.parsedResult.engine=i.describe(this.getUA())),this.parsedResult.engine},i.parse=function(){return this.parseBrowser(),this.parseOS(),this.parsePlatform(),this.parseEngine(),this},i.getResult=function(){return u.default.assign({},this.parsedResult)},i.satisfies=function(t){var i=this,r={},n=0,s={},a=0;if(Object.keys(t).forEach(function(i){var l=t[i];"string"==typeof l?(s[i]=l,a+=1):"object"==typeof l&&(r[i]=l,n+=1)}),n>0){var l=Object.keys(r),c=u.default.find(l,function(t){return i.isOS(t)});if(c){var h=this.satisfies(r[c]);if(void 0!==h)return h}var d=u.default.find(l,function(t){return i.isPlatform(t)});if(d){var p=this.satisfies(r[d]);if(void 0!==p)return p}}if(a>0){var f=Object.keys(s),m=u.default.find(f,function(t){return i.isBrowser(t,!0)});if(void 0!==m)return this.compareVersion(s[m])}},i.isBrowser=function(t,i){void 0===i&&(i=!1);var r=this.getBrowserName().toLowerCase(),n=t.toLowerCase(),s=u.default.getBrowserTypeByAlias(n);return i&&s&&(n=s.toLowerCase()),n===r},i.compareVersion=function(t){var i=[0],r=t,n=!1,s=this.getBrowserVersion();if("string"==typeof s)return">"===t[0]||"<"===t[0]?(r=t.substr(1),"="===t[1]?(n=!0,r=t.substr(2)):i=[],">"===t[0]?i.push(1):i.push(-1)):"="===t[0]?r=t.substr(1):"~"===t[0]&&(n=!0,r=t.substr(1)),i.indexOf(u.default.compareVersions(s,r,n))>-1},i.isOS=function(t){return this.getOSName(!0)===String(t).toLowerCase()},i.isPlatform=function(t){return this.getPlatformType(!0)===String(t).toLowerCase()},i.isEngine=function(t){return this.getEngineName(!0)===String(t).toLowerCase()},i.is=function(t,i){return void 0===i&&(i=!1),this.isBrowser(t,i)||this.isOS(t)||this.isPlatform(t)},i.some=function(t){var i=this;return void 0===t&&(t=[]),t.some(function(t){return i.is(t)})},t}();i.default=h,t.exports=i.default},92:function(t,i,r){i.__esModule=!0,i.default=void 0;var n,s=(n=r(17))&&n.__esModule?n:{default:n},a=/version\/(\d+(\.?_?\d+)+)/i,l=[{test:[/googlebot/i],describe:function(t){var i={name:"Googlebot"},r=s.default.getFirstMatch(/googlebot\/(\d+(\.\d+))/i,t)||s.default.getFirstMatch(a,t);return r&&(i.version=r),i}},{test:[/opera/i],describe:function(t){var i={name:"Opera"},r=s.default.getFirstMatch(a,t)||s.default.getFirstMatch(/(?:opera)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/opr\/|opios/i],describe:function(t){var i={name:"Opera"},r=s.default.getFirstMatch(/(?:opr|opios)[\s/](\S+)/i,t)||s.default.getFirstMatch(a,t);return r&&(i.version=r),i}},{test:[/SamsungBrowser/i],describe:function(t){var i={name:"Samsung Internet for Android"},r=s.default.getFirstMatch(a,t)||s.default.getFirstMatch(/(?:SamsungBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/Whale/i],describe:function(t){var i={name:"NAVER Whale Browser"},r=s.default.getFirstMatch(a,t)||s.default.getFirstMatch(/(?:whale)[\s/](\d+(?:\.\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/MZBrowser/i],describe:function(t){var i={name:"MZ Browser"},r=s.default.getFirstMatch(/(?:MZBrowser)[\s/](\d+(?:\.\d+)+)/i,t)||s.default.getFirstMatch(a,t);return r&&(i.version=r),i}},{test:[/focus/i],describe:function(t){var i={name:"Focus"},r=s.default.getFirstMatch(/(?:focus)[\s/](\d+(?:\.\d+)+)/i,t)||s.default.getFirstMatch(a,t);return r&&(i.version=r),i}},{test:[/swing/i],describe:function(t){var i={name:"Swing"},r=s.default.getFirstMatch(/(?:swing)[\s/](\d+(?:\.\d+)+)/i,t)||s.default.getFirstMatch(a,t);return r&&(i.version=r),i}},{test:[/coast/i],describe:function(t){var i={name:"Opera Coast"},r=s.default.getFirstMatch(a,t)||s.default.getFirstMatch(/(?:coast)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/opt\/\d+(?:.?_?\d+)+/i],describe:function(t){var i={name:"Opera Touch"},r=s.default.getFirstMatch(/(?:opt)[\s/](\d+(\.?_?\d+)+)/i,t)||s.default.getFirstMatch(a,t);return r&&(i.version=r),i}},{test:[/yabrowser/i],describe:function(t){var i={name:"Yandex Browser"},r=s.default.getFirstMatch(/(?:yabrowser)[\s/](\d+(\.?_?\d+)+)/i,t)||s.default.getFirstMatch(a,t);return r&&(i.version=r),i}},{test:[/ucbrowser/i],describe:function(t){var i={name:"UC Browser"},r=s.default.getFirstMatch(a,t)||s.default.getFirstMatch(/(?:ucbrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/Maxthon|mxios/i],describe:function(t){var i={name:"Maxthon"},r=s.default.getFirstMatch(a,t)||s.default.getFirstMatch(/(?:Maxthon|mxios)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/epiphany/i],describe:function(t){var i={name:"Epiphany"},r=s.default.getFirstMatch(a,t)||s.default.getFirstMatch(/(?:epiphany)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/puffin/i],describe:function(t){var i={name:"Puffin"},r=s.default.getFirstMatch(a,t)||s.default.getFirstMatch(/(?:puffin)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/sleipnir/i],describe:function(t){var i={name:"Sleipnir"},r=s.default.getFirstMatch(a,t)||s.default.getFirstMatch(/(?:sleipnir)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/k-meleon/i],describe:function(t){var i={name:"K-Meleon"},r=s.default.getFirstMatch(a,t)||s.default.getFirstMatch(/(?:k-meleon)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/micromessenger/i],describe:function(t){var i={name:"WeChat"},r=s.default.getFirstMatch(/(?:micromessenger)[\s/](\d+(\.?_?\d+)+)/i,t)||s.default.getFirstMatch(a,t);return r&&(i.version=r),i}},{test:[/qqbrowser/i],describe:function(t){var i={name:/qqbrowserlite/i.test(t)?"QQ Browser Lite":"QQ Browser"},r=s.default.getFirstMatch(/(?:qqbrowserlite|qqbrowser)[/](\d+(\.?_?\d+)+)/i,t)||s.default.getFirstMatch(a,t);return r&&(i.version=r),i}},{test:[/msie|trident/i],describe:function(t){var i={name:"Internet Explorer"},r=s.default.getFirstMatch(/(?:msie |rv:)(\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/\sedg\//i],describe:function(t){var i={name:"Microsoft Edge"},r=s.default.getFirstMatch(/\sedg\/(\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/edg([ea]|ios)/i],describe:function(t){var i={name:"Microsoft Edge"},r=s.default.getSecondMatch(/edg([ea]|ios)\/(\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/vivaldi/i],describe:function(t){var i={name:"Vivaldi"},r=s.default.getFirstMatch(/vivaldi\/(\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/seamonkey/i],describe:function(t){var i={name:"SeaMonkey"},r=s.default.getFirstMatch(/seamonkey\/(\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/sailfish/i],describe:function(t){var i={name:"Sailfish"},r=s.default.getFirstMatch(/sailfish\s?browser\/(\d+(\.\d+)?)/i,t);return r&&(i.version=r),i}},{test:[/silk/i],describe:function(t){var i={name:"Amazon Silk"},r=s.default.getFirstMatch(/silk\/(\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/phantom/i],describe:function(t){var i={name:"PhantomJS"},r=s.default.getFirstMatch(/phantomjs\/(\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/slimerjs/i],describe:function(t){var i={name:"SlimerJS"},r=s.default.getFirstMatch(/slimerjs\/(\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(t){var i={name:"BlackBerry"},r=s.default.getFirstMatch(a,t)||s.default.getFirstMatch(/blackberry[\d]+\/(\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/(web|hpw)[o0]s/i],describe:function(t){var i={name:"WebOS Browser"},r=s.default.getFirstMatch(a,t)||s.default.getFirstMatch(/w(?:eb)?[o0]sbrowser\/(\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/bada/i],describe:function(t){var i={name:"Bada"},r=s.default.getFirstMatch(/dolfin\/(\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/tizen/i],describe:function(t){var i={name:"Tizen"},r=s.default.getFirstMatch(/(?:tizen\s?)?browser\/(\d+(\.?_?\d+)+)/i,t)||s.default.getFirstMatch(a,t);return r&&(i.version=r),i}},{test:[/qupzilla/i],describe:function(t){var i={name:"QupZilla"},r=s.default.getFirstMatch(/(?:qupzilla)[\s/](\d+(\.?_?\d+)+)/i,t)||s.default.getFirstMatch(a,t);return r&&(i.version=r),i}},{test:[/firefox|iceweasel|fxios/i],describe:function(t){var i={name:"Firefox"},r=s.default.getFirstMatch(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/electron/i],describe:function(t){var i={name:"Electron"},r=s.default.getFirstMatch(/(?:electron)\/(\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/MiuiBrowser/i],describe:function(t){var i={name:"Miui"},r=s.default.getFirstMatch(/(?:MiuiBrowser)[\s/](\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/chromium/i],describe:function(t){var i={name:"Chromium"},r=s.default.getFirstMatch(/(?:chromium)[\s/](\d+(\.?_?\d+)+)/i,t)||s.default.getFirstMatch(a,t);return r&&(i.version=r),i}},{test:[/chrome|crios|crmo/i],describe:function(t){var i={name:"Chrome"},r=s.default.getFirstMatch(/(?:chrome|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/GSA/i],describe:function(t){var i={name:"Google Search"},r=s.default.getFirstMatch(/(?:GSA)\/(\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:function(t){var i=!t.test(/like android/i),r=t.test(/android/i);return i&&r},describe:function(t){var i={name:"Android Browser"},r=s.default.getFirstMatch(a,t);return r&&(i.version=r),i}},{test:[/playstation 4/i],describe:function(t){var i={name:"PlayStation 4"},r=s.default.getFirstMatch(a,t);return r&&(i.version=r),i}},{test:[/safari|applewebkit/i],describe:function(t){var i={name:"Safari"},r=s.default.getFirstMatch(a,t);return r&&(i.version=r),i}},{test:[/.*/i],describe:function(t){var i=-1!==t.search("\\(")?/^(.*)\/(.*)[ \t]\((.*)/:/^(.*)\/(.*) /;return{name:s.default.getFirstMatch(i,t),version:s.default.getSecondMatch(i,t)}}}];i.default=l,t.exports=i.default},93:function(t,i,r){i.__esModule=!0,i.default=void 0;var n,s=(n=r(17))&&n.__esModule?n:{default:n},a=r(18),l=[{test:[/Roku\/DVP/],describe:function(t){var i=s.default.getFirstMatch(/Roku\/DVP-(\d+\.\d+)/i,t);return{name:a.OS_MAP.Roku,version:i}}},{test:[/windows phone/i],describe:function(t){var i=s.default.getFirstMatch(/windows phone (?:os)?\s?(\d+(\.\d+)*)/i,t);return{name:a.OS_MAP.WindowsPhone,version:i}}},{test:[/windows /i],describe:function(t){var i=s.default.getFirstMatch(/Windows ((NT|XP)( \d\d?.\d)?)/i,t),r=s.default.getWindowsVersionName(i);return{name:a.OS_MAP.Windows,version:i,versionName:r}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(t){var i={name:a.OS_MAP.iOS},r=s.default.getSecondMatch(/(Version\/)(\d[\d.]+)/,t);return r&&(i.version=r),i}},{test:[/macintosh/i],describe:function(t){var i=s.default.getFirstMatch(/mac os x (\d+(\.?_?\d+)+)/i,t).replace(/[_\s]/g,"."),r=s.default.getMacOSVersionName(i),n={name:a.OS_MAP.MacOS,version:i};return r&&(n.versionName=r),n}},{test:[/(ipod|iphone|ipad)/i],describe:function(t){var i=s.default.getFirstMatch(/os (\d+([_\s]\d+)*) like mac os x/i,t).replace(/[_\s]/g,".");return{name:a.OS_MAP.iOS,version:i}}},{test:function(t){var i=!t.test(/like android/i),r=t.test(/android/i);return i&&r},describe:function(t){var i=s.default.getFirstMatch(/android[\s/-](\d+(\.\d+)*)/i,t),r=s.default.getAndroidVersionName(i),n={name:a.OS_MAP.Android,version:i};return r&&(n.versionName=r),n}},{test:[/(web|hpw)[o0]s/i],describe:function(t){var i=s.default.getFirstMatch(/(?:web|hpw)[o0]s\/(\d+(\.\d+)*)/i,t),r={name:a.OS_MAP.WebOS};return i&&i.length&&(r.version=i),r}},{test:[/blackberry|\bbb\d+/i,/rim\stablet/i],describe:function(t){var i=s.default.getFirstMatch(/rim\stablet\sos\s(\d+(\.\d+)*)/i,t)||s.default.getFirstMatch(/blackberry\d+\/(\d+([_\s]\d+)*)/i,t)||s.default.getFirstMatch(/\bbb(\d+)/i,t);return{name:a.OS_MAP.BlackBerry,version:i}}},{test:[/bada/i],describe:function(t){var i=s.default.getFirstMatch(/bada\/(\d+(\.\d+)*)/i,t);return{name:a.OS_MAP.Bada,version:i}}},{test:[/tizen/i],describe:function(t){var i=s.default.getFirstMatch(/tizen[/\s](\d+(\.\d+)*)/i,t);return{name:a.OS_MAP.Tizen,version:i}}},{test:[/linux/i],describe:function(){return{name:a.OS_MAP.Linux}}},{test:[/CrOS/],describe:function(){return{name:a.OS_MAP.ChromeOS}}},{test:[/PlayStation 4/],describe:function(t){var i=s.default.getFirstMatch(/PlayStation 4[/\s](\d+(\.\d+)*)/i,t);return{name:a.OS_MAP.PlayStation4,version:i}}}];i.default=l,t.exports=i.default},94:function(t,i,r){i.__esModule=!0,i.default=void 0;var n,s=(n=r(17))&&n.__esModule?n:{default:n},a=r(18),l=[{test:[/googlebot/i],describe:function(){return{type:"bot",vendor:"Google"}}},{test:[/huawei/i],describe:function(t){var i=s.default.getFirstMatch(/(can-l01)/i,t)&&"Nova",r={type:a.PLATFORMS_MAP.mobile,vendor:"Huawei"};return i&&(r.model=i),r}},{test:[/nexus\s*(?:7|8|9|10).*/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Nexus"}}},{test:[/ipad/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/Macintosh(.*?) FxiOS(.*?)\//],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Apple",model:"iPad"}}},{test:[/kftt build/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Amazon",model:"Kindle Fire HD 7"}}},{test:[/silk/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet,vendor:"Amazon"}}},{test:[/tablet(?! pc)/i],describe:function(){return{type:a.PLATFORMS_MAP.tablet}}},{test:function(t){var i=t.test(/ipod|iphone/i),r=t.test(/like (ipod|iphone)/i);return i&&!r},describe:function(t){var i=s.default.getFirstMatch(/(ipod|iphone)/i,t);return{type:a.PLATFORMS_MAP.mobile,vendor:"Apple",model:i}}},{test:[/nexus\s*[0-6].*/i,/galaxy nexus/i],describe:function(){return{type:a.PLATFORMS_MAP.mobile,vendor:"Nexus"}}},{test:[/[^-]mobi/i],describe:function(){return{type:a.PLATFORMS_MAP.mobile}}},{test:function(t){return"blackberry"===t.getBrowserName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.mobile,vendor:"BlackBerry"}}},{test:function(t){return"bada"===t.getBrowserName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.mobile}}},{test:function(t){return"windows phone"===t.getBrowserName()},describe:function(){return{type:a.PLATFORMS_MAP.mobile,vendor:"Microsoft"}}},{test:function(t){var i=Number(String(t.getOSVersion()).split(".")[0]);return"android"===t.getOSName(!0)&&i>=3},describe:function(){return{type:a.PLATFORMS_MAP.tablet}}},{test:function(t){return"android"===t.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.mobile}}},{test:function(t){return"macos"===t.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.desktop,vendor:"Apple"}}},{test:function(t){return"windows"===t.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.desktop}}},{test:function(t){return"linux"===t.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.desktop}}},{test:function(t){return"playstation 4"===t.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.tv}}},{test:function(t){return"roku"===t.getOSName(!0)},describe:function(){return{type:a.PLATFORMS_MAP.tv}}}];i.default=l,t.exports=i.default},95:function(t,i,r){i.__esModule=!0,i.default=void 0;var n,s=(n=r(17))&&n.__esModule?n:{default:n},a=r(18),l=[{test:function(t){return"microsoft edge"===t.getBrowserName(!0)},describe:function(t){if(/\sedg\//i.test(t))return{name:a.ENGINE_MAP.Blink};var i=s.default.getFirstMatch(/edge\/(\d+(\.?_?\d+)+)/i,t);return{name:a.ENGINE_MAP.EdgeHTML,version:i}}},{test:[/trident/i],describe:function(t){var i={name:a.ENGINE_MAP.Trident},r=s.default.getFirstMatch(/trident\/(\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:function(t){return t.test(/presto/i)},describe:function(t){var i={name:a.ENGINE_MAP.Presto},r=s.default.getFirstMatch(/presto\/(\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:function(t){var i=t.test(/gecko/i),r=t.test(/like gecko/i);return i&&!r},describe:function(t){var i={name:a.ENGINE_MAP.Gecko},r=s.default.getFirstMatch(/gecko\/(\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}},{test:[/(apple)?webkit\/537\.36/i],describe:function(){return{name:a.ENGINE_MAP.Blink}}},{test:[/(apple)?webkit/i],describe:function(t){var i={name:a.ENGINE_MAP.WebKit},r=s.default.getFirstMatch(/webkit\/(\d+(\.?_?\d+)+)/i,t);return r&&(i.version=r),i}}];i.default=l,t.exports=i.default}})},"object"==typeof t&&"object"==typeof i?i.exports=r():"function"==typeof define&&define.amd?define([],r):t.bowser=r()});eh(),eh();var iL=el(ib());eh();var iN=((P=iN||{}).svPrimary="sv-primary",P.svPrimary900="sv-primary-900",P.svPrimary200="sv-primary-200",P.svSecondary="sv-secondary",P.svGray="sv-gray",P.svSuccess="sv-success",P.svDanger="sv-danger",P.svBlack="sv-black",P.svWhite="sv-white",P.svGray100="sv-gray-100",P.svGray200="sv-gray-200",P.svGray300="sv-gray-300",P.svGray400="sv-gray-400",P.svGray500="sv-gray-500",P.svGray600="sv-gray-600",P.svGray700="sv-gray-700",P.svGray800="sv-gray-800",P);eh(),eh(),eh(),eh();var iD=(t,i,r,...n)=>ec(void 0,[t,i,r,...n],function*(t,i,r,n={}){let s=yield fetch(t,{method:i,headers:er({"Content-Type":"application/json"},n),body:r?JSON.stringify(r):null});if(!s.ok)throw s;try{return yield s.json()}catch{return s.ok}});eh();var ij=el(ib()),iB=class{constructor(t){this.debug=(0,ij.default)(t)}log(t,...i){this.debug(t,...i)}};eh(),eh();var iU=el(iR()),iz=class{constructor(t={}){this.subscribe=t=>{this.callbacks.push(t)},this.unsubscribe=t=>{this.callbacks=this.callbacks.filter(i=>i!==t)},this.publish=(...t)=>{this.callbacks&&this.callbacks.forEach(i=>{this.callListener(i,t).catch(r=>{var n;null==(n=this.logger)||n.log("superviz-sdk:observer-helper:publish:error",`
            Failed to execute callback on publish value.
            Callback: ${i.name}
            Event: ${JSON.stringify(t)}
            Error: ${r}
          `)})})},this.reset=()=>{this.callbacks=[]},this.destroy=()=>{delete this.logger,delete this.callbacks},this.callListener=(t,i)=>new Promise((r,n)=>{try{let n=t(...i);r(n)}catch(t){n(t)}});let{logger:i,throttleTime:r}=t;this.logger=i||new iB("@superviz/sdk/observer-helper"),this.throttle=r,this.callbacks=[],this.throttle&&(this.publish=(0,iU.default)(this.publish,this.throttle))}},iW=class{constructor(){this.observers={},this.subscribe=(t,i)=>{this.logger.log(`subscribed to ${t} event`),this.observers[t]||(this.observers[t]=new iz({logger:this.logger})),this.observers[t].subscribe(i)},this.unsubscribe=(t,i)=>{if(this.logger.log(`unsubscribed from ${t} event`),this.observers[t]){if(!i){this.observers[t].destroy(),delete this.observers[t];return}this.observers[t].unsubscribe(i)}},this.publish=(t,i)=>{t in this.observers&&this.observers[t].publish(i)}}};eh();var i$=class{static createUrl(t,i,r={}){let n=new URL(i,t);return Object.keys(r).forEach(t=>n.searchParams.append(t,r[t])),n.toString()}static validateApiKey(t,i){return iD(this.createUrl(t,"/user/checkapikey"),"POST",{apiKey:i})}static fetchConfig(t,i){return iD(this.createUrl(t,"/immersive-config"),"POST",{apiKey:i})}static fetchLimits(t,i){return ec(this,null,function*(){let r=this.createUrl(t,"/user/check_limits_v2");return(yield iD(r,"GET","",{apikey:i})).limits})}static fetchWaterMark(t,i){return ec(this,null,function*(){let r=this.createUrl(t,"/user/watermark"),{message:n}=yield iD(r,"POST",{apiKey:i});return n})}static createAnnotations(t,i,r){return ec(this,null,function*(){return iD(this.createUrl(t,"/annotations"),"POST",er({},r),{apikey:i})})}static updateComment(t,i,r,n){return ec(this,null,function*(){let s=`/comments/${r}`;return iD(this.createUrl(t,s),"PUT",{text:n},{apikey:i})})}static createComment(t,i,r){return ec(this,null,function*(){return iD(this.createUrl(t,"/comments"),"POST",er({},r),{apikey:i})})}static fetchAnnotation(t,i,r){return ec(this,null,function*(){return iD(this.createUrl(t,"/annotations",{roomId:r.roomId}),"GET",void 0,{apikey:i})})}static resolveAnnotation(t,i,r){return ec(this,null,function*(){let n=`/annotations/resolve/${r}`;return iD(this.createUrl(t,n),"POST",{},{apikey:i})})}static deleteComment(t,i,r){return ec(this,null,function*(){let n=`/comments/${r}`;return iD(this.createUrl(t,n),"DELETE",{},{apikey:i})})}static deleteAnnotation(t,i,r){return ec(this,null,function*(){let n=`/annotations/${r}`;return iD(this.createUrl(t,n),"DELETE",{},{apikey:i})})}static createParticipant(t){return ec(this,null,function*(){let i=eM.get("apiUrl");return iD(this.createUrl(i,"/participants"),"POST",er({},t),{apikey:eM.get("apiKey")})})}static fetchParticipant(t){return ec(this,null,function*(){let i=eM.get("apiUrl"),r=`/participants/${t}`;return iD(this.createUrl(i,r),"GET",void 0,{apikey:eM.get("apiKey")})})}static sendActivity(t,i,r,n){return ec(this,null,function*(){let s=eM.get("apiUrl"),a=eM.get("roomId"),l=eM.get("apiKey");return iD(this.createUrl(s,"/activity"),"POST",{groupId:i,groupName:r,meetingId:a,product:n,userId:t},{apikey:l})})}static fetchParticipantsByGroup(t){return ec(this,null,function*(){let i=`/groups/participants/${t}`,r=eM.get("apiUrl");return iD(this.createUrl(r,i,{take:1e4}),"GET",void 0,{apikey:eM.get("apiKey")})})}static createMentions(t){return ec(this,null,function*(){let i=eM.get("apiUrl");return iD(this.createUrl(i,"/mentions"),"POST",t,{apikey:eM.get("apiKey")})})}};eh(),eh();var iV=class{static getRemoteConfig(){return ec(this,arguments,function*(t="prod"){if("local"===t)return(yield r.e(5524).then(r.bind(r,5524))).default.remoteConfig;let{version:i}=yield r.e(425).then(r.bind(r,425));return console.log(`[SuperViz] - v.${i}`),iD(this.createUrl({version:i,environment:t}),"GET",null)})}static getFeatures(t){return ec(this,null,function*(){return iD(`${this.REMOTE_CONFIG_BASE_URL}/features/${t}`,"GET",void 0)})}static createUrl({version:t,environment:i}){return`${this.REMOTE_CONFIG_BASE_URL}/sdk/${t}?env=${i}`}};iV.REMOTE_CONFIG_BASE_URL="https://remote-config.superviz.com",eh(),eh();var iZ=Object.create,iG=Object.defineProperty,iJ=Object.defineProperties,iq=Object.getOwnPropertyDescriptor,iH=Object.getOwnPropertyDescriptors,iK=Object.getOwnPropertyNames,iY=Object.getOwnPropertySymbols,iQ=Object.getPrototypeOf,iX=Object.prototype.hasOwnProperty,i0=Object.prototype.propertyIsEnumerable,i1=(t,i,r)=>i in t?iG(t,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[i]=r,i3=(t,i)=>{for(var r in i||(i={}))iX.call(i,r)&&i1(t,r,i[r]);if(iY)for(var r of iY(i))i0.call(i,r)&&i1(t,r,i[r]);return t},i2=(t,i)=>iJ(t,iH(i)),i9=(t,i)=>()=>(i||t((i={exports:{}}).exports,i),i.exports),i6=(t,i,r)=>new Promise((n,s)=>{var a=t=>{try{u(r.next(t))}catch(t){s(t)}},l=t=>{try{u(r.throw(t))}catch(t){s(t)}},u=t=>t.done?n(t.value):Promise.resolve(t.value).then(a,l);u((r=r.apply(t,i)).next())}),i4=i9((t,i)=>{function r(t,i,r,n){return Math.round(t/r)+" "+n+(i>=1.5*r?"s":"")}i.exports=function(t,i){i=i||{};var n,s,a=typeof t;if("string"===a&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(i){var r=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"weeks":case"week":case"w":return 6048e5*r;case"days":case"day":case"d":return 864e5*r;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*r;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*r;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}(t);if("number"===a&&isFinite(t))return i.long?(n=Math.abs(t))>=864e5?r(t,n,864e5,"day"):n>=36e5?r(t,n,36e5,"hour"):n>=6e4?r(t,n,6e4,"minute"):n>=1e3?r(t,n,1e3,"second"):t+" ms":(s=Math.abs(t))>=864e5?Math.round(t/864e5)+"d":s>=36e5?Math.round(t/36e5)+"h":s>=6e4?Math.round(t/6e4)+"m":s>=1e3?Math.round(t/1e3)+"s":t+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}}),i5=i9((t,i)=>{i.exports=function(t){function i(t){let n,s=null,a,l;function u(...t){if(!u.enabled)return;let r=Number(new Date),s=r-(n||r);u.diff=s,u.prev=n,u.curr=r,n=r,t[0]=i.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let a=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(r,n)=>{if("%%"===r)return"%";a++;let s=i.formatters[n];if("function"==typeof s){let i=t[a];r=s.call(u,i),t.splice(a,1),a--}return r}),i.formatArgs.call(u,t),(u.log||i.log).apply(u,t)}return u.namespace=t,u.useColors=i.useColors(),u.color=i.selectColor(t),u.extend=r,u.destroy=i.destroy,Object.defineProperty(u,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(a!==i.namespaces&&(a=i.namespaces,l=i.enabled(t)),l),set:t=>{s=t}}),"function"==typeof i.init&&i.init(u),u}function r(t,r){let n=i(this.namespace+(typeof r>"u"?":":r)+t);return n.log=this.log,n}function n(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return i.debug=i,i.default=i,i.coerce=function(t){return t instanceof Error?t.stack||t.message:t},i.disable=function(){let t=[...i.names.map(n),...i.skips.map(n).map(t=>"-"+t)].join(",");return i.enable(""),t},i.enable=function(t){i.save(t),i.namespaces=t,i.names=[],i.skips=[];let r,n=("string"==typeof t?t:"").split(/[\s,]+/),s=n.length;for(r=0;r<s;r++)n[r]&&("-"===(t=n[r].replace(/\*/g,".*?"))[0]?i.skips.push(RegExp("^"+t.slice(1)+"$")):i.names.push(RegExp("^"+t+"$")))},i.enabled=function(t){let r,n;if("*"===t[t.length-1])return!0;for(r=0,n=i.skips.length;r<n;r++)if(i.skips[r].test(t))return!1;for(r=0,n=i.names.length;r<n;r++)if(i.names[r].test(t))return!0;return!1},i.humanize=i4(),i.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach(r=>{i[r]=t[r]}),i.names=[],i.skips=[],i.formatters={},i.selectColor=function(t){let r=0;for(let i=0;i<t.length;i++)r=(r<<5)-r+t.charCodeAt(i)|0;return i.colors[Math.abs(r)%i.colors.length]},i.enable(i.load()),i}}),i7=i9((t,i)=>{let r;t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+i.exports.humanize(this.diff),!this.useColors)return;let r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,s=0;t[0].replace(/%[a-zA-Z%]/g,t=>{"%%"!==t&&(n++,"%c"===t&&(s=n))}),t.splice(s,0,r)},t.save=function(i){try{i?t.storage.setItem("debug",i):t.storage.removeItem("debug")}catch{}},t.load=function(){let i;try{i=t.storage.getItem("debug")}catch{}return!i&&"u">typeof V&&"env"in V&&(i=W.DEBUG),i},t.useColors=function(){let t;return"u">typeof window&&!!window.process&&("renderer"===window.process.type||!!window.process.__nwjs)||!("u">typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("u">typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"u">typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"u">typeof navigator&&navigator.userAgent&&(t=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(t[1],10)>=31||"u">typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch{}}(),t.destroy=(r=!1,()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),i.exports=i5()(t);var{formatters:n}=i.exports;n.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}),i8=((A=i8||{}).JOIN_ROOM="room.join",A.JOINED_ROOM="room.joined",A.LEAVE_ROOM="room.leave",A.UPDATE="room.update",A.ERROR="room.error",A),re=((S=re||{}).JOINED_ROOM="presence.joined-room",S.LEAVE="presence.leave",S.UPDATE="presence.update",S),rt=((O=rt||{}).CONNECTED="CONNECTED",O.CONNECTING="CONNECTING",O.DISCONNECTED="DISCONNECTED",O.CONNECTION_ERROR="CONNECTION_ERROR",O.RECONNECTING="RECONNECTING",O.RECONNECT_ERROR="RECONNECT_ERROR",O),ri=function(t,i){return(ri=Object.setPrototypeOf||({__proto__:[]})instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(t[r]=i[r])})(t,i)};function rr(t,i){if("function"!=typeof i&&null!==i)throw TypeError("Class extends value "+String(i)+" is not a constructor or null");function r(){this.constructor=t}ri(t,i),t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}function rn(t){var i="function"==typeof Symbol&&Symbol.iterator,r=i&&t[i],n=0;if(r)return r.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}};throw TypeError(i?"Object is not iterable.":"Symbol.iterator is not defined.")}function rs(t,i){var r="function"==typeof Symbol&&t[Symbol.iterator];if(!r)return t;var n,s,a=r.call(t),l=[];try{for(;(void 0===i||i-- >0)&&!(n=a.next()).done;)l.push(n.value)}catch(t){s={error:t}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(s)throw s.error}}return l}function ro(t,i,r){if(2==arguments.length)for(var n,s=0,a=i.length;s<a;s++)!n&&s in i||(n||(n=Array.prototype.slice.call(i,0,s)),n[s]=i[s]);return t.concat(n||Array.prototype.slice.call(i))}function ra(t){return"function"==typeof t}function rl(t){var i=t(function(t){Error.call(t),t.stack=Error().stack});return i.prototype=Object.create(Error.prototype),i.prototype.constructor=i,i}var ru=rl(function(t){return function(i){t(this),this.message=i?i.length+` errors occurred during unsubscription:
`+i.map(function(t,i){return i+1+") "+t.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=i}});function rc(t,i){if(t){var r=t.indexOf(i);0<=r&&t.splice(r,1)}}var rh=function(){var t;function i(t){this.initialTeardown=t,this.closed=!1,this._parentage=null,this._finalizers=null}return i.prototype.unsubscribe=function(){var t,i,r,n,s;if(!this.closed){this.closed=!0;var a=this._parentage;if(a){if(this._parentage=null,Array.isArray(a))try{for(var l=rn(a),u=l.next();!u.done;u=l.next())u.value.remove(this)}catch(i){t={error:i}}finally{try{u&&!u.done&&(i=l.return)&&i.call(l)}finally{if(t)throw t.error}}else a.remove(this)}var c=this.initialTeardown;if(ra(c))try{c()}catch(t){s=t instanceof ru?t.errors:[t]}var h=this._finalizers;if(h){this._finalizers=null;try{for(var d=rn(h),p=d.next();!p.done;p=d.next()){var f=p.value;try{rf(f)}catch(t){s=s??[],t instanceof ru?s=ro(ro([],rs(s)),rs(t.errors)):s.push(t)}}}catch(t){r={error:t}}finally{try{p&&!p.done&&(n=d.return)&&n.call(d)}finally{if(r)throw r.error}}}if(s)throw new ru(s)}},i.prototype.add=function(t){var r;if(t&&t!==this){if(this.closed)rf(t);else{if(t instanceof i){if(t.closed||t._hasParent(this))return;t._addParent(this)}(this._finalizers=null!==(r=this._finalizers)&&void 0!==r?r:[]).push(t)}}},i.prototype._hasParent=function(t){var i=this._parentage;return i===t||Array.isArray(i)&&i.includes(t)},i.prototype._addParent=function(t){var i=this._parentage;this._parentage=Array.isArray(i)?(i.push(t),i):i?[i,t]:t},i.prototype._removeParent=function(t){var i=this._parentage;i===t?this._parentage=null:Array.isArray(i)&&rc(i,t)},i.prototype.remove=function(t){var r=this._finalizers;r&&rc(r,t),t instanceof i&&t._removeParent(this)},i.EMPTY=((t=new i).closed=!0,t),i}(),rd=rh.EMPTY;function rp(t){return t instanceof rh||t&&"closed"in t&&ra(t.remove)&&ra(t.add)&&ra(t.unsubscribe)}function rf(t){ra(t)?t():t.unsubscribe()}var rm={Promise:void 0,useDeprecatedNextContext:!1},rv=function(t,i){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return setTimeout.apply(void 0,ro([t,i],rs(r)))};function rg(){}var rb=function(t){function i(i){var r=t.call(this)||this;return r.isStopped=!1,i?(r.destination=i,rp(i)&&i.add(r)):r.destination=rP,r}return rr(i,t),i.create=function(t,i,r){return new rE(t,i,r)},i.prototype.next=function(t){this.isStopped||this._next(t)},i.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},i.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},i.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},i.prototype._next=function(t){this.destination.next(t)},i.prototype._error=function(t){try{this.destination.error(t)}finally{this.unsubscribe()}},i.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},i}(rh),ry=Function.prototype.bind;function r_(t,i){return ry.call(t,i)}var rw=function(){function t(t){this.partialObserver=t}return t.prototype.next=function(t){var i=this.partialObserver;if(i.next)try{i.next(t)}catch(t){rC(t)}},t.prototype.error=function(t){var i=this.partialObserver;if(i.error)try{i.error(t)}catch(t){rC(t)}else rC(t)},t.prototype.complete=function(){var t=this.partialObserver;if(t.complete)try{t.complete()}catch(t){rC(t)}},t}(),rE=function(t){function i(i,r,n){var s,a,l=t.call(this)||this;return ra(i)||!i?a={next:i??void 0,error:r??void 0,complete:n??void 0}:l&&rm.useDeprecatedNextContext?((s=Object.create(i)).unsubscribe=function(){return l.unsubscribe()},a={next:i.next&&r_(i.next,s),error:i.error&&r_(i.error,s),complete:i.complete&&r_(i.complete,s)}):a=i,l.destination=new rw(a),l}return rr(i,t),i}(rb);function rC(t){rv(function(){throw t})}var rP={closed:!0,next:rg,error:function(t){throw t},complete:rg},rA="function"==typeof Symbol&&Symbol.observable||"@@observable",rS=function(){function t(t){t&&(this._subscribe=t)}return t.prototype.lift=function(i){var r=new t;return r.source=this,r.operator=i,r},t.prototype.subscribe=function(t,i,r){var n,s,a,l=(n=t)&&n instanceof rb||n&&ra(n.next)&&ra(n.error)&&ra(n.complete)&&rp(n)?t:new rE(t,i,r);return s=this.operator,a=this.source,l.add(s?s.call(l,a):a?this._subscribe(l):this._trySubscribe(l)),l},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(i){t.error(i)}},t.prototype.forEach=function(t,i){var r=this;return new(i=rO(i))(function(i,n){var s=new rE({next:function(i){try{t(i)}catch(t){n(t),s.unsubscribe()}},error:n,complete:i});r.subscribe(s)})},t.prototype._subscribe=function(t){var i;return null===(i=this.source)||void 0===i?void 0:i.subscribe(t)},t.prototype[rA]=function(){return this},t.prototype.pipe=function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return(0===t.length?function(t){return t}:1===t.length?t[0]:function(i){return t.reduce(function(t,i){return i(t)},i)})(this)},t.prototype.toPromise=function(t){var i=this;return new(t=rO(t))(function(t,r){var n;i.subscribe(function(t){return n=t},function(t){return r(t)},function(){return t(n)})})},t.create=function(i){return new t(i)},t}();function rO(t){var i;return null!==(i=t??rm.Promise)&&void 0!==i?i:Promise}var rT=rl(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),rx=function(t){function i(){var i=t.call(this)||this;return i.closed=!1,i.currentObservers=null,i.observers=[],i.isStopped=!1,i.hasError=!1,i.thrownError=null,i}return rr(i,t),i.prototype.lift=function(t){var i=new rk(this,this);return i.operator=t,i},i.prototype._throwIfClosed=function(){if(this.closed)throw new rT},i.prototype.next=function(t){var i=this;(function(){var r,n;if(i._throwIfClosed(),!i.isStopped){i.currentObservers||(i.currentObservers=Array.from(i.observers));try{for(var s=rn(i.currentObservers),a=s.next();!a.done;a=s.next())a.value.next(t)}catch(t){r={error:t}}finally{try{a&&!a.done&&(n=s.return)&&n.call(s)}finally{if(r)throw r.error}}}})()},i.prototype.error=function(t){var i=this;(function(){if(i._throwIfClosed(),!i.isStopped){i.hasError=i.isStopped=!0,i.thrownError=t;for(var r=i.observers;r.length;)r.shift().error(t)}})()},i.prototype.complete=function(){var t=this;(function(){if(t._throwIfClosed(),!t.isStopped){t.isStopped=!0;for(var i=t.observers;i.length;)i.shift().complete()}})()},i.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(i.prototype,"observed",{get:function(){var t;return(null===(t=this.observers)||void 0===t?void 0:t.length)>0},enumerable:!1,configurable:!0}),i.prototype._trySubscribe=function(i){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,i)},i.prototype._subscribe=function(t){return this._throwIfClosed(),this._checkFinalizedStatuses(t),this._innerSubscribe(t)},i.prototype._innerSubscribe=function(t){var i=this,r=this.hasError,n=this.isStopped,s=this.observers;return r||n?rd:(this.currentObservers=null,s.push(t),new rh(function(){i.currentObservers=null,rc(s,t)}))},i.prototype._checkFinalizedStatuses=function(t){var i=this.hasError,r=this.thrownError,n=this.isStopped;i?t.error(r):n&&t.complete()},i.prototype.asObservable=function(){var t=new rS;return t.source=this,t},i.create=function(t,i){return new rk(t,i)},i}(rS),rk=function(t){function i(i,r){var n=t.call(this)||this;return n.destination=i,n.source=r,n}return rr(i,t),i.prototype.next=function(t){var i,r;null===(r=null===(i=this.destination)||void 0===i?void 0:i.next)||void 0===r||r.call(i,t)},i.prototype.error=function(t){var i,r;null===(r=null===(i=this.destination)||void 0===i?void 0:i.error)||void 0===r||r.call(i,t)},i.prototype.complete=function(){var t,i;null===(i=null===(t=this.destination)||void 0===t?void 0:t.complete)||void 0===i||i.call(t)},i.prototype._subscribe=function(t){var i,r;return null!==(r=null===(i=this.source)||void 0===i?void 0:i.subscribe(t))&&void 0!==r?r:rd},i}(rx),rI=(x=null!=(T=i7())?iZ(iQ(T)):{},((t,i,r,n)=>{if(i&&"object"==typeof i||"function"==typeof i)for(let s of iK(i))iX.call(t,s)||s===r||iG(t,s,{get:()=>i[s],enumerable:!(n=iq(i,s))||n.enumerable});return t})(T&&T.__esModule?x:iG(x,"default",{value:T,enumerable:!0}),T)),rM=class{constructor(t){this.debug=(0,rI.default)(t),rI.default.enable("*")}log(t,...i){this.debug(t,...i)}},rR=class t{constructor(t,i,r){this.io=t,this.presence=i,this.roomId=r,this.presences=new Set,this.observers=new Map,this.onPresenceJoin=t=>{(null==t?void 0:t.roomId)===this.roomId&&(this.logger.log("presence room @ presence join",t),this.presences.add(t),this.observers.get("presence.joined-room").next({connectionId:t.connectionId,data:t.data,id:t.id,name:t.name,timestamp:t.timestamp}))},this.onPresenceLeave=t=>{(null==t?void 0:t.roomId)===this.roomId&&(this.logger.log("presence room @ presence leave",t),this.presences.delete(t),this.observers.get("presence.leave").next(t))},this.onPresenceUpdate=t=>{(null==t?void 0:t.roomId)===this.roomId&&(this.logger.log("presence room @ presence update",t),this.observers.get("presence.update").next({connectionId:t.connectionId,data:t.data,id:t.id,name:t.name,roomId:null==t?void 0:t.roomId,timestamp:t.timestamp}))},this.logger=new rM("@superviz/socket-client/presence"),this.registerSubjects(),this.subscribeToPresenceEvents()}static register(i,r,n){return new t(i,r,n)}get(t,i){let r=new rx;r.subscribe({next:t,error:i});let n=t=>{let i=t.presences.map(t=>({connectionId:t.connectionId,data:t.data,id:t.id,name:t.name,timestamp:t.timestamp}));this.logger.log("presence room @ get",t),this.io.off("presence.get",n),r.next(i),r.complete()};this.io.on("presence.get",n),this.io.emit("presence.get",this.roomId)}update(t){let i={connectionId:this.io.id,data:t,id:this.presence.id,name:this.presence.name,timestamp:Date.now()};this.io.emit("presence.update",this.roomId,i),this.logger.log("presence room @ update",this.roomId,i)}destroy(){this.io.off("presence.joined-room",this.onPresenceJoin),this.io.off("presence.leave",this.onPresenceLeave),this.io.off("presence.update",this.onPresenceUpdate),this.observers.forEach(t=>t.unsubscribe()),this.observers.clear()}registerSubjects(){this.observers.set("presence.joined-room",new rx),this.observers.set("presence.leave",new rx),this.observers.set("presence.update",new rx)}on(t,i,r){this.observers.get(t).subscribe({error:r,next:i})}off(t){this.observers.get(t).unsubscribe(),this.observers.delete(t),this.observers.set(t,new rx)}subscribeToPresenceEvents(){this.io.on("presence.joined-room",this.onPresenceJoin),this.io.on("presence.leave",this.onPresenceLeave),this.io.on("presence.update",this.onPresenceUpdate)}},rF=Object.create(null);rF.open="0",rF.close="1",rF.ping="2",rF.pong="3",rF.message="4",rF.upgrade="5",rF.noop="6";var rL=Object.create(null);Object.keys(rF).forEach(t=>{rL[rF[t]]=t});var rN={type:"error",data:"parser error"},rD="function"==typeof Blob||"u">typeof Blob&&"[object BlobConstructor]"===Object.prototype.toString.call(Blob),rj="function"==typeof ArrayBuffer,rB=t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t&&t.buffer instanceof ArrayBuffer,rU=({type:t,data:i},r,n)=>rD&&i instanceof Blob?r?n(i):rz(i,n):rj&&(i instanceof ArrayBuffer||rB(i))?r?n(i):rz(new Blob([i]),n):n(rF[t]+(i||"")),rz=(t,i)=>{let r=new FileReader;return r.onload=function(){i("b"+(r.result.split(",")[1]||""))},r.readAsDataURL(t)};function rW(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):new Uint8Array(t.buffer,t.byteOffset,t.byteLength)}var r$="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rV=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let t=0;t<r$.length;t++)rV[r$.charCodeAt(t)]=t;var rZ=t=>{let i=.75*t.length,r=t.length,n,s=0,a,l,u,c;"="===t[t.length-1]&&(i--,"="===t[t.length-2]&&i--);let h=new ArrayBuffer(i),d=new Uint8Array(h);for(n=0;n<r;n+=4)a=rV[t.charCodeAt(n)],l=rV[t.charCodeAt(n+1)],u=rV[t.charCodeAt(n+2)],c=rV[t.charCodeAt(n+3)],d[s++]=a<<2|l>>4,d[s++]=(15&l)<<4|u>>2,d[s++]=(3&u)<<6|63&c;return h},rG="function"==typeof ArrayBuffer,rJ=(t,i)=>{if("string"!=typeof t)return{type:"message",data:rH(t,i)};let r=t.charAt(0);return"b"===r?{type:"message",data:rq(t.substring(1),i)}:rL[r]?t.length>1?{type:rL[r],data:t.substring(1)}:{type:rL[r]}:rN},rq=(t,i)=>rG?rH(rZ(t),i):{base64:!0,data:t},rH=(t,i)=>"blob"===i?t instanceof Blob?t:new Blob([t]):t instanceof ArrayBuffer?t:t.buffer,rK=(t,i)=>{let r=t.length,n=Array(r),s=0;t.forEach((t,a)=>{rU(t,!1,t=>{n[a]=t,++s===r&&i(n.join("\x1e"))})})},rY=(t,i)=>{let r=t.split("\x1e"),n=[];for(let t=0;t<r.length;t++){let s=rJ(r[t],i);if(n.push(s),"error"===s.type)break}return n};function rQ(t){return t.reduce((t,i)=>t+i.length,0)}function rX(t,i){if(t[0].length===i)return t.shift();let r=new Uint8Array(i),n=0;for(let s=0;s<i;s++)r[s]=t[0][n++],n===t[0].length&&(t.shift(),n=0);return t.length&&n<t[0].length&&(t[0]=t[0].slice(n)),r}function r0(t){if(t)return function(t){for(var i in r0.prototype)t[i]=r0.prototype[i];return t}(t)}r0.prototype.on=r0.prototype.addEventListener=function(t,i){return this._callbacks=this._callbacks||{},(this._callbacks["$"+t]=this._callbacks["$"+t]||[]).push(i),this},r0.prototype.once=function(t,i){function r(){this.off(t,r),i.apply(this,arguments)}return r.fn=i,this.on(t,r),this},r0.prototype.off=r0.prototype.removeListener=r0.prototype.removeAllListeners=r0.prototype.removeEventListener=function(t,i){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var r=this._callbacks["$"+t];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+t],this;for(var n,s=0;s<r.length;s++)if((n=r[s])===i||n.fn===i){r.splice(s,1);break}return 0===r.length&&delete this._callbacks["$"+t],this},r0.prototype.emit=function(t){this._callbacks=this._callbacks||{};for(var i=Array(arguments.length-1),r=this._callbacks["$"+t],n=1;n<arguments.length;n++)i[n-1]=arguments[n];if(r){r=r.slice(0);for(var n=0,s=r.length;n<s;++n)r[n].apply(this,i)}return this},r0.prototype.emitReserved=r0.prototype.emit,r0.prototype.listeners=function(t){return this._callbacks=this._callbacks||{},this._callbacks["$"+t]||[]},r0.prototype.hasListeners=function(t){return!!this.listeners(t).length};var r1="u">typeof self?self:"u">typeof window?window:Function("return this")();function r3(t,...i){return i.reduce((i,r)=>(t.hasOwnProperty(r)&&(i[r]=t[r]),i),{})}var r2=r1.setTimeout,r9=r1.clearTimeout;function r6(t,i){i.useNativeTimers?(t.setTimeoutFn=r2.bind(r1),t.clearTimeoutFn=r9.bind(r1)):(t.setTimeoutFn=r1.setTimeout.bind(r1),t.clearTimeoutFn=r1.clearTimeout.bind(r1))}var r4,r5,r7,r8=class extends Error{constructor(t,i,r){super(t),this.description=i,this.context=r,this.type="TransportError"}},ne=class extends r0{constructor(t){super(),this.writable=!1,r6(this,t),this.opts=t,this.query=t.query,this.socket=t.socket}onError(t,i,r){return super.emitReserved("error",new r8(t,i,r)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return("opening"===this.readyState||"open"===this.readyState)&&(this.doClose(),this.onClose()),this}send(t){"open"===this.readyState&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){let i=rJ(t,this.socket.binaryType);this.onPacket(i)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,i={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(i)}_hostname(){let t=this.opts.hostname;return -1===t.indexOf(":")?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(443!==this.opts.port)||!this.opts.secure&&80!==Number(this.opts.port))?":"+this.opts.port:""}_query(t){let i=function(t){let i="";for(let r in t)t.hasOwnProperty(r)&&(i.length&&(i+="&"),i+=encodeURIComponent(r)+"="+encodeURIComponent(t[r]));return i}(t);return i.length?"?"+i:""}},nt="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),ni={},nr=0,nn=0;function ns(t){let i="";do i=nt[t%64]+i,t=Math.floor(t/64);while(t>0);return i}function no(){let t=ns(+new Date);return t!==r7?(nr=0,r7=t):t+"."+ns(nr++)}for(;nn<64;nn++)ni[nt[nn]]=nn;var na=!1;try{na="u">typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch{}var nl=na;function nu(t){let i=t.xdomain;try{if("u">typeof XMLHttpRequest&&(!i||nl))return new XMLHttpRequest}catch{}if(!i)try{return new r1[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}function nc(){}var nh=null!=new nu({xdomain:!1}).responseType,nd=class extends ne{constructor(t){if(super(t),this.polling=!1,"u">typeof location){let i="https:"===location.protocol,r=location.port;r||(r=i?"443":"80"),this.xd="u">typeof location&&t.hostname!==location.hostname||r!==t.port}let i=t&&t.forceBase64;this.supportsBinary=nh&&!i,this.opts.withCredentials&&(this.cookieJar=void 0)}get name(){return"polling"}doOpen(){this.poll()}pause(t){this.readyState="pausing";let i=()=>{this.readyState="paused",t()};if(this.polling||!this.writable){let t=0;this.polling&&(t++,this.once("pollComplete",function(){--t||i()})),this.writable||(t++,this.once("drain",function(){--t||i()}))}else i()}poll(){this.polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){rY(t,this.socket.binaryType).forEach(t=>{if("opening"===this.readyState&&"open"===t.type&&this.onOpen(),"close"===t.type)return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(t)}),"closed"!==this.readyState&&(this.polling=!1,this.emitReserved("pollComplete"),"open"===this.readyState&&this.poll())}doClose(){let t=()=>{this.write([{type:"close"}])};"open"===this.readyState?t():this.once("open",t)}write(t){this.writable=!1,rK(t,t=>{this.doWrite(t,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){let t=this.opts.secure?"https":"http",i=this.query||{};return!1!==this.opts.timestampRequests&&(i[this.opts.timestampParam]=no()),this.supportsBinary||i.sid||(i.b64=1),this.createUri(t,i)}request(t={}){return Object.assign(t,{xd:this.xd,cookieJar:this.cookieJar},this.opts),new np(this.uri(),t)}doWrite(t,i){let r=this.request({method:"POST",data:t});r.on("success",i),r.on("error",(t,i)=>{this.onError("xhr post error",t,i)})}doPoll(){let t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(t,i)=>{this.onError("xhr poll error",t,i)}),this.pollXhr=t}},np=class t extends r0{constructor(t,i){super(),r6(this,i),this.opts=i,this.method=i.method||"GET",this.uri=t,this.data=void 0!==i.data?i.data:null,this.create()}create(){var i;let r=r3(this.opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");r.xdomain=!!this.opts.xd;let n=this.xhr=new nu(r);try{n.open(this.method,this.uri,!0);try{if(this.opts.extraHeaders)for(let t in n.setDisableHeaderCheck&&n.setDisableHeaderCheck(!0),this.opts.extraHeaders)this.opts.extraHeaders.hasOwnProperty(t)&&n.setRequestHeader(t,this.opts.extraHeaders[t])}catch{}if("POST"===this.method)try{n.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{n.setRequestHeader("Accept","*/*")}catch{}null===(i=this.opts.cookieJar)||void 0===i||i.addCookies(n),"withCredentials"in n&&(n.withCredentials=this.opts.withCredentials),this.opts.requestTimeout&&(n.timeout=this.opts.requestTimeout),n.onreadystatechange=()=>{var t;3===n.readyState&&(null===(t=this.opts.cookieJar)||void 0===t||t.parseCookies(n)),4===n.readyState&&(200===n.status||1223===n.status?this.onLoad():this.setTimeoutFn(()=>{this.onError("number"==typeof n.status?n.status:0)},0))},n.send(this.data)}catch(t){this.setTimeoutFn(()=>{this.onError(t)},0);return}"u">typeof document&&(this.index=t.requestsCount++,t.requests[this.index]=this)}onError(t){this.emitReserved("error",t,this.xhr),this.cleanup(!0)}cleanup(i){if(!(typeof this.xhr>"u"||null===this.xhr)){if(this.xhr.onreadystatechange=nc,i)try{this.xhr.abort()}catch{}"u">typeof document&&delete t.requests[this.index],this.xhr=null}}onLoad(){let t=this.xhr.responseText;null!==t&&(this.emitReserved("data",t),this.emitReserved("success"),this.cleanup())}abort(){this.cleanup()}};function nf(){for(let t in np.requests)np.requests.hasOwnProperty(t)&&np.requests[t].abort()}np.requestsCount=0,np.requests={},"u">typeof document&&("function"==typeof attachEvent?attachEvent("onunload",nf):"function"==typeof addEventListener&&addEventListener("onpagehide"in r1?"pagehide":"unload",nf,!1));var nm="function"==typeof Promise&&"function"==typeof Promise.resolve?t=>Promise.resolve().then(t):(t,i)=>i(t,0),nv=r1.WebSocket||r1.MozWebSocket,ng="u">typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),nb={websocket:class extends ne{constructor(t){super(t),this.supportsBinary=!t.forceBase64}get name(){return"websocket"}doOpen(){if(!this.check())return;let t=this.uri(),i=this.opts.protocols,r=ng?{}:r3(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(r.headers=this.opts.extraHeaders);try{this.ws=ng?new nv(t,i,r):i?new nv(t,i):new nv(t)}catch(t){return this.emitReserved("error",t)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let i=0;i<t.length;i++){let r=t[i],n=i===t.length-1;rU(r,this.supportsBinary,t=>{try{this.ws.send(t)}catch{}n&&nm(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){"u">typeof this.ws&&(this.ws.close(),this.ws=null)}uri(){let t=this.opts.secure?"wss":"ws",i=this.query||{};return this.opts.timestampRequests&&(i[this.opts.timestampParam]=no()),this.supportsBinary||(i.b64=1),this.createUri(t,i)}check(){return!!nv}},webtransport:class extends ne{get name(){return"webtransport"}doOpen(){"function"==typeof WebTransport&&(this.transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name]),this.transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this.transport.ready.then(()=>{this.transport.createBidirectionalStream().then(t=>{var i,r;let n,s,a,l;let u=(i=Number.MAX_SAFE_INTEGER,r=this.socket.binaryType,r5||(r5=new TextDecoder),n=[],s=0,a=-1,l=!1,new TransformStream({transform(t,u){for(n.push(t);;){if(0===s){if(1>rQ(n))break;let t=rX(n,1);l=(128&t[0])==128,s=(a=127&t[0])<126?3:126===a?1:2}else if(1===s){if(2>rQ(n))break;let t=rX(n,2);a=new DataView(t.buffer,t.byteOffset,t.length).getUint16(0),s=3}else if(2===s){if(8>rQ(n))break;let t=rX(n,8),i=new DataView(t.buffer,t.byteOffset,t.length),r=i.getUint32(0);if(r>2097151){u.enqueue(rN);break}a=4294967296*r+i.getUint32(4),s=3}else{if(rQ(n)<a)break;let t=rX(n,a);u.enqueue(rJ(l?t:r5.decode(t),r)),s=0}if(0===a||a>i){u.enqueue(rN);break}}}})),c=t.readable.pipeThrough(u).getReader(),h=new TransformStream({transform(t,i){var r;r=r=>{let n=r.length,s;if(n<126)new DataView((s=new Uint8Array(1)).buffer).setUint8(0,n);else if(n<65536){let t=new DataView((s=new Uint8Array(3)).buffer);t.setUint8(0,126),t.setUint16(1,n)}else{let t=new DataView((s=new Uint8Array(9)).buffer);t.setUint8(0,127),t.setBigUint64(1,BigInt(n))}t.data&&"string"!=typeof t.data&&(s[0]|=128),i.enqueue(s),i.enqueue(r)},rD&&t.data instanceof Blob?t.data.arrayBuffer().then(rW).then(r):rj&&(t.data instanceof ArrayBuffer||rB(t.data))?r(rW(t.data)):rU(t,!1,t=>{r4||(r4=new TextEncoder),r(r4.encode(t))})}});h.readable.pipeTo(t.writable),this.writer=h.writable.getWriter();let d=()=>{c.read().then(({done:t,value:i})=>{t||(this.onPacket(i),d())}).catch(t=>{})};d();let p={type:"open"};this.query.sid&&(p.data=`{"sid":"${this.query.sid}"}`),this.writer.write(p).then(()=>this.onOpen())})}))}write(t){this.writable=!1;for(let i=0;i<t.length;i++){let r=t[i],n=i===t.length-1;this.writer.write(r).then(()=>{n&&nm(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;null===(t=this.transport)||void 0===t||t.close()}},polling:nd},ny=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,n_=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function nw(t){var i,r;let n,s;if(t.length>2e3)throw"URI too long";let a=t,l=t.indexOf("["),u=t.indexOf("]");-1!=l&&-1!=u&&(t=t.substring(0,l)+t.substring(l,u).replace(/:/g,";")+t.substring(u,t.length));let c=ny.exec(t||""),h={},d=14;for(;d--;)h[n_[d]]=c[d]||"";return -1!=l&&-1!=u&&(h.source=a,h.host=h.host.substring(1,h.host.length-1).replace(/;/g,":"),h.authority=h.authority.replace("[","").replace("]","").replace(/;/g,":"),h.ipv6uri=!0),h.pathNames=(n=(i=h.path).replace(/\/{2,9}/g,"/").split("/"),("/"==i.slice(0,1)||0===i.length)&&n.splice(0,1),"/"==i.slice(-1)&&n.splice(n.length-1,1),n),h.queryKey=(r=h.query,s={},r.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(t,i,r){i&&(s[i]=r)}),s),h}var nE=class t extends r0{constructor(t,i={}){super(),this.binaryType="arraybuffer",this.writeBuffer=[],t&&"object"==typeof t&&(i=t,t=null),t?(t=nw(t),i.hostname=t.host,i.secure="https"===t.protocol||"wss"===t.protocol,i.port=t.port,t.query&&(i.query=t.query)):i.host&&(i.hostname=nw(i.host).host),r6(this,i),this.secure=null!=i.secure?i.secure:"u">typeof location&&"https:"===location.protocol,i.hostname&&!i.port&&(i.port=this.secure?"443":"80"),this.hostname=i.hostname||("u">typeof location?location.hostname:"localhost"),this.port=i.port||("u">typeof location&&location.port?location.port:this.secure?"443":"80"),this.transports=i.transports||["polling","websocket","webtransport"],this.writeBuffer=[],this.prevBufferLen=0,this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},i),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),"string"==typeof this.opts.query&&(this.opts.query=function(t){let i={},r=t.split("&");for(let t=0,n=r.length;t<n;t++){let n=r[t].split("=");i[decodeURIComponent(n[0])]=decodeURIComponent(n[1])}return i}(this.opts.query)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingTimeoutTimer=null,"function"==typeof addEventListener&&(this.opts.closeOnBeforeunload&&(this.beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this.beforeunloadEventListener,!1)),"localhost"!==this.hostname&&(this.offlineEventListener=()=>{this.onClose("transport close",{description:"network connection lost"})},addEventListener("offline",this.offlineEventListener,!1))),this.open()}createTransport(t){let i=Object.assign({},this.opts.query);i.EIO=4,i.transport=t,this.id&&(i.sid=this.id);let r=Object.assign({},this.opts,{query:i,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new nb[t](r)}open(){let i;if(this.opts.rememberUpgrade&&t.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))i="websocket";else if(0===this.transports.length){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}else i=this.transports[0];this.readyState="opening";try{i=this.createTransport(i)}catch{this.transports.shift(),this.open();return}i.open(),this.setTransport(i)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this.onDrain.bind(this)).on("packet",this.onPacket.bind(this)).on("error",this.onError.bind(this)).on("close",t=>this.onClose("transport close",t))}probe(i){let r=this.createTransport(i),n=!1;t.priorWebsocketSuccess=!1;let s=()=>{n||(r.send([{type:"ping",data:"probe"}]),r.once("packet",i=>{if(!n){if("pong"===i.type&&"probe"===i.data)this.upgrading=!0,this.emitReserved("upgrading",r),r&&(t.priorWebsocketSuccess="websocket"===r.name,this.transport.pause(()=>{n||"closed"!==this.readyState&&(d(),this.setTransport(r),r.send([{type:"upgrade"}]),this.emitReserved("upgrade",r),r=null,this.upgrading=!1,this.flush())}));else{let t=Error("probe error");t.transport=r.name,this.emitReserved("upgradeError",t)}}}))};function a(){n||(n=!0,d(),r.close(),r=null)}let l=t=>{let i=Error("probe error: "+t);i.transport=r.name,a(),this.emitReserved("upgradeError",i)};function u(){l("transport closed")}function c(){l("socket closed")}function h(t){r&&t.name!==r.name&&a()}let d=()=>{r.removeListener("open",s),r.removeListener("error",l),r.removeListener("close",u),this.off("close",c),this.off("upgrading",h)};r.once("open",s),r.once("error",l),r.once("close",u),this.once("close",c),this.once("upgrading",h),-1!==this.upgrades.indexOf("webtransport")&&"webtransport"!==i?this.setTimeoutFn(()=>{n||r.open()},200):r.open()}onOpen(){if(this.readyState="open",t.priorWebsocketSuccess="websocket"===this.transport.name,this.emitReserved("open"),this.flush(),"open"===this.readyState&&this.opts.upgrade){let t=0,i=this.upgrades.length;for(;t<i;t++)this.probe(this.upgrades[t])}}onPacket(t){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),this.resetPingTimeout(),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this.sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong");break;case"error":let i=Error("server error");i.code=t.data,this.onError(i);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data)}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this.upgrades=this.filterUpgrades(t.upgrades),this.pingInterval=t.pingInterval,this.pingTimeout=t.pingTimeout,this.maxPayload=t.maxPayload,this.onOpen(),"closed"!==this.readyState&&this.resetPingTimeout()}resetPingTimeout(){this.clearTimeoutFn(this.pingTimeoutTimer),this.pingTimeoutTimer=this.setTimeoutFn(()=>{this.onClose("ping timeout")},this.pingInterval+this.pingTimeout),this.opts.autoUnref&&this.pingTimeoutTimer.unref()}onDrain(){this.writeBuffer.splice(0,this.prevBufferLen),this.prevBufferLen=0,0===this.writeBuffer.length?this.emitReserved("drain"):this.flush()}flush(){if("closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){let t=this.getWritablePackets();this.transport.send(t),this.prevBufferLen=t.length,this.emitReserved("flush")}}getWritablePackets(){if(!(this.maxPayload&&"polling"===this.transport.name&&this.writeBuffer.length>1))return this.writeBuffer;let t=1;for(let i=0;i<this.writeBuffer.length;i++){let r=this.writeBuffer[i].data;if(r&&(t+="string"==typeof r?function(t){let i=0,r=0;for(let n=0,s=t.length;n<s;n++)(i=t.charCodeAt(n))<128?r+=1:i<2048?r+=2:i<55296||i>=57344?r+=3:(n++,r+=4);return r}(r):Math.ceil(1.33*(r.byteLength||r.size))),i>0&&t>this.maxPayload)return this.writeBuffer.slice(0,i);t+=2}return this.writeBuffer}write(t,i,r){return this.sendPacket("message",t,i,r),this}send(t,i,r){return this.sendPacket("message",t,i,r),this}sendPacket(t,i,r,n){if("function"==typeof i&&(n=i,i=void 0),"function"==typeof r&&(n=r,r=null),"closing"===this.readyState||"closed"===this.readyState)return;(r=r||{}).compress=!1!==r.compress;let s={type:t,data:i,options:r};this.emitReserved("packetCreate",s),this.writeBuffer.push(s),n&&this.once("flush",n),this.flush()}close(){let t=()=>{this.onClose("forced close"),this.transport.close()},i=()=>{this.off("upgrade",i),this.off("upgradeError",i),t()},r=()=>{this.once("upgrade",i),this.once("upgradeError",i)};return("opening"===this.readyState||"open"===this.readyState)&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?r():t()}):this.upgrading?r():t()),this}onError(i){t.priorWebsocketSuccess=!1,this.emitReserved("error",i),this.onClose("transport error",i)}onClose(t,i){("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)&&(this.clearTimeoutFn(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),"function"==typeof removeEventListener&&(removeEventListener("beforeunload",this.beforeunloadEventListener,!1),removeEventListener("offline",this.offlineEventListener,!1)),this.readyState="closed",this.id=null,this.emitReserved("close",t,i),this.writeBuffer=[],this.prevBufferLen=0)}filterUpgrades(t){let i=[],r=0,n=t.length;for(;r<n;r++)~this.transports.indexOf(t[r])&&i.push(t[r]);return i}};nE.protocol=4;var nC={};((t,i)=>{for(var r in i)iG(t,r,{get:i[r],enumerable:!0})})(nC,{Decoder:()=>nL,Encoder:()=>nR,PacketType:()=>nk,protocol:()=>nM});var nP="function"==typeof ArrayBuffer,nA=t=>"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(t):t.buffer instanceof ArrayBuffer,nS=Object.prototype.toString,nO="function"==typeof Blob||"u">typeof Blob&&"[object BlobConstructor]"===nS.call(Blob),nT="function"==typeof File||"u">typeof File&&"[object FileConstructor]"===nS.call(File);function nx(t){return nP&&(t instanceof ArrayBuffer||nA(t))||nO&&t instanceof Blob||nT&&t instanceof File}var nk,nI=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],nM=5;(n8=nk||(nk={}))[n8.CONNECT=0]="CONNECT",n8[n8.DISCONNECT=1]="DISCONNECT",n8[n8.EVENT=2]="EVENT",n8[n8.ACK=3]="ACK",n8[n8.CONNECT_ERROR=4]="CONNECT_ERROR",n8[n8.BINARY_EVENT=5]="BINARY_EVENT",n8[n8.BINARY_ACK=6]="BINARY_ACK";var nR=class{constructor(t){this.replacer=t}encode(t){return(t.type===nk.EVENT||t.type===nk.ACK)&&function t(i,r){if(!i||"object"!=typeof i)return!1;if(Array.isArray(i)){for(let r=0,n=i.length;r<n;r++)if(t(i[r]))return!0;return!1}if(nx(i))return!0;if(i.toJSON&&"function"==typeof i.toJSON&&1==arguments.length)return t(i.toJSON(),!0);for(let r in i)if(Object.prototype.hasOwnProperty.call(i,r)&&t(i[r]))return!0;return!1}(t)?this.encodeAsBinary({type:t.type===nk.EVENT?nk.BINARY_EVENT:nk.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let i=""+t.type;return(t.type===nk.BINARY_EVENT||t.type===nk.BINARY_ACK)&&(i+=t.attachments+"-"),t.nsp&&"/"!==t.nsp&&(i+=t.nsp+","),null!=t.id&&(i+=t.id),null!=t.data&&(i+=JSON.stringify(t.data,this.replacer)),i}encodeAsBinary(t){let i,r;let n=(i=[],r=t.data,t.data=function t(i,r){if(!i)return i;if(nx(i)){let t={_placeholder:!0,num:r.length};return r.push(i),t}if(Array.isArray(i)){let n=Array(i.length);for(let s=0;s<i.length;s++)n[s]=t(i[s],r);return n}if("object"==typeof i&&!(i instanceof Date)){let n={};for(let s in i)Object.prototype.hasOwnProperty.call(i,s)&&(n[s]=t(i[s],r));return n}return i}(r,i),t.attachments=i.length,{packet:t,buffers:i}),s=this.encodeAsString(n.packet),a=n.buffers;return a.unshift(s),a}};function nF(t){return"[object Object]"===Object.prototype.toString.call(t)}var nL=class t extends r0{constructor(t){super(),this.reviver=t}add(t){let i;if("string"==typeof t){if(this.reconstructor)throw Error("got plaintext data when reconstructing a packet");let r=(i=this.decodeString(t)).type===nk.BINARY_EVENT;r||i.type===nk.BINARY_ACK?(i.type=r?nk.EVENT:nk.ACK,this.reconstructor=new nN(i),0===i.attachments&&super.emitReserved("decoded",i)):super.emitReserved("decoded",i)}else if(nx(t)||t.base64){if(this.reconstructor)(i=this.reconstructor.takeBinaryData(t))&&(this.reconstructor=null,super.emitReserved("decoded",i));else throw Error("got binary data when not reconstructing a packet")}else throw Error("Unknown type: "+t)}decodeString(i){let r=0,n={type:Number(i.charAt(0))};if(void 0===nk[n.type])throw Error("unknown packet type "+n.type);if(n.type===nk.BINARY_EVENT||n.type===nk.BINARY_ACK){let t=r+1;for(;"-"!==i.charAt(++r)&&r!=i.length;);let s=i.substring(t,r);if(s!=Number(s)||"-"!==i.charAt(r))throw Error("Illegal attachments");n.attachments=Number(s)}if("/"===i.charAt(r+1)){let t=r+1;for(;++r&&!(","===i.charAt(r)||r===i.length););n.nsp=i.substring(t,r)}else n.nsp="/";let s=i.charAt(r+1);if(""!==s&&Number(s)==s){let t=r+1;for(;++r;){let t=i.charAt(r);if(null==t||Number(t)!=t){--r;break}if(r===i.length)break}n.id=Number(i.substring(t,r+1))}if(i.charAt(++r)){let s=this.tryParse(i.substr(r));if(t.isPayloadValid(n.type,s))n.data=s;else throw Error("invalid payload")}return n}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,i){switch(t){case nk.CONNECT:return nF(i);case nk.DISCONNECT:return void 0===i;case nk.CONNECT_ERROR:return"string"==typeof i||nF(i);case nk.EVENT:case nk.BINARY_EVENT:return Array.isArray(i)&&("number"==typeof i[0]||"string"==typeof i[0]&&-1===nI.indexOf(i[0]));case nk.ACK:case nk.BINARY_ACK:return Array.isArray(i)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}},nN=class{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){var i,r;let t=(i=this.reconPack,r=this.buffers,i.data=function t(i,r){if(!i)return i;if(i&&!0===i._placeholder){if("number"==typeof i.num&&i.num>=0&&i.num<r.length)return r[i.num];throw Error("illegal attachments")}if(Array.isArray(i))for(let n=0;n<i.length;n++)i[n]=t(i[n],r);else if("object"==typeof i)for(let n in i)Object.prototype.hasOwnProperty.call(i,n)&&(i[n]=t(i[n],r));return i}(i.data,r),delete i.attachments,i);return this.finishedReconstruction(),t}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}};function nD(t,i,r){return t.on(i,r),function(){t.off(i,r)}}var nj=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1}),nB=class extends r0{constructor(t,i,r){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=i,r&&r.auth&&(this.auth=r.auth),this._opts=Object.assign({},r),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;let t=this.io;this.subs=[nD(t,"open",this.onopen.bind(this)),nD(t,"packet",this.onpacket.bind(this)),nD(t,"error",this.onerror.bind(this)),nD(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected||(this.subEvents(),this.io._reconnecting||this.io.open(),"open"===this.io._readyState&&this.onopen()),this}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...i){if(nj.hasOwnProperty(t))throw Error('"'+t.toString()+'" is a reserved event name');if(i.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(i),this;let r={type:nk.EVENT,data:i};if(r.options={},r.options.compress=!1!==this.flags.compress,"function"==typeof i[i.length-1]){let t=this.ids++,n=i.pop();this._registerAckCallback(t,n),r.id=t}let n=this.io.engine&&this.io.engine.transport&&this.io.engine.transport.writable;return(!this.flags.volatile||n&&this.connected)&&(this.connected?(this.notifyOutgoingListeners(r),this.packet(r)):this.sendBuffer.push(r)),this.flags={},this}_registerAckCallback(t,i){var r;let n=null!==(r=this.flags.timeout)&&void 0!==r?r:this._opts.ackTimeout;if(void 0===n){this.acks[t]=i;return}let s=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let i=0;i<this.sendBuffer.length;i++)this.sendBuffer[i].id===t&&this.sendBuffer.splice(i,1);i.call(this,Error("operation has timed out"))},n),a=(...t)=>{this.io.clearTimeoutFn(s),i.apply(this,t)};a.withError=!0,this.acks[t]=a}emitWithAck(t,...i){return new Promise((r,n)=>{let s=(t,i)=>t?n(t):r(i);s.withError=!0,i.push(s),this.emit(t,...i)})}_addToQueue(t){let i;"function"==typeof t[t.length-1]&&(i=t.pop());let r={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((t,...n)=>r!==this._queue[0]?void 0:(null!==t?r.tryCount>this._opts.retries&&(this._queue.shift(),i&&i(t)):(this._queue.shift(),i&&i(null,...n)),r.pending=!1,this._drainQueue())),this._queue.push(r),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||0===this._queue.length)return;let i=this._queue[0];i.pending&&!t||(i.pending=!0,i.tryCount++,this.flags=i.flags,this.emit.apply(this,i.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){"function"==typeof this.auth?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:nk.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,i){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,i),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(i=>String(i.id)===t)){let i=this.acks[t];delete this.acks[t],i.withError&&i.call(this,Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case nk.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case nk.EVENT:case nk.BINARY_EVENT:this.onevent(t);break;case nk.ACK:case nk.BINARY_ACK:this.onack(t);break;case nk.DISCONNECT:this.ondisconnect();break;case nk.CONNECT_ERROR:this.destroy();let i=Error(t.data.message);i.data=t.data.data,this.emitReserved("connect_error",i)}}onevent(t){let i=t.data||[];null!=t.id&&i.push(this.ack(t.id)),this.connected?this.emitEvent(i):this.receiveBuffer.push(Object.freeze(i))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length)for(let i of this._anyListeners.slice())i.apply(this,t);super.emit.apply(this,t),this._pid&&t.length&&"string"==typeof t[t.length-1]&&(this._lastOffset=t[t.length-1])}ack(t){let i=this,r=!1;return function(...n){r||(r=!0,i.packet({type:nk.ACK,id:t,data:n}))}}onack(t){let i=this.acks[t.id];"function"==typeof i&&(delete this.acks[t.id],i.withError&&t.data.unshift(null),i.apply(this,t.data))}onconnect(t,i){this.id=t,this.recovered=i&&this._pid===i,this._pid=i,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:nk.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){let i=this._anyListeners;for(let r=0;r<i.length;r++)if(t===i[r])return i.splice(r,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){let i=this._anyOutgoingListeners;for(let r=0;r<i.length;r++)if(t===i[r])return i.splice(r,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length)for(let i of this._anyOutgoingListeners.slice())i.apply(this,t.data)}};function nU(t){t=t||{},this.ms=t.min||100,this.max=t.max||1e4,this.factor=t.factor||2,this.jitter=t.jitter>0&&t.jitter<=1?t.jitter:0,this.attempts=0}nU.prototype.duration=function(){var t=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var i=Math.random(),r=Math.floor(i*this.jitter*t);t=1&Math.floor(10*i)?t+r:t-r}return 0|Math.min(t,this.max)},nU.prototype.reset=function(){this.attempts=0},nU.prototype.setMin=function(t){this.ms=t},nU.prototype.setMax=function(t){this.max=t},nU.prototype.setJitter=function(t){this.jitter=t};var nz=class extends r0{constructor(t,i){var r;super(),this.nsps={},this.subs=[],t&&"object"==typeof t&&(i=t,t=void 0),(i=i||{}).path=i.path||"/socket.io",this.opts=i,r6(this,i),this.reconnection(!1!==i.reconnection),this.reconnectionAttempts(i.reconnectionAttempts||1/0),this.reconnectionDelay(i.reconnectionDelay||1e3),this.reconnectionDelayMax(i.reconnectionDelayMax||5e3),this.randomizationFactor(null!==(r=i.randomizationFactor)&&void 0!==r?r:.5),this.backoff=new nU({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==i.timeout?2e4:i.timeout),this._readyState="closed",this.uri=t;let n=i.parser||nC;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this._autoConnect=!1!==i.autoConnect,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,this):this._reconnection}reconnectionAttempts(t){return void 0===t?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var i;return void 0===t?this._reconnectionDelay:(this._reconnectionDelay=t,null===(i=this.backoff)||void 0===i||i.setMin(t),this)}randomizationFactor(t){var i;return void 0===t?this._randomizationFactor:(this._randomizationFactor=t,null===(i=this.backoff)||void 0===i||i.setJitter(t),this)}reconnectionDelayMax(t){var i;return void 0===t?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,null===(i=this.backoff)||void 0===i||i.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new nE(this.uri,this.opts);let i=this.engine,r=this;this._readyState="opening",this.skipReconnect=!1;let n=nD(i,"open",function(){r.onopen(),t&&t()}),s=i=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",i),t?t(i):this.maybeReconnectOnOpen()},a=nD(i,"error",s);if(!1!==this._timeout){let t=this._timeout,r=this.setTimeoutFn(()=>{n(),s(Error("timeout")),i.close()},t);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}return this.subs.push(n),this.subs.push(a),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");let t=this.engine;this.subs.push(nD(t,"ping",this.onping.bind(this)),nD(t,"data",this.ondata.bind(this)),nD(t,"error",this.onerror.bind(this)),nD(t,"close",this.onclose.bind(this)),nD(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(t){this.onclose("parse error",t)}}ondecoded(t){nm(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,i){let r=this.nsps[t];return r?this._autoConnect&&!r.active&&r.connect():(r=new nB(this,t,i),this.nsps[t]=r),r}_destroy(t){for(let t of Object.keys(this.nsps))if(this.nsps[t].active)return;this._close()}_packet(t){let i=this.encoder.encode(t);for(let r=0;r<i.length;r++)this.engine.write(i[r],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close"),this.engine&&this.engine.close()}disconnect(){return this._close()}onclose(t,i){this.cleanup(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,i),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;let t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{let i=this.backoff.duration();this._reconnecting=!0;let r=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),t.skipReconnect||t.open(i=>{i?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",i)):t.onreconnect()}))},i);this.opts.autoUnref&&r.unref(),this.subs.push(()=>{this.clearTimeoutFn(r)})}}onreconnect(){let t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}},nW={};function n$(t,i){"object"==typeof t&&(i=t,t=void 0);let r=function(t,i="",r){let n=t;r=r||"u">typeof location&&location,null==t&&(t=r.protocol+"//"+r.host),"string"==typeof t&&("/"===t.charAt(0)&&(t="/"===t.charAt(1)?r.protocol+t:r.host+t),/^(https?|wss?):\/\//.test(t)||(t="u">typeof r?r.protocol+"//"+t:"https://"+t),n=nw(t)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";let s=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+s+":"+n.port+i,n.href=n.protocol+"://"+s+(r&&r.port===n.port?"":":"+n.port),n}(t,(i=i||{}).path||"/socket.io"),n=r.source,s=r.id,a=r.path,l=nW[s]&&a in nW[s].nsps,u;return i.forceNew||i["force new connection"]||!1===i.multiplex||l?u=new nz(n,i):(nW[s]||(nW[s]=new nz(n,i)),u=nW[s]),r.query&&!i.query&&(i.query=r.queryKey),u.socket(r.path,i)}Object.assign(n$,{Manager:nz,Socket:nB,io:n$,connect:n$}),(se=si||(si={})).assertEqual=t=>t,se.assertIs=function(t){},se.assertNever=function(t){throw Error()},se.arrayToEnum=t=>{let i={};for(let r of t)i[r]=r;return i},se.getValidEnumValues=t=>{let i=se.objectKeys(t).filter(i=>"number"!=typeof t[t[i]]),r={};for(let n of i)r[n]=t[n];return se.objectValues(r)},se.objectValues=t=>se.objectKeys(t).map(function(i){return t[i]}),se.objectKeys="function"==typeof Object.keys?t=>Object.keys(t):t=>{let i=[];for(let r in t)Object.prototype.hasOwnProperty.call(t,r)&&i.push(r);return i},se.find=(t,i)=>{for(let r of t)if(i(r))return r},se.isInteger="function"==typeof Number.isInteger?t=>Number.isInteger(t):t=>"number"==typeof t&&isFinite(t)&&Math.floor(t)===t,se.joinValues=function(t,i=" | "){return t.map(t=>"string"==typeof t?`'${t}'`:t).join(i)},se.jsonStringifyReplacer=(t,i)=>"bigint"==typeof i?i.toString():i,(sr||(sr={})).mergeShapes=(t,i)=>i3(i3({},t),i);var nV=si.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),nZ=t=>{switch(typeof t){case"undefined":return nV.undefined;case"string":return nV.string;case"number":return isNaN(t)?nV.nan:nV.number;case"boolean":return nV.boolean;case"function":return nV.function;case"bigint":return nV.bigint;case"symbol":return nV.symbol;case"object":return Array.isArray(t)?nV.array:null===t?nV.null:t.then&&"function"==typeof t.then&&t.catch&&"function"==typeof t.catch?nV.promise:"u">typeof Map&&t instanceof Map?nV.map:"u">typeof Set&&t instanceof Set?nV.set:"u">typeof Date&&t instanceof Date?nV.date:nV.object;default:return nV.unknown}},nG=si.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),nJ=class t extends Error{constructor(t){super(),this.issues=[],this.addIssue=t=>{this.issues=[...this.issues,t]},this.addIssues=(t=[])=>{this.issues=[...this.issues,...t]};let i=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,i):this.__proto__=i,this.name="ZodError",this.issues=t}get errors(){return this.issues}format(t){let i=t||function(t){return t.message},r={_errors:[]},n=t=>{for(let s of t.issues)if("invalid_union"===s.code)s.unionErrors.map(n);else if("invalid_return_type"===s.code)n(s.returnTypeError);else if("invalid_arguments"===s.code)n(s.argumentsError);else if(0===s.path.length)r._errors.push(i(s));else{let t=r,n=0;for(;n<s.path.length;){let r=s.path[n];n===s.path.length-1?(t[r]=t[r]||{_errors:[]},t[r]._errors.push(i(s))):t[r]=t[r]||{_errors:[]},t=t[r],n++}}};return n(this),r}static assert(i){if(!(i instanceof t))throw Error(`Not a ZodError: ${i}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,si.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(t=t=>t.message){let i={},r=[];for(let n of this.issues)n.path.length>0?(i[n.path[0]]=i[n.path[0]]||[],i[n.path[0]].push(t(n))):r.push(t(n));return{formErrors:r,fieldErrors:i}}get formErrors(){return this.flatten()}};nJ.create=t=>new nJ(t);var nq=(t,i)=>{let r;switch(t.code){case nG.invalid_type:r=t.received===nV.undefined?"Required":`Expected ${t.expected}, received ${t.received}`;break;case nG.invalid_literal:r=`Invalid literal value, expected ${JSON.stringify(t.expected,si.jsonStringifyReplacer)}`;break;case nG.unrecognized_keys:r=`Unrecognized key(s) in object: ${si.joinValues(t.keys,", ")}`;break;case nG.invalid_union:r="Invalid input";break;case nG.invalid_union_discriminator:r=`Invalid discriminator value. Expected ${si.joinValues(t.options)}`;break;case nG.invalid_enum_value:r=`Invalid enum value. Expected ${si.joinValues(t.options)}, received '${t.received}'`;break;case nG.invalid_arguments:r="Invalid function arguments";break;case nG.invalid_return_type:r="Invalid function return type";break;case nG.invalid_date:r="Invalid date";break;case nG.invalid_string:"object"==typeof t.validation?"includes"in t.validation?(r=`Invalid input: must include "${t.validation.includes}"`,"number"==typeof t.validation.position&&(r=`${r} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?r=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?r=`Invalid input: must end with "${t.validation.endsWith}"`:si.assertNever(t.validation):r="regex"!==t.validation?`Invalid ${t.validation}`:"Invalid";break;case nG.too_small:r="array"===t.type?`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:"string"===t.type?`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:"number"===t.type?`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:"date"===t.type?`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:"Invalid input";break;case nG.too_big:r="array"===t.type?`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:"string"===t.type?`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:"number"===t.type?`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:"bigint"===t.type?`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:"date"===t.type?`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:"Invalid input";break;case nG.custom:r="Invalid input";break;case nG.invalid_intersection_types:r="Intersection results could not be merged";break;case nG.not_multiple_of:r=`Number must be a multiple of ${t.multipleOf}`;break;case nG.not_finite:r="Number must be finite";break;default:r=i.defaultError,si.assertNever(t)}return{message:r}},nH=nq;function nK(){return nH}var nY=t=>{let{data:i,path:r,errorMaps:n,issueData:s}=t,a=[...r,...s.path||[]],l=i2(i3({},s),{path:a});if(void 0!==s.message)return i2(i3({},s),{path:a,message:s.message});let u="";for(let t of n.filter(t=>!!t).slice().reverse())u=t(l,{data:i,defaultError:u}).message;return i2(i3({},s),{path:a,message:u})};function nQ(t,i){let r=nK(),n=nY({issueData:i,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,r,r===nq?void 0:nq].filter(t=>!!t)});t.common.issues.push(n)}var nX=class t{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(t,i){let r=[];for(let n of i){if("aborted"===n.status)return n0;"dirty"===n.status&&t.dirty(),r.push(n.value)}return{status:t.value,value:r}}static mergeObjectAsync(i,r){return i6(this,null,function*(){let n=[];for(let t of r){let i=yield t.key,r=yield t.value;n.push({key:i,value:r})}return t.mergeObjectSync(i,n)})}static mergeObjectSync(t,i){let r={};for(let n of i){let{key:i,value:s}=n;if("aborted"===i.status||"aborted"===s.status)return n0;"dirty"===i.status&&t.dirty(),"dirty"===s.status&&t.dirty(),"__proto__"!==i.value&&("u">typeof s.value||n.alwaysSet)&&(r[i.value]=s.value)}return{status:t.value,value:r}}},n0=Object.freeze({status:"aborted"}),n1=t=>({status:"dirty",value:t}),n3=t=>({status:"valid",value:t}),n2=t=>"aborted"===t.status,n9=t=>"dirty"===t.status,n6=t=>"valid"===t.status,n4=t=>"u">typeof Promise&&t instanceof Promise;function n5(t,i,r,n){if("function"==typeof i?t!==i||!n:!i.has(t))throw TypeError("Cannot read private member from an object whose class did not declare it");return i.get(t)}function n7(t,i,r,n,s){if("function"==typeof i?t!==i||!s:!i.has(t))throw TypeError("Cannot write private member to an object whose class did not declare it");return i.set(t,r),r}(st=sn||(sn={})).errToObj=t=>"string"==typeof t?{message:t}:t||{},st.toString=t=>"string"==typeof t?t:null==t?void 0:t.message;var n8,se,st,si,sr,sn,ss,so,sa=class{constructor(t,i,r,n){this._cachedPath=[],this.parent=t,this.data=i,this._path=r,this._key=n}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}},sl=(t,i)=>{if(n6(i))return{success:!0,data:i.value};if(!t.common.issues.length)throw Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;let i=new nJ(t.common.issues);return this._error=i,this._error}}};function su(t){if(!t)return{};let{errorMap:i,invalid_type_error:r,required_error:n,description:s}=t;if(i&&(r||n))throw Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');return i?{errorMap:i,description:s}:{errorMap:(i,s)=>{var a,l;let{message:u}=t;return"invalid_enum_value"===i.code?{message:u??s.defaultError}:typeof s.data>"u"?{message:null!==(a=u??n)&&void 0!==a?a:s.defaultError}:"invalid_type"!==i.code?{message:s.defaultError}:{message:null!==(l=u??r)&&void 0!==l?l:s.defaultError}},description:s}}var sc,sh=class{constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this)}get description(){return this._def.description}_getType(t){return nZ(t.data)}_getOrReturnCtx(t,i){return i||{common:t.parent.common,data:t.data,parsedType:nZ(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new nX,ctx:{common:t.parent.common,data:t.data,parsedType:nZ(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){let i=this._parse(t);if(n4(i))throw Error("Synchronous parse encountered promise.");return i}_parseAsync(t){return Promise.resolve(this._parse(t))}parse(t,i){let r=this.safeParse(t,i);if(r.success)return r.data;throw r.error}safeParse(t,i){var r;let n={common:{issues:[],async:null!==(r=null==i?void 0:i.async)&&void 0!==r&&r,contextualErrorMap:null==i?void 0:i.errorMap},path:(null==i?void 0:i.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:nZ(t)},s=this._parseSync({data:t,path:n.path,parent:n});return sl(n,s)}parseAsync(t,i){return i6(this,null,function*(){let r=yield this.safeParseAsync(t,i);if(r.success)return r.data;throw r.error})}safeParseAsync(t,i){return i6(this,null,function*(){let r={common:{issues:[],contextualErrorMap:null==i?void 0:i.errorMap,async:!0},path:(null==i?void 0:i.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:nZ(t)},n=this._parse({data:t,path:r.path,parent:r});return sl(r,(yield n4(n)?n:Promise.resolve(n)))})}refine(t,i){let r=t=>"string"==typeof i||typeof i>"u"?{message:i}:"function"==typeof i?i(t):i;return this._refinement((i,n)=>{let s=t(i),a=()=>n.addIssue(i3({code:nG.custom},r(i)));return"u">typeof Promise&&s instanceof Promise?s.then(t=>!!t||(a(),!1)):!!s||(a(),!1)})}refinement(t,i){return this._refinement((r,n)=>!!t(r)||(n.addIssue("function"==typeof i?i(r,n):i),!1))}_refinement(t){return new s1({schema:this,typeName:oi.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}optional(){return s3.create(this,this._def)}nullable(){return s2.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return sj.create(this,this._def)}promise(){return s0.create(this,this._def)}or(t){return sU.create([this,t],this._def)}and(t){return s$.create(this,t,this._def)}transform(t){return new s1(i2(i3({},su(this._def)),{schema:this,typeName:oi.ZodEffects,effect:{type:"transform",transform:t}}))}default(t){return new s9(i2(i3({},su(this._def)),{innerType:this,defaultValue:"function"==typeof t?t:()=>t,typeName:oi.ZodDefault}))}brand(){return new s7(i3({typeName:oi.ZodBranded,type:this},su(this._def)))}catch(t){return new s6(i2(i3({},su(this._def)),{innerType:this,catchValue:"function"==typeof t?t:()=>t,typeName:oi.ZodCatch}))}describe(t){return new this.constructor(i2(i3({},this._def),{description:t}))}pipe(t){return s8.create(this,t)}readonly(){return oe.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}},sd=/^c[^\s-]{8,}$/i,sp=/^[0-9a-z]+$/,sf=/^[0-9A-HJKMNP-TV-Z]{26}$/,sm=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,sv=/^[a-z0-9_-]{21}$/i,sg=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,sb=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,sy=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,s_=/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,sw=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,sE="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",sC=RegExp(`^${sE}$`);function sP(t){let i="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?i=`${i}\\.\\d{${t.precision}}`:null==t.precision&&(i=`${i}(\\.\\d+)?`),i}function sA(t){let i=`${sE}T${sP(t)}`,r=[];return r.push(t.local?"Z?":"Z"),t.offset&&r.push("([+-]\\d{2}:?\\d{2})"),i=`${i}(${r.join("|")})`,RegExp(`^${i}$`)}var sS=class t extends sh{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==nV.string){let i=this._getOrReturnCtx(t);return nQ(i,{code:nG.invalid_type,expected:nV.string,received:i.parsedType}),n0}let i=new nX,r;for(let a of this._def.checks)if("min"===a.kind)t.data.length<a.value&&(nQ(r=this._getOrReturnCtx(t,r),{code:nG.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),i.dirty());else if("max"===a.kind)t.data.length>a.value&&(nQ(r=this._getOrReturnCtx(t,r),{code:nG.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),i.dirty());else if("length"===a.kind){let n=t.data.length>a.value,s=t.data.length<a.value;(n||s)&&(r=this._getOrReturnCtx(t,r),n?nQ(r,{code:nG.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):s&&nQ(r,{code:nG.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),i.dirty())}else if("email"===a.kind)sb.test(t.data)||(nQ(r=this._getOrReturnCtx(t,r),{validation:"email",code:nG.invalid_string,message:a.message}),i.dirty());else if("emoji"===a.kind)sc||(sc=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),sc.test(t.data)||(nQ(r=this._getOrReturnCtx(t,r),{validation:"emoji",code:nG.invalid_string,message:a.message}),i.dirty());else if("uuid"===a.kind)sm.test(t.data)||(nQ(r=this._getOrReturnCtx(t,r),{validation:"uuid",code:nG.invalid_string,message:a.message}),i.dirty());else if("nanoid"===a.kind)sv.test(t.data)||(nQ(r=this._getOrReturnCtx(t,r),{validation:"nanoid",code:nG.invalid_string,message:a.message}),i.dirty());else if("cuid"===a.kind)sd.test(t.data)||(nQ(r=this._getOrReturnCtx(t,r),{validation:"cuid",code:nG.invalid_string,message:a.message}),i.dirty());else if("cuid2"===a.kind)sp.test(t.data)||(nQ(r=this._getOrReturnCtx(t,r),{validation:"cuid2",code:nG.invalid_string,message:a.message}),i.dirty());else if("ulid"===a.kind)sf.test(t.data)||(nQ(r=this._getOrReturnCtx(t,r),{validation:"ulid",code:nG.invalid_string,message:a.message}),i.dirty());else if("url"===a.kind)try{new URL(t.data)}catch{nQ(r=this._getOrReturnCtx(t,r),{validation:"url",code:nG.invalid_string,message:a.message}),i.dirty()}else{var n,s;"regex"===a.kind?(a.regex.lastIndex=0,a.regex.test(t.data)||(nQ(r=this._getOrReturnCtx(t,r),{validation:"regex",code:nG.invalid_string,message:a.message}),i.dirty())):"trim"===a.kind?t.data=t.data.trim():"includes"===a.kind?t.data.includes(a.value,a.position)||(nQ(r=this._getOrReturnCtx(t,r),{code:nG.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),i.dirty()):"toLowerCase"===a.kind?t.data=t.data.toLowerCase():"toUpperCase"===a.kind?t.data=t.data.toUpperCase():"startsWith"===a.kind?t.data.startsWith(a.value)||(nQ(r=this._getOrReturnCtx(t,r),{code:nG.invalid_string,validation:{startsWith:a.value},message:a.message}),i.dirty()):"endsWith"===a.kind?t.data.endsWith(a.value)||(nQ(r=this._getOrReturnCtx(t,r),{code:nG.invalid_string,validation:{endsWith:a.value},message:a.message}),i.dirty()):"datetime"===a.kind?sA(a).test(t.data)||(nQ(r=this._getOrReturnCtx(t,r),{code:nG.invalid_string,validation:"datetime",message:a.message}),i.dirty()):"date"===a.kind?sC.test(t.data)||(nQ(r=this._getOrReturnCtx(t,r),{code:nG.invalid_string,validation:"date",message:a.message}),i.dirty()):"time"===a.kind?RegExp(`^${sP(a)}$`).test(t.data)||(nQ(r=this._getOrReturnCtx(t,r),{code:nG.invalid_string,validation:"time",message:a.message}),i.dirty()):"duration"===a.kind?sg.test(t.data)||(nQ(r=this._getOrReturnCtx(t,r),{validation:"duration",code:nG.invalid_string,message:a.message}),i.dirty()):"ip"===a.kind?(n=t.data,("v4"===(s=a.version)||!s)&&sy.test(n)||("v6"===s||!s)&&s_.test(n)||(nQ(r=this._getOrReturnCtx(t,r),{validation:"ip",code:nG.invalid_string,message:a.message}),i.dirty())):"base64"===a.kind?sw.test(t.data)||(nQ(r=this._getOrReturnCtx(t,r),{validation:"base64",code:nG.invalid_string,message:a.message}),i.dirty()):si.assertNever(a)}return{status:i.value,value:t.data}}_regex(t,i,r){return this.refinement(i=>t.test(i),i3({validation:i,code:nG.invalid_string},sn.errToObj(r)))}_addCheck(i){return new t(i2(i3({},this._def),{checks:[...this._def.checks,i]}))}email(t){return this._addCheck(i3({kind:"email"},sn.errToObj(t)))}url(t){return this._addCheck(i3({kind:"url"},sn.errToObj(t)))}emoji(t){return this._addCheck(i3({kind:"emoji"},sn.errToObj(t)))}uuid(t){return this._addCheck(i3({kind:"uuid"},sn.errToObj(t)))}nanoid(t){return this._addCheck(i3({kind:"nanoid"},sn.errToObj(t)))}cuid(t){return this._addCheck(i3({kind:"cuid"},sn.errToObj(t)))}cuid2(t){return this._addCheck(i3({kind:"cuid2"},sn.errToObj(t)))}ulid(t){return this._addCheck(i3({kind:"ulid"},sn.errToObj(t)))}base64(t){return this._addCheck(i3({kind:"base64"},sn.errToObj(t)))}ip(t){return this._addCheck(i3({kind:"ip"},sn.errToObj(t)))}datetime(t){var i,r;return"string"==typeof t?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck(i3({kind:"datetime",precision:typeof(null==t?void 0:t.precision)>"u"?null:null==t?void 0:t.precision,offset:null!==(i=null==t?void 0:t.offset)&&void 0!==i&&i,local:null!==(r=null==t?void 0:t.local)&&void 0!==r&&r},sn.errToObj(null==t?void 0:t.message)))}date(t){return this._addCheck({kind:"date",message:t})}time(t){return"string"==typeof t?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck(i3({kind:"time",precision:typeof(null==t?void 0:t.precision)>"u"?null:null==t?void 0:t.precision},sn.errToObj(null==t?void 0:t.message)))}duration(t){return this._addCheck(i3({kind:"duration"},sn.errToObj(t)))}regex(t,i){return this._addCheck(i3({kind:"regex",regex:t},sn.errToObj(i)))}includes(t,i){return this._addCheck(i3({kind:"includes",value:t,position:null==i?void 0:i.position},sn.errToObj(null==i?void 0:i.message)))}startsWith(t,i){return this._addCheck(i3({kind:"startsWith",value:t},sn.errToObj(i)))}endsWith(t,i){return this._addCheck(i3({kind:"endsWith",value:t},sn.errToObj(i)))}min(t,i){return this._addCheck(i3({kind:"min",value:t},sn.errToObj(i)))}max(t,i){return this._addCheck(i3({kind:"max",value:t},sn.errToObj(i)))}length(t,i){return this._addCheck(i3({kind:"length",value:t},sn.errToObj(i)))}nonempty(t){return this.min(1,sn.errToObj(t))}trim(){return new t(i2(i3({},this._def),{checks:[...this._def.checks,{kind:"trim"}]}))}toLowerCase(){return new t(i2(i3({},this._def),{checks:[...this._def.checks,{kind:"toLowerCase"}]}))}toUpperCase(){return new t(i2(i3({},this._def),{checks:[...this._def.checks,{kind:"toUpperCase"}]}))}get isDatetime(){return!!this._def.checks.find(t=>"datetime"===t.kind)}get isDate(){return!!this._def.checks.find(t=>"date"===t.kind)}get isTime(){return!!this._def.checks.find(t=>"time"===t.kind)}get isDuration(){return!!this._def.checks.find(t=>"duration"===t.kind)}get isEmail(){return!!this._def.checks.find(t=>"email"===t.kind)}get isURL(){return!!this._def.checks.find(t=>"url"===t.kind)}get isEmoji(){return!!this._def.checks.find(t=>"emoji"===t.kind)}get isUUID(){return!!this._def.checks.find(t=>"uuid"===t.kind)}get isNANOID(){return!!this._def.checks.find(t=>"nanoid"===t.kind)}get isCUID(){return!!this._def.checks.find(t=>"cuid"===t.kind)}get isCUID2(){return!!this._def.checks.find(t=>"cuid2"===t.kind)}get isULID(){return!!this._def.checks.find(t=>"ulid"===t.kind)}get isIP(){return!!this._def.checks.find(t=>"ip"===t.kind)}get isBase64(){return!!this._def.checks.find(t=>"base64"===t.kind)}get minLength(){let t=null;for(let i of this._def.checks)"min"===i.kind&&(null===t||i.value>t)&&(t=i.value);return t}get maxLength(){let t=null;for(let i of this._def.checks)"max"===i.kind&&(null===t||i.value<t)&&(t=i.value);return t}};sS.create=t=>{var i;return new sS(i3({checks:[],typeName:oi.ZodString,coerce:null!==(i=null==t?void 0:t.coerce)&&void 0!==i&&i},su(t)))};var sO=class t extends sh{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==nV.number){let i=this._getOrReturnCtx(t);return nQ(i,{code:nG.invalid_type,expected:nV.number,received:i.parsedType}),n0}let i,r=new nX;for(let n of this._def.checks)"int"===n.kind?si.isInteger(t.data)||(nQ(i=this._getOrReturnCtx(t,i),{code:nG.invalid_type,expected:"integer",received:"float",message:n.message}),r.dirty()):"min"===n.kind?(n.inclusive?t.data<n.value:t.data<=n.value)&&(nQ(i=this._getOrReturnCtx(t,i),{code:nG.too_small,minimum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?t.data>n.value:t.data>=n.value)&&(nQ(i=this._getOrReturnCtx(t,i),{code:nG.too_big,maximum:n.value,type:"number",inclusive:n.inclusive,exact:!1,message:n.message}),r.dirty()):"multipleOf"===n.kind?0!==function(t,i){let r=(t.toString().split(".")[1]||"").length,n=(i.toString().split(".")[1]||"").length,s=r>n?r:n;return parseInt(t.toFixed(s).replace(".",""))%parseInt(i.toFixed(s).replace(".",""))/Math.pow(10,s)}(t.data,n.value)&&(nQ(i=this._getOrReturnCtx(t,i),{code:nG.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):"finite"===n.kind?Number.isFinite(t.data)||(nQ(i=this._getOrReturnCtx(t,i),{code:nG.not_finite,message:n.message}),r.dirty()):si.assertNever(n);return{status:r.value,value:t.data}}gte(t,i){return this.setLimit("min",t,!0,sn.toString(i))}gt(t,i){return this.setLimit("min",t,!1,sn.toString(i))}lte(t,i){return this.setLimit("max",t,!0,sn.toString(i))}lt(t,i){return this.setLimit("max",t,!1,sn.toString(i))}setLimit(i,r,n,s){return new t(i2(i3({},this._def),{checks:[...this._def.checks,{kind:i,value:r,inclusive:n,message:sn.toString(s)}]}))}_addCheck(i){return new t(i2(i3({},this._def),{checks:[...this._def.checks,i]}))}int(t){return this._addCheck({kind:"int",message:sn.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:sn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:sn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:sn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:sn.toString(t)})}multipleOf(t,i){return this._addCheck({kind:"multipleOf",value:t,message:sn.toString(i)})}finite(t){return this._addCheck({kind:"finite",message:sn.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:sn.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:sn.toString(t)})}get minValue(){let t=null;for(let i of this._def.checks)"min"===i.kind&&(null===t||i.value>t)&&(t=i.value);return t}get maxValue(){let t=null;for(let i of this._def.checks)"max"===i.kind&&(null===t||i.value<t)&&(t=i.value);return t}get isInt(){return!!this._def.checks.find(t=>"int"===t.kind||"multipleOf"===t.kind&&si.isInteger(t.value))}get isFinite(){let t=null,i=null;for(let r of this._def.checks){if("finite"===r.kind||"int"===r.kind||"multipleOf"===r.kind)return!0;"min"===r.kind?(null===i||r.value>i)&&(i=r.value):"max"===r.kind&&(null===t||r.value<t)&&(t=r.value)}return Number.isFinite(i)&&Number.isFinite(t)}};sO.create=t=>new sO(i3({checks:[],typeName:oi.ZodNumber,coerce:(null==t?void 0:t.coerce)||!1},su(t)));var sT=class t extends sh{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce&&(t.data=BigInt(t.data)),this._getType(t)!==nV.bigint){let i=this._getOrReturnCtx(t);return nQ(i,{code:nG.invalid_type,expected:nV.bigint,received:i.parsedType}),n0}let i,r=new nX;for(let n of this._def.checks)"min"===n.kind?(n.inclusive?t.data<n.value:t.data<=n.value)&&(nQ(i=this._getOrReturnCtx(t,i),{code:nG.too_small,type:"bigint",minimum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"max"===n.kind?(n.inclusive?t.data>n.value:t.data>=n.value)&&(nQ(i=this._getOrReturnCtx(t,i),{code:nG.too_big,type:"bigint",maximum:n.value,inclusive:n.inclusive,message:n.message}),r.dirty()):"multipleOf"===n.kind?t.data%n.value!==BigInt(0)&&(nQ(i=this._getOrReturnCtx(t,i),{code:nG.not_multiple_of,multipleOf:n.value,message:n.message}),r.dirty()):si.assertNever(n);return{status:r.value,value:t.data}}gte(t,i){return this.setLimit("min",t,!0,sn.toString(i))}gt(t,i){return this.setLimit("min",t,!1,sn.toString(i))}lte(t,i){return this.setLimit("max",t,!0,sn.toString(i))}lt(t,i){return this.setLimit("max",t,!1,sn.toString(i))}setLimit(i,r,n,s){return new t(i2(i3({},this._def),{checks:[...this._def.checks,{kind:i,value:r,inclusive:n,message:sn.toString(s)}]}))}_addCheck(i){return new t(i2(i3({},this._def),{checks:[...this._def.checks,i]}))}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:sn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:sn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:sn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:sn.toString(t)})}multipleOf(t,i){return this._addCheck({kind:"multipleOf",value:t,message:sn.toString(i)})}get minValue(){let t=null;for(let i of this._def.checks)"min"===i.kind&&(null===t||i.value>t)&&(t=i.value);return t}get maxValue(){let t=null;for(let i of this._def.checks)"max"===i.kind&&(null===t||i.value<t)&&(t=i.value);return t}};sT.create=t=>{var i;return new sT(i3({checks:[],typeName:oi.ZodBigInt,coerce:null!==(i=null==t?void 0:t.coerce)&&void 0!==i&&i},su(t)))};var sx=class extends sh{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==nV.boolean){let i=this._getOrReturnCtx(t);return nQ(i,{code:nG.invalid_type,expected:nV.boolean,received:i.parsedType}),n0}return n3(t.data)}};sx.create=t=>new sx(i3({typeName:oi.ZodBoolean,coerce:(null==t?void 0:t.coerce)||!1},su(t)));var sk=class t extends sh{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==nV.date){let i=this._getOrReturnCtx(t);return nQ(i,{code:nG.invalid_type,expected:nV.date,received:i.parsedType}),n0}if(isNaN(t.data.getTime()))return nQ(this._getOrReturnCtx(t),{code:nG.invalid_date}),n0;let i=new nX,r;for(let n of this._def.checks)"min"===n.kind?t.data.getTime()<n.value&&(nQ(r=this._getOrReturnCtx(t,r),{code:nG.too_small,message:n.message,inclusive:!0,exact:!1,minimum:n.value,type:"date"}),i.dirty()):"max"===n.kind?t.data.getTime()>n.value&&(nQ(r=this._getOrReturnCtx(t,r),{code:nG.too_big,message:n.message,inclusive:!0,exact:!1,maximum:n.value,type:"date"}),i.dirty()):si.assertNever(n);return{status:i.value,value:new Date(t.data.getTime())}}_addCheck(i){return new t(i2(i3({},this._def),{checks:[...this._def.checks,i]}))}min(t,i){return this._addCheck({kind:"min",value:t.getTime(),message:sn.toString(i)})}max(t,i){return this._addCheck({kind:"max",value:t.getTime(),message:sn.toString(i)})}get minDate(){let t=null;for(let i of this._def.checks)"min"===i.kind&&(null===t||i.value>t)&&(t=i.value);return null!=t?new Date(t):null}get maxDate(){let t=null;for(let i of this._def.checks)"max"===i.kind&&(null===t||i.value<t)&&(t=i.value);return null!=t?new Date(t):null}};sk.create=t=>new sk(i3({checks:[],coerce:(null==t?void 0:t.coerce)||!1,typeName:oi.ZodDate},su(t)));var sI=class extends sh{_parse(t){if(this._getType(t)!==nV.symbol){let i=this._getOrReturnCtx(t);return nQ(i,{code:nG.invalid_type,expected:nV.symbol,received:i.parsedType}),n0}return n3(t.data)}};sI.create=t=>new sI(i3({typeName:oi.ZodSymbol},su(t)));var sM=class extends sh{_parse(t){if(this._getType(t)!==nV.undefined){let i=this._getOrReturnCtx(t);return nQ(i,{code:nG.invalid_type,expected:nV.undefined,received:i.parsedType}),n0}return n3(t.data)}};sM.create=t=>new sM(i3({typeName:oi.ZodUndefined},su(t)));var sR=class extends sh{_parse(t){if(this._getType(t)!==nV.null){let i=this._getOrReturnCtx(t);return nQ(i,{code:nG.invalid_type,expected:nV.null,received:i.parsedType}),n0}return n3(t.data)}};sR.create=t=>new sR(i3({typeName:oi.ZodNull},su(t)));var sF=class extends sh{constructor(){super(...arguments),this._any=!0}_parse(t){return n3(t.data)}};sF.create=t=>new sF(i3({typeName:oi.ZodAny},su(t)));var sL=class extends sh{constructor(){super(...arguments),this._unknown=!0}_parse(t){return n3(t.data)}};sL.create=t=>new sL(i3({typeName:oi.ZodUnknown},su(t)));var sN=class extends sh{_parse(t){let i=this._getOrReturnCtx(t);return nQ(i,{code:nG.invalid_type,expected:nV.never,received:i.parsedType}),n0}};sN.create=t=>new sN(i3({typeName:oi.ZodNever},su(t)));var sD=class extends sh{_parse(t){if(this._getType(t)!==nV.undefined){let i=this._getOrReturnCtx(t);return nQ(i,{code:nG.invalid_type,expected:nV.void,received:i.parsedType}),n0}return n3(t.data)}};sD.create=t=>new sD(i3({typeName:oi.ZodVoid},su(t)));var sj=class t extends sh{_parse(t){let{ctx:i,status:r}=this._processInputParams(t),n=this._def;if(i.parsedType!==nV.array)return nQ(i,{code:nG.invalid_type,expected:nV.array,received:i.parsedType}),n0;if(null!==n.exactLength){let t=i.data.length>n.exactLength.value,s=i.data.length<n.exactLength.value;(t||s)&&(nQ(i,{code:t?nG.too_big:nG.too_small,minimum:s?n.exactLength.value:void 0,maximum:t?n.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:n.exactLength.message}),r.dirty())}if(null!==n.minLength&&i.data.length<n.minLength.value&&(nQ(i,{code:nG.too_small,minimum:n.minLength.value,type:"array",inclusive:!0,exact:!1,message:n.minLength.message}),r.dirty()),null!==n.maxLength&&i.data.length>n.maxLength.value&&(nQ(i,{code:nG.too_big,maximum:n.maxLength.value,type:"array",inclusive:!0,exact:!1,message:n.maxLength.message}),r.dirty()),i.common.async)return Promise.all([...i.data].map((t,r)=>n.type._parseAsync(new sa(i,t,i.path,r)))).then(t=>nX.mergeArray(r,t));let s=[...i.data].map((t,r)=>n.type._parseSync(new sa(i,t,i.path,r)));return nX.mergeArray(r,s)}get element(){return this._def.type}min(i,r){return new t(i2(i3({},this._def),{minLength:{value:i,message:sn.toString(r)}}))}max(i,r){return new t(i2(i3({},this._def),{maxLength:{value:i,message:sn.toString(r)}}))}length(i,r){return new t(i2(i3({},this._def),{exactLength:{value:i,message:sn.toString(r)}}))}nonempty(t){return this.min(1,t)}};sj.create=(t,i)=>new sj(i3({type:t,minLength:null,maxLength:null,exactLength:null,typeName:oi.ZodArray},su(i)));var sB=class t extends sh{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;let t=this._def.shape(),i=si.objectKeys(t);return this._cached={shape:t,keys:i}}_parse(t){if(this._getType(t)!==nV.object){let i=this._getOrReturnCtx(t);return nQ(i,{code:nG.invalid_type,expected:nV.object,received:i.parsedType}),n0}let{status:i,ctx:r}=this._processInputParams(t),{shape:n,keys:s}=this._getCached(),a=[];if(!(this._def.catchall instanceof sN&&"strip"===this._def.unknownKeys))for(let t in r.data)s.includes(t)||a.push(t);let l=[];for(let t of s){let i=n[t],s=r.data[t];l.push({key:{status:"valid",value:t},value:i._parse(new sa(r,s,r.path,t)),alwaysSet:t in r.data})}if(this._def.catchall instanceof sN){let t=this._def.unknownKeys;if("passthrough"===t)for(let t of a)l.push({key:{status:"valid",value:t},value:{status:"valid",value:r.data[t]}});else if("strict"===t)a.length>0&&(nQ(r,{code:nG.unrecognized_keys,keys:a}),i.dirty());else if("strip"!==t)throw Error("Internal ZodObject error: invalid unknownKeys value.")}else{let t=this._def.catchall;for(let i of a){let n=r.data[i];l.push({key:{status:"valid",value:i},value:t._parse(new sa(r,n,r.path,i)),alwaysSet:i in r.data})}}return r.common.async?Promise.resolve().then(()=>i6(this,null,function*(){let t=[];for(let i of l){let r=yield i.key,n=yield i.value;t.push({key:r,value:n,alwaysSet:i.alwaysSet})}return t})).then(t=>nX.mergeObjectSync(i,t)):nX.mergeObjectSync(i,l)}get shape(){return this._def.shape()}strict(i){return sn.errToObj,new t(i3(i2(i3({},this._def),{unknownKeys:"strict"}),void 0!==i?{errorMap:(t,r)=>{var n,s,a,l;let u=null!==(a=null===(s=(n=this._def).errorMap)||void 0===s?void 0:s.call(n,t,r).message)&&void 0!==a?a:r.defaultError;return"unrecognized_keys"===t.code?{message:null!==(l=sn.errToObj(i).message)&&void 0!==l?l:u}:{message:u}}}:{}))}strip(){return new t(i2(i3({},this._def),{unknownKeys:"strip"}))}passthrough(){return new t(i2(i3({},this._def),{unknownKeys:"passthrough"}))}extend(i){return new t(i2(i3({},this._def),{shape:()=>i3(i3({},this._def.shape()),i)}))}merge(i){return new t({unknownKeys:i._def.unknownKeys,catchall:i._def.catchall,shape:()=>i3(i3({},this._def.shape()),i._def.shape()),typeName:oi.ZodObject})}setKey(t,i){return this.augment({[t]:i})}catchall(i){return new t(i2(i3({},this._def),{catchall:i}))}pick(i){let r={};return si.objectKeys(i).forEach(t=>{i[t]&&this.shape[t]&&(r[t]=this.shape[t])}),new t(i2(i3({},this._def),{shape:()=>r}))}omit(i){let r={};return si.objectKeys(this.shape).forEach(t=>{i[t]||(r[t]=this.shape[t])}),new t(i2(i3({},this._def),{shape:()=>r}))}deepPartial(){return function t(i){if(!(i instanceof sB))return i instanceof sj?new sj(i2(i3({},i._def),{type:t(i.element)})):i instanceof s3?s3.create(t(i.unwrap())):i instanceof s2?s2.create(t(i.unwrap())):i instanceof sV?sV.create(i.items.map(i=>t(i))):i;{let r={};for(let n in i.shape){let s=i.shape[n];r[n]=s3.create(t(s))}return new sB(i2(i3({},i._def),{shape:()=>r}))}}(this)}partial(i){let r={};return si.objectKeys(this.shape).forEach(t=>{let n=this.shape[t];i&&!i[t]?r[t]=n:r[t]=n.optional()}),new t(i2(i3({},this._def),{shape:()=>r}))}required(i){let r={};return si.objectKeys(this.shape).forEach(t=>{if(i&&!i[t])r[t]=this.shape[t];else{let i=this.shape[t];for(;i instanceof s3;)i=i._def.innerType;r[t]=i}}),new t(i2(i3({},this._def),{shape:()=>r}))}keyof(){return sY(si.objectKeys(this.shape))}};sB.create=(t,i)=>new sB(i3({shape:()=>t,unknownKeys:"strip",catchall:sN.create(),typeName:oi.ZodObject},su(i))),sB.strictCreate=(t,i)=>new sB(i3({shape:()=>t,unknownKeys:"strict",catchall:sN.create(),typeName:oi.ZodObject},su(i))),sB.lazycreate=(t,i)=>new sB(i3({shape:t,unknownKeys:"strip",catchall:sN.create(),typeName:oi.ZodObject},su(i)));var sU=class extends sh{_parse(t){let{ctx:i}=this._processInputParams(t),r=this._def.options;if(i.common.async)return Promise.all(r.map(t=>i6(this,null,function*(){let r=i2(i3({},i),{common:i2(i3({},i.common),{issues:[]}),parent:null});return{result:yield t._parseAsync({data:i.data,path:i.path,parent:r}),ctx:r}}))).then(function(t){for(let i of t)if("valid"===i.result.status)return i.result;for(let r of t)if("dirty"===r.result.status)return i.common.issues.push(...r.ctx.common.issues),r.result;let r=t.map(t=>new nJ(t.ctx.common.issues));return nQ(i,{code:nG.invalid_union,unionErrors:r}),n0});{let t,n=[];for(let s of r){let r=i2(i3({},i),{common:i2(i3({},i.common),{issues:[]}),parent:null}),a=s._parseSync({data:i.data,path:i.path,parent:r});if("valid"===a.status)return a;"dirty"!==a.status||t||(t={result:a,ctx:r}),r.common.issues.length&&n.push(r.common.issues)}if(t)return i.common.issues.push(...t.ctx.common.issues),t.result;let s=n.map(t=>new nJ(t));return nQ(i,{code:nG.invalid_union,unionErrors:s}),n0}}get options(){return this._def.options}};sU.create=(t,i)=>new sU(i3({options:t,typeName:oi.ZodUnion},su(i)));var sz=t=>t instanceof sH?sz(t.schema):t instanceof s1?sz(t.innerType()):t instanceof sK?[t.value]:t instanceof sQ?t.options:t instanceof sX?si.objectValues(t.enum):t instanceof s9?sz(t._def.innerType):t instanceof sM?[void 0]:t instanceof sR?[null]:t instanceof s3?[void 0,...sz(t.unwrap())]:t instanceof s2?[null,...sz(t.unwrap())]:t instanceof s7||t instanceof oe?sz(t.unwrap()):t instanceof s6?sz(t._def.innerType):[],sW=class t extends sh{_parse(t){let{ctx:i}=this._processInputParams(t);if(i.parsedType!==nV.object)return nQ(i,{code:nG.invalid_type,expected:nV.object,received:i.parsedType}),n0;let r=this.discriminator,n=i.data[r],s=this.optionsMap.get(n);return s?i.common.async?s._parseAsync({data:i.data,path:i.path,parent:i}):s._parseSync({data:i.data,path:i.path,parent:i}):(nQ(i,{code:nG.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),n0)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(i,r,n){let s=new Map;for(let t of r){let r=sz(t.shape[i]);if(!r.length)throw Error(`A discriminator value for key \`${i}\` could not be extracted from all schema options`);for(let n of r){if(s.has(n))throw Error(`Discriminator property ${String(i)} has duplicate value ${String(n)}`);s.set(n,t)}}return new t(i3({typeName:oi.ZodDiscriminatedUnion,discriminator:i,options:r,optionsMap:s},su(n)))}},s$=class extends sh{_parse(t){let{status:i,ctx:r}=this._processInputParams(t),n=(t,n)=>{if(n2(t)||n2(n))return n0;let s=function t(i,r){let n=nZ(i),s=nZ(r);if(i===r)return{valid:!0,data:i};if(n===nV.object&&s===nV.object){let n=si.objectKeys(r),s=si.objectKeys(i).filter(t=>-1!==n.indexOf(t)),a=i3(i3({},i),r);for(let n of s){let s=t(i[n],r[n]);if(!s.valid)return{valid:!1};a[n]=s.data}return{valid:!0,data:a}}if(n!==nV.array||s!==nV.array)return n===nV.date&&s===nV.date&&+i==+r?{valid:!0,data:i}:{valid:!1};{if(i.length!==r.length)return{valid:!1};let n=[];for(let s=0;s<i.length;s++){let a=t(i[s],r[s]);if(!a.valid)return{valid:!1};n.push(a.data)}return{valid:!0,data:n}}}(t.value,n.value);return s.valid?((n9(t)||n9(n))&&i.dirty(),{status:i.value,value:s.data}):(nQ(r,{code:nG.invalid_intersection_types}),n0)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([t,i])=>n(t,i)):n(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}};s$.create=(t,i,r)=>new s$(i3({left:t,right:i,typeName:oi.ZodIntersection},su(r)));var sV=class t extends sh{_parse(t){let{status:i,ctx:r}=this._processInputParams(t);if(r.parsedType!==nV.array)return nQ(r,{code:nG.invalid_type,expected:nV.array,received:r.parsedType}),n0;if(r.data.length<this._def.items.length)return nQ(r,{code:nG.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n0;!this._def.rest&&r.data.length>this._def.items.length&&(nQ(r,{code:nG.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),i.dirty());let n=[...r.data].map((t,i)=>{let n=this._def.items[i]||this._def.rest;return n?n._parse(new sa(r,t,r.path,i)):null}).filter(t=>!!t);return r.common.async?Promise.all(n).then(t=>nX.mergeArray(i,t)):nX.mergeArray(i,n)}get items(){return this._def.items}rest(i){return new t(i2(i3({},this._def),{rest:i}))}};sV.create=(t,i)=>{if(!Array.isArray(t))throw Error("You must pass an array of schemas to z.tuple([ ... ])");return new sV(i3({items:t,typeName:oi.ZodTuple,rest:null},su(i)))};var sZ=class t extends sh{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){let{status:i,ctx:r}=this._processInputParams(t);if(r.parsedType!==nV.object)return nQ(r,{code:nG.invalid_type,expected:nV.object,received:r.parsedType}),n0;let n=[],s=this._def.keyType,a=this._def.valueType;for(let t in r.data)n.push({key:s._parse(new sa(r,t,r.path,t)),value:a._parse(new sa(r,r.data[t],r.path,t)),alwaysSet:t in r.data});return r.common.async?nX.mergeObjectAsync(i,n):nX.mergeObjectSync(i,n)}get element(){return this._def.valueType}static create(i,r,n){return new t(r instanceof sh?i3({keyType:i,valueType:r,typeName:oi.ZodRecord},su(n)):i3({keyType:sS.create(),valueType:i,typeName:oi.ZodRecord},su(r)))}},sG=class extends sh{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){let{status:i,ctx:r}=this._processInputParams(t);if(r.parsedType!==nV.map)return nQ(r,{code:nG.invalid_type,expected:nV.map,received:r.parsedType}),n0;let n=this._def.keyType,s=this._def.valueType,a=[...r.data.entries()].map(([t,i],a)=>({key:n._parse(new sa(r,t,r.path,[a,"key"])),value:s._parse(new sa(r,i,r.path,[a,"value"]))}));if(r.common.async){let t=new Map;return Promise.resolve().then(()=>i6(this,null,function*(){for(let r of a){let n=yield r.key,s=yield r.value;if("aborted"===n.status||"aborted"===s.status)return n0;("dirty"===n.status||"dirty"===s.status)&&i.dirty(),t.set(n.value,s.value)}return{status:i.value,value:t}}))}{let t=new Map;for(let r of a){let n=r.key,s=r.value;if("aborted"===n.status||"aborted"===s.status)return n0;("dirty"===n.status||"dirty"===s.status)&&i.dirty(),t.set(n.value,s.value)}return{status:i.value,value:t}}}};sG.create=(t,i,r)=>new sG(i3({valueType:i,keyType:t,typeName:oi.ZodMap},su(r)));var sJ=class t extends sh{_parse(t){let{status:i,ctx:r}=this._processInputParams(t);if(r.parsedType!==nV.set)return nQ(r,{code:nG.invalid_type,expected:nV.set,received:r.parsedType}),n0;let n=this._def;null!==n.minSize&&r.data.size<n.minSize.value&&(nQ(r,{code:nG.too_small,minimum:n.minSize.value,type:"set",inclusive:!0,exact:!1,message:n.minSize.message}),i.dirty()),null!==n.maxSize&&r.data.size>n.maxSize.value&&(nQ(r,{code:nG.too_big,maximum:n.maxSize.value,type:"set",inclusive:!0,exact:!1,message:n.maxSize.message}),i.dirty());let s=this._def.valueType;function a(t){let r=new Set;for(let n of t){if("aborted"===n.status)return n0;"dirty"===n.status&&i.dirty(),r.add(n.value)}return{status:i.value,value:r}}let l=[...r.data.values()].map((t,i)=>s._parse(new sa(r,t,r.path,i)));return r.common.async?Promise.all(l).then(t=>a(t)):a(l)}min(i,r){return new t(i2(i3({},this._def),{minSize:{value:i,message:sn.toString(r)}}))}max(i,r){return new t(i2(i3({},this._def),{maxSize:{value:i,message:sn.toString(r)}}))}size(t,i){return this.min(t,i).max(t,i)}nonempty(t){return this.min(1,t)}};sJ.create=(t,i)=>new sJ(i3({valueType:t,minSize:null,maxSize:null,typeName:oi.ZodSet},su(i)));var sq=class t extends sh{constructor(){super(...arguments),this.validate=this.implement}_parse(t){let{ctx:i}=this._processInputParams(t);if(i.parsedType!==nV.function)return nQ(i,{code:nG.invalid_type,expected:nV.function,received:i.parsedType}),n0;function r(t,r){return nY({data:t,path:i.path,errorMaps:[i.common.contextualErrorMap,i.schemaErrorMap,nK(),nq].filter(t=>!!t),issueData:{code:nG.invalid_arguments,argumentsError:r}})}function n(t,r){return nY({data:t,path:i.path,errorMaps:[i.common.contextualErrorMap,i.schemaErrorMap,nK(),nq].filter(t=>!!t),issueData:{code:nG.invalid_return_type,returnTypeError:r}})}let s={errorMap:i.common.contextualErrorMap},a=i.data;if(this._def.returns instanceof s0){let t=this;return n3(function(...i){return i6(this,null,function*(){let l=new nJ([]),u=yield t._def.args.parseAsync(i,s).catch(t=>{throw l.addIssue(r(i,t)),l}),c=yield Reflect.apply(a,this,u);return yield t._def.returns._def.type.parseAsync(c,s).catch(t=>{throw l.addIssue(n(c,t)),l})})})}{let t=this;return n3(function(...i){let l=t._def.args.safeParse(i,s);if(!l.success)throw new nJ([r(i,l.error)]);let u=Reflect.apply(a,this,l.data),c=t._def.returns.safeParse(u,s);if(!c.success)throw new nJ([n(u,c.error)]);return c.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...i){return new t(i2(i3({},this._def),{args:sV.create(i).rest(sL.create())}))}returns(i){return new t(i2(i3({},this._def),{returns:i}))}implement(t){return this.parse(t)}strictImplement(t){return this.parse(t)}static create(i,r,n){return new t(i3({args:i||sV.create([]).rest(sL.create()),returns:r||sL.create(),typeName:oi.ZodFunction},su(n)))}},sH=class extends sh{get schema(){return this._def.getter()}_parse(t){let{ctx:i}=this._processInputParams(t);return this._def.getter()._parse({data:i.data,path:i.path,parent:i})}};sH.create=(t,i)=>new sH(i3({getter:t,typeName:oi.ZodLazy},su(i)));var sK=class extends sh{_parse(t){if(t.data!==this._def.value){let i=this._getOrReturnCtx(t);return nQ(i,{received:i.data,code:nG.invalid_literal,expected:this._def.value}),n0}return{status:"valid",value:t.data}}get value(){return this._def.value}};function sY(t,i){return new sQ(i3({values:t,typeName:oi.ZodEnum},su(i)))}sK.create=(t,i)=>new sK(i3({value:t,typeName:oi.ZodLiteral},su(i)));var sQ=class t extends sh{constructor(){super(...arguments),ss.set(this,void 0)}_parse(t){if("string"!=typeof t.data){let i=this._getOrReturnCtx(t),r=this._def.values;return nQ(i,{expected:si.joinValues(r),received:i.parsedType,code:nG.invalid_type}),n0}if(n5(this,ss)||n7(this,ss,new Set(this._def.values)),!n5(this,ss).has(t.data)){let i=this._getOrReturnCtx(t),r=this._def.values;return nQ(i,{received:i.data,code:nG.invalid_enum_value,options:r}),n0}return n3(t.data)}get options(){return this._def.values}get enum(){let t={};for(let i of this._def.values)t[i]=i;return t}get Values(){let t={};for(let i of this._def.values)t[i]=i;return t}get Enum(){let t={};for(let i of this._def.values)t[i]=i;return t}extract(i,r=this._def){return t.create(i,i3(i3({},this._def),r))}exclude(i,r=this._def){return t.create(this.options.filter(t=>!i.includes(t)),i3(i3({},this._def),r))}};ss=new WeakMap,sQ.create=sY;var sX=class extends sh{constructor(){super(...arguments),so.set(this,void 0)}_parse(t){let i=si.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==nV.string&&r.parsedType!==nV.number){let t=si.objectValues(i);return nQ(r,{expected:si.joinValues(t),received:r.parsedType,code:nG.invalid_type}),n0}if(n5(this,so)||n7(this,so,new Set(si.getValidEnumValues(this._def.values))),!n5(this,so).has(t.data)){let t=si.objectValues(i);return nQ(r,{received:r.data,code:nG.invalid_enum_value,options:t}),n0}return n3(t.data)}get enum(){return this._def.values}};so=new WeakMap,sX.create=(t,i)=>new sX(i3({values:t,typeName:oi.ZodNativeEnum},su(i)));var s0=class extends sh{unwrap(){return this._def.type}_parse(t){let{ctx:i}=this._processInputParams(t);return i.parsedType!==nV.promise&&!1===i.common.async?(nQ(i,{code:nG.invalid_type,expected:nV.promise,received:i.parsedType}),n0):n3((i.parsedType===nV.promise?i.data:Promise.resolve(i.data)).then(t=>this._def.type.parseAsync(t,{path:i.path,errorMap:i.common.contextualErrorMap})))}};s0.create=(t,i)=>new s0(i3({type:t,typeName:oi.ZodPromise},su(i)));var s1=class extends sh{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===oi.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){let{status:i,ctx:r}=this._processInputParams(t),n=this._def.effect||null,s={addIssue:t=>{nQ(r,t),t.fatal?i.abort():i.dirty()},get path(){return r.path}};if(s.addIssue=s.addIssue.bind(s),"preprocess"===n.type){let t=n.transform(r.data,s);if(r.common.async)return Promise.resolve(t).then(t=>i6(this,null,function*(){if("aborted"===i.value)return n0;let n=yield this._def.schema._parseAsync({data:t,path:r.path,parent:r});return"aborted"===n.status?n0:"dirty"===n.status||"dirty"===i.value?n1(n.value):n}));{if("aborted"===i.value)return n0;let n=this._def.schema._parseSync({data:t,path:r.path,parent:r});return"aborted"===n.status?n0:"dirty"===n.status||"dirty"===i.value?n1(n.value):n}}if("refinement"===n.type){let t=t=>{let i=n.refinement(t,s);if(r.common.async)return Promise.resolve(i);if(i instanceof Promise)throw Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return t};if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(r=>"aborted"===r.status?n0:("dirty"===r.status&&i.dirty(),t(r.value).then(()=>({status:i.value,value:r.value}))));{let n=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===n.status?n0:("dirty"===n.status&&i.dirty(),t(n.value),{status:i.value,value:n.value})}}if("transform"===n.type){if(!1!==r.common.async)return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(t=>n6(t)?Promise.resolve(n.transform(t.value,s)).then(t=>({status:i.value,value:t})):t);{let t=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!n6(t))return t;let a=n.transform(t.value,s);if(a instanceof Promise)throw Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:i.value,value:a}}}si.assertNever(n)}};s1.create=(t,i,r)=>new s1(i3({schema:t,typeName:oi.ZodEffects,effect:i},su(r))),s1.createWithPreprocess=(t,i,r)=>new s1(i3({schema:i,effect:{type:"preprocess",transform:t},typeName:oi.ZodEffects},su(r)));var s3=class extends sh{_parse(t){return this._getType(t)===nV.undefined?n3(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}};s3.create=(t,i)=>new s3(i3({innerType:t,typeName:oi.ZodOptional},su(i)));var s2=class extends sh{_parse(t){return this._getType(t)===nV.null?n3(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}};s2.create=(t,i)=>new s2(i3({innerType:t,typeName:oi.ZodNullable},su(i)));var s9=class extends sh{_parse(t){let{ctx:i}=this._processInputParams(t),r=i.data;return i.parsedType===nV.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:i.path,parent:i})}removeDefault(){return this._def.innerType}};s9.create=(t,i)=>new s9(i3({innerType:t,typeName:oi.ZodDefault,defaultValue:"function"==typeof i.default?i.default:()=>i.default},su(i)));var s6=class extends sh{_parse(t){let{ctx:i}=this._processInputParams(t),r=i2(i3({},i),{common:i2(i3({},i.common),{issues:[]})}),n=this._def.innerType._parse({data:r.data,path:r.path,parent:i3({},r)});return n4(n)?n.then(t=>({status:"valid",value:"valid"===t.status?t.value:this._def.catchValue({get error(){return new nJ(r.common.issues)},input:r.data})})):{status:"valid",value:"valid"===n.status?n.value:this._def.catchValue({get error(){return new nJ(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}};s6.create=(t,i)=>new s6(i3({innerType:t,typeName:oi.ZodCatch,catchValue:"function"==typeof i.catch?i.catch:()=>i.catch},su(i)));var s4=class extends sh{_parse(t){if(this._getType(t)!==nV.nan){let i=this._getOrReturnCtx(t);return nQ(i,{code:nG.invalid_type,expected:nV.nan,received:i.parsedType}),n0}return{status:"valid",value:t.data}}};s4.create=t=>new s4(i3({typeName:oi.ZodNaN},su(t)));var s5=Symbol("zod_brand"),s7=class extends sh{_parse(t){let{ctx:i}=this._processInputParams(t),r=i.data;return this._def.type._parse({data:r,path:i.path,parent:i})}unwrap(){return this._def.type}},s8=class t extends sh{_parse(t){let{status:i,ctx:r}=this._processInputParams(t);if(r.common.async)return i6(this,null,function*(){let t=yield this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return"aborted"===t.status?n0:"dirty"===t.status?(i.dirty(),n1(t.value)):this._def.out._parseAsync({data:t.value,path:r.path,parent:r})});{let t=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return"aborted"===t.status?n0:"dirty"===t.status?(i.dirty(),{status:"dirty",value:t.value}):this._def.out._parseSync({data:t.value,path:r.path,parent:r})}}static create(i,r){return new t({in:i,out:r,typeName:oi.ZodPipeline})}},oe=class extends sh{_parse(t){let i=this._def.innerType._parse(t),r=t=>(n6(t)&&(t.value=Object.freeze(t.value)),t);return n4(i)?i.then(t=>r(t)):r(i)}unwrap(){return this._def.innerType}};function ot(t,i={},r){return t?sF.create().superRefine((n,s)=>{var a,l;if(!t(n)){let t="function"==typeof i?i(n):"string"==typeof i?{message:i}:i,u=null===(l=null!==(a=t.fatal)&&void 0!==a?a:r)||void 0===l||l;s.addIssue(i2(i3({code:"custom"},"string"==typeof t?{message:t}:t),{fatal:u}))}}):sF.create()}oe.create=(t,i)=>new oe(i3({innerType:t,typeName:oi.ZodReadonly},su(i)));var oi,or={object:sB.lazycreate};(z=oi||(oi={})).ZodString="ZodString",z.ZodNumber="ZodNumber",z.ZodNaN="ZodNaN",z.ZodBigInt="ZodBigInt",z.ZodBoolean="ZodBoolean",z.ZodDate="ZodDate",z.ZodSymbol="ZodSymbol",z.ZodUndefined="ZodUndefined",z.ZodNull="ZodNull",z.ZodAny="ZodAny",z.ZodUnknown="ZodUnknown",z.ZodNever="ZodNever",z.ZodVoid="ZodVoid",z.ZodArray="ZodArray",z.ZodObject="ZodObject",z.ZodUnion="ZodUnion",z.ZodDiscriminatedUnion="ZodDiscriminatedUnion",z.ZodIntersection="ZodIntersection",z.ZodTuple="ZodTuple",z.ZodRecord="ZodRecord",z.ZodMap="ZodMap",z.ZodSet="ZodSet",z.ZodFunction="ZodFunction",z.ZodLazy="ZodLazy",z.ZodLiteral="ZodLiteral",z.ZodEnum="ZodEnum",z.ZodEffects="ZodEffects",z.ZodNativeEnum="ZodNativeEnum",z.ZodOptional="ZodOptional",z.ZodNullable="ZodNullable",z.ZodDefault="ZodDefault",z.ZodCatch="ZodCatch",z.ZodPromise="ZodPromise",z.ZodBranded="ZodBranded",z.ZodPipeline="ZodPipeline",z.ZodReadonly="ZodReadonly";var on=sS.create,os=sO.create,oo=s4.create,oa=sT.create,ol=sx.create,ou=sk.create,oc=sI.create,oh=sM.create,od=sR.create,op=sF.create,of=sL.create,om=sN.create,ov=sD.create,og=sj.create,ob=sB.create,oy=sB.strictCreate,o_=sU.create,ow=sW.create,oE=s$.create,oC=sV.create,oP=sZ.create,oA=sG.create,oS=sJ.create,oO=sq.create,oT=sH.create,ox=sK.create,ok=sQ.create,oI=sX.create,oM=s0.create,oR=s1.create,oF=s3.create,oL=s2.create,oN=s1.createWithPreprocess,oD=s8.create,oj=Object.freeze({__proto__:null,defaultErrorMap:nq,setErrorMap:function(t){nH=t},getErrorMap:nK,makeIssue:nY,EMPTY_PATH:[],addIssueToContext:nQ,ParseStatus:nX,INVALID:n0,DIRTY:n1,OK:n3,isAborted:n2,isDirty:n9,isValid:n6,isAsync:n4,get util(){return si},get objectUtil(){return sr},ZodParsedType:nV,getParsedType:nZ,ZodType:sh,datetimeRegex:sA,ZodString:sS,ZodNumber:sO,ZodBigInt:sT,ZodBoolean:sx,ZodDate:sk,ZodSymbol:sI,ZodUndefined:sM,ZodNull:sR,ZodAny:sF,ZodUnknown:sL,ZodNever:sN,ZodVoid:sD,ZodArray:sj,ZodObject:sB,ZodUnion:sU,ZodDiscriminatedUnion:sW,ZodIntersection:s$,ZodTuple:sV,ZodRecord:sZ,ZodMap:sG,ZodSet:sJ,ZodFunction:sq,ZodLazy:sH,ZodLiteral:sK,ZodEnum:sQ,ZodNativeEnum:sX,ZodPromise:s0,ZodEffects:s1,ZodTransformer:s1,ZodOptional:s3,ZodNullable:s2,ZodDefault:s9,ZodCatch:s6,ZodNaN:s4,BRAND:s5,ZodBranded:s7,ZodPipeline:s8,ZodReadonly:oe,custom:ot,Schema:sh,ZodSchema:sh,late:or,get ZodFirstPartyTypeKind(){return oi},coerce:{string:t=>sS.create(i2(i3({},t),{coerce:!0})),number:t=>sO.create(i2(i3({},t),{coerce:!0})),boolean:t=>sx.create(i2(i3({},t),{coerce:!0})),bigint:t=>sT.create(i2(i3({},t),{coerce:!0})),date:t=>sk.create(i2(i3({},t),{coerce:!0}))},any:op,array:og,bigint:oa,boolean:ol,date:ou,discriminatedUnion:ow,effect:oR,enum:ok,function:oO,instanceof:(t,i={message:`Input not instance of ${t.name}`})=>ot(i=>i instanceof t,i),intersection:oE,lazy:oT,literal:ox,map:oA,nan:oo,nativeEnum:oI,never:om,null:od,nullable:oL,number:os,object:ob,oboolean:()=>ol().optional(),onumber:()=>os().optional(),optional:oF,ostring:()=>on().optional(),pipeline:oD,preprocess:oN,promise:oM,record:oP,set:oS,strictObject:oy,string:on,symbol:oc,transformer:oR,tuple:oC,undefined:oh,union:o_,unknown:of,void:ov,NEVER:n0,ZodIssueCode:nG,quotelessJson:t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:nJ}),oB=oj.object({serverUrl:oj.string()}).parse({serverUrl:"https://io.superviz.com"}),oU=class{constructor(t){this.socket=t,this.onConnect=()=>{this.logger.log("connection @ on connect","Connected to the socket"),this.changeState("CONNECTED")},this.onDisconnect=t=>{this.logger.log("connection @ on disconnect","Disconnected from the socket"),this.changeState("DISCONNECTED",t)},this.onConnectError=t=>{this.logger.log("connection @ on connect error","Connection error",t),this.changeState("CONNECTION_ERROR",t.message)},this.onConnectionError=t=>{this.logger.log("connection @ on connection error","Connection error",t),this.changeState("CONNECTION_ERROR",t.message)},this.onReconnect=()=>{this.logger.log("connection @ on reconnect","Reconnected to the socket"),this.changeState("CONNECTED")},this.onReconnectError=t=>{this.logger.log("connection @ on reconnect error","Reconnect error",t),this.changeState("RECONNECT_ERROR",t.message)},this.onReconnectFailed=()=>{this.logger.log("connection @ on reconnect failed","Failed to reconnect to the socket"),this.changeState("RECONNECT_ERROR")},this.onReconnecAttempt=t=>{this.logger.log("connection @ on reconnect attempt",`Reconnect attempt #${t}`),this.changeState("RECONNECTING",`Reconnect attempt #${t}`)},this.onCustomError=t=>{t.needsToDisconnect&&(this.socket.disconnect(),this.changeState("DISCONNECTED",t.errorType));let i=`[SuperViz] 
    - Error: ${t.errorType}
    - Message: ${t.message}
    `;if("error"===t.level){console.error(i);return}console.warn(i)},this.logger=new rM("@superviz/socket-client/connection"),this.subscribeToManagerEvents(),this.stateObserver=new rx}on(t,i){this.stateObserver.closed&&(this.stateObserver=new rx),this.stateObserver.subscribe({next:t,error:i})}off(){this.stateObserver.closed||this.stateObserver.unsubscribe()}subscribeToManagerEvents(){this.socket.on("connect",this.onConnect),this.socket.on("disconnect",this.onDisconnect),this.socket.on("connect_error",this.onConnectError),this.socket.io.on("error",this.onConnectionError),this.socket.io.on("reconnect",this.onReconnect),this.socket.io.on("reconnect_attempt",this.onReconnecAttempt),this.socket.io.on("reconnect_error",this.onReconnectError),this.socket.io.on("reconnect_failed",this.onReconnectFailed),this.socket.on("socket-event.error",this.onCustomError)}changeState(t,i){this.state=t,this.stateObserver.closed||this.stateObserver.next({state:t,reason:i})}},oz=class t{constructor(t,i,r,n,s=100){this.io=t,this.user=i,this.roomId=r,this.apiKey=n,this.maxConnections=s,this.isJoined=!1,this.subscriptions=new Map,this.observers=new Map,this.onJoinedRoom=t=>{var i;this.roomId===(null==(i=null==t?void 0:t.data)?void 0:i.name)&&(this.isJoined=!0,this.io.emit("room.joined",this.roomId,t.data),this.logger.log("room @ joined",t))},this.onHttpEvent=t=>{this.publishEventToClient(t.name,t)},this.logger=new rM("@superviz/socket-client/room"),this.presence=rR.register(t,i,r),this.io.emit("room.join",{name:r,user:i,maxConnections:s}),this.subscribeToRoomEvents()}static register(i,r,n,s,a){return new t(i,r,n,s,a)}on(t,i){this.logger.log("room @ on",t);let r=this.observers.get(t);r||(r=new rx,this.observers.set(t,r),this.io.on(t,i=>{this.publishEventToClient(t,i)})),this.subscriptions.set(i,r.subscribe(i))}off(t,i){var r;if(this.logger.log("room @ off",t),!i){this.observers.delete(t),this.io.off(t);return}null==(r=this.subscriptions.get(i))||r.unsubscribe()}emit(t,i){if(!this.isJoined){this.logger.log("Cannot emit event. Not joined to room");return}let r={name:t,roomId:this.roomId,presence:this.user,connectionId:this.io.id,data:i,timestamp:Date.now()};this.io.emit("room.update",this.roomId,r),this.logger.log("room @ emit",t,i)}history(t,i){let r=new rx;r.subscribe({next:t,error:i});let n=t=>{this.logger.log("room @ history",t),this.io.off("room.get",n),r.next(t),r.complete(),r.unsubscribe()};this.io.on("room.get",n),this.io.emit("room.get",this.roomId)}disconnect(){this.logger.log("room @ disconnect","Leaving room...",this.roomId),this.io.emit("room.leave",this.roomId),this.subscriptions.forEach(t=>t.unsubscribe()),this.subscriptions.clear(),this.observers.forEach(t=>t.unsubscribe()),this.observers.clear(),this.presence.destroy()}publishEventToClient(t,i){let r=this.observers.get(t);r&&i.roomId===this.roomId&&r.next(i)}subscribeToRoomEvents(){this.io.on("room.joined",this.onJoinedRoom),this.io.on("room.error",t=>{this.logger.log("Error:",t.data)}),this.io.on(`http:${this.roomId}:${this.apiKey}`,this.onHttpEvent)}},oW=class{constructor(t,i,r,n,s){let a;this.apiKey=t,this.environment=i,this.presence=r,this.secret=n,this.clientId=s,this.manager=new nz(oB.serverUrl,{addTrailingSlash:!1,secure:!0,withCredentials:!0,reconnection:!0,reconnectionDelay:1e3,reconnectionDelayMax:5e3,reconnectionAttempts:5,extraHeaders:{"sv-api-key":this.apiKey}}),"u">typeof window&&(a=window.location.origin),this.socket=this.manager.socket(`/${i}`,{auth:{apiKey:this.apiKey,origin:a,envirioment:this.environment,secret:this.secret,clientId:this.clientId}}),this.connection=new oU(this.socket)}get state(){return this.connection.state}connect(t,i){return oz.register(this.socket,this.presence,t,this.apiKey,i)}destroy(){this.socket.disconnect(),this.connection.off()}};oj.object({name:oj.string(),user:oj.object({id:oj.string(),name:oj.string().nullable()}),maxConnections:oj.union([oj.number(),oj.literal("unlimited"),oj.undefined()])});var o$=el(ex());eh();var oV=class{constructor(){this.observers=new Map,this.subscribe=(t,i)=>{this.logger.log("event bus service @ subscribe",{event:t,callback:i}),this.observers.has(t)||this.observers.set(t,new iz),this.observers.get(t).subscribe(i)},this.unsubscribe=(t,i)=>{this.logger.log("event bus service @ unsubscribe",{event:t,callback:i}),this.observers.has(t)&&(this.observers.get(t).reset(),this.observers.delete(t))},this.publish=(t,i)=>{this.logger.log("event bus service @ publish",{event:t,data:i}),this.observers.has(t)&&this.observers.get(t).publish(i)},this.destroy=()=>{this.logger.log("event bus service @ destroy"),this.observers.forEach(t=>{t.reset(),t.destroy()}),this.observers.clear()},this.logger=new iB("@superviz/sdk/event-bus"),this.logger.log("event bus created")}};eh(),eh();var oZ=class{constructor(t){this.participant=t,this.stateSubject=new tr,this.handleConnectionState=t=>{if("Unauthorized connection"===t.reason){console.error("[Superviz] Unauthorized connection. Please check your API key and if your domain is white listed."),this.state={state:rt.DISCONNECTED,reason:"Unauthorized connection"},this.stateSubject.next("AUTH_ERROR");return}if("user-already-in-room"===t.reason){this.state=t,this.stateSubject.next("SAME_ACCOUNT_ERROR");return}this.state=t,this.stateSubject.next(t.state)},this.createClient()}destroy(){this.stateSubject.complete(),this.client.destroy()}subscribeToDefaultEvents(){this.client.connection.on(this.handleConnectionState)}createClient(){let t=eM.get("environment");t=["dev","prod"].includes(t)?t:"dev",this.client=new oW(eM.get("apiKey"),t,{id:this.participant.id,name:this.participant.name}),this.subscribeToDefaultEvents()}createRoom(t,i=50){let r=eM.get("roomId");return this.client.connect(`${r}:${t}`,i)}};eh(),eh();var oG=((k=oG||{}).comments="presence",k.presence3dMatterport="presence",k.presence3dAutodesk="presence",k.presence3dThreejs="presence",k.whoIsOnline="presence",k.formElements="presence",k.yjsProvider="presence",k),oJ=class{static checkComponentLimit(t){var i,r;let n=eM.get("limits"),s=null!=(i=oG[t])?i:t;return null!=(r=null==n?void 0:n[s])?r:{canUse:!1,maxParticipants:50}}};eh();var oq=el(ex());eh();var oH=class{constructor(t,i){this.participants3DObservers=[],this.initializeParticipantsList=()=>{this.room.presence.get(t=>{t.forEach(t=>{this.unthrottledUpdatePresence3D(t.data)})})},this.onLocalParticipantJoined=t=>{var i;if(!t.slot||(null==(i=t.slot)?void 0:i.index)===null){setTimeout(()=>{this.onLocalParticipantJoined(this.localParticipant)},2e3);return}if(!this.room.isJoined){setTimeout(()=>{this.onLocalParticipantJoined(t)},2e3);return}let{hasJoined3D:r}=this.useStore("presence-3d-store");r.publish(!0),this.room.emit("participant-joined",t),this.room.presence.update(t),this.initializeParticipantsList()},this.subscribeToRoomEvents=()=>{this.room.on("participant-joined",this.onJoinedRoom),this.room.presence.on(re.LEAVE,this.onLeaveRoom),this.room.presence.on(re.UPDATE,this.onParticipantUpdate),this.room.presence.on(re.JOINED_ROOM,this.onJoinedPresence)},this.unsubscribeFromRoomEvents=()=>{this.room.off("participant-joined",this.onJoinedRoom),this.room.presence.off(re.LEAVE),this.room.presence.off(re.UPDATE),this.room.presence.off(re.JOINED_ROOM)},this.onJoinedRoom=t=>{let{participants:i}=this.useStore("presence-3d-store"),r=i.value.find(i=>i.id===t.data.id);i.publish([...i.value.filter(i=>i.id!==t.data.id),er(er({},r),t.data)])},this.onLeaveRoom=t=>{if(t.id===this.localParticipant.id){this.unsubscribeFromRoomEvents(),this.useStore("presence-3d-store").destroy();return}let{participants:i}=this.useStore("presence-3d-store"),r=i.value.filter(i=>i.id!==t.id);i.publish(r)},this.unthrottledUpdatePresence3D=t=>{if(!(null!=t&&t.id))return;let{participants:i,hasJoined3D:r}=this.useStore("presence-3d-store"),n=er(er({},i.value.find(i=>i.id===t.id)),t);i.publish([...i.value.filter(i=>i.id!==t.id),n]),r.value&&n.id===this.localParticipant.id&&this.room.presence.update(n)},this.onJoinedPresence=t=>{t.id===this.localParticipant.id&&(this.logger.log("participant joined 3D room",t.id,this.localParticipant),this.onLocalParticipantJoined(this.localParticipant))},this.updatePresence3D=(0,oq.throttle)(t=>{this.unthrottledUpdatePresence3D(t)},1e3),this.onParticipantUpdate=t=>{if(t.id===this.localParticipant.id)return;let{participants:i}=this.useStore("presence-3d-store"),r=er(er({},i.value.filter(i=>i.id===t.id)[0]),t.data),n=i.value.map(i=>i.id===t.id?r:i);i.publish(n),this.participants3DObservers[t.id]&&this.participants3DObservers[t.id].publish(r)},this.setParticipantData=t=>{this.updatePresence3D(t)},this.room=t,this.logger=new iB("@superviz/sdk/presence3D-manager"),this.useStore=i,this.subscribeToRoomEvents();let{localParticipant:r}=this.useStore("global-store");r.subscribe(t=>{this.room.presence.update(t);let{participants:i}=this.useStore("presence-3d-store"),r=er(er({},i.value.find(i=>i.id===t.id)),t);i.publish([...i.value.filter(i=>i.id!==t.id),r]),this.localParticipant=r})}subscribeToUpdates(t,i){this.participants3DObservers[t]||(this.participants3DObservers[t]=new iz({logger:this.logger})),this.participants3DObservers[t].subscribe(i)}unsubscribeFromUpdates(t,i){this.participants3DObservers[t]&&this.participants3DObservers[t].unsubscribe(i)}get getParticipants(){return this.useStore("presence-3d-store").participants.value}};eh(),eh();var oK=((I=oK||{}).HOST="host",I.GUEST="guest",I.AUDIENCE="audience",I),oY=class{constructor(t,i){this.room=t,this.useStore=i,this.isAssigningSlot=!1,this.slot={index:null,color:eP.gray,textColor:"#fff",colorName:"gray",timestamp:Date.now()},this.onPresenceUpdate=t=>ec(this,null,function*(){var i,r,n;let{localParticipant:s}=this.useStore("global-store");if(t.id===s.value.id){let i=yield this.validateSlotType(t.data);s.publish(en(er({},s.value),{slot:i}));return}if(!((null==(i=t.data.slot)?void 0:i.index)===null||null===this.slot.index)&&(null==(r=t.data.slot)?void 0:r.index)===(null==(n=this.slot)?void 0:n.index)){let t=yield this.assignSlot();s.publish(en(er({},s.value),{slot:t})),console.debug(`[SuperViz] - Slot reassigned to ${s.value.id}, slot: ${t.colorName}`)}}),this.participantNeedsSlot=t=>{var i;let r=["formElements","whoIsOnline","presence","presence3dAutodesk","presence3dMatterport","presence3dThreejs","yjsProvider"].some(i=>{var r;return null==(r=null==t?void 0:t.activeComponents)?void 0:r.includes(i)}),n=(null==(i=null==t?void 0:t.activeComponents)?void 0:i.includes("videoConference"))&&"audience"!==t.type;return r||n},this.validateSlotType=t=>ec(this,null,function*(){var i,r;if(this.isAssigningSlot)return this.slot;let n=this.participantNeedsSlot(t);if((null==(i=t.slot)?void 0:i.index)===null&&n){let t=yield this.assignSlot();this.slot=t}return(null==(r=t.slot)?void 0:r.index)===null||n||this.setDefaultSlot(),this.slot}),this.room=t,this.room.presence.on(re.UPDATE,this.onPresenceUpdate)}assignSlot(){return ec(this,null,function*(){if(this.isAssigningSlot)return this.slot;this.isAssigningSlot=!0;let t=Array.from({length:50},(t,i)=>i),i=Math.floor(50*Math.random()),{localParticipant:r,participants:n}=im("global-store");try{yield new Promise((i,n)=>{this.room.presence.get(s=>{if(s&&s.length||i(!0),s.length>=50){t=[],n(Error("[SuperViz] - No more slots available"));return}s.forEach(i=>{i.id!==r.value.id&&(t=t.filter(t=>{var r,n;return t!==(null==(n=null==(r=i.data)?void 0:r.slot)?void 0:n.index)}))}),i(!0)})}),t.includes(i)||(i=t.shift());let s=Object.keys(eP)[i],a={index:i,color:eP[s],textColor:eC.includes(s)?"#fff":"#000",colorName:s,timestamp:Date.now()};return this.slot=a,r.publish(en(er({},r.value),{slot:a})),n.publish(en(er({},n.value),{[r.value.id]:en(er({},n.value[r.value.id]),{slot:a})})),this.room.presence.update({slot:a}),this.isAssigningSlot=!1,a}catch(t){return console.error(t),null}})}setDefaultSlot(){let{localParticipant:t,participants:i}=im("global-store"),r={index:null,color:eP.gray,textColor:"#fff",colorName:"gray",timestamp:Date.now()};this.slot=r,t.publish(en(er({},t.value),{slot:r})),i.publish(en(er({},i.value),{[t.value.id]:en(er({},i.value[t.value.id]),{slot:r})})),this.room.presence.update({slot:r})}};eh();var oQ=class extends iW{constructor({participant:t,group:i}){super(),this.isDestroyed=!1,this.activeComponents=[],this.componentsToAttachAfterJoin=[],this.activeComponentsInstances=[],this.eventBus=new oV,this.useStore=im.bind(this),this.addComponent=t=>ec(this,null,function*(){if(!this.canAddComponent(t))return;let{hasJoinedRoom:i,group:r,localParticipant:n}=im("global-store");if(!i.value){this.logger.log("launcher service @ addComponent - not joined yet"),this.componentsToAttachAfterJoin.push(t);return}let s=oJ.checkComponentLimit(t.name);t.attach({ioc:this.ioc,config:eM.configuration,eventBus:this.eventBus,useStore:im,Presence3DManagerService:oH,connectionLimit:s.maxParticipants}),this.activeComponents.push(t.name),this.activeComponentsInstances.some(i=>i.name===t.name)?this.activeComponentsInstances=this.activeComponentsInstances.map(i=>i.name===t.name?t:i):this.activeComponentsInstances.push(t),n.publish(en(er({},n.value),{activeComponents:this.activeComponents})),this.room.presence.update(en(er({},n.value),{slot:this.slotService.slot,activeComponents:this.activeComponents})),i$.sendActivity(this.participant.id,r.value.id,r.value.name,t.name)}),this.attachComponentsAfterJoin=()=>{this.logger.log("launcher service @ attachComponentsAfterJoin"),this.componentsToAttachAfterJoin.forEach(t=>{this.logger.log("launcher service @ attachComponentsAfterJoin - attaching component",t.name),this.addComponent(t)}),this.componentsToAttachAfterJoin=[]},this.removeComponent=t=>{if(!this.activeComponents.includes(t.name)){let i=`[SuperViz] Component ${t.name} is not initialized yet.`;this.logger.log(i),console.error(i);return}t.detach(),this.activeComponentsInstances=this.activeComponentsInstances.filter(i=>i.name!==t.name),this.activeComponents.splice(this.activeComponents.indexOf(t.name),1),this.room.presence.update(en(er({},this.participant),{activeComponents:this.activeComponents}))},this.destroy=()=>{var t,i,r,n,s,a;this.logger.log("launcher service @ destroy"),this.activeComponentsInstances.forEach(t=>{this.logger.log("launcher service @ destroy - removing component",t.name),this.removeComponent(t)}),this.activeComponents=[],this.activeComponentsInstances=[],null==(t=tj())||t.destroy(),null==(i=this.eventBus)||i.destroy(),this.eventBus=void 0,null==(r=this.room)||r.presence.off(re.JOINED_ROOM),null==(n=this.room)||n.presence.off(re.LEAVE),null==(s=this.room)||s.presence.off(re.UPDATE),null==(a=this.ioc)||a.destroy(),this.isDestroyed=!0,"u">typeof window&&(window.SUPERVIZ=void 0)},this.canAddComponent=t=>{var i;let r=eM.get(`features.${t.name}`),n=oJ.checkComponentLimit(t.name),s=null==(i=this.activeComponents)?void 0:i.includes(t.name),a=[{isValid:r,message:`[SuperViz] Component ${t.name} is not enabled in the room`},{isValid:!this.isDestroyed,message:"[SuperViz] Component can not be added because the superviz room is destroyed. Initialize a new room to add and use components."},{isValid:!s,message:`[SuperViz] Component ${t.name} is already active. Please remove it first`},{isValid:n.canUse,message:`[SuperViz] You reached the limit usage of ${t.name}`}];for(let t=0;t<a.length;t++){let{isValid:i,message:r}=a[t];if(!i)return this.logger.log(r),console.error(r),!1}return!0},this.onAuthentication=t=>{t||(this.destroy(),console.error("[SuperViz] Room cannot be initialized because this website's domain is not whitelisted. If you are the developer, please add your domain in https://dashboard.superviz.com/developer"))},this.onLocalParticipantUpdateOnStore=t=>{this.participant=t,this.activeComponents=t.activeComponents||[]},this.onLocalParticipantUpdateOnCore=t=>{this.room&&this.room.presence.update(t)},this.onParticipantsListUpdateOnCore=t=>{let{participants:i}=this.useStore("global-store");i.publish(t)},this.onSameAccount=()=>{this.publish("participant.same-account-error"),this.destroy()},this.startIOC=()=>{this.logger.log("launcher service @ startIOC");let{participants:t}=im("global-store");this.ioc.stateSubject.subscribe(this.onConnectionStateChange),this.room.presence.get(i=>{let r={};i.forEach(t=>{r[t.id]=en(er({},t.data),{name:t.name,id:t.id,timestamp:t.timestamp})}),r[this.participant.id]=er(er({},r[this.participant.id]),this.participant),t.publish(r)}),this.room.presence.on(re.JOINED_ROOM,this.onParticipantJoinedIOC),this.room.presence.on(re.LEAVE,this.onParticipantLeaveIOC),this.room.presence.on(re.UPDATE,this.onParticipantUpdatedIOC)},this.onConnectionStateChange=t=>{if("AUTH_ERROR"===t){this.onAuthentication(!1);return}"SAME_ACCOUNT_ERROR"===t&&this.onSameAccount()},this.onParticipantJoinedIOC=t=>ec(this,null,function*(){if(t.id!==this.participant.id)return;this.room.presence.update(this.participant),this.logger.log("launcher service @ onParticipantJoined - local participant joined");let{hasJoinedRoom:i}=im("global-store");i.publish(!0),this.attachComponentsAfterJoin(),this.publish("participant.local-joined",this.participant),this.publish("participant.joined",this.participant)}),this.onParticipantLeaveIOC=t=>{let{participants:i,localParticipant:r}=im("global-store"),n=er({},i.value);delete n[t.id],i.publish(n),t.id===r.value.id&&(this.logger.log("launcher service @ onParticipantLeave - local participant left"),this.publish("participant.local-left",t.data)),this.logger.log("launcher service @ onParticipantLeave - participant left",t.data),this.publish("participant.left",t.data),this.publish("participant.list-updated",Object.values(n))},this.onParticipantUpdatedIOC=t=>{let{localParticipant:i}=im("global-store");if(i.value&&t.id===i.value.id){let r=er(er({},i.value),t.data);i.publish(en(er({},r),{timestamp:t.timestamp})),this.publish("participant.updated",r),this.logger.log("Publishing ParticipantEvent.UPDATED",t.data)}let{participants:r}=im("global-store"),n=er({id:t.id,name:t.name,timestamp:t.timestamp},t.data);r.value[t.id]||this.publish("participant.joined",n);let s=Object.assign({},r.value);if(s[t.id]=n,(0,o$.isEqual)(s,r.value))return;r.publish(s);let a=Object.values(r.value);this.logger.log("Publishing ParticipantEvent.LIST_UPDATED",r.value),this.publish("participant.list-updated",a)},this.logger=new iB("@superviz/sdk/launcher");let{localParticipant:r,group:n,isDomainWhitelisted:s}=this.useStore("global-store"),{localParticipant:a,participants:l}=this.useStore("core-store");r.publish(er({},t)),s.subscribe(this.onAuthentication),r.subscribe(this.onLocalParticipantUpdateOnStore),a.subscribe(this.onLocalParticipantUpdateOnCore),l.subscribe(this.onParticipantsListUpdateOnCore),n.publish(i),this.ioc=new oZ(r.value),this.room=this.ioc.createRoom("launcher","unlimited"),this.slotService=new oY(this.room,this.useStore),r.publish(en(er({},r.value),{slot:this.slotService.slot,activeComponents:[]})),this.participant=r.value,this.eventBus=new oV,this.logger.log("launcher created"),this.startIOC()}},oX=t=>{if("u">typeof window&&window.SUPERVIZ)return console.warn("[SUPERVIZ] Room already initialized"),{destroy:window.SUPERVIZ.destroy,subscribe:window.SUPERVIZ.subscribe,unsubscribe:window.SUPERVIZ.unsubscribe,addComponent:window.SUPERVIZ.addComponent,removeComponent:window.SUPERVIZ.removeComponent};let i=new oQ(t);return"u">typeof window&&(window.SUPERVIZ=i),{destroy:i.destroy,subscribe:i.subscribe,unsubscribe:i.unsubscribe,addComponent:i.addComponent,removeComponent:i.removeComponent}};function o0(t){return!(!/^.{2,64}$/.test(t)||!/^[-_&@+=,(){}\[\]\/«».:|'"#a-zA-Z0-9À-ÿ\s]*$/.test(t))}var o1=({group:t,participant:i,roomId:r,customColors:n})=>{var s;if(n&&o3(n),!t||!t.name||!t.id)throw Error("[SuperViz] Group fields is required");if(!i||!i.id)throw Error("[SuperViz] Participant id is required");if(!r)throw Error("[SuperViz] Room id is required");if(!o0(r))throw Error(`[SuperViz] Room id is invalid, it should be between 2 and 64 characters and only accept letters, numbers and special characters: -_&@+=,(){}[]/\xab\xbb.:|'"`);if(!o0(i.id))throw Error(`[SuperViz] Participant id is invalid, it should be between 2 and 64 characters and only accept letters, numbers and special characters: -_&@+=,(){}[]/\xab\xbb.:|'"`);if(i.email&&(s=i.email,!/^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$/.test(s)))throw Error("[SuperViz] Participant email is invalid")},o3=t=>{Object.entries(t).forEach(([t,i])=>{if(!Object.values(iN).includes(t))throw Error(`[SuperViz] Color ${t} is not a valid color variable name. Please check the documentation for more information.`);if(!/^(\d{1,3}\s){2}\d{1,3}$/.test(i))throw Error(`[SuperViz] Color ${t} is not a valid color variable value. Please check the documentation for more information.`)})},o2=t=>{t&&Object.entries(t).forEach(([t,i])=>{let r=i.replace(/\s/g,", ");document.documentElement.style.setProperty(`--${t}`,r)})},o9=(t,i)=>ec(void 0,null,function*(){var r,n,s,a,l;if(!(t&&t.trim()))throw Error("API key is required");if(!i)throw Error("Options is required");o1(i),i.debug?iL.debug.enable("*"):iL.debug.disable();let[{apiUrl:u,conferenceLayerUrl:c},h]=yield Promise.all([iV.getRemoteConfig(i.environment),iV.getFeatures(t)]);if(!(yield function(t,i){return ec(this,null,function*(){try{return(yield i$.validateApiKey(t,i))===!0}catch(t){if(404===t.status)return!1;throw Error("Unable to validate API key")}})}(u,t)))throw Error("Failed to validate API key");let[d,p]=yield Promise.all([i$.fetchWaterMark(u,t),i$.fetchLimits(u,t)]).catch(()=>{throw Error("[SuperViz] Failed to load configuration from server")}),{participant:f,roomId:m,customColors:v}=i;eM.setConfig({apiUrl:u,apiKey:t,conferenceLayerUrl:c,environment:null!=(r=i.environment)?r:"prod",roomId:m,debug:i.debug,limits:p,waterMark:d,colors:v,features:h}),o2(v);let g=yield i$.fetchParticipant(f.id).catch(()=>null);if(!g&&!f.name)throw Error("[SuperViz] - Participant does not exist, create the user in the API or add the name in the initialization to initialize the SuperViz room.");return g||(yield i$.createParticipant({participantId:f.id,name:null==f?void 0:f.name,avatar:null==(n=f.avatar)?void 0:n.imageUrl,email:null==f?void 0:f.email})),oX(en(er({},i),{participant:{id:f.id,name:null!=(s=f.name)?s:null==g?void 0:g.name,avatar:null!=(a=f.avatar)?a:null==g?void 0:g.avatar,email:null!=(l=f.email)?l:null==g?void 0:g.email}}))});eh(),"u">typeof window&&"u">typeof HTMLElement&&(Promise.all([r.e(7250),r.e(6375)]).then(r.bind(r,6375)),Promise.all([r.e(7250),r.e(283)]).then(r.bind(r,283)),Promise.all([r.e(7250),r.e(7976)]).then(r.bind(r,7976)),Promise.all([r.e(7250),r.e(7585)]).then(r.bind(r,7585)),Promise.all([r.e(7250),r.e(2702),r.e(6288)]).then(r.bind(r,6288)),Promise.all([r.e(7250),r.e(2702),r.e(3121)]).then(r.bind(r,3121)),Promise.all([r.e(7250),r.e(2702),r.e(5533)]).then(r.bind(r,5533)),Promise.all([r.e(7250),r.e(2702),r.e(1066)]).then(r.bind(r,1066)),Promise.all([r.e(7250),r.e(2702),r.e(2759)]).then(r.bind(r,2759)),Promise.all([r.e(7250),r.e(2702),r.e(7083)]).then(r.bind(r,7083)),Promise.all([r.e(7250),r.e(2702),r.e(9022)]).then(r.bind(r,9022)),Promise.all([r.e(7250),r.e(9103)]).then(r.bind(r,9103)),Promise.all([r.e(7250),r.e(2702),r.e(8557)]).then(r.bind(r,8557)),Promise.all([r.e(7250),r.e(2702),r.e(7830)]).then(r.bind(r,7830)),Promise.all([r.e(7250),r.e(2702),r.e(925)]).then(r.bind(r,925)),Promise.all([r.e(7250),r.e(2702),r.e(3229)]).then(r.bind(r,5962)),Promise.all([r.e(7250),r.e(8771)]).then(r.bind(r,2075)),Promise.all([r.e(7250),r.e(2067)]).then(r.bind(r,2067))),eh(),eh(),function(t){if("u">typeof document){let i=document.createElement("style");i.id="superviz-style";let r=document.createTextNode(t);i.appendChild(r),document.head.appendChild(i)}}(`@import"https://unpkg.com/@superviz/sv-icons@0.8.13/css/style.css";@import"https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;500;700&family=Roboto:wght@400;500;700&display=swap";:root{--sv-primary: 98, 16, 204}html,body{width:100%;height:100%;overflow:hidden}#sv-video-wrapper iframe{position:fixed;border:none;margin:0;padding:0;overflow:hidden;z-index:1000}#sv-video-wrapper iframe.sv-video-frame--right{top:var(--superviz-offset-top);right:var(--superviz-offset-right)}#sv-video-wrapper iframe.sv-video-frame--left{top:var(--superviz-offset-top);left:var(--superviz-offset-left)}#sv-video-wrapper iframe.sv-video-frame--bottom{bottom:var(--superviz-offset-bottom);right:var(--superviz-offset-right);width:100%}#sv-video-wrapper iframe.sv-video-frame--top{top:var(--superviz-offset-top);right:var(--superviz-offset-right);width:100%}#sv-video-wrapper iframe.sv-video-frame--no-overlay{display:none}.pointer-mouse{display:flex;height:15px;width:16px;background-image:url(https://production.cdn.superviz.com/static/pointers/0.svg);background-repeat:no-repeat}.mouse-user-name{display:block;position:absolute;border-radius:30px;padding:2px 8px;font-weight:700;font-size:14px;font-family:Roboto,sans-serif;line-height:22px;margin-left:10px;margin-top:-6px;background:#ff0;white-space:nowrap}.mouse-follower{position:absolute;display:block;z-index:2}
`),eh();var o6=((M=o6||{}).RIGHT="right",M.CENTER="center",M.LEFT="left",M),o4=((R=o4||{}).GRID="grid",R.LIST="list",R),o5=((F=o5||{}).RIGHT="right",F.LEFT="left",F.TOP="top",F.BOTTOM="bottom",F);eh();var o7=((L=o7||{}).STARTED="STARTED",L.STOPPED="STOPPED",L),o8=((N=o8||{}).REALTIME_STATE_CHANGED="realtime-component.state-changed",N);eh();var ae=((D=ae||{}).BLUR="field.blur",D.FOCUS="field.focus",D.CONTENT_CHANGE="field.content-change",D.INTERACTION="field.interaction",D);eh(),eh(),eh();var at=class extends iW{constructor(){super(...arguments),this.isAttached=!1,this.unsubscribeFrom=[],this.useStore=im.bind(this),this.attach=t=>{var i;if(Object.values(t).includes(null)||Object.values(t).includes(void 0)){let t=`${this.name} @ attach - params are required`;throw this.logger.log(t),Error(t)}let{config:r,eventBus:n,ioc:s}=t,{isDomainWhitelisted:a,hasJoinedRoom:l}=this.useStore("global-store");if(!a.value){let t=`Component ${this.name} can't be used because this website's domain is not whitelisted. Please add your domain in https://dashboard.superviz.com/developer`;this.logger.log(t);return}if(eM.setConfig(r),this.eventBus=n,this.isAttached=!0,this.ioc=s,this.connectionLimit=null!=(i=t.connectionLimit)?i:50,this.room=s.createRoom(this.name,this.connectionLimit),!l.value){this.logger.log(`${this.name} @ attach - not joined yet`),setTimeout(()=>{this.logger.log(`${this.name} @ attach - retrying`),this.attach(t)},1e3);return}this.logger.log(`${this.name} @ attached`),this.observers={},this.start(),this.publish("mount")},this.detach=()=>{if(!this.isAttached){this.logger.log(`${this.name} @ detach - component is not attached`);return}this.logger.log("detached"),this.publish("unmount"),this.destroy(),this.room.disconnect(),this.room=void 0,this.unsubscribeFrom.forEach(t=>t(this)),Object.values(this.observers).forEach(t=>{t.reset(),t.destroy()}),this.observers=void 0,this.isAttached=!1}}},ai=class extends at{constructor(t,i){var r,n,s;super(),this.sidebarOpen=!1,this.layoutOptions={},this.openThreads=()=>{var t;this.sidebarOpen||(null==(t=this.element)||t.setAttribute("open",""),this.sidebarOpen=!0,document.body.dispatchEvent(new CustomEvent("toggle-annotation-sidebar",{detail:{open:this.sidebarOpen},composed:!0,bubbles:!0})))},this.closeThreads=()=>{var t;this.sidebarOpen&&(null==(t=this.element)||t.removeAttribute("open"),this.sidebarOpen=!1,document.body.dispatchEvent(new CustomEvent("toggle-annotation-sidebar",{detail:{open:this.sidebarOpen},composed:!0,bubbles:!0})))},this.togglePinActive=()=>{if(this.pinActive){this.disable();return}this.enable()},this.onPinFixed=t=>{this.coordinates=t},this.toggleAnnotationSidebar=()=>{this.element.toggleAttribute("open"),this.sidebarOpen=this.element.hasAttribute("open"),document.body.dispatchEvent(new CustomEvent("prepare-to-create-annotation",{detail:void 0,composed:!0,bubbles:!0})),document.body.dispatchEvent(new CustomEvent("toggle-annotation-sidebar",{detail:{open:this.sidebarOpen},composed:!0,bubbles:!0}))},this.onSelectAnnotation=t=>{this.sidebarOpen||this.toggleAnnotationSidebar()},this.positionFloatingButton=()=>{var t,i;this.button=document.createElement("superviz-comments-button");let r=null==(t=this.layoutOptions)?void 0:t.buttonLocation,n=null==(i=this.layoutOptions)?void 0:i.position;if(!r){document.body.appendChild(this.button),this.button.commentsPosition=n;return}let s="",a=Object.values(eO),l=!1,u=!a.includes(r.toLocaleLowerCase());if(u){let t=window.document.body.querySelector(`#${r}`);t?(t.appendChild(this.button),s="position: relative"):(l=!0,r="top-left")}if(!u||l){document.body.appendChild(this.button);let[t,i]=r.split("-");s=`${t}: 20px; ${i}: 20px;`}this.button.positionStyles=s,this.button.commentsPosition=n},this.positionComments=()=>{var t;this.element=document.createElement("superviz-comments"),this.element.setAttribute("comments",JSON.stringify([])),this.element.side="left",this.element.offset=this.offset,document.body.appendChild(this.element);let i=null==(t=this.layoutOptions)?void 0:t.position;if(!i)return;let r=i.toUpperCase();eS[r]&&(this.element.side=eS[r])},this.createAnnotation=t=>ec(this,[t],function*({detail:t}){try{let{text:i,mentions:r}=t,n=er({},this.coordinates),s=yield i$.createAnnotations(eM.get("apiUrl"),eM.get("apiKey"),{roomId:eM.get("roomId"),position:JSON.stringify(n),userId:this.localParticipantId}),a=yield this.createComment(s.uuid,i,r);this.addAnnotation(en(er({},s),{comments:[a]})),this.pinAdapter.removeAnnotationPin("temporary-pin"),document.body.dispatchEvent(new CustomEvent("select-annotation",{detail:{uuid:s.uuid,haltGoToPin:!0,newPin:!0},composed:!0,bubbles:!0}))}catch(t){this.logger.log("error when creating annotation",t)}}),this.deleteAnnotation=t=>ec(this,[t],function*({detail:t}){try{let{uuid:i}=t;yield i$.deleteAnnotation(eM.get("apiUrl"),eM.get("apiKey"),i);let r=this.annotations.filter(t=>t.uuid!==i);this.updateAnnotationList(r),this.pinAdapter.removeAnnotationPin(i),this.element.updateAnnotations(this.annotations)}catch(t){this.logger.log("error when deleting annotation",t)}}),this.updateComment=t=>ec(this,[t],function*({detail:t}){try{let{uuid:i,text:r,mentions:n}=t,s=yield i$.updateComment(eM.get("apiUrl"),eM.get("apiKey"),i,r);yield i$.createMentions({commentsId:s.uuid,participants:n.map(t=>({id:t.userId}))});let a=this.annotations.map(t=>Object.assign({},t,{comments:t.comments.map(t=>t.uuid===i?Object.assign({},t,{text:r,mentions:n}):t)}));this.updateAnnotationList(a)}catch(t){this.logger.log("error when updating comment",t)}}),this.resolveAnnotation=t=>ec(this,[t],function*({detail:t}){try{let{uuid:i}=t,{resolved:r}=yield i$.resolveAnnotation(eM.get("apiUrl"),eM.get("apiKey"),i),n=this.annotations.map(t=>t.uuid===i?Object.assign({},t,{resolved:r}):t);if(this.updateAnnotationList(n),r){this.pinAdapter.removeAnnotationPin(i);return}this.pinAdapter.updateAnnotations(this.annotations)}catch(t){this.logger.log("error when resolve annotation",t)}}),this.deleteComment=t=>ec(this,[t],function*({detail:t}){try{let{uuid:i,annotationId:r}=t;if(!i||!r)return;yield i$.deleteComment(eM.get("apiUrl"),eM.get("apiKey"),i);let n=this.annotations.find(t=>t.uuid===r);n.comments=n.comments.filter(t=>t.uuid!==i);let s=this.annotations.map(t=>t.uuid===r?n:t);this.element.updateAnnotations(s),this.updateAnnotationList(s)}catch(t){this.logger.log("error when deleting comment",t)}}),this.onAnnotationListUpdate=t=>{let{data:i,clientId:r}=t;this.localParticipantId!==r&&(this.annotations=i,this.element.updateAnnotations(this.annotations),this.pinAdapter.updateAnnotations(this.annotations))},this.name="comments",this.logger=new iB("@superviz/sdk/comments-component"),this.annotations=[],this.layoutOptions={buttonLocation:null!=(r=null==i?void 0:i.buttonLocation)?r:"top-left",position:null!=(n=null==i?void 0:i.position)?n:"left"},this.hideDefaultButton=null!=(s=null==i?void 0:i.hideDefaultButton)&&s,this.setStyles(null==i?void 0:i.styles),this.offset=null==i?void 0:i.offset,setTimeout(()=>{var i,r;t.setCommentsMetadata(null!=(r=null==(i=this.layoutOptions)?void 0:i.position)?r:"left")}),this.pinAdapter=t;let{group:a,localParticipant:l}=this.useStore("global-store");a.subscribe(),l.subscribe(t=>{this.localParticipantId=t.id})}enable(){this.pinAdapter.setActive(!0),this.pinActive=!0,this.publish("pin-mode.active"),document.body.dispatchEvent(new CustomEvent("toggle-pin-active",{detail:{isActive:!0}}))}disable(){this.pinAdapter.setActive(!1),this.pinActive=!1,this.publish("pin-mode.inactive"),document.body.dispatchEvent(new CustomEvent("toggle-pin-active",{detail:{isActive:!1}}))}start(){"u">typeof window&&(this.clientUrl=window.location.href,this.positionComments(),this.hideDefaultButton||this.positionFloatingButton(),this.fetchAnnotations(),this.waterMarkState(),this.participantsList(),this.addListeners(),this.pinAdapter.setPinsVisibility(!0))}destroy(){var t;this.logger.log("comments component @ destroy"),this.destroyListeners(),null==(t=this.button)||t.remove(),this.element.remove(),this.element=void 0,this.pinAdapter.destroy()}addListeners(){var t;null==(t=this.button)||t.addEventListener("toggle",this.togglePinActive),this.element.addEventListener("close-threads",this.closeThreads),document.body.addEventListener("create-annotation",this.createAnnotation),this.element.addEventListener("resolve-annotation",this.resolveAnnotation),this.element.addEventListener("delete-annotation",this.deleteAnnotation),this.element.addEventListener("create-comment",({detail:t})=>{this.createComment(t.uuid,t.text,t.mentions,!0)}),this.element.addEventListener("update-comment",this.updateComment),this.element.addEventListener("delete-comment",this.deleteComment),document.body.addEventListener("select-annotation",this.onSelectAnnotation),this.room.on("update-comments",this.onAnnotationListUpdate),this.pinAdapter.onPinFixedObserver.subscribe(this.onPinFixed)}destroyListeners(){var t;null==(t=this.button)||t.removeEventListener("toggle",this.togglePinActive),this.element.removeEventListener("close-threads",this.closeThreads),this.element.removeEventListener("resolve-annotation",this.resolveAnnotation),this.element.removeEventListener("create-comment",({detail:t})=>{this.createComment(t.uuid,t.text,t.mentions,!0)}),this.element.removeEventListener("update-comment",this.updateComment),this.element.removeEventListener("delete-comment",this.deleteComment),document.body.removeEventListener("select-annotation",this.onSelectAnnotation),document.body.removeEventListener("create-annotation",this.createAnnotation),this.room.off("update-comments",this.onAnnotationListUpdate),this.pinAdapter.onPinFixedObserver.unsubscribe(this.onPinFixed)}setStyles(t=""){if(!t)return;let i=document.createElement("style");i.textContent=t,i.id="superviz-comments-styles",document.head.appendChild(i)}createComment(t,i){return ec(this,arguments,function*(t,i,r=[],n=!1){try{let s=yield i$.createComment(eM.get("apiUrl"),eM.get("apiKey"),{annotationId:t,userId:this.localParticipantId,text:i});return yield i$.createMentions({commentsId:s.uuid,participants:r.map(t=>({id:t.userId,readed:0}))}),s.mentions=r,n&&this.addComment(t,s),s}catch(t){this.logger.log("error when creating comment",t)}})}addAnnotation(t){let i=[t,...this.annotations];this.element.updateAnnotations(i),this.pinAdapter.updateAnnotations(i),this.updateAnnotationList(i)}updateAnnotationList(t){this.annotations=t,this.room.emit("update-comments",t)}addComment(t,i){let r=this.annotations.find(i=>i.uuid===t);r.comments.push(i);let n=this.annotations.map(i=>i.uuid===t?r:i);this.updateAnnotationList(n),this.element.updateAnnotations(n)}fetchAnnotations(){return ec(this,null,function*(){try{let t=yield i$.fetchAnnotation(eM.get("apiUrl"),eM.get("apiKey"),{roomId:eM.get("roomId")});this.annotations=t,this.element.updateAnnotations(this.annotations),this.pinAdapter.updateAnnotations(this.annotations)}catch(t){this.logger.log("error when fetching annotations",t)}})}waterMarkState(){return ec(this,null,function*(){try{let t=yield i$.fetchWaterMark(eM.get("apiUrl"),eM.get("apiKey"));this.element.waterMarkStatus(t)}catch(t){this.logger.log("error when fetching waterMark",t)}})}participantsList(){return ec(this,null,function*(){try{let t=(yield i$.fetchParticipantsByGroup(this.group.id)).data;this.pinAdapter.participantsList=t,this.element.participantsList=t}catch(t){this.logger.log("error when fetching participantsList",t)}})}};eh();var ar=class{constructor(t,i){if(this.isPinsVisible=!0,this.selectedPin=null,this.temporaryPinCoordinates=null,this.commentsSide="left",this.setCommentsMetadata=t=>{this.commentsSide=t},this.resetPins=t=>{t&&(null==t?void 0:t.key)!=="Escape"||(this.resetSelectedPin(),this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates=null)},this.animate=()=>{(this.isActive||this.isPinsVisible)&&(this.renderAnnotationsPins(),this.divWrapper=this.renderDivWrapper()),this.temporaryPinCoordinates&&this.renderTemporaryPin(),this.animateFrame=requestAnimationFrame(this.animate)},this.setMouseDownCoordinates=({x:t,y:i})=>{this.mouseDownCoordinates={x:t,y:i}},this.annotationSelected=({detail:{uuid:t,haltGoToPin:i,newPin:r}})=>{var n,s;if(!t)return;r&&this.pins.get(t).setAttribute("newPin","");let a=JSON.parse(null!=(s=null==(n=this.selectedPin)?void 0:n.getAttribute("annotation"))?s:"{}");if(this.resetPins(),(null==a?void 0:a.uuid)===t)return;document.body.dispatchEvent(new CustomEvent("close-temporary-annotation"));let l=this.pins.get(t);l&&(l.setAttribute("active",""),this.selectedPin=l,i||this.goToPin(t))},this.onClick=t=>{if(!this.isActive)return;let i=this.canvas.getBoundingClientRect(),{x:r,y:n}=this.mouseDownCoordinates,s=r-i.x,a=n-i.y,l=t.clientX-i.left,u=t.clientY-i.top;if(Math.hypot(l-s,u-a)>10)return;let c=this.canvas.getContext("2d").getTransform().inverse(),h=new DOMPoint(l,u-31).matrixTransform(c);this.onPinFixedObserver.publish({x:h.x,y:h.y,type:"canvas"}),this.resetSelectedPin(),this.temporaryPinCoordinates={x:h.x,y:h.y},this.renderTemporaryPin();let d=document.getElementById("superviz-temporary-pin");this.movedTemporaryPin=!this.movedTemporaryPin,d.setAttribute("movedPosition",String(this.movedTemporaryPin)),this.selectedPin||document.body.dispatchEvent(new CustomEvent("unselect-annotation"))},this.onToggleAnnotationSidebar=({detail:t})=>{let{open:i}=t;i||(this.pins.forEach(t=>{t.removeAttribute("active")}),this.pins.has("temporary-pin")&&this.removeAnnotationPin("temporary-pin"))},this.hideTemporaryPin=t=>{var i;let r=t.target,n=r.contains(this.canvas),{x:s,y:a}=t,{left:l,top:u,right:c,bottom:h}=this.canvas.getBoundingClientRect();this.canvas.contains(r)||null!=(i=this.pins.get("temporary-pin"))&&i.contains(r)||n&&s>l&&s<c&&a>u&&a<h||(this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates=null)},this.logger=new iB("@superviz/sdk/comments-component/canvas-pin-adapter"),this.canvas=document.getElementById(t),this.isActive=!1,this.pins=new Map,this.goToPinCallback=null==i?void 0:i.onGoToPin,!this.canvas){let i=`Canvas with id ${t} not found`;throw this.logger.log(i),Error(i)}this.canvasSides=this.canvas.getBoundingClientRect(),document.body.style.position="relative",this.onPinFixedObserver=new iz({logger:this.logger}),this.divWrapper=this.renderDivWrapper(),this.annotations=[],this.renderAnnotationsPins(),this.animateFrame=requestAnimationFrame(this.animate),document.body.addEventListener("select-annotation",this.annotationSelected),document.body.addEventListener("keyup",this.resetPins)}destroy(){this.isActive=!1,this.removeListeners(),this.removeAnnotationsPins(),this.pins=new Map,this.divWrapper.remove(),this.divWrapper=null,this.onPinFixedObserver.destroy(),this.onPinFixedObserver=null,this.canvas.style.cursor="default",this.annotations=[],cancelAnimationFrame(this.animateFrame),document.body.removeEventListener("select-annotation",this.annotationSelected),document.body.removeEventListener("keyup",this.resetPins)}setPinsVisibility(t){if(this.isPinsVisible=t,this.isPinsVisible){this.renderAnnotationsPins();return}this.removeAnnotationsPins()}setActive(t){if(this.isActive!==t){if(this.isActive=t,this.isActive){this.originalCanvasCursor=this.canvas.style.cursor,this.canvas.style.cursor='url("https://production.cdn.superviz.com/static/pin-html.png") 0 100, pointer',this.addListeners();return}this.resetPins(),this.removeListeners(),this.canvas.style.cursor=this.originalCanvasCursor}}updateAnnotations(t){this.logger.log("updateAnnotations",t),this.annotations=t,(this.isActive||this.isPinsVisible)&&(this.removeAnnotationsPins(),this.renderAnnotationsPins())}removeAnnotationPin(t){let i=this.pins.get(t);i&&(i.remove(),this.pins.delete(t),"temporary-pin"!==t&&(this.annotations=this.annotations.filter(i=>i.uuid!==t)))}renderTemporaryPin(){let t=document.getElementById("superviz-temporary-pin");t||((t=document.createElement("superviz-comments-annotation-pin")).id="superviz-temporary-pin",t.setAttribute("type","add"),t.setAttribute("showInput",""),t.setAttribute("containerSides",JSON.stringify(this.canvasSides)),t.setAttribute("commentsSide",this.commentsSide),t.setAttribute("position",JSON.stringify(this.temporaryPinCoordinates)),t.setAttribute("annotation",JSON.stringify({})),t.setAttribute("participantsList",JSON.stringify(this.participants)),t.setAttributeNode(document.createAttribute("active")),this.divWrapper.appendChild(t));let{x:i,y:r}=this.temporaryPinCoordinates,n=this.canvas.getContext("2d").getTransform(),s=n.e,a=n.f,l=n.a,u=n.d;t.setAttribute("position",JSON.stringify({x:i*l+s,y:r*u+a})),this.pins.set("temporary-pin",t)}addListeners(){this.canvas.addEventListener("click",this.onClick),this.canvas.addEventListener("mousedown",this.setMouseDownCoordinates),document.body.addEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),document.body.addEventListener("click",this.hideTemporaryPin)}removeListeners(){this.canvas.removeEventListener("click",this.onClick),this.canvas.removeEventListener("mousedown",this.setMouseDownCoordinates),document.body.removeEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),document.body.addEventListener("click",this.hideTemporaryPin)}resetSelectedPin(){this.selectedPin&&(this.selectedPin.removeAttribute("active"),this.selectedPin=null)}renderDivWrapper(){let t=this.canvas.getBoundingClientRect(),i=this.divWrapper;return i||((i=document.createElement("div")).id="superviz-canvas-wrapper",["","static"].includes(this.canvas.parentElement.style.position)&&(this.canvas.parentElement.style.position="relative")),i.style.position="absolute",i.style.top=`${this.canvas.offsetTop}px`,i.style.left=`${this.canvas.offsetLeft}px`,i.style.width=`${t.width}px`,i.style.height=`${t.height}px`,i.style.pointerEvents="none",i.style.overflow="hidden",document.getElementById("superviz-canvas-wrapper")||this.canvas.parentElement.appendChild(i),i}renderAnnotationsPins(){if((!this.annotations.length||"none"===this.canvas.style.display)&&!this.pins.get("temporary-pin")){this.removeAnnotationsPins();return}this.annotations.forEach(t=>{if(t.resolved)return;let i=JSON.parse(t.position);if((null==i?void 0:i.type)!=="canvas")return;let{x:r,y:n}=i,s=this.canvas.getContext("2d").getTransform(),a=s.e,l=s.f,u=s.a,c=s.d,h=r*u+a,d=n*c+l;if(this.pins.has(t.uuid)){let i=this.pins.get(t.uuid);if(this.divWrapper.clientWidth>h&&this.divWrapper.clientHeight>d){i.setAttribute("style","opacity: 1"),this.pins.get(t.uuid).setAttribute("position",JSON.stringify({x:h,y:d}));return}i.setAttribute("style","opacity: 0");return}let p=document.createElement("superviz-comments-annotation-pin");p.setAttribute("type","show"),p.setAttribute("participantsList",JSON.stringify(this.participants)),p.setAttribute("annotation",JSON.stringify(t)),p.setAttribute("position",JSON.stringify({x:h,y:d})),p.id=t.uuid,this.divWrapper.appendChild(p),this.pins.set(t.uuid,p)})}removeAnnotationsPins(){this.pins.forEach(t=>{t.remove()}),this.pins.clear()}set participantsList(t){this.participants=t}goToPin(t){let i=this.annotations.find(i=>i.uuid===t);if(!i)return;let r=JSON.parse(i.position);if((null==r?void 0:r.type)!=="canvas")return;let{width:n,height:s}=this.canvas.getBoundingClientRect(),{x:a,y:l}=r;this.goToPinCallback&&this.goToPinCallback({x:n/2-a,y:s/2-l})}};eh();var an=el(ex()),as=class{constructor(t,i={}){if(this.isPinsVisible=!0,this.selectedPin=null,this.dataAttribute="data-superviz-id",this.commentsSide="left",this.temporaryPinCoordinates={},this.elementsWithDataId={},this.divWrappers=new Map,this.voidElementsWrappers=new Map,this.VOID_ELEMENTS=["area","base","br","col","embed","hr","img","input","link","meta","param","source","track","wbr","svg","rect","ellipse"],this.animate=()=>{this.voidElementsWrappers&&(this.updatePinsPositions(),this.animateFrame=requestAnimationFrame(this.animate))},this.setCommentsMetadata=t=>{this.commentsSide=t},this.hideTemporaryPin=t=>{var i;let r=t.target,n=this.divWrappers.get(this.temporaryPinCoordinates.elementId);if(!n)return;let s=n.contains(r),a=null==(i=this.pins.get("temporary-pin"))?void 0:i.contains(r);s||a||(this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates={})},this.resetPins=t=>{t&&(null==t?void 0:t.key)!=="Escape"||(this.resetSelectedPin(),this.resetHoveredWrapper(),this.temporaryPinCoordinates.elementId&&(this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates={}))},this.annotationSelected=({detail:{uuid:t,newPin:i}})=>{if(!t)return;i&&this.pins.get(t).setAttribute("newPin","");let r=this.annotations.find(t=>{var i;return t.uuid===(null==(i=this.selectedPin)?void 0:i.id)});if(this.resetPins(),(null==r?void 0:r.uuid)===t)return;document.body.dispatchEvent(new CustomEvent("close-temporary-annotation"));let n=this.pins.get(t);if(!n)return;n.setAttribute("active",""),this.selectedPin=n;let s=this.annotations.find(i=>i.uuid===t);this.selectedPin.setAttribute("elementId",JSON.parse(s.position).elementId)},this.onClick=t=>{if(!this.isActive||t.target===this.pins.get("temporary-pin"))return;let i=t.target,r=t.currentTarget;if(i!==r&&this.pins.has(i.id))return;let n=r.getAttribute("data-wrapper-id"),s=r.getBoundingClientRect(),{x:a,y:l}=this.mouseDownCoordinates,u=t.clientX-s.left,c=t.clientY-s.top;if(Math.hypot(u-(a-s.x),c-(l-s.y))>10)return;let{width:h,height:d}=r.getBoundingClientRect(),p=r.getBoundingClientRect().width/r.offsetWidth||1;u=100*u/h,c=(c-32*p)*100/d,this.onPinFixedObserver.publish({x:u,y:c,type:"html",elementId:n}),this.resetSelectedPin(),this.temporaryPinCoordinates=en(er({},this.temporaryPinCoordinates),{x:u,y:c}),this.renderTemporaryPin(n);let f=this.pins.get("temporary-pin");this.movedTemporaryPin=!this.movedTemporaryPin,f.setAttribute("movedPosition",String(this.movedTemporaryPin)),document.body.dispatchEvent(new CustomEvent("unselect-annotation"))},this.onMouseDown=({x:t,y:i})=>{this.mouseDownCoordinates={x:t,y:i}},this.handleMutationObserverChanges=t=>{t.forEach(t=>{var i;let{target:r,oldValue:n}=t,s=r.getAttribute(this.dataAttribute);if(!s&&!n||s===n)return;let a=this.dataAttributeValueFilters.some(t=>n.match(t));if(!s&&n&&!a){this.removeAnnotationPin("temporary-pin"),this.clearElement(n),(null==(i=this.selectedPin)?void 0:i.getAttribute("elementId"))===n&&(document.body.dispatchEvent(new CustomEvent("unselect-annotation")),this.selectedPin=null);return}let l=this.dataAttributeValueFilters.some(t=>s.match(t));(n&&this.elementsWithDataId[n]||l)&&this.clearElement(n),l||(this.setElementReadyToPin(r,s),this.renderAnnotationsPins())})},this.onToggleAnnotationSidebar=({detail:t})=>{let{open:i}=t;i||(this.resetSelectedPin(),this.pins.has("temporary-pin")&&(this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates.elementId=void 0))},this.onMouseEnter=t=>{var i;let r=t.target;if(this.hoveredWrapper=r,!(null!=(i=r.getAttribute("data-wrapper-type"))&&i.includes("ellipse"))){this.hoveredWrapper.style.setProperty("outline","1px solid rgb(var(--sv-primary))");return}let n=r.querySelector("ellipse");n.setAttribute("stroke","rgb(var(--sv-primary))"),n.setAttribute("stroke-width","1")},this.onMouseLeave=t=>{var i;let r=t.target;if(this.hoveredWrapper=r,!(null!=(i=r.getAttribute("data-wrapper-type"))&&i.includes("ellipse"))){this.hoveredWrapper.style.setProperty("outline","");return}let n=r.querySelector("ellipse");n.removeAttribute("stroke"),n.removeAttribute("stroke-width")},this.logger=new iB("@superviz/sdk/comments-component/container-pin-adapter"),this.container=document.getElementById(t),!this.container){let i=`Element with id ${t} not found`;throw this.logger.log(i),Error(i)}if("object"!=typeof i)throw Error("Second argument of the HTMLPin constructor must be an object");let{dataAttributeName:r,dataAttributeValueFilters:n}=i;if(""===r)throw Error("dataAttributeName must be a non-empty string");if(null===r)throw Error("dataAttributeName cannot be null");if(void 0!==r&&"string"!=typeof r)throw Error("dataAttributeName must be a non-empty string");this.dataAttribute=r||this.dataAttribute,this.dataAttributeValueFilters=n||[],this.isActive=!1,this.prepareElements(),this.mutationObserver=new MutationObserver(this.handleMutationObserverChanges),this.observeContainer(),this.pins=new Map,this.onPinFixedObserver=new iz({logger:this.logger}),this.annotations=[],document.body.addEventListener("select-annotation",this.annotationSelected),document.body.addEventListener("keyup",this.resetPins),this.voidElementsWrappers.size&&(this.animateFrame=requestAnimationFrame(this.animate))}destroy(){var t;this.logger.log("Destroying HTML Pin Adapter for Comments"),this.removeListeners(),this.removeObservers(),this.divWrappers.forEach(t=>t.remove()),this.divWrappers.clear(),this.pins.forEach(t=>t.remove()),this.pins.clear(),this.divWrappers=void 0,this.pins=void 0,this.elementsWithDataId=void 0,this.logger=void 0,this.onPinFixedObserver.destroy(),this.onPinFixedObserver=void 0,this.container=void 0,this.voidElementsWrappers.clear(),this.voidElementsWrappers=void 0,this.annotations=[],null==(t=this.svgWrappers)||t.remove(),this.svgWrappers=void 0,document.body.removeEventListener("select-annotation",this.annotationSelected),document.body.removeEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),cancelAnimationFrame(this.animateFrame)}addElementListeners(t){this.divWrappers.get(t).addEventListener("click",this.onClick,!0),this.divWrappers.get(t).addEventListener("mousedown",this.onMouseDown),this.divWrappers.get(t).addEventListener("mouseenter",this.onMouseEnter),this.divWrappers.get(t).addEventListener("mouseleave",this.onMouseLeave)}removeElementListeners(t){this.divWrappers.get(t).removeEventListener("click",this.onClick,!0),this.divWrappers.get(t).removeEventListener("mousedown",this.onMouseDown),this.divWrappers.get(t).removeEventListener("mouseenter",this.onMouseEnter),this.divWrappers.get(t).removeEventListener("mouseleave",this.onMouseLeave)}set participantsList(t){this.participants=t}removeObservers(){this.mutationObserver.disconnect(),this.mutationObserver=void 0}addListeners(){this.divWrappers.forEach((t,i)=>this.addElementListeners(i)),document.body.addEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),document.body.addEventListener("click",this.hideTemporaryPin)}removeListeners(){this.divWrappers.forEach((t,i)=>this.removeElementListeners(i)),document.body.removeEventListener("keyup",this.resetPins),document.body.removeEventListener("click",this.hideTemporaryPin)}observeContainer(){this.mutationObserver.observe(this.container,{subtree:!0,attributes:!0,attributeFilter:[this.dataAttribute],attributeOldValue:!0})}prepareElements(){this.container.querySelectorAll(`[${this.dataAttribute}]`).forEach(t=>{let i=t.getAttribute(this.dataAttribute);this.dataAttributeValueFilters.some(t=>i.match(t))||this.setElementReadyToPin(t,i)})}addAllCursors(){this.divWrappers.forEach((t,i)=>{this.addCursor(t,i)})}removeAddCursor(){this.divWrappers.forEach((t,i)=>{let r=t,n=t.getAttribute("data-wrapper-type");if(n){let t=n.split("-")[1];r=this.divWrappers.get(i).querySelector(t)}r.style.setProperty("cursor","default"),r.style.setProperty("pointer-events","none")})}setPinsVisibility(t){this.isPinsVisible=t,this.isPinsVisible&&this.renderAnnotationsPins(),this.removeAnnotationsPins()}removeAnnotationPin(t){let i=this.pins.get(t);(i||"temporary-pin"!==t)&&(i&&(i.remove(),this.pins.delete(t)),"temporary-pin"!==t&&(this.annotations=this.annotations.filter(i=>i.uuid!==t)))}updateAnnotations(t){this.logger.log("updateAnnotations",t),this.annotations=t,this.isPinsVisible&&(this.removeAnnotationsPins(),this.renderAnnotationsPins())}setActive(t){if(this.isActive!==t){if(this.isActive=t,this.isActive){this.addListeners(),this.addAllCursors(),this.prepareElements();return}this.resetPins(),this.removeListeners(),this.removeAddCursor()}}renderTemporaryPin(t){var i,r;(i=this.temporaryPinCoordinates).elementId||(i.elementId=t);let n=this.pins.get("temporary-pin");if(t&&t!==this.temporaryPinCoordinates.elementId&&(this.pins.get("temporary-pin").remove(),this.pins.delete("temporary-pin"),this.temporaryPinCoordinates.elementId=t,n=null),!n){let i=null==(r=this.elementsWithDataId[t])?void 0:r.getBoundingClientRect();(n=document.createElement("superviz-comments-annotation-pin")).id="superviz-temporary-pin",n.setAttribute("type","add"),n.setAttribute("showInput",""),n.setAttribute("containerSides",JSON.stringify(i)),n.setAttribute("commentsSide",this.commentsSide),n.setAttribute("position",JSON.stringify(this.temporaryPinCoordinates)),n.setAttribute("annotation",JSON.stringify({})),n.setAttribute("participantsList",JSON.stringify(this.participants)),n.setAttribute("keepPositionRatio",""),n.setAttributeNode(document.createAttribute("active")),this.addTemporaryPinToElement(t,n)}let{x:s,y:a}=this.temporaryPinCoordinates;n.setAttribute("position",JSON.stringify({x:s,y:a})),this.pins.set("temporary-pin",n)}renderAnnotationsPins(){if(!this.annotations.length){this.removeAnnotationsPins();return}this.annotations.forEach(t=>{if(t.resolved)return;let{x:i,y:r,elementId:n,type:s}=JSON.parse(t.position);if("html"!==s||this.pins.has(t.uuid)||!this.elementsWithDataId[n])return;let a=this.divWrappers.get(n);if(!a)return;let l=this.createPin(t,i,r);a.appendChild(l),this.pins.set(t.uuid,l)})}updatePinsPositions(){this.voidElementsWrappers.forEach((t,i)=>{let r=JSON.stringify(t.getBoundingClientRect()),n=this.elementsWithDataId[i].getBoundingClientRect();"ellipse"===this.elementsWithDataId[i].tagName.toLowerCase()&&(n=this.elementsWithDataId[i].viewportElement.getBoundingClientRect()),(0,an.isEqual)(JSON.stringify(n),r)||(t.style.setProperty("top",`${n.top}px`),t.style.setProperty("left",`${n.left}px`),t.style.setProperty("width",`${n.width}px`),t.style.setProperty("height",`${n.height}px`))})}clearElement(t){if(!this.elementsWithDataId[t])return;let i=this.divWrappers.get(t);if(i){let t=i.children,{length:r}=t;for(let i=0;i<r;++i){let r=t.item(i);this.pins.delete(r.id)}i.remove()}this.voidElementsWrappers.delete(t),this.removeElementListeners(t),this.divWrappers.delete(t),this.elementsWithDataId[t]=void 0,this.voidElementsWrappers.size||(cancelAnimationFrame(this.animateFrame),this.animateFrame=void 0)}resetSelectedPin(){this.selectedPin&&(this.selectedPin.removeAttribute("active"),this.selectedPin=null)}resetHoveredWrapper(){this.hoveredWrapper&&this.onMouseLeave({target:this.hoveredWrapper})}removeAnnotationsPins(){this.pins.forEach(t=>{t.remove()}),this.pins.clear()}setElementReadyToPin(t,i){if(!this.elementsWithDataId[i]){if(this.elementsWithDataId[i]=t,!this.divWrappers.get(i)){let r=this.createWrapper(t,i);this.divWrappers.set(i,r)}this.isActive&&this.isPinsVisible&&(this.addCursor(this.divWrappers.get(i),i),this.addElementListeners(i))}}handleSvgElement(t,i){let r=t.viewportElement;if(void 0===r)return;if("svg"===t.tagName.toLowerCase()){let r=document.createElementNS("http://www.w3.org/2000/svg","foreignObject");return r.setAttribute("height","100%"),r.setAttribute("width","100%"),r.style.setProperty("overflow","visible"),r.appendChild(i),t.appendChild(r),t.style.setProperty("overflow","visible"),i}let n=t.tagName.toLowerCase(),s="ellipse"===n,a="rect"===n;if(!s&&!a)return;let l=document.createElementNS("http://www.w3.org/2000/svg","svg"),u=document.createElementNS("http://www.w3.org/2000/svg",n),c,h,d,p;if(a&&(t.getAttribute("x"),t.getAttribute("y"),c=t.getAttribute("width"),h=t.getAttribute("height"),d=t.getAttribute("rx"),p=t.getAttribute("ry"),u.setAttribute("fill","transparent"),u.setAttribute("stroke","transparent"),u.setAttribute("x","0"),u.setAttribute("y","0"),u.setAttribute("rx",d),u.setAttribute("ry",p)),s){let i=t.getAttribute("cx"),n=t.getAttribute("cy");d=t.getAttribute("rx"),p=t.getAttribute("ry");let{width:s,height:a}=r.getBoundingClientRect();c=`${s}px`,h=`${a}px`,u.setAttribute("fill","transparent"),u.setAttribute("stroke","transparent"),u.setAttribute("cx",i),u.setAttribute("cy",n),u.setAttribute("rx",d),u.setAttribute("ry",p)}return u.setAttribute("height",h),u.setAttribute("width",c),l.setAttribute("height",h),l.setAttribute("width",c),l.appendChild(u),i.appendChild(l),t.style.setProperty("overflow","visible"),i.setAttribute("data-wrapper-type",`svg-${n}`),i}addTemporaryPinToElement(t,i){if(!this.elementsWithDataId[t])return;let r=this.divWrappers.get(t);r&&r.appendChild(i)}createPin(t,i,r){let n=document.createElement("superviz-comments-annotation-pin");return n.setAttribute("type","show"),n.setAttribute("annotation",JSON.stringify(t)),n.setAttribute("position",JSON.stringify({x:i,y:r})),n.setAttribute("keepPositionRatio",""),n.setAttribute("participantsList",JSON.stringify(this.participants)),n.id=t.uuid,n}addCursor(t,i){let r=t,n=t.getAttribute("data-wrapper-type");if(n){let t=n.split("-")[1];r=this.divWrappers.get(i).querySelector(t)}r.style.setProperty("cursor",'url("https://production.cdn.superviz.com/static/pin-html.png") 0 100, pointer'),r.style.setProperty("pointer-events","auto")}createWrapper(t,i){var r;let n=`superviz-id-${i}`;if(this.divWrappers.get(i))return;let s=t.getBoundingClientRect(),a=document.createElement("div");a.setAttribute("data-wrapper-id",i),a.id=n,a.style.position="absolute",a.style.pointerEvents="none",a.style.transform="translateX(0) translateY(0) scale(1)",a.style.cursor="default",a.style.top="0",a.style.left="0",a.style.width="100%",a.style.height="100%",a.style.pointerEvents="none";let l=window.getComputedStyle(t).getPropertyValue("border-radius");if(a.style.borderRadius=l,!this.VOID_ELEMENTS.includes(this.elementsWithDataId[i].tagName.toLowerCase()))return this.elementsWithDataId[i].appendChild(a),this.setPositionNotStatic(this.elementsWithDataId[i]),a;(a=null!=(r=this.handleSvgElement(t,a))?r:a).style.position="fixed",a.style.top=`${s.top}px`,a.style.left=`${s.left}px`,a.style.width=`${s.width}px`,a.style.height=`${s.height}px`;let u=this.elementsWithDataId[i].parentElement;return(!u||t.viewportElement)&&(u=document.body),this.setPositionNotStatic(u),u.appendChild(a),this.voidElementsWrappers.set(i,a),this.animateFrame||(this.animateFrame=requestAnimationFrame(this.animate)),a}setPositionNotStatic(t){let{position:i}=window.getComputedStyle(t);"static"===i&&t.style.setProperty("position","relative")}};eh(),eh();var ao=el(iF()),aa=class{constructor(){this.browser=ao.default.getParser(navigator.userAgent)}get clientStats(){return this.browser.getResult()}get isFirefox(){return this.browser.isBrowser(ao.default.BROWSER_MAP.firefox)}get isSafari(){return this.browser.isBrowser(ao.default.BROWSER_MAP.safari)}get isChrome(){return this.browser.isBrowser(ao.default.BROWSER_MAP.chrome)}get isIE(){return this.browser.isBrowser(ao.default.BROWSER_MAP.ie)}get isEdge(){return this.browser.isBrowser(ao.default.BROWSER_MAP.edge)}get isMobileDevice(){return(this.browser.is(ao.default.PLATFORMS_MAP.mobile)||this.browser.is(ao.default.PLATFORMS_MAP.tablet))&&!navigator.userAgent.match(/iPad/i)}get isTabletDevice(){return this.browser.is(ao.default.PLATFORMS_MAP.tablet)}get isAndroid(){return this.isMobileDevice&&!!navigator.userAgent.match(/Android/i)}get isIpad(){return!!navigator.userAgent.match(/iPad/i)}get isIphone(){return this.isMobileDevice&&!!navigator.userAgent.match(/iPhone/i)}get isAppleMobileDevice(){return this.isIpad||this.isIphone}};eh();var al=class{constructor(){this.updateMeetingConnectionStatus=t=>{this.oldConnectionStatus=this.connectionStatus,this.connectionStatus=t,this.connectionStatusObserver.publish(t),this.logger.log("CONNECTION STATUS CHANGE",t)},this.onUpdateBrowserOnlineStatus=t=>{let{type:i}=t;if("online"===i){this.updateMeetingConnectionStatus(1);return}this.updateMeetingConnectionStatus(4)},this.logger=new iB("@superviz/sdk/connection-service"),this.connectionStatus=0,this.connectionStatusObserver=new iz({logger:this.logger})}addListeners(){"u">typeof window&&(window.addEventListener("online",this.onUpdateBrowserOnlineStatus),window.addEventListener("offline",this.onUpdateBrowserOnlineStatus))}removeListeners(){"u">typeof window&&(window.removeEventListener("online",this.onUpdateBrowserOnlineStatus),window.removeEventListener("offline",this.onUpdateBrowserOnlineStatus))}};eh(),eh();var au=class{constructor(t,i,r){this.myParticipant={},this.localRoomProperties=null,this.drawingData=null,this.state=0,this.MESSAGE_SIZE_LIMIT=6e4,this.useStore=im.bind(this),this.join=()=>{this.room.presence.on(re.LEAVE,this.onParticipantLeave),this.room.presence.on(re.JOINED_ROOM,this.onPresenceEnter),this.enableSync&&(this.room.on("update",this.updateLocalRoomState),this.drawingRoom.presence.on(re.UPDATE,this.updateDrawing))},this.updateMyProperties=t=>{let i=t??{};this.isMessageTooBig(i)||this.left||!this.enableSync||this.isSyncFrozen||(void 0===i.avatar&&delete i.avatar,this.myParticipant=er(er({},this.myParticipant),i),this.room.presence.update(this.myParticipant),this.logger.log("REALTIME","updating my properties",this.myParticipant))},this.isMessageTooBig=(t,i=this.MESSAGE_SIZE_LIMIT)=>{let r=JSON.stringify(t);return new TextEncoder().encode(r).length>i&&(this.logger.log("Message too long, the message limit size is 60kb."),!0)},this.updateRoomProperties=t=>{if(this.isMessageTooBig(t)||this.isSyncFrozen||this.left)return;let i=er(er({},this.localRoomProperties),t);this.localRoomProperties=i,this.room.emit("update",i)},this.updateDrawingProperties=t=>{this.isMessageTooBig(t)||this.isSyncFrozen||this.left||(this.drawingData=er(er({},this.drawingData),t),this.drawingRoom.presence.update(this.drawingData))},this.setHost=t=>{this.updateRoomProperties({hostClientId:t})},this.setKickParticipant=t=>{if(!t)return;let{participants:i}=im("global-store"),r=i.value[t];this.updateRoomProperties({kickParticipant:r})},this.initializeRoomProperties=()=>{let t={isGridModeEnabled:!1,hostClientId:null,followParticipantId:null,gather:!1,transcript:"transcript.stop",kickParticipant:null};this.localRoomProperties=t,this.updateRoomProperties(t)},this.onParticipantLeave=t=>{var i;t.id===this.myParticipant.id&&(this.left=!0),t.id===(null==(i=this.localRoomProperties)?void 0:i.followParticipantId)&&this.setFollowParticipant()},this.start=()=>ec(this,null,function*(){this.started||(this.started=!0,this.room.isJoined||(this.logger.log("room state service - not joined room yet"),setTimeout(()=>{this.logger.log("room state service - retrying"),this.start()},2e3)),this.localRoomProperties=yield this.fetchRoomProperties(),this.localRoomProperties?this.updateLocalRoomState({data:this.localRoomProperties}):this.initializeRoomProperties(),this.publishStateUpdate(4),this.logger.log("REALTIME","Joined realtime room"))}),this.onPresenceEnter=()=>{this.updateMyProperties()},this.updateLocalRoomState=t=>ec(this,[t],function*({data:t}){this.logger.log("REALTIME","Room update received",t),this.localRoomProperties=Object.assign({},this.localRoomProperties,t);let{followParticipantId:i,gather:r,hostId:n,isGridModeEnabled:s,transcript:a}=this.useStore("video-store");i.publish(t.followParticipantId),r.publish(t.gather),n.publish(t.hostClientId),s.publish(t.isGridModeEnabled),a.publish(t.transcript),t.kickParticipant&&t.kickParticipant.id===this.myParticipant.id&&(this.updateRoomProperties({kickParticipant:null}),this.kickParticipantObserver.publish(this.myParticipant.id))}),this.updateDrawing=t=>{if(t.id===this.myParticipant.id)return;let{drawing:i}=this.useStore("video-store");i.publish(t.data)},this.freezeSync=t=>{if(this.isSyncFrozen=t,t){this.destroy();return}this.join()},this.room=t,this.drawingRoom=i,this.logger=r,this.kickParticipantObserver=new iz({logger:this.logger});let{localParticipant:n,participants:s}=this.useStore("global-store");n.subscribe(t=>{this.enableSync="audience"!==t.type,this.myParticipant=er(er({},this.myParticipant),t)}),s.subscribe(),this.join()}setGridMode(t){this.updateRoomProperties({isGridModeEnabled:t})}setDrawing(t){this.updateDrawingProperties(t)}setTranscript(t){this.updateRoomProperties({transcript:t})}fetchRoomProperties(){return ec(this,null,function*(){if((yield new Promise(t=>{this.room.presence.get(i=>{i||t(0),t(i.length)})}))<=1)return null;let t=yield new Promise((t,i)=>{this.room.history(r=>{r||i(r),r.events.length||t(null),t(r.events.pop())})}),i=(null==t?void 0:t.timestamp)<Date.now()-36e5;return!(null!=t&&t.data)||i?null:t.data})}publishStateUpdate(t){if(this.state===t)return;this.state=t,this.logger.log("REALTIME",`Realtime state did change. New state: ${tH[this.state]}`);let{meetingState:i}=this.useStore("video-store");i.publish(this.state)}setFollowParticipant(t){this.updateRoomProperties({followParticipantId:t})}setGather(t){this.updateRoomProperties({gather:t})}destroy(){this.room.presence.off(re.LEAVE),this.room.presence.off(re.JOINED_ROOM),this.drawingRoom.presence.off(re.UPDATE),this.room.off("update",this.updateLocalRoomState)}};eh(),eh();var ac=class{build(t,i,r,n={},s={}){let a=document.querySelector(`#${t}`),l=new URL(i);if(this.wrapperId||this.element)throw Error("Tried to initialize two frames with the same FrameBricklayer instance");this.element=document.createElement("iframe"),Object.entries(n).forEach(([t,i])=>{l.searchParams.set(t,i)}),Object.entries(s).forEach(([t,i])=>{this.element.setAttribute(t,i)}),this.element.src=l.toString(),this.element.id=r,a.appendChild(this.element),this.wrapperId=t}destroy(){if(!this.wrapperId)throw Error("Tried to destroy a frame before it was initialized");let t=document.querySelector(`#${this.wrapperId}`);t&&t.querySelector(`#${this.element.id}`)&&t.removeChild(this.element),this.wrapperId=null,this.element=null}};eh();var ah=class{constructor(t){this.observers={},this.sourceBlockList=["vue-devtools-proxy","vue-devtools-backend"],this.originBlockList=["https://sketchfab.com"],this.publish=(t,i={})=>{this.logger.log("MessageBridge","Posting message to frame",t,i),this.contentWindow.postMessage({type:t,data:i},this.allowedOrigins)},this.listen=(t,i)=>{this.observers[t]||(this.observers[t]=new iz({logger:this.logger})),this.observers[t].subscribe(i)},this.onReceiveMessage=t=>{let{type:i,data:r,source:n}=t.data;if(this.sourceBlockList.includes(n)||this.originBlockList.includes(t.origin))return;let s=!!i,a=!this.domains.length||this.domains.includes(t.origin),l=this.observers.hasOwnProperty(i);if(this.logger.log("MessageBridge",`Message received -
        TYPE: ${t.type}
        ORIGIN: ${t.origin}
        DATA: ${JSON.stringify(t.data)} `),!s||!a||!l){this.logger.log("MessageBridge","Message discarded");return}this.observers[i].publish(r)};let{contentWindow:i,domains:r=[],allowedOrigins:n="*",sourceBlockList:s=[],logger:a}=t;if(this.logger=a,this.domains=r,this.allowedOrigins=n,this.sourceBlockList.push(...s),typeof window>"u")throw Error("MessageBridge: window is undefined");this.contentWindow=i,window.addEventListener("message",this.onReceiveMessage)}destroy(){Object.entries(this.observers).forEach(([t,i])=>{i.reset(),delete this.observers[t]}),"u">typeof window&&window.removeEventListener("message",this.onReceiveMessage),delete this.logger,delete this.allowedOrigins,delete this.contentWindow,delete this.domains,delete this.observers,delete this.sourceBlockList}},ad="sv-video-frame",ap=class{constructor(t){var i,r,n,s;this.logger=new iB("@superviz/sdk/video-conference-manager"),this.frameStateObserver=new iz({logger:this.logger}),this.frameSizeObserver=new iz({logger:this.logger}),this.waitingForHostObserver=new iz({logger:this.logger}),this.realtimeEventsObserver=new iz({logger:this.logger}),this.sameAccountErrorObserver=new iz({logger:this.logger}),this.devicesObserver=new iz({logger:this.logger}),this.meetingStateObserver=new iz({logger:this.logger}),this.meetingConnectionObserver=new iz({logger:this.logger}),this.participantJoinedObserver=new iz({logger:this.logger}),this.participantLeftObserver=new iz({logger:this.logger}),this.participantListObserver=new iz({logger:this.logger}),this.frameState=0,this.layoutModalsAndCamerasConfig=(t,i)=>{let r=t,n=i;return["left","right","bottom","top"].includes(n)||(n="right"),["left","right","center"].includes(r)||(r="right"),this.browserService.isMobileDevice?{layoutPosition:r,camerasPosition:n="bottom"}:("left"===r&&"right"===n&&(r="right"),"right"===r&&"left"===n&&(r="left"),{layoutPosition:r,camerasPosition:n})},this.onFrameLoad=()=>{this.messageBridge=new ah({logger:this.logger,contentWindow:this.bricklayer.element.contentWindow}),this.addMessagesListeners(),this.updateFrameState(2),this.updateFrameLocale(),this.updateMeetingAvatars(),this.onWindowResize(),this.setCustomColors(),this.setCallbacks()},this.setFrameOffset=t=>{let i=t??{};["top","bottom","left","right"].forEach(t=>{Object.keys(i).includes(t)||(i[t]=0)}),this.frameOffset=i},this.setCustomColors=()=>{this.customColors&&this.messageBridge.publish("frame.color-list-update",this.customColors),this.styles&&this.messageBridge.publish("frame.styles-update",this.styles)},this.setCallbacks=()=>{if(!this.callbacks)return;let t={onToggleMicrophone:!!this.callbacks.onToggleMicrophone,onToggleCam:!!this.callbacks.onToggleCam,onToggleRecording:!!this.callbacks.onToggleRecording,onToggleChat:!!this.callbacks.onToggleChat,onToggleScreenShare:!!this.callbacks.onToggleScreenShare,onClickHangup:!!this.callbacks.onClickHangup,onToggleMeetingSetup:!!this.callbacks.onToggleMeetingSetup};this.messageBridge.listen("callback-called",t=>{var i,r;null==(r=(i=this.callbacks)[t])||r.call(i)}),this.messageBridge.publish("frame.callbacks-update",JSON.stringify(t))},this.setFrameStyle=t=>{let i=document.createElement("style"),{bottom:r,left:n,right:s,top:a}=this.frameOffset;if(i.innerHTML=`
      :root {
        --superviz-offset-top: ${a}px;
        --superviz-offset-right: ${s}px;
        --superviz-offset-left: ${n}px;
        --superviz-offset-bottom: ${r}px;
      }     
    `,document.head.appendChild(i),this.browserService.isMobileDevice){this.bricklayer.element.classList.add("sv-video-frame--bottom");return}this.bricklayer.element.classList.add(`sv-video-frame--${t}`)},this.onFrameDimensionsUpdate=({width:t,height:i})=>{if(typeof window>"u")return;let r=document.getElementById(ad),{bottom:n,right:s,left:a,top:l}=this.frameOffset,u=this.isWaterMarkEnabled?40:0,c=`${t}px`,h=`${i+u}px`;(t>=window.innerWidth||this.isHorizontalCameraEnabled)&&(c=`calc(100% - ${s}px - ${a}px)`),i>=window.innerHeight&&(h=`calc(100% - ${l}px - ${n}px)`),r.style.width=c,r.style.height=h,this.frameSizeObserver.publish({width:r.offsetWidth,height:r.offsetHeight})},this.onWindowResize=()=>{let{top:t,bottom:i,right:r,left:n}=this.frameOffset,{innerHeight:s,innerWidth:a}=window;this.messageBridge&&this.messageBridge.publish("frame.parent-window-size-update",{height:s-t-i,width:a-r-n})},this.updateFrameLocale=()=>{var t,i;if(!this.frameLocale||!(null!=(t=this.frameLocale)&&t.language)&&null!=(i=this.frameLocale)&&i.locales)return;let{language:r,locales:n}=this.frameLocale,s=["en",...n.map(t=>null==t?void 0:t.language)];if(r&&!s.includes(r))throw Error("The default language is not available in the language listing.");this.messageBridge.publish("frame.locales-update",this.frameLocale)},this.updateMeetingAvatars=()=>{this.messageBridge.publish("frame.avatar-list-update",this.meetingAvatars)},this.onParticipantJoined=t=>{this.participantJoinedObserver.publish(t)},this.onParticipantLeft=t=>{this.participantLeftObserver.publish(t)},this.onMeetingHostChange=t=>{this.realtimeEventsObserver.publish({event:"realtime.host-change",data:t})},this.onMeetingKickParticipant=t=>{this.realtimeEventsObserver.publish({event:"meeting.kick-participant",data:t})},this.onFollowParticipantDidChange=t=>{this.realtimeEventsObserver.publish({event:"realtime.follow-participant",data:t})},this.onGoToDidChange=t=>{this.realtimeEventsObserver.publish({event:"realtime.go-to-participant",data:t})},this.onGather=()=>{this.realtimeEventsObserver.publish({event:"realtime.gather",data:!0})},this.onGridModeChange=t=>{this.realtimeEventsObserver.publish({event:"realtime.grid-mode-change",data:t})},this.onDrawingChange=t=>{this.realtimeEventsObserver.publish({event:"realtime.drawing-change",data:t})},this.onTranscriptChange=t=>{this.realtimeEventsObserver.publish({event:"realtime.transcript-change",data:t})},this.onSameAccountError=t=>{this.sameAccountErrorObserver.publish(t)},this.onDevicesChange=t=>{this.devicesObserver.publish(t)},this.meetingStateUpdate=t=>{this.meetingStateObserver.publish(t)},this.onConnectionStatusChange=t=>{this.meetingConnectionObserver.publish(t)},this.onWaitingForHostDidChange=t=>{this.waitingForHostObserver.publish(t)},this.onParticipantListUpdate=t=>{this.participantListObserver.publish(t)};let{language:a,canUseCams:l,canUseChat:u,canUseScreenshare:c,canUseDefaultAvatars:h,canUseFollow:d,canUseGoTo:p,canUseGather:f,canShowAudienceList:m,canUseDefaultToolbar:v,canUseRecording:g,browserService:b,offset:y,locales:_,avatars:w,customColors:E,styles:C,waterMark:P,layoutPosition:A,camerasPosition:S,skipMeetingSettings:O,devices:T,layoutMode:x,collaborationMode:k,callbacks:I}=t;this.browserService=b;let M=this.layoutModalsAndCamerasConfig(A,S),R=document.createElement("div");this.frameConfig={apiKey:eM.get("apiKey"),apiUrl:eM.get("apiUrl"),debug:eM.get("debug"),roomId:eM.get("roomId"),limits:eM.get("limits"),collaborationMode:k,canUseFollow:d,canUseGoTo:p,canUseCams:l,canUseChat:u,canUseGather:f,canUseScreenshare:c,canUseDefaultAvatars:h,canUseRecording:g,canShowAudienceList:m,camerasPosition:null!=(i=M.camerasPosition)?i:"right",canUseDefaultToolbar:v,devices:{audioInput:null==(r=null==T?void 0:T.audioInput)||r,audioOutput:null==(n=null==T?void 0:T.audioOutput)||n,videoInput:null==(s=null==T?void 0:T.videoInput)||s},waterMark:P,layoutMode:x,skipMeetingSettings:O,layoutPosition:M.layoutPosition,transcriptLangs:eM.get("features.transcriptLangs")},this.customColors=E,this.callbacks=I,this.styles=C,R.classList.add("sv_video_wrapper"),R.id="sv-video-wrapper",document.body.appendChild(R),this.updateFrameState(1),this.bricklayer=new ac,this.bricklayer.build(R.id,eM.get("conferenceLayerUrl"),ad,void 0,{allow:"camera *;microphone *; display-capture *;"}),this.setFrameOffset(y),this.setFrameStyle(M.camerasPosition),this.bricklayer.element.addEventListener("load",this.onFrameLoad),this.frameLocale={language:a,locales:_},this.meetingAvatars=w,"u">typeof window&&(window.addEventListener("resize",this.onWindowResize),window.addEventListener("orientationchange",this.onWindowResize))}get isWaterMarkEnabled(){return!this.browserService.isMobileDevice&&this.frameConfig.waterMark}get isHorizontalCameraEnabled(){return!this.browserService.isMobileDevice&&["top","bottom"].includes(this.frameConfig.camerasPosition)}addMessagesListeners(){this.messageBridge.listen("meeting.waiting-for-host",this.onWaitingForHostDidChange),this.messageBridge.listen("meeting.participant-joined",this.onParticipantJoined),this.messageBridge.listen("meeting.participant-list-update",this.onParticipantListUpdate),this.messageBridge.listen("meeting.participant-left",this.onParticipantLeft),this.messageBridge.listen("meeting.host-change",this.onMeetingHostChange),this.messageBridge.listen("meeting.kick-participant",this.onMeetingKickParticipant),this.messageBridge.listen("meeting.same-participant-error",this.onSameAccountError),this.messageBridge.listen("meeting.state-update",this.meetingStateUpdate),this.messageBridge.listen("meeting.connection-status-change",this.onConnectionStatusChange),this.messageBridge.listen("meeting.devices-change",this.onDevicesChange),this.messageBridge.listen("realtime.grid-mode-change",this.onGridModeChange),this.messageBridge.listen("realtime.drawing-change",this.onDrawingChange),this.messageBridge.listen("realtime.transcript-change",this.onTranscriptChange),this.messageBridge.listen("frame.dimensions-update",this.onFrameDimensionsUpdate),this.messageBridge.listen("realtime.follow-participant",this.onFollowParticipantDidChange),this.messageBridge.listen("realtime.go-to-participant",this.onGoToDidChange),this.messageBridge.listen("realtime.gather",this.onGather)}updateFrameState(t){t!==this.frameState&&(this.frameState=t,this.frameStateObserver.publish(this.frameState)),this.meetingStateUpdate({1:6,2:7,0:8}[t])}start(t){this.messageBridge.publish("meeting.start",en(er({},t),{config:this.frameConfig}))}leave(){this.messageBridge.publish("meeting.leave"),this.destroy()}destroy(){var t,i,r,n,s,a,l,u,c,h;null==(t=this.messageBridge)||t.destroy(),null==(i=this.bricklayer)||i.destroy(),null==(r=this.frameSizeObserver)||r.destroy(),null==(n=this.realtimeEventsObserver)||n.destroy(),null==(s=this.sameAccountErrorObserver)||s.destroy(),null==(a=this.devicesObserver)||a.destroy(),null==(l=this.meetingStateObserver)||l.destroy(),null==(u=this.meetingConnectionObserver)||u.destroy(),null==(c=this.participantJoinedObserver)||c.destroy(),null==(h=this.participantLeftObserver)||h.destroy(),this.bricklayer=null,this.frameState=null,"u">typeof window&&(window.removeEventListener("resize",this.onWindowResize),window.removeEventListener("orientationchange",this.onWindowResize))}publishMessageToFrame(t,i){this.messageBridge&&this.messageBridge.publish(t,i)}};eh();var af=new class{constructor(){this.logger=new iB("@superviz/sdk/core-bridge"),this.logger.log("CoreBridge initialized")}updateLocalParticipant(t){this.logger.log("updateLocalParticipant",t);let{localParticipant:i}=im("core-store");i.publish(t)}updateParticipantsList(t){this.logger.log("updateParticipantsList",t);let{participants:i}=im("core-store");i.publish(t)}},am=null,av=class extends at{constructor(t){var i,r;super(),this.participantsOnMeeting=[],this.kickParticipantsOnHostLeave=!1,this.startVideo=()=>{var t,i,r,n,s,a,l,u,c,h,d,p,f,m,v,g,b,y,_,w,E,C,P,A,S,O,T,x,k,I,M,R,F,L,N,D,j,B;let U=(null==(t=this.params)?void 0:t.userType)!=="audience"&&(null==(i=this.params)?void 0:i.defaultAvatars)===!0;this.videoConfig={language:null==(r=this.params)?void 0:r.language,canUseRecording:!!(null!=(n=this.params)&&n.enableRecording),canShowAudienceList:null==(a=null==(s=this.params)?void 0:s.showAudienceList)||a,canUseChat:!(null!=(l=this.params)&&l.chatOff),canUseCams:!(null!=(u=this.params)&&u.camsOff),canUseScreenshare:!(null!=(c=this.params)&&c.screenshareOff),canUseDefaultAvatars:U&&!(null!=(d=null==(h=this.localParticipant)?void 0:h.avatar)&&d.model3DUrl),canUseGather:!!(null!=(p=this.params)&&p.enableGather),canUseFollow:!!(null!=(f=this.params)&&f.enableFollow),canUseGoTo:!!(null!=(m=this.params)&&m.enableGoTo),canUseDefaultToolbar:null==(g=null==(v=this.params)?void 0:v.defaultToolbar)||g,camerasPosition:null==(y=null==(b=this.params)?void 0:b.collaborationMode)?void 0:y.position,devices:null==(_=this.params)?void 0:_.devices,skipMeetingSettings:null==(w=this.params)?void 0:w.skipMeetingSettings,browserService:this.browserService,offset:null==(E=this.params)?void 0:E.offset,locales:null!=(P=null==(C=this.params)?void 0:C.locales)?P:[],avatars:null!=(S=null==(A=this.params)?void 0:A.avatars)?S:[],customColors:eM.get("colors"),waterMark:eM.get("waterMark"),styles:null==(O=this.params)?void 0:O.styles,collaborationMode:null==(k=null==(x=null==(T=this.params)?void 0:T.collaborationMode)?void 0:x.enabled)||k,layoutPosition:(null==(M=null==(I=this.params)?void 0:I.collaborationMode)?void 0:M.enabled)===!1?"center":null!=(L=null==(F=null==(R=this.params)?void 0:R.collaborationMode)?void 0:F.modalPosition)?L:"center",layoutMode:null!=(j=null==(D=null==(N=this.params)?void 0:N.collaborationMode)?void 0:D.initialView)?j:"list",callbacks:null==(B=this.params)?void 0:B.callbacks},this.logger.log("video conference @ start video",this.videoConfig),this.videoManager=new ap(this.videoConfig),this.subscribeToVideoEvents()},this.subscribeToVideoEvents=()=>{this.logger.log("video conference @ subscribe to video events"),this.videoManager.meetingConnectionObserver.subscribe(this.connectionService.updateMeetingConnectionStatus),this.videoManager.participantListObserver.subscribe(this.onParticipantListUpdate),this.videoManager.waitingForHostObserver.subscribe(this.onWaitingForHost),this.videoManager.frameSizeObserver.subscribe(this.onFrameSizeDidChange),this.videoManager.meetingStateObserver.subscribe(this.onMeetingStateChange),this.videoManager.frameStateObserver.subscribe(this.onFrameStateChange),this.videoManager.realtimeEventsObserver.subscribe(this.onRealtimeEventFromFrame),this.videoManager.participantJoinedObserver.subscribe(this.onParticipantJoined),this.videoManager.participantLeftObserver.subscribe(this.onParticipantLeft),this.videoManager.sameAccountErrorObserver.subscribe(this.onSameAccountError),this.videoManager.devicesObserver.subscribe(this.onDevicesChange)},this.unsubscribeFromVideoEvents=()=>{this.videoManager&&(this.logger.log("video conference @ unsubscribe from video events"),this.videoManager.meetingConnectionObserver.unsubscribe(this.connectionService.updateMeetingConnectionStatus),this.videoManager.participantListObserver.unsubscribe(this.onParticipantListUpdate),this.videoManager.waitingForHostObserver.unsubscribe(this.onWaitingForHost),this.videoManager.frameSizeObserver.unsubscribe(this.onFrameSizeDidChange),this.videoManager.meetingStateObserver.unsubscribe(this.onMeetingStateChange),this.videoManager.frameStateObserver.unsubscribe(this.onFrameStateChange),this.videoManager.realtimeEventsObserver.unsubscribe(this.onRealtimeEventFromFrame),this.videoManager.participantJoinedObserver.unsubscribe(this.onParticipantJoined),this.videoManager.participantLeftObserver.unsubscribe(this.onParticipantLeft),this.videoManager.sameAccountErrorObserver.unsubscribe(this.onSameAccountError),this.videoManager.devicesObserver.unsubscribe(this.onDevicesChange))},this.suscribeToRealtimeEvents=()=>{this.logger.log("video conference @ subscribe to realtime events"),this.room.presence.on(re.UPDATE,this.onParticipantUpdateOnRealtime),this.room.presence.on(re.JOINED_ROOM,this.onParticipantJoinedOnRealtime),this.room.presence.on(re.LEAVE,this.onParticipantLeftOnRealtime)},this.unsubscribeFromRealtimeEvents=()=>{var t;this.logger.log("video conference @ unsubscribe from realtime events"),this.room.presence.off(re.UPDATE),this.room.presence.off(re.LEAVE),this.room.presence.off(re.JOINED_ROOM),null==(t=this.roomState)||t.kickParticipantObserver.unsubscribe(this.onKickLocalParticipant)},this.subscribeToStoreUpdates=()=>{let{localParticipant:t,group:i,participants:r}=this.useStore("global-store");r.subscribe(t=>{let i=Object.values(t);this.onRealtimeParticipantsDidChange(i)});let{drawing:n,hostId:s,isGridModeEnabled:a,transcript:l,followParticipantId:u,gather:c}=this.useStore("video-store");t.subscribe(t=>{this.localParticipant=en(er(er({},this.localParticipant),t),{type:this.params.userType})}),n.subscribe(this.setDrawing),s.subscribe(this.setHost),a.subscribe(this.setGridMode),l.subscribe(this.setTranscript),u.subscribe(this.setFollowParticipant),c.subscribe(this.setGather),i.subscribe()},this.createParticipantFromPresence=t=>{var i;return{participantId:t.id,id:t.id,color:(null==(i=t.data.slot)?void 0:i.color)||eP.gray,avatar:t.data.avatar,type:t.data.type,name:t.data.name,isHost:t.data.isHost,timestamp:t.timestamp,slot:t.data.slot}},this.onFrameSizeDidChange=t=>{this.publish("frame.dimensions-update",t)},this.onWaitingForHost=t=>{this.publish("meeting.waiting-for-host",t)},this.onConnectionStatusChange=t=>{this.logger.log("video conference @ on connection status change",t);let i=[2,4,3,6];i.includes(t)&&this.roomState.freezeSync(!0),i.includes(this.connectionService.oldConnectionStatus)&&!i.includes(t)&&this.roomState.freezeSync(!1),this.publish("meeting.connection-status-change",t)},this.onMeetingStateChange=t=>{this.logger.log("video conference @ on meeting state change",t),this.publish("meeting.state-update",t)},this.onSameAccountError=t=>{this.publish("meeting.same-participant-error",t),this.detach()},this.onDevicesChange=t=>{this.publish("meeting.devices-change",t)},this.onFrameStateChange=t=>{this.logger.log("video conference @ on frame state change",t),2===t&&(this.roomState=new au(this.room,this.drawingRoom,this.logger),this.roomState.kickParticipantObserver.subscribe(this.onKickLocalParticipant),this.roomState.start(),"guest"!==this.params.userType&&(this.localParticipant=Object.assign(this.localParticipant,{type:this.params.userType}),this.roomState.updateMyProperties(er({},this.localParticipant))),this.videoManager.start({group:this.group,participant:this.localParticipant,roomId:eM.get("roomId")}),this.publish("meeting.start"))},this.onRealtimeEventFromFrame=({event:t,data:i})=>{this.logger.log("video conference @ on realtime event from frame",t,i),({"realtime.host-change":t=>this.roomState.setHost(t),"realtime.gather":t=>this.roomState.setGather(t),"realtime.grid-mode-change":t=>this.roomState.setGridMode(t),"realtime.drawing-change":t=>{this.roomState.setDrawing(t)},"realtime.follow-participant":t=>{this.roomState.setFollowParticipant(t)},"meeting.kick-participant":t=>{this.roomState.setKickParticipant(t)},"realtime.transcript-change":t=>{this.roomState.setTranscript(t)},"realtime.go-to-participant":t=>{this.eventBus.publish("realtime.go-to-participant",t)}})[t](i),this.publish(t,i)},this.onParticipantJoined=t=>{var i;this.logger.log("video conference @ on participant joined",t),this.publish("meeting.participant-joined",t),this.publish("my-participant.joined",t),this.kickParticipantsOnHostLeave=!(null!=(i=this.params)&&i.allowGuests);let{localParticipant:r,participants:n}=this.useStore("global-store"),s=t.name.trim();if(this.videoConfig.canUseDefaultAvatars){this.roomState.updateMyProperties({avatar:t.avatar,name:t.name,type:t.type,joinedMeeting:!0}),af.updateLocalParticipant(en(er({},r.value),{avatar:t.avatar,name:t.name,type:this.params.userType})),af.updateParticipantsList(en(er({},n.value),{[t.id]:en(er({},n.value[t.id]),{avatar:t.avatar,name:t.name})}));return}af.updateLocalParticipant(en(er({},r.value),{name:s,type:this.params.userType})),af.updateParticipantsList(en(er({},n.value),{[t.id]:en(er({},n.value[t.id]),{name:s,type:this.params.userType})})),this.roomState.updateMyProperties({name:t.name,type:t.type,joinedMeeting:!0})},this.onParticipantLeft=t=>{var i,r;this.logger.log("video conference @ on participant left",this.localParticipant);let{localParticipant:n,participants:s}=this.useStore("global-store");n.publish(en(er({},n.value),{activeComponents:null==(i=n.value.activeComponents)?void 0:i.filter(t=>"videoConference"!==t)})),s.publish(en(er({},s.value),{[this.localParticipant.id]:en(er({},n.value),{activeComponents:null==(r=n.value.activeComponents)?void 0:r.filter(t=>"videoConference"!==t)})})),this.connectionService.removeListeners(),this.publish("my-participant.left",this.localParticipant),this.unsubscribeFromVideoEvents(),this.videoManager.leave(),this.videoManager=void 0,this.connectionService=void 0,this.detach()},this.onParticipantListUpdate=t=>{this.logger.log("video conference @ on participant list update",t);let i=Object.values(t).map(t=>{var i,r;return{id:t.id,slot:t.slot,avatar:t.avatar,name:t.name,type:t.type,isHost:null!=(i=t.isHost)&&i,timestamp:t.timestamp,color:(null==(r=t.slot)?void 0:r.color)||eP.gray}});this.publish("meeting.participant-list-update",i),this.participantsOnMeeting.length!==i.length&&this.publish("meeting.amount-of-participants-update",i.length),this.participantsOnMeeting=i,this.validateIfInTheRoomHasHost()},this.onKickLocalParticipant=()=>{this.logger.log("video conference @ on kick local participant"),this.publish("meeting.kick-participant",this.localParticipant),this.detach()},this.setDrawing=t=>{var i;null==(i=this.videoManager)||i.publishMessageToFrame("realtime.drawing-change",t)},this.setHost=t=>{var i;null==(i=this.videoManager)||i.publishMessageToFrame("realtime.host-change",t),this.onHostParticipantDidChange(t)},this.setGridMode=t=>{var i;null==(i=this.videoManager)||i.publishMessageToFrame("realtime.grid-mode-change",t)},this.setTranscript=t=>{var i;null==(i=this.videoManager)||i.publishMessageToFrame("realtime.transcript-change",t)},this.setFollowParticipant=t=>{var i;null==(i=this.videoManager)||i.publishMessageToFrame("realtime.follow-participant",t),this.eventBus.publish("realtime.follow-participant",t)},this.setGather=t=>{if(!this.videoManager||!t)return;let{hostId:i,gather:r}=this.useStore("video-store");if(r.publish(!1),i.value!==this.localParticipant.id){this.eventBus.publish("realtime.go-to-participant",i.value);return}this.videoManager.publishMessageToFrame("realtime.gather",t)},this.onRealtimeParticipantsDidChange=t=>{var i;this.logger.log("video conference @ on participants did change",t);let r=t.map(t=>{var i,r;return{id:t.id,timestamp:t.timestamp,participantId:t.id,color:(null==(i=t.slot)?void 0:i.color)||eP.gray,name:t.name,isHost:null!=(r=t.isHost)&&r,avatar:t.avatar,type:t.type,slot:t.slot}});null==(i=this.videoManager)||i.publishMessageToFrame("realtime.participant-list-update",r)},this.onHostParticipantDidChange=t=>{var i,r;this.logger.log("video conference @ on host participant did change",t),null==(i=this.videoManager)||i.publishMessageToFrame("realtime.host-change",t);let{participants:n}=this.useStore("global-store"),s=Object.values(n.value).find(i=>i.id===t),a=s?{id:s.id,color:(null==(r=s.slot)?void 0:r.color)||eP.gray,avatar:s.avatar,type:s.type,name:s.name,isHost:s.id===t}:null;am&&a&&(this.logger.log("video conference @ on host participant did change - clear kick all participants timeout"),clearTimeout(am),am=null),this.publish("meeting.host-change",a)},this.onHostAvailabilityChange=t=>{if(this.logger.log("launcher service @ onHostAvailabilityChange"),t){this.publish("meeting.host-available");return}this.publish("meeting.no-host-available")},this.onParticipantJoinedOnRealtime=t=>{this.logger.log("video conference @ on participant joined on realtime",t),this.publish("meeting.participant-joined",this.createParticipantFromPresence(t)),t.id===this.localParticipant.id&&this.room.presence.update(this.localParticipant)},this.onParticipantLeftOnRealtime=t=>{this.logger.log("video conference @ on participant left on realtime",t),this.publish("meeting.participant-left",this.createParticipantFromPresence(t))},this.onParticipantUpdateOnRealtime=t=>{this.logger.log("video conference @ on participant update on realtime",t);let{localParticipant:i,participants:r}=this.useStore("global-store");t.data.id===this.localParticipant.id&&this.publish("my-participant.update",this.createParticipantFromPresence(t)),r.publish(en(er({},r.value),{[t.data.id]:er(er({},i.value),t.data)}))},this.validateIfInTheRoomHasHost=()=>{var t,i;if(!this.roomState)return;let{hostId:r}=this.useStore("video-store"),{participants:n}=this.useStore("global-store"),s=Object.values(n.value),a=s.filter(t=>"host"===t.type&&this.participantsOnMeeting.some(i=>i.id===t.id));a.length||!this.kickParticipantsOnHostLeave||(null==(t=this.localParticipant)?void 0:t.type)==="host"||am||(this.logger.log("video conference @ validate if in the room has host - init kick all participants timeout"),am=setTimeout(()=>{this.logger.log("video conference @ validate if in the room has host - kick all participants"),this.onKickLocalParticipant()},6e4)),a.length&&am&&(this.logger.log("video conference @ validade if in the room has host - clear kick all participants timeout"),clearTimeout(am),am=null),this.onHostAvailabilityChange(!!a.length);let l=s.find(t=>(null==t?void 0:t.id)===(null==r?void 0:r.value));if(!a.length||l)return;let u=a.reduce((t,i)=>(this.logger.log("video conference @ validate if in the room has host - reducing participants",{previous:t,current:i}),t&&(null==i?void 0:i.id)!==r.value&&(null==i?void 0:i.timestamp)>t.timestamp?t:i),null);this.room.presence.update(en(er({},this.localParticipant),{isHost:u.id===this.localParticipant.id})),u&&u.id===(null==(i=this.localParticipant)?void 0:i.id)&&(this.logger.log("video conference @ validate if in the room has host - set host",u),r.publish(u.id),this.roomState.setHost(u.id))},this.params=en(er({},t),{userType:null!=(r=null!=(i=null==t?void 0:t.participantType)?i:null==t?void 0:t.userType)?r:"guest"}),this.name="videoConference",this.logger=new iB("@superviz/sdk/videoConference"),this.browserService=new aa,this.connectionService=new al,this.connectionService.addListeners(),this.connectionService.connectionStatusObserver.subscribe(this.onConnectionStatusChange)}toggleMeetingSetup(){var t;return null==(t=this.videoManager)?void 0:t.publishMessageToFrame("meeting-controls.toggle-setup")}toggleMicrophone(){var t;if("audience"===this.localParticipant.type){console.warn("[SuperViz] Audience cannot toggle microphone");return}return null==(t=this.videoManager)?void 0:t.publishMessageToFrame("meeting-controls.toggle-microphone")}toggleCam(){var t;if("audience"===this.localParticipant.type){console.warn("[SuperViz] Audience cannot toggle camera");return}null==(t=this.videoManager)||t.publishMessageToFrame("meeting-controls.toggle-cam")}toggleScreenShare(){var t;if("audience"===this.localParticipant.type){console.warn("[SuperViz] Audience cannot toggle screen share");return}return null==(t=this.videoManager)?void 0:t.publishMessageToFrame("meeting-controls.toggle-screenshare")}toggleChat(){var t;return null==(t=this.videoManager)?void 0:t.publishMessageToFrame("meeting-controls.toggle-chat")}toggleRecording(){var t;if(this.localParticipant.isHost){console.warn("[SuperViz] Only host can toggle recording");return}return null==(t=this.videoManager)?void 0:t.publishMessageToFrame("meeting-controls.toggle-recording")}hangUp(){var t;null==(t=this.videoManager)||t.publishMessageToFrame("hang-up")}start(){this.logger.log("video conference @ start"),this.drawingRoom=this.ioc.createRoom("drawing"),this.subscribeToStoreUpdates(),this.suscribeToRealtimeEvents(),this.startVideo()}destroy(){var t,i,r;this.logger.log("video conference @ destroy");let{destroy:n}=this.useStore("video-store");n(),null==(t=this.roomState)||t.destroy(),this.drawingRoom.disconnect(),this.kickParticipantsOnHostLeave=!1,this.publish("destroy"),this.unsubscribeFromRealtimeEvents(),this.unsubscribeFromVideoEvents(),null==(i=this.videoManager)||i.leave(),null==(r=this.connectionService)||r.removeListeners()}};eh(),eh();var ag=el(ex()),ab=class extends at{constructor(t,i){var r;if(super(),this.camera={x:0,y:0,screen:{width:0,height:0},scale:1},this.subscribeToRealtimeEvents=()=>{this.logger.log("presence-mouse component @ subscribe to realtime events"),this.room.presence.on(re.JOINED_ROOM,this.onPresenceJoinedRoom),this.room.presence.on(re.LEAVE,this.onPresenceLeftRoom),this.room.presence.on(re.UPDATE,this.onPresenceUpdate)},this.unsubscribeFromRealtimeEvents=()=>{this.logger.log("presence-mouse component @ unsubscribe from realtime events"),this.room.presence.off(re.JOINED_ROOM),this.room.presence.off(re.LEAVE),this.room.presence.off(re.UPDATE)},this.setParticipantPrivate=t=>{this.isPrivate=t,this.room.presence.update({visible:!t})},this.onPresenceJoinedRoom=t=>{t.id===this.localParticipant.id&&this.room.presence.update(this.localParticipant)},this.onPresenceLeftRoom=t=>{this.removePresenceMouseParticipant(t.id)},this.onPresenceUpdate=t=>{if(this.following&&this.presences.get(this.following)&&this.goToMouse(this.following),t.id===this.localParticipant.id)return;let i=t.data;if(this.following&&i.id!==this.following&&this.presences.has(i.id)){this.removePresenceMouseParticipant(i.id);return}this.presences.set(i.id,i)},this.animate=()=>{this.getCamera(),this.renderDivWrapper(),this.updateParticipantsMouses(),requestAnimationFrame(this.animate)},this.goToMouse=t=>{let i=this.presences.get(t);if(!(null!=i&&i.camera))return;let r=i.camera.x,n=i.camera.y,s=this.divWrapper.clientHeight/i.camera.screen.height,a=this.divWrapper.clientWidth/i.camera.screen.width;this.goToMouseCallback&&this.goToMouseCallback({x:r,y:n,scaleX:Math.min(s,1),scaleY:Math.min(a,1)})},this.onMyParticipantMouseMove=(0,ag.throttle)(t=>{let i=this.canvas.getContext("2d"),r=this.canvas.getBoundingClientRect(),n=t.x-r.left,s=t.y-r.top,a=(null==i?void 0:i.getTransform()).inverse(),l=new DOMPoint(n,s).matrixTransform(a),u={x:l.x,y:l.y};this.room.presence.update(en(er(er({},this.localParticipant),u),{visible:!this.isPrivate,camera:this.camera}))},30),this.onMyParticipantMouseOut=t=>{let{x:i,y:r,width:n,height:s}=this.canvas.getBoundingClientRect();t.x>0&&t.y>0&&t.x<i+n&&t.y<r+s||this.room.presence.update({visible:!1})},this.updateParticipantsMouses=()=>{this.presences.forEach(t=>{if(!(null!=t&&t.visible)||this.following&&this.following!==t.id){this.removePresenceMouseParticipant(t.id);return}this.renderPresenceMouses(t)})},this.getCamera=()=>{var t;let i=null==(t=this.canvas)?void 0:t.getContext("2d"),r=null==i?void 0:i.getTransform(),n=null==r?void 0:r.e,s=null==r?void 0:r.f,a=null==r?void 0:r.a;this.camera={screen:{width:this.divWrapper.clientHeight,height:this.divWrapper.clientWidth},x:n,y:s,scale:a}},this.renderPresenceMouses=t=>{var i,r,n,s,a;let l=document.getElementById(`mouse-${t.id}`);l||(l=this.createMouseElement(t));let u=document.getElementById(`mouse-${t.id}`),c=document.getElementById(`mouse-${t.id}`);if(!u||!c)return;let h=u.getElementsByClassName("mouse-user-name")[0],d=c.getElementsByClassName("pointer-mouse")[0];d&&(d.style.backgroundImage=`url(https://production.cdn.superviz.com/static/mouse-pointers/${null==(i=t.slot)?void 0:i.colorName}.svg)`),h&&(h.style.color=null!=(n=null==(r=t.slot)?void 0:r.textColor)?n:"#fff",h.style.backgroundColor=null!=(a=null==(s=t.slot)?void 0:s.color)?a:eP.gray,h.innerHTML=t.name);let{x:p,y:f}=t,m=this.canvas.getContext("2d"),v=null==m?void 0:m.getTransform(),g=null==v?void 0:v.e,b=null==v?void 0:v.f,y=v.a,_=v.d,w=p*y+g,E=f*_+b,C=this.divWrapper.clientWidth>w&&this.divWrapper.clientHeight>E&&t.visible;l.style.opacity=C?"1":"0",l.style.left=`${w}px`,l.style.top=`${E}px`},this.followMouse=t=>{this.following=t,this.goToMouse(t)},this.name="presence",this.logger=new iB("@superviz/sdk/presence"),this.canvas=document.getElementById(t),this.presences=new Map,!this.canvas){let i=`Canvas with id ${t} not found`;throw this.logger.log(i),Error(i)}this.divWrapper=this.renderDivWrapper(),this.animateFrame=requestAnimationFrame(this.animate),this.goToMouseCallback=null==(r=null==i?void 0:i.callbacks)?void 0:r.onGoToPresence;let{localParticipant:n}=this.useStore("global-store");n.subscribe(),this.getCamera()}start(){this.logger.log("presence-mouse component @ start"),this.canvas.addEventListener("mousemove",this.onMyParticipantMouseMove),this.canvas.addEventListener("mouseout",this.onMyParticipantMouseOut),this.eventBus.subscribe("realtime.go-to-participant",this.goToMouse),this.eventBus.subscribe("realtime.local-follow-participant",this.followMouse),this.eventBus.subscribe("realtime.private-mode",this.setParticipantPrivate),this.subscribeToRealtimeEvents()}destroy(){this.logger.log("presence-mouse component @ destroy"),this.eventBus.unsubscribe("realtime.go-to-participant",this.goToMouse),this.eventBus.unsubscribe("realtime.local-follow-participant",this.followMouse),this.eventBus.unsubscribe("realtime.private-mode",this.setParticipantPrivate),this.unsubscribeFromRealtimeEvents(),cancelAnimationFrame(this.animateFrame),this.canvas.removeEventListener("mousemove",this.onMyParticipantMouseMove),this.canvas.removeEventListener("mouseout",this.onMyParticipantMouseOut),this.divWrapper.remove()}renderDivWrapper(){let t=this.canvas.getBoundingClientRect(),i=document.getElementById("superviz-presence-mouse-wrapper");return i||((i=document.createElement("div")).id="superviz-presence-mouse-wrapper",this.canvas.parentElement.style.position="relative",this.canvas.parentElement.appendChild(i)),i.style.position="fixed",i.style.top=`${t.top}px`,i.style.left=`${t.left}px`,i.style.width=`${t.width}px`,i.style.height=`${t.height}px`,i.style.pointerEvents="none",i.style.overflow="hidden",i.style.zIndex="2",i}removePresenceMouseParticipant(t){let i=document.getElementById(`mouse-${t}`);i&&(i.remove(),this.presences.delete(t))}createMouseElement(t){let i=document.createElement("div");i.setAttribute("id",`mouse-${t.id}`),i.setAttribute("class","mouse-follower");let r=document.createElement("div");r.setAttribute("class","pointer-mouse");let n=document.createElement("div");return n.setAttribute("class","mouse-user-name"),n.innerHTML=t.name,i.appendChild(r),i.appendChild(n),i.style.left="0px",i.style.top="0px",this.divWrapper.appendChild(i),i}transform(t){console.warn("[SuperViz] - transform method not available when container is a canvas element.")}};eh();var ay=el(ex());eh();var a_=((j=a_||{}).AREA="area",j.BASE="base",j.BR="br",j.COL="col",j.EMBED="embed",j.HR="hr",j.IMG="img",j.INPUT="input",j.LINK="link",j.META="meta",j.PARAM="param",j.SOURCE="source",j.TRACK="track",j.WBR="wbr",j),aw=((B=aw||{}).RECT="rect",B.ELLIPSE="ellipse",B.SVG="svg",B),aE=class extends at{constructor(t,i){var r;if(super(),this.presences=new Map,this.mouses=new Map,this.transformation={translate:{x:0,y:0},scale:1},this.onMyParticipantMouseMove=t=>{if(this.isPrivate)return;let{left:i,top:r}=t.currentTarget.getBoundingClientRect(),n=(t.x-i-this.transformation.translate.x)/this.transformation.scale,s=(t.y-r-this.transformation.translate.y)/this.transformation.scale;this.room.presence.update(en(er({},this.localParticipant),{x:n,y:s,visible:!0,camera:this.camera}))},this.onMyParticipantMouseLeave=t=>{if(typeof window>"u")return;let{left:i,top:r,right:n,bottom:s}=this.container.getBoundingClientRect(),a=t.x>i&&t.y>r&&t.x<n&&t.y<s,l=t.x>0&&t.y>0&&t.x<window.innerWidth&&t.y<window.innerHeight;a&&l||this.room.presence.update({visible:!1})},this.goToMouse=t=>{let i=this.mouses.get(t),r=this.presences.get(t);if(r){if(this.goToPresenceCallback){let t=this.camera.screen.width/r.camera.screen.width,i=this.camera.screen.height/r.camera.screen.height,n=r.camera.x*t,s=r.camera.y*i,a=r.camera.scale*t,l=r.camera.scale*i;this.goToPresenceCallback({x:n,y:s,scaleX:a,scaleY:l});return}i&&i.scrollIntoView({block:"center",inline:"center",behavior:"smooth"})}},this.followMouse=t=>{this.userBeingFollowedId=t,this.goToMouse(t)},this.setParticipantPrivate=t=>{this.isPrivate=t,this.room.presence.update({visible:!t})},this.onPresenceJoinedRoom=t=>{t.id===this.localParticipant.id&&this.room.presence.update(this.localParticipant)},this.onPresenceLeftRoom=t=>{this.removePresenceMouseParticipant(t.id)},this.onPresenceUpdate=t=>{if(t.id===this.localParticipant.id)return;let i=t.data;if(this.userBeingFollowedId&&i.id!==this.userBeingFollowedId&&this.presences.has(i.id)){this.removePresenceMouseParticipant(i.id);return}this.presences.set(i.id,i),this.animate(),this.updateParticipantsMouses()},this.animate=()=>{a_[this.containerTagname]&&this.updateVoidElementWrapper(),aw[this.containerTagname]&&this.updateSVGElementWrapper(),this.animationFrame=requestAnimationFrame(this.animate)},this.updateParticipantsMouses=t=>{this.presences.forEach(t=>{if(t.id!==this.localParticipant.id){if(!(null!=t&&t.visible)){this.removePresenceMouseParticipant(t.id);return}this.renderPresenceMouses(t)}}),!t&&this.presences.has(this.userBeingFollowedId)&&this.goToMouse(this.userBeingFollowedId)},this.renderPresenceMouses=t=>{var i,r,n,s,a;if(t.id===this.localParticipant.id)return;let l=document.getElementById(`mouse-${t.id}`);if(l||(l=this.createMouseElement(t)),!l)return;let u=l.getElementsByClassName("mouse-user-name")[0],c=l.getElementsByClassName("pointer-mouse")[0];c&&(c.style.backgroundImage=`url(https://production.cdn.superviz.com/static/mouse-pointers/${null==(i=t.slot)?void 0:i.colorName}.svg)`),u&&(u.style.color=null!=(n=null==(r=t.slot)?void 0:r.textColor)?n:eP.gray,u.style.backgroundColor=null!=(a=null==(s=t.slot)?void 0:s.color)?a:"#fff",u.innerHTML=t.name);let{x:h,y:d}=t,{translate:{x:p,y:f},scale:m}=this.transformation;l.style.left=`${p+h*m}px`,l.style.top=`${f+d*m}px`},this.renderVoidElementWrapper=()=>{let t=document.createElement("div"),{width:i,height:r,left:n,top:s}=this.container.getBoundingClientRect();t.style.position="absolute",t.style.width=`${i}px`,t.style.height=`${r}px`,t.style.top=`${s}px`,t.style.left=`${n}px`,t.style.overflow="visible",t.style.pointerEvents="none",this.container.parentElement.appendChild(t),this.wrapper=t},this.renderSVGElementWrapper=()=>{let t=this.containerTagname.toLowerCase();if("svg"===t){this.createSVGWrapper();return}if("rect"===t){this.createRectWrapper();return}"ellipse"===t&&this.createEllipseWrapper()},this.container=document.getElementById(t),this.logger=new iB("@superviz/sdk/presence"),!this.container){let i=`Element with id ${t} not found`;throw this.logger.log(i),Error(i)}this.camera={x:0,y:0,scale:1,screen:{width:this.container.clientWidth,height:this.container.clientHeight}},this.name="presence";let{localParticipant:n}=this.useStore("global-store");n.subscribe(),this.containerTagname=this.container.tagName.toUpperCase(),this.goToPresenceCallback=null==(r=null==i?void 0:i.callbacks)?void 0:r.onGoToPresence}start(){this.logger.log("presence-mouse component @ start"),this.renderWrapper(),this.addListeners(),this.subscribeToRealtimeEvents(),this.eventBus.subscribe("realtime.private-mode",this.setParticipantPrivate),this.animationFrame=requestAnimationFrame(this.animate),this.eventBus.subscribe("realtime.go-to-participant",this.goToMouse),this.eventBus.subscribe("realtime.local-follow-participant",this.followMouse)}destroy(){cancelAnimationFrame(this.animationFrame),this.logger.log("presence-mouse component @ destroy"),this.removeListeners(),this.wrapper.remove(),this.presences.clear(),this.presences=void 0,this.container=void 0,this.wrapper=void 0,this.unsubscribeFromRealtimeEvents(),this.eventBus.unsubscribe("realtime.private-mode",this.setParticipantPrivate),this.eventBus.unsubscribe("realtime.go-to-participant",this.goToMouse),this.eventBus.unsubscribe("realtime.local-follow-participant",this.followMouse),this.logger=void 0}subscribeToRealtimeEvents(){this.logger.log("presence-mouse component @ subscribe to realtime events"),this.room.presence.on(re.JOINED_ROOM,this.onPresenceJoinedRoom),this.room.presence.on(re.LEAVE,this.onPresenceLeftRoom),this.room.presence.on(re.UPDATE,this.onPresenceUpdate)}unsubscribeFromRealtimeEvents(){this.logger.log("presence-mouse component @ unsubscribe from realtime events"),this.room.presence.off(re.JOINED_ROOM),this.room.presence.off(re.LEAVE),this.room.presence.off(re.UPDATE)}addListeners(){var t,i,r,n,s,a,l;this.pointerMoveObserver=(function t(i,r,n,s){if(ez(n)&&(s=n,n=void 0),s)return t(i,r,n).pipe((a=s,tb(function(t){return ty(t)?a.apply(void 0,eB([],ej(t))):a(t)})));var a,l=ej(ez(i.addEventListener)&&ez(i.removeEventListener)?tw.map(function(t){return function(s){return i[t](r,s,n)}}):ez(i.addListener)&&ez(i.removeListener)?t_.map(tC(i,r)):ez(i.on)&&ez(i.off)?tE.map(tC(i,r)):[],2),u=l[0],c=l[1];if(!u&&tf(i))return(function t(i,r,n){return void 0===n&&(n=1/0),ez(r)?t(function(t,n){return tb(function(i,s){return r(t,i,n,s)})(tv(i(t,n)))},n):("number"==typeof r&&(n=r),e8(function(t,r){var s,a,l,u,c,h,d;return s=n,a=[],l=0,u=0,c=!1,h=function(){!c||a.length||l||r.complete()},d=function(t){l++;var n=!1;tv(i(t,u++)).subscribe(te(r,function(t){r.next(t)},function(){n=!0},void 0,function(){if(n)try{for(l--;a.length&&l<s;)!function(){var t=a.shift();d(t)}();h()}catch(t){r.error(t)}}))},t.subscribe(te(r,function(t){return l<s?d(t):a.push(t)},function(){c=!0,h()})),function(){}}))})(function(i){return t(i,r,n)})(tv(i));if(!u)throw TypeError("Invalid event target");return new e5(function(t){var i=function(){for(var i=[],r=0;r<arguments.length;r++)i[r]=arguments[r];return t.next(1<i.length?i:i[0])};return u(i),function(){return c(i)}})})(this.container,"pointermove").pipe((void 0===t&&(t=tp),i=t,void 0===r&&(r=tp),n=-1,null!=i&&(i&&ez(i.schedule)?r=i:n=i),s=new e5(function(t){var i=30,s=0;return r.schedule(function(){t.closed||(t.next(s++),0<=n?this.schedule(void 0,n):t.complete())},i)}),a=function(){return s},l=void 0,e8(function(t,i){var r=l??{},n=r.leading,s=void 0===n||n,u=r.trailing,c=void 0!==u&&u,h=!1,d=null,p=null,f=!1,m=function(){null==p||p.unsubscribe(),p=null,c&&(b(),f&&i.complete())},v=function(){p=null,f&&i.complete()},g=function(t){return p=tv(a(t)).subscribe(te(i,m,v))},b=function(){if(h){h=!1;var t=d;d=null,i.next(t),f||g(t)}};t.subscribe(te(i,function(t){h=!0,d=t,p&&!p.closed||(s?b():g(t))},function(){f=!0,c&&h&&p&&!p.closed||i.complete()}))}))).subscribe(this.onMyParticipantMouseMove),this.container.addEventListener("pointerleave",this.onMyParticipantMouseLeave)}removeListeners(){var t;null==(t=this.pointerMoveObserver)||t.unsubscribe(),this.container.removeEventListener("pointerleave",this.onMyParticipantMouseLeave)}setPositionNotStatic(){let{position:t}=window.getComputedStyle(this.container);"static"===t&&this.container.style.setProperty("position","relative")}createMouseElement(t){if(!this.wrapper)return;let i=document.createElement("div");i.setAttribute("id",`mouse-${t.id}`),i.setAttribute("class","mouse-follower");let r=document.createElement("div");r.setAttribute("class","pointer-mouse");let n=document.createElement("div");return n.setAttribute("class","mouse-user-name"),n.innerHTML=t.name,i.appendChild(r),i.appendChild(n),i.style.left="0px",i.style.top="0px",this.wrapper.appendChild(i),this.mouses.set(t.id,i),i}updateSVGPosition(){let t=this.container.parentElement.getBoundingClientRect(),i=this.container.getBoundingClientRect(),r=i.left-t.left,n=i.top-t.top,{width:s,height:a}=this.container.getBoundingClientRect();this.wrapper.style.setProperty("width",`${s}px`),this.wrapper.style.setProperty("height",`${a}px`),this.wrapper.style.setProperty("top",`${n}px`),this.wrapper.style.setProperty("left",`${r}px`)}createSVGWrapper(){let t=document.createElement("div"),i=this.container.parentElement.getBoundingClientRect(),r=this.container.getBoundingClientRect(),n=r.left-i.left,s=r.top-i.top,{width:a,height:l}=this.container.getBoundingClientRect();t.style.position="fixed",t.style.width=`${a}px`,t.style.height=`${l}px`,t.style.top=`${s}px`,t.style.left=`${n}px`,t.style.overflow="visible",t.style.pointerEvents="none",t.id="superviz-svg-wrapper",this.container.parentElement.appendChild(t),this.wrapper=t}createRectWrapper(){let t=document.createElementNS("http://www.w3.org/2000/svg","svg"),i=document.createElementNS("http://www.w3.org/2000/svg","rect"),r=document.createElement("div"),n=this.container.getAttribute("width"),s=this.container.getAttribute("height"),a=this.container.getAttribute("rx"),l=this.container.getAttribute("ry");i.setAttribute("fill","transparent"),i.setAttribute("stroke","transparent"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("rx",a),i.setAttribute("ry",l),i.setAttribute("height",s),i.setAttribute("width",n),t.setAttribute("height",s),t.setAttribute("width",n),t.appendChild(i),r.appendChild(t);let u=this.container.getBoundingClientRect();r.style.position="fixed",r.style.top=`${u.top}px`,r.style.left=`${u.left}px`,r.style.width=`${u.width}px`,r.style.height=`${u.height}px`,r.style.overflow="visible",r.style.pointerEvents="none",r.id="superviz-rect-wrapper";let c=this.container.viewportElement;for(;c.viewportElement;)c=c.viewportElement;c.parentElement.appendChild(r),this.wrapper=r}createEllipseWrapper(){let t=document.createElementNS("http://www.w3.org/2000/svg","svg"),i=document.createElementNS("http://www.w3.org/2000/svg","ellipse"),r=document.createElement("div"),n=this.container.getAttribute("cx"),s=this.container.getAttribute("cy"),a=this.container.getAttribute("rx"),l=this.container.getAttribute("ry"),u=Number(n)-Number(a),c=Number(s)-Number(l),h=String(2*Number(n)),d=String(2*Number(s));i.setAttribute("fill","transparent"),i.setAttribute("stroke","transparent"),i.setAttribute("x","0"),i.setAttribute("y","0"),i.setAttribute("rx",a),i.setAttribute("ry",l),i.setAttribute("cx",`${Number(n)-u}`),i.setAttribute("cy",`${Number(s)-c}`),i.setAttribute("height",d),i.setAttribute("width",h),t.setAttribute("height",d),t.setAttribute("width",h),t.appendChild(i),r.appendChild(t);let p=this.container.getBoundingClientRect();r.style.position="fixed",r.style.top=`${p.top}px`,r.style.left=`${p.left}px`,r.style.width=`${p.width}px`,r.style.height=`${p.height}px`,r.style.overflow="visible",r.style.pointerEvents="none",r.id="superviz-ellipse-wrapper";let f=this.container.viewportElement;for(;f.viewportElement;)f=f.viewportElement;f.parentElement.appendChild(r),this.wrapper=r}transform(t){var i,r;this.transformation=t,this.camera={x:t.translate.x,y:t.translate.y,scale:t.scale,screen:{width:(null==(i=this.wrapper)?void 0:i.clientWidth)||1,height:(null==(r=this.wrapper)?void 0:r.clientHeight)||1}},this.updateParticipantsMouses(!0)}updateVoidElementWrapper(){let t=this.container.getBoundingClientRect(),i=this.wrapper.getBoundingClientRect(),r=this.container;if((0,ay.isEqual)(t,i))return;let n=r.offsetLeft,s=r.offsetTop;this.wrapper.style.setProperty("width",`${t.width}px`),this.wrapper.style.setProperty("height",`${t.height}px`),this.wrapper.style.setProperty("top",`${s}px`),this.wrapper.style.setProperty("left",`${n}px`),this.wrapper.id="superviz-void-wrapper"}updateSVGElementWrapper(){let{left:t,top:i,width:r,height:n}=this.container.getBoundingClientRect(),{left:s,top:a,width:l,height:u}=this.wrapper.getBoundingClientRect();if(!(t===s&&i===a&&r===l&&n===u)){if("svg"===this.containerTagname.toLowerCase()){this.updateSVGPosition();return}this.wrapper.style.setProperty("width",`${r}px`),this.wrapper.style.setProperty("height",`${n}px`),this.wrapper.style.setProperty("top",`${i}px`),this.wrapper.style.setProperty("left",`${t}px`)}}renderWrapper(){if(!this.wrapper){if(a_[this.containerTagname]){this.renderVoidElementWrapper();return}if(aw[this.containerTagname]){this.renderSVGElementWrapper();return}this.renderElementWrapper()}}removePresenceMouseParticipant(t){let i=document.getElementById(`mouse-${t}`);i&&(i.remove(),this.presences.delete(t),this.mouses.delete(t))}renderElementWrapper(){let t=document.createElement("div");t.style.position="absolute",t.style.width="100%",t.style.height="100%",t.style.top="0",t.style.left="0",t.style.overflow="visible",t.style.pointerEvents="none",this.setPositionNotStatic(),this.container.appendChild(t),this.wrapper=t}},aC=class{constructor(t,i){let r=document.getElementById(t);if(!r)throw Error(`[Superviz] Container with id ${t} not found`);return"canvas"===r.tagName.toLowerCase()?new ab(t,i):new aE(t,i)}transform(t){}};eh(),eh();var aP=el(iR());eh();var aA=class{constructor(t){this.room=t,this.logger=new iB("@superviz/sdk/realtime-presence")}update(t){this.logger.log("Realtime Presence @ update presence",t),this.room.presence.update(t)}subscribe(t,i){this.logger.log("Realtime Presence @ subscribe",t),this.room.presence.on(t,i)}unsubscribe(t){this.logger.log("Realtime Presence @ unsubscribe",t),this.room.presence.off(t)}getAll(){return ec(this,null,function*(){return this.logger.log("Realtime Presence @ get all"),new Promise((t,i)=>{this.room.presence.get(i=>t(i),t=>{let r=`[SuperViz] ${t.name} - ${t.message}`;this.logger.log(t),console.error(r),i(t)})})})}},aS=class extends iW{constructor(t,i,r,n){super(),this.state="DISCONNECTED",this.callbacksToSubscribeWhenJoined=[],this.publish=(0,aP.default)((t,i)=>{if("CONNECTED"!==this.state){let i=`Realtime channel ${this.name} is not started yet. You can't publish event ${t} before start`;this.logger.log(i),console.warn(`[SuperViz] ${i}`);return}this.channel.emit(`message:${this.name}`,{name:t,payload:i})},30),this.subscribe=(t,i)=>{if("CONNECTED"!==this.state){this.callbacksToSubscribeWhenJoined.push({event:t,callback:i});return}this.observers[t]||(this.observers[t]=new iz),this.observers[t].subscribe(i)},this.unsubscribe=(t,i)=>{var r;null==(r=this.observers[t])||r.unsubscribe(i)},this.fetchHistory=t=>ec(this,null,function*(){if("CONNECTED"!==this.state){let t="Realtime component is not started yet. You can't retrieve history before start";return this.logger.log(t),console.warn(`[SuperViz] ${t}`),null}return yield new Promise((i,r)=>{this.channel.history(n=>{var s;null!=(s=n.events)&&s.length||i(null);let a=n.events.reduce((t,i)=>{var r;return t[i.data.name]||(t[i.data.name]=[]),t[i.data.name].push({data:i.data.payload,connectionId:i.connectionId,name:i.data.name,participantId:null==(r=i.presence)?void 0:r.id,timestamp:i.timestamp}),t},{});t&&!a[t]&&r(Error(`Event ${t} not found in the history`)),t&&i(a[t]),i(a)})})}),this.publishEventToClient=(t,i)=>{var r;this.logger.log("realtime channel @ publishEventToClient",{event:t,data:i}),null==(r=this.observers[t])||r.publish(i)},this.name=t,this.ioc=i,this.logger=new iB("@superviz/sdk/realtime-channel"),this.channel=this.ioc.createRoom(`realtime:${this.name}`,n),this.localParticipant=r,this.subscribeToRealtimeEvents(),this.logger.log("started"),this.participant=new aA(this.channel)}disconnect(){return ec(this,null,function*(){if("DISCONNECTED"===this.state){this.logger.log("Realtime channel is already disconnected");return}this.logger.log("destroyed"),this.changeState("DISCONNECTED"),this.channel.disconnect()})}changeState(t){this.logger.log("realtime component @ changeState - state changed",t),this.state=t,this.publishEventToClient("realtime-channel.state-changed",this.state)}subscribeToRealtimeEvents(){this.channel.presence.on(re.JOINED_ROOM,t=>{t.id===this.localParticipant.id&&(this.changeState("CONNECTED"),this.callbacksToSubscribeWhenJoined.forEach(({event:t,callback:i})=>{this.subscribe(t,i)}),this.logger.log("joined room"),this.changeState("CONNECTED"))}),this.channel.on(`message:${this.name}`,t=>{var i,r;this.logger.log("message received",t),this.publishEventToClient(t.data.name,{data:t.data.payload,participantId:null!=(r=null==(i=null==t?void 0:t.presence)?void 0:i.id)?r:null,name:t.data.name,timestamp:t.timestamp,connectionId:t.connectionId})})}},aO=class extends at{constructor(){super(),this.state="STOPPED",this.channels=new Map,this.callbacksToSubscribeWhenJoined=[],this.subscribe=(t,i)=>{if(!this.channel){this.callbacksToSubscribeWhenJoined.push({event:t,callback:i});return}this.channel.subscribe(t,i)},this.publish=(t,i)=>{var r;if(ew[t.toUpperCase()]){this.channel.publishEventToClient(t,i);return}null==(r=this.channel)||r.publish(t,i)},this.unsubscribe=(t,i)=>{var r;null==(r=this.channel)||r.unsubscribe(t,i)},this.name="realtime",this.logger=new iB("@superviz/sdk/realtime-component");let{localParticipant:t}=this.useStore("global-store");t.subscribe()}connect(t){if(!this.channel)return new Promise(i=>{let{localParticipant:r}=tj();r.subscribe("connect-after-init",n=>{n.activeComponents.includes("realtime")&&(r.unsubscribe("connect-after-init"),i(this.connect(t)))})});let i=this.channels.get(t);return i||(i=new aS(t,this.ioc,this.localParticipant,this.connectionLimit),this.channels.set(t,i),"STARTED"===this.state)?i:new Promise(t=>{this.subscribe("realtime-component.state-changed",r=>{"STARTED"===r&&t(i)})})}start(){this.logger.log("started"),this.channel=new aS("default",this.ioc,this.localParticipant,this.connectionLimit),this.channel.subscribe("realtime-channel.state-changed",t=>{"CONNECTED"===t&&(this.callbacksToSubscribeWhenJoined.forEach(({event:t,callback:i})=>{this.channel.subscribe(t,i)}),this.changeState("STARTED"),this.callbacksToSubscribeWhenJoined=[],this.channel.unsubscribe("realtime-channel.state-changed"),this.participant=this.channel.participant,this.channels.set("default",this.channel))})}destroy(){this.logger.log("destroyed"),this.changeState("STOPPED"),this.disconnectFromAllChannels()}disconnectFromAllChannels(){this.channels.forEach(t=>t.disconnect())}changeState(t){var i;this.logger.log("realtime component @ changeState - state changed",t),this.state=t,null==(i=this.channel)||i.publishEventToClient("realtime-component.state-changed",this.state)}};eh();var aT=class extends at{constructor(t){var i;super(),this.onParticipantListUpdate=t=>{if(void 0===this.localParticipantId||""===this.localParticipantId)return;if(!this.initialized){this.initialized=!0,this.initializeList();return}let i=en(er({},t.data),{tooltip:this.getTooltipData(t.data),controls:this.getControls(t.data)}),{participants:r,extras:n}=this.useStore("who-is-online-store");if(r.value.some(({id:i})=>i===t.data.id)){this.updateParticipant(i);return}if(n.value.some(({id:i})=>i===t.data.id)){this.updateExtra(i);return}if(r.value.length<4){r.publish([...r.value,i]);return}n.publish([...n.value,i])},this.onParticipantLeave=t=>{let{participants:i,extras:r}=this.useStore("who-is-online-store");if(-1===i.value.findIndex(i=>i.id===t.id)){let i=r.value.filter(i=>i.id!==t.id);r.publish(i);return}let n=i.value.filter(i=>i.id!==t.id);if(r.value.length){n.push(r.value[0]);let t=r.value.slice(1);r.publish(t)}i.publish(n)},this.updateParticipant=t=>{let{participants:i,extras:r}=this.useStore("who-is-online-store");if(t.isPrivate&&t.id!==this.localParticipantId){let n=i.value.filter(({id:i})=>i!==t.id),s=r.value.splice(0,1);i.publish([...n,...s]),r.publish([...r.value]);return}let n=i.value.map(i=>i.id===t.id?t:i);i.publish(n)},this.updateExtra=t=>{let{extras:i}=this.useStore("who-is-online-store");if(t.isPrivate&&t.id!==this.localParticipantId){let r=i.value.filter(({id:i})=>i!==t.id);i.publish(r);return}let r=i.value.map(i=>i.id===t.id?t:i);i.publish(r)},this.subscribeToLocalParticipantUpdates=t=>{if(!t.slot)return;this.localParticipantId=t.id;let{privateMode:i,joinedPresence:r}=this.useStore("who-is-online-store"),n=this.isInPresence(t.activeComponents);r.publish(n);let s=this.getParticipant(t);this.room.presence.update(en(er({},s),{isPrivate:i.value}))},this.goToMousePointer=t=>{var i,r,n;let s=null!=(n=null==(i=t.presence)?void 0:i.id)?n:null==(r=t.detail)?void 0:r.id;s!==this.localParticipantId&&(this.eventBus.publish("realtime.go-to-participant",s),this.publish("who-is-online.go-to-participant",s))},this.followMousePointer=({detail:t})=>{this.eventBus.publish("realtime.local-follow-participant",t.id),this.following&&this.publish("who-is-online.start-following-participant",this.following),this.following||this.publish("who-is-online.stop-following-participant"),"extras"===t.source&&this.highlightParticipantBeingFollowed(),this.updateParticipantsControls(t.id)},this.setPrivate=({detail:{isPrivate:t,id:i}})=>{let{privateMode:r,participants:n}=this.useStore("who-is-online-store"),s=n.value.find(t=>t.id===i);r.publish(t),this.eventBus.publish("realtime.private-mode",t),this.room.presence.update(en(er({},s),{isPrivate:t})),t&&this.publish("who-is-online.enter-private-mode"),t||this.publish("who-is-online.leave-private-mode")},this.setFollow=t=>{let{id:i}=t.presence;if(i===this.localParticipantId)return;let{data:r}=t,{following:n}=this.useStore("who-is-online-store");n.publish(r),this.followMousePointer({detail:{id:r}})},this.follow=({detail:t})=>{let{everyoneFollowsMe:i}=this.useStore("who-is-online-store");i.publish(!!(null!=t&&t.id)),this.room.emit("who-is-online.start-follow-me",t),this.following&&this.publish("who-is-online.start-follow-me",this.following),this.following||this.publish("who-is-online.stop-follow-me"),this.updateParticipantsControls(null==t?void 0:t.id)},this.stopFollowing=t=>{var i;if(t.id!==(null==(i=this.following)?void 0:i.id))return;let{following:r}=this.useStore("who-is-online-store");r.publish(void 0),this.eventBus.publish("realtime.local-follow-participant",void 0),this.publish("who-is-online.stop-following-participant")},this.gather=t=>{this.room.emit("who-is-online.gather-all",t.detail.id),this.publish("who-is-online.gather-all",t.detail.id)},this.onJoinedRoom=t=>{if(t.id!==this.localParticipantId)return;let{localParticipant:i}=this.useStore("global-store");i.subscribe(this.subscribeToLocalParticipantUpdates)},this.name="whoIsOnline",this.logger=new iB("@superviz/sdk/who-is-online-component");let{disablePresenceControls:r,disableGoToParticipant:n,disableFollowParticipant:s,disablePrivateMode:a,disableGatherAll:l,disableFollowMe:u,following:c}=this.useStore("who-is-online-store");if(c.subscribe(),"object"!=typeof t){this.position=t??"top-right";return}"object"==typeof t&&(this.position=null!=(i=t.position)?i:"top-right",this.setStyles(t.styles),r.publish(t.disablePresenceControls),n.publish(t.disableGoToParticipant),s.publish(t.disableFollowParticipant),a.publish(t.disablePrivateMode),l.publish(t.disableGatherAll),u.publish(t.disableFollowMe))}start(){let{localParticipant:t}=this.useStore("global-store");this.localParticipantId=t.value.id,this.subscribeToRealtimeEvents(),this.positionWhoIsOnline(),this.addListeners()}destroy(){this.unsubscribeFromRealtimeEvents(),this.removeListeners(),this.element.remove(),this.element=null,this.initialized=!1;let{destroy:t}=this.useStore("who-is-online-store");t()}addListeners(){this.element.addEventListener("realtime.local-follow-participant",this.followMousePointer),this.element.addEventListener("realtime.go-to-participant",this.goToMousePointer),this.element.addEventListener("realtime.private-mode",this.setPrivate),this.element.addEventListener("realtime.follow-participant",this.follow),this.element.addEventListener("realtime.gather",this.gather)}removeListeners(){this.element.removeEventListener("realtime.local-follow-participant",this.followMousePointer),this.element.removeEventListener("realtime.go-to-participant",this.goToMousePointer),this.element.removeEventListener("realtime.private-mode",this.setPrivate),this.element.removeEventListener("realtime.follow-participant",this.follow),this.element.removeEventListener("realtime.gather",this.gather)}subscribeToRealtimeEvents(){this.room.presence.on(re.UPDATE,this.onParticipantListUpdate),this.room.presence.on(re.LEAVE,this.onParticipantLeave),this.room.presence.on(re.LEAVE,this.stopFollowing),this.room.presence.on(re.JOINED_ROOM,this.onJoinedRoom),this.room.on("who-is-online.gather-all",this.goToMousePointer),this.room.on("who-is-online.start-follow-me",this.setFollow)}unsubscribeFromRealtimeEvents(){this.room.presence.off(re.UPDATE),this.room.presence.off(re.LEAVE),this.room.presence.off(re.JOINED_ROOM),this.room.off("who-is-online.gather-all",this.goToMousePointer),this.room.off("who-is-online.start-follow-me",this.setFollow)}initializeList(){let{participants:t,extras:i}=this.useStore("who-is-online-store");this.room.presence.get(r=>{let n=r.filter(t=>t.data.id).map(({data:t})=>{let i=t.avatar;i||(i=this.getAvatar({avatar:t.avatar,color:t.slot.color,name:t.name,letterColor:t.slot.textColor}));let r=this.getTooltipData(t),n=this.getControls(t);return en(er({},t),{tooltip:r,controls:n,avatar:i,isLocalParticipant:t.id===this.localParticipantId})});if(!n.length)return;let s=n.findIndex(t=>t.id===this.localParticipantId),a=n.splice(s,1)[0],l=n.splice(0,3);t.publish([a,...l]),i.publish(n)})}setStyles(t=""){if(!t)return;let i=document.createElement("style");i.textContent=t,i.id="superviz-who-is-online-styles",document.head.appendChild(i)}positionWhoIsOnline(){if(this.element=document.createElement("superviz-who-is-online"),Object.values(eA).includes(this.position.toLowerCase())){document.body.appendChild(this.element);let[t,i]=this.position.split("-");this.element.position=`${t}: 20px; ${i}: 40px;`;return}let t=document.getElementById(this.position);if(!t){this.element.position="top: 20px; right: 40px;",document.body.appendChild(this.element);return}t.appendChild(this.element),this.element.position="position: relative;"}getParticipant(t){let{avatar:i,activeComponents:r,id:n,name:s,slot:{color:a,textColor:l}}=t,u=this.shouldDisableDropdown({activeComponents:r,participantId:n}),c=this.getAvatar({avatar:i,color:a,name:s,letterColor:l});return{id:n,name:s,avatar:c,disableDropdown:u,activeComponents:r,isPrivate:!1}}shouldDisableDropdown({activeComponents:t,participantId:i}){let{joinedPresence:{value:r},disablePresenceControls:{value:n},disableFollowMe:{value:s},disableFollowParticipant:{value:a},disableGoToParticipant:{value:l},disableGatherAll:{value:u},disablePrivateMode:{value:c}}=this.useStore("who-is-online-store");return!1===r||!0===n||i===this.localParticipantId&&!!s&&!!c&&!!u||i!==this.localParticipantId&&!!a&&!!l||!(null!=t&&t.some(t=>t.toLowerCase().includes("presence")))}getTooltipData(t){let{name:i,disableDropdown:r,id:n}=t,s=n===this.localParticipantId,a={name:i};return s&&(a.name+=" (You)"),r||s||(a.info="Click to follow"),a}getAvatar({avatar:t,color:i,name:r,letterColor:n}){var s,a;return{imageUrl:null==t?void 0:t.imageUrl,firstLetter:null!=(a=null==(s=null==r?void 0:r.at(0))?void 0:s.toUpperCase())?a:"A",color:i,letterColor:n}}getControls(t){let{disablePresenceControls:i}=this.useStore("who-is-online-store"),{disableDropdown:r,id:n}=t;return i.value||r?[]:n===this.localParticipantId?this.getLocalParticipantControls():this.getOtherParticipantsControls(n)}getOtherParticipantsControls(t){var i;let{disableGoToParticipant:r,disableFollowParticipant:n,following:s}=this.useStore("who-is-online-store"),a=[];if(r.value||a.push({label:"go to",icon:"place"}),!n.value){let r=(null==(i=s.value)?void 0:i.id)===t;a.push({label:r?"unfollow":"follow",icon:r?"send-off":"send"})}return a}getLocalParticipantControls(){let{disableFollowMe:{value:t},disableGatherAll:{value:i},disablePrivateMode:{value:r},everyoneFollowsMe:{value:n},privateMode:{value:s}}=this.useStore("who-is-online-store"),a=[];return i||a.push({label:"gather all",icon:"gather"}),t||a.push({label:n?"stop followers":"everyone follows me",icon:n?"send-off":"send"}),r||a.push({label:s?"leave private mode":"private mode",icon:s?"eye_inative":"eye"}),a}updateParticipantsControls(t){let{participants:i}=this.useStore("who-is-online-store"),r=i.value.map(i=>{if(t&&i.id!==t)return i;let r=this.getControls(i);return en(er({},i),{controls:r})});i.publish(r)}highlightParticipantBeingFollowed(){let{extras:t,participants:i,following:{value:r}}=this.useStore("who-is-online-store"),n=i.value[0],s=t.value.findIndex(t=>t.id===r.id),a=t.value.splice(s,1)[0];i.value.unshift(n),i.value[1]=a;let l=i.value.pop();t.value.push(l),t.publish(t.value),i.publish(i.value)}isInPresence(t){return null==t?void 0:t.some(t=>t.includes("presence"))}};eh();var ax=class extends at{constructor(t={}){super(),this.fields={},this.fieldsOriginalOutline={},this.focusList={},this.enabledOutlineFields={},this.enabledRealtimeSyncFields={},this.flags={},this.allowedTagNames=["input","textarea"],this.allowedInputTypes=["text","email","date","color","datetime-local","month","number","password","range","search","tel","time","url","week","checkbox","radio"],this.throwError={onInvalidFieldsProp:t=>{throw Error(`"Fields" property must be either a string or an array of strings. Received type: ${t}`)},onFieldNotFound:t=>{throw Error(`You must pass the id of an existing element. Element with id ${t} not found`)},onInvalidTagName:t=>{throw Error(`You can't register an element with tag ${t}. Only the tags "${this.allowedTagNames.join(", ")}" are allowed`)},onInvalidInputType:t=>{throw Error(`You can't register an input element of type ${t}. Only the types "${this.allowedInputTypes.join(", ")}" are allowed`)},onDeregisterInvalidField:t=>{throw Error(`You can't deregister field of id ${t}. No field was registered with id ${t} `)}},this.sync=t=>{var i,r;let n=this.fields[t],s=this.hasCheckedProperty(n),a={value:s?n.checked:n.value,color:this.localParticipant.slot.color,fieldId:t,showOutline:this.canUpdateColor(t),syncContent:this.canSyncContent(t),attribute:s?"checked":"value"};null==(i=this.room)||i.emit("field.content-change"+t,a),null==(r=this.room)||r.emit("field.interaction"+t,a)},this.handleInput=t=>{var i,r,n,s;let a=t.target;null==(r=this.room)||r.emit("field.interaction"+a.id,{fieldId:a.id,color:null==(i=this.localParticipant.slot)?void 0:i.color});let l=this.canSyncContent(a.id);if(!l)return;let u={value:a.value,color:null==(n=this.localParticipant.slot)?void 0:n.color,fieldId:a.id,showOutline:this.canUpdateColor(a.id),syncContent:l,attribute:"value"};null==(s=this.room)||s.emit("field.content-change"+a.id,u)},this.handleChange=t=>{var i;let r=t.target;if(!this.canSyncContent(r.id))return;let n={fieldId:r.id,value:r.checked,color:this.localParticipant.slot.color,showOutline:this.canUpdateColor(r.id),syncContent:this.canSyncContent(r.id),attribute:"checked"};null==(i=this.room)||i.emit("field.content-change"+r.id,n)},this.handleFocus=t=>{var i;let r=t.target,n={color:this.localParticipant.slot.color,fieldId:r.id};null==(i=this.room)||i.emit("field.focus"+r.id,n)},this.handleBlur=t=>{var i;let r=t.target,n={fieldId:r.id};null==(i=this.room)||i.emit("field.blur"+r.id,n)},this.removeFieldColor=({presence:t,data:{fieldId:i}})=>{var r,n;(null==(r=this.focusList[i])?void 0:r.id)===t.id&&this.fields[i]&&(this.fields[i].style.outline=null!=(n=this.fieldsOriginalOutline[i])?n:"",delete this.fieldsOriginalOutline[i],delete this.focusList[i])},this.updateFieldColor=({presence:t,data:{color:i,fieldId:r},timestamp:n})=>{var s;let a=null!=(s=this.focusList[r])?s:{},l=!a.id,u=t.id===this.localParticipant.id;if(l&&u){this.focusList[r]={id:t.id,color:i,firstInteraction:n,lastInteraction:n};return}if(a.id===t.id){this.focusList[r].lastInteraction=n;return}let c=n-a.lastInteraction>=3e3,h=n-a.firstInteraction>=1e4;if(!(c||h||l))return;this.focusList[r]={id:t.id,color:i,firstInteraction:n,lastInteraction:n};let d=u?this.fieldsOriginalOutline[r]:`1px solid ${i}`;this.fields[r].style.outline=d},this.updateFieldContent=t=>{var{presence:i,data:{value:r,fieldId:n,color:s,showOutline:a,syncContent:l,attribute:u},timestamp:c}=t,h=es(t,["presence","data","timestamp"]);this.publish("field.content-change",{value:r,fieldId:n,attribute:u,userId:i.id,userName:i.name,timestamp:c}),l&&this.canSyncContent(n)&&i.id!==this.localParticipant.id&&(this.fields[n][u]=r),a&&this.canUpdateColor(n)&&this.updateFieldColor(er({presence:i,data:{color:s,fieldId:n},timestamp:c},h))},this.publishTypedEvent=({presence:t,data:{fieldId:i,color:r}})=>{this.publish("field.interaction",{fieldId:i,userId:t.id,userName:t.name,color:r})},this.canSyncContent=t=>!this.flags.disableRealtimeSync&&!1!==this.enabledRealtimeSyncFields[t]||!!this.enabledRealtimeSyncFields[t],this.name="formElements",this.logger=new iB("@superviz/sdk/presence-input-component");let{fields:i}=t,r=es(t,["fields"]);if(this.flags=r??{},"string"==typeof i){this.validateField(i),this.fields[i]=null;return}if(Array.isArray(i)){i.forEach(t=>{this.validateField(t),this.fields[t]=null});return}void 0!==i&&this.throwError.onInvalidFieldsProp(typeof i)}enableOutline(t){let i=this.fields[t];i&&(this.enabledOutlineFields[t]=!0,this.fieldsOriginalOutline[t]=i.style.outline,i.addEventListener("focus",this.handleFocus),i.addEventListener("blur",this.handleBlur),this.room.on("field.focus"+t,this.updateFieldColor),this.room.on("field.blur"+t,this.removeFieldColor))}disableOutline(t){var i,r;let n=this.fields[t];n&&(this.enabledOutlineFields[t]=!1,n.style.outline=null!=(i=this.fieldsOriginalOutline[t])?i:"",n.removeEventListener("focus",this.handleFocus),n.removeEventListener("blur",this.handleBlur),this.room.off("field.focus"+t,this.updateFieldColor),this.room.off("field.blur"+t,this.removeFieldColor),null==(r=this.room)||r.emit("field.blur"+t,{fieldId:t}))}enableRealtimeSync(t){this.enabledRealtimeSyncFields[t]=!0}disableRealtimeSync(t){this.enabledRealtimeSyncFields[t]=!1}registerField(t){this.validateField(t);let i=document.getElementById(t);this.fields[t]=i,this.addListenersToField(i),this.addRealtimeListenersToField(t),this.fieldsOriginalOutline[t]=i.style.outline}deregisterField(t){var i;this.fields[t]||this.throwError.onDeregisterInvalidField(t),this.removeListenersFromField(this.fields[t]),this.removeRealtimeListenersFromField(t),this.fields[t].style.outline=this.fieldsOriginalOutline[t],this.fields[t]=void 0,delete this.enabledOutlineFields[t],delete this.enabledRealtimeSyncFields[t],delete this.fieldsOriginalOutline[t],delete this.focusList[t],null==(i=this.room)||i.emit("field.blur"+t,{fieldId:t})}start(){let{localParticipant:t}=this.useStore("global-store");t.subscribe(),Object.entries(this.fields).forEach(([t])=>{this.registerField(t)})}destroy(){this.restoreOutlines(),this.deregisterAllFields(),this.fieldsOriginalOutline=void 0,this.focusList=void 0}addListenersToField(t){this.hasCheckedProperty(t)?t.addEventListener("change",this.handleChange):t.addEventListener("input",this.handleInput),this.flags.disableOutline||(t.addEventListener("focus",this.handleFocus),t.addEventListener("blur",this.handleBlur))}addRealtimeListenersToField(t){this.room&&(this.room.on("field.content-change"+t,this.updateFieldContent),this.room.on("field.interaction"+t,this.publishTypedEvent),this.flags.disableOutline||(this.room.on("field.focus"+t,this.updateFieldColor),this.room.on("field.blur"+t,this.removeFieldColor)))}removeListenersFromField(t){this.hasCheckedProperty(t)?t.removeEventListener("change",this.handleChange):t.removeEventListener("input",this.handleInput),this.flags.disableOutline||(t.removeEventListener("focus",this.handleFocus),t.removeEventListener("blur",this.handleBlur))}removeRealtimeListenersFromField(t){this.room&&(this.room.off("field.content-change"+t,this.updateFieldContent),this.room.off("field.interaction"+t,this.publishTypedEvent),this.flags.disableOutline||(this.room.off("field.focus"+t,this.updateFieldColor),this.room.off("field.blur"+t,this.removeFieldColor)))}deregisterAllFields(){Object.keys(this.fields).forEach(t=>{this.deregisterField(t)}),this.fields=void 0}validateField(t){this.validateFieldId(t);let i=document.getElementById(t);this.validateFieldTagName(i),this.validateFieldType(i)}validateFieldTagName(t){let i=t.tagName.toLowerCase();this.allowedTagNames.includes(i)||(this.logger.log("invalid element tagname"),this.throwError.onInvalidTagName(i))}validateFieldType(t){if("input"!==t.tagName.toLowerCase())return;let i=t.getAttribute("type"),r=this.allowedInputTypes.includes(i);i&&!r&&(this.logger.log("invalid input type"),this.throwError.onInvalidInputType(i))}validateFieldId(t){document.getElementById(t)||this.throwError.onFieldNotFound(t)}restoreOutlines(){Object.entries(this.fields).forEach(([t])=>{this.fields[t].style.outline=this.fieldsOriginalOutline[t]})}hasCheckedProperty(t){let i=t.tagName.toLowerCase(),r=t.getAttribute("type");return"input"===i&&("radio"===r||"checkbox"===r)}canUpdateColor(t){return!this.flags.disableOutline&&!1!==this.enabledOutlineFields[t]||this.enabledOutlineFields[t]}};"u">typeof window&&(window.SuperVizRoom={init:o9,CommentEvent:e_,MeetingEvent:ed,DeviceEvent:ey,RealtimeEvent:em,MeetingState:ev,MeetingConnectionStatus:eb,MeetingControlsEvent:ef,ParticipantEvent:eg,FrameEvent:ep,LayoutMode:o4,VideoConference:av,MousePointers:aC,Realtime:aO,Comments:ai,CanvasPin:ar,HTMLPin:as,WhoIsOnline:aT,FormElements:ax,ParticipantType:oK,LayoutPosition:o6,CamerasPosition:o5,RealtimeComponentState:o7,RealtimeComponentEvent:o8,ComponentLifeCycleEvent:ew,WhoIsOnlineEvent:eE,StoreType:ek,PresenceEvents:re,FieldEvents:ae,PinMode:eT,Comment});var ak=o9,aI=Object.create,aM=Object.defineProperty,aR=Object.defineProperties,aF=Object.getOwnPropertyDescriptor,aL=Object.getOwnPropertyDescriptors,aN=Object.getOwnPropertyNames,aD=Object.getOwnPropertySymbols,aj=Object.getPrototypeOf,aB=Object.prototype.hasOwnProperty,aU=Object.prototype.propertyIsEnumerable,az=(t,i,r)=>i in t?aM(t,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[i]=r,aW=(t,i)=>{for(var r in i||(i={}))aB.call(i,r)&&az(t,r,i[r]);if(aD)for(var r of aD(i))aU.call(i,r)&&az(t,r,i[r]);return t},a$=(t,i)=>aR(t,aL(i)),aV=(t,i)=>function(){return i||(0,t[aN(t)[0]])((i={exports:{}}).exports,i),i.exports},aZ=(t,i,r)=>new Promise((n,s)=>{var a=t=>{try{u(r.next(t))}catch(t){s(t)}},l=t=>{try{u(r.throw(t))}catch(t){s(t)}},u=t=>t.done?n(t.value):Promise.resolve(t.value).then(a,l);u((r=r.apply(t,i)).next())}),aG=aV({"../../node_modules/.pnpm/ms@2.1.3/node_modules/ms/index.js"(t,i){function r(t,i,r,n){return Math.round(t/r)+" "+n+(i>=1.5*r?"s":"")}i.exports=function(t,i){i=i||{};var n,s,a=typeof t;if("string"===a&&t.length>0)return function(t){if(!((t=String(t)).length>100)){var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(i){var r=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"weeks":case"week":case"w":return 6048e5*r;case"days":case"day":case"d":return 864e5*r;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*r;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*r;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}(t);if("number"===a&&isFinite(t))return i.long?(n=Math.abs(t))>=864e5?r(t,n,864e5,"day"):n>=36e5?r(t,n,36e5,"hour"):n>=6e4?r(t,n,6e4,"minute"):n>=1e3?r(t,n,1e3,"second"):t+" ms":(s=Math.abs(t))>=864e5?Math.round(t/864e5)+"d":s>=36e5?Math.round(t/36e5)+"h":s>=6e4?Math.round(t/6e4)+"m":s>=1e3?Math.round(t/1e3)+"s":t+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))}}}),aJ=aV({"../../node_modules/.pnpm/debug@4.3.7/node_modules/debug/src/common.js"(t,i){i.exports=function(t){function i(t){let n,s=null,a,l;function u(...t){if(!u.enabled)return;let r=Number(new Date),s=r-(n||r);u.diff=s,u.prev=n,u.curr=r,n=r,t[0]=i.coerce(t[0]),"string"!=typeof t[0]&&t.unshift("%O");let a=0;t[0]=t[0].replace(/%([a-zA-Z%])/g,(r,n)=>{if("%%"===r)return"%";a++;let s=i.formatters[n];if("function"==typeof s){let i=t[a];r=s.call(u,i),t.splice(a,1),a--}return r}),i.formatArgs.call(u,t),(u.log||i.log).apply(u,t)}return u.namespace=t,u.useColors=i.useColors(),u.color=i.selectColor(t),u.extend=r,u.destroy=i.destroy,Object.defineProperty(u,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(a!==i.namespaces&&(a=i.namespaces,l=i.enabled(t)),l),set:t=>{s=t}}),"function"==typeof i.init&&i.init(u),u}function r(t,r){let n=i(this.namespace+(typeof r>"u"?":":r)+t);return n.log=this.log,n}function n(t){return t.toString().substring(2,t.toString().length-2).replace(/\.\*\?$/,"*")}return i.debug=i,i.default=i,i.coerce=function(t){return t instanceof Error?t.stack||t.message:t},i.disable=function(){let t=[...i.names.map(n),...i.skips.map(n).map(t=>"-"+t)].join(",");return i.enable(""),t},i.enable=function(t){let r;i.save(t),i.namespaces=t,i.names=[],i.skips=[];let n=("string"==typeof t?t:"").split(/[\s,]+/),s=n.length;for(r=0;r<s;r++)n[r]&&("-"===(t=n[r].replace(/\*/g,".*?"))[0]?i.skips.push(RegExp("^"+t.slice(1)+"$")):i.names.push(RegExp("^"+t+"$")))},i.enabled=function(t){let r,n;if("*"===t[t.length-1])return!0;for(r=0,n=i.skips.length;r<n;r++)if(i.skips[r].test(t))return!1;for(r=0,n=i.names.length;r<n;r++)if(i.names[r].test(t))return!0;return!1},i.humanize=aG(),i.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(t).forEach(r=>{i[r]=t[r]}),i.names=[],i.skips=[],i.formatters={},i.selectColor=function(t){let r=0;for(let i=0;i<t.length;i++)r=(r<<5)-r+t.charCodeAt(i)|0;return i.colors[Math.abs(r)%i.colors.length]},i.enable(i.load()),i}}}),aq=aV({"../../node_modules/.pnpm/debug@4.3.7/node_modules/debug/src/browser.js"(t,i){let r;t.formatArgs=function(t){if(t[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+t[0]+(this.useColors?"%c ":" ")+"+"+i.exports.humanize(this.diff),!this.useColors)return;let r="color: "+this.color;t.splice(1,0,r,"color: inherit");let n=0,s=0;t[0].replace(/%[a-zA-Z%]/g,t=>{"%%"!==t&&(n++,"%c"===t&&(s=n))}),t.splice(s,0,r)},t.save=function(i){try{i?t.storage.setItem("debug",i):t.storage.removeItem("debug")}catch{}},t.load=function(){let i;try{i=t.storage.getItem("debug")}catch{}return!i&&"u">typeof V&&"env"in V&&(i=V.env.DEBUG),i},t.useColors=function(){let t;return"u">typeof window&&!!window.process&&("renderer"===window.process.type||!!window.process.__nwjs)||!("u">typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("u">typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"u">typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"u">typeof navigator&&navigator.userAgent&&(t=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(t[1],10)>=31||"u">typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},t.storage=function(){try{return localStorage}catch{}}(),t.destroy=(r=!1,()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),t.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],t.log=console.debug||console.log||(()=>{}),i.exports=aJ()(t);var{formatters:n}=i.exports;n.j=function(t){try{return JSON.stringify(t)}catch(t){return"[UnexpectedJSONParseError]: "+t.message}}}}),aH=()=>new Map,aK=(t,i,r)=>{let n=t.get(i);return void 0===n&&t.set(i,n=r()),n},aY=()=>new Set,aQ=Array.from,aX=class{constructor(){this._observers=aH()}on(t,i){return aK(this._observers,t,aY).add(i),i}once(t,i){let r=(...n)=>{this.off(t,r),i(...n)};this.on(t,r)}off(t,i){let r=this._observers.get(t);void 0!==r&&(r.delete(i),0===r.size&&this._observers.delete(t))}emit(t,i){return aQ((this._observers.get(t)||aH()).values()).forEach(t=>t(...i))}destroy(){this._observers=aH()}},a0=class extends aX{constructor(t,i){super(),this.doc=t,this.logger=i,this.clientID=0,this.states=new Map,this._checkInterval=null,this.meta=new Map,this.participantIdToClientId=new Map,this.room=null,this.TIMEOUT_TIMER_MS=3e4,this.YJS_STATE="__yjs",this.previousState=null,this.participantId="",this.setLocalState=t=>{var i,r;if(this.logger.log("[SuperViz | Awareness] - Set local state",t),null===t){if(!this.states.has(this.clientID))return;this.states.delete(this.clientID),null==(i=this.room)||i.presence.update(a$(aW({},this.states.get(this.clientID)),{[this.YJS_STATE]:null,origin:"set local state null"}));let t={added:[],updated:[],removed:[this.clientID]};this.emit("change",[t,"local"]);return}let n={added:[],updated:[],removed:[]},s=this.states.get(this.clientID);s?n.updated.push(this.clientID):(s={[this.YJS_STATE]:{},clientID:this.clientID},n.added.push(this.clientID));let a=a$(aW({},s),{[this.YJS_STATE]:t,origin:"set local state"});this.states.set(this.clientID,a),null==(r=this.room)||r.presence.update(a),this.emit("change",[n,"local"])},this.onLeave=t=>{let i=this.participantIdToClientId.get(t.id);if(this.logger.log("[SuperViz | Awareness] - Participant left",{participant:t,clientID:i}),!i)return;if(i===this.clientID){let t=Array.from(this.states.keys());this.removeAwarenessStates(t,"presence");return}let r={added:[],updated:[],removed:[i]};this.participantIdToClientId.delete(t.id),this.states.delete(i),this.emit("update",[r,"presence"]),this.emit("change",[r,"presence"])},this.onUpdate=t=>{if(t.id===this.participantId)return;if(this.logger.log("[SuperViz | Awareness] - Participant updated",t),null===t.data[this.YJS_STATE]){this.removeAwarenessStates([t.data.clientID],"presence");return}let i=[],r=[],n=this.participantIdToClientId.get(t.id);n?r.push(t.data.clientID):(this.participantIdToClientId.set(t.id,t.data.clientID),n=t.data.clientID,i.push(t.data.clientID)),this.states.set(n,aW(aW({},this.states.get(n)||{}),t.data)),this.emit("update",[{added:i,updated:r,removed:[]},"presence"]),this.emit("change",[{added:i,updated:r,removed:[]},"presence"])},this.onVisibilityChange=()=>{if("visible"===document.visibilityState){clearTimeout(this.visibilityTimeout),this.previousState&&(this.setLocalState(this.previousState),this.previousState=null);return}this.visibilityTimeout=setTimeout(()=>{this.previousState=this.getLocalState(),this.setLocalState(null)},this.TIMEOUT_TIMER_MS)},this.clientID=this.doc.clientID}connect(t,i){this.logger.log("[SuperViz | Awareness] - Connect awareness to room"),this.participantId=t,this.room=i,this.addRoomListeners(),this.addDocumentListeners(),this.initializePresences()}destroy(){this.logger.log("[SuperViz | Awareness] - Destroy awareness"),this.setLocalState(null),this.removeAwarenessStates(Array.from(this.states.keys()),"local"),clearTimeout(this.visibilityTimeout),this.visibilityTimeout=void 0,this.removeDocumentListeners(),this.removeRoomListeners(),this.room=null,this.states.clear(),this.participantIdToClientId.clear(),this.onLeave({id:this.participantId})}getLocalState(){var t;this.logger.log("[SuperViz | Awareness] - Get local state",null==(t=this.states.get(this.clientID))?void 0:t[this.YJS_STATE]);let i=this.states.get(this.clientID);return i&&i[this.YJS_STATE]?i[this.YJS_STATE]:null}getStates(){let t=new Map;return this.states.forEach((i,r)=>{t.set(r,i[this.YJS_STATE])}),this.logger.log("[SuperViz | Awareness] - Get states",t),t}setLocalStateField(t,i){this.logger.log("[SuperViz | Awareness] - Set local state field",{field:t,value:i});let r=this.getLocalState();this.setLocalState(a$(aW({},r||{}),{[t]:i}))}addRoomListeners(){this.room.presence.on("presence.update",this.onUpdate),this.room.presence.on("presence.leave",this.onLeave)}removeRoomListeners(){this.room.presence.off("presence.update"),this.room.presence.off("presence.leave")}addDocumentListeners(){document.addEventListener("visibilitychange",this.onVisibilityChange)}removeDocumentListeners(){document.removeEventListener("visibilitychange",this.onVisibilityChange)}initializePresences(){this.room.presence.get(t=>{let i=[];t.forEach(t=>{let{clientID:r}=t.data;r&&(i.push(r),this.participantIdToClientId.set(t.id,r),this.states.set(r,aW({},t.data)))});let{clientID:r}=this.doc;this.room.presence.update(a$(aW({clientID:r,[this.YJS_STATE]:{}},this.states.get(r)||{}),{origin:"on connect"})),this.emit("change",[{added:i,updated:[],removed:[]},"presence"])})}removeAwarenessStates(t,i){this.logger.log("[SuperViz | Awareness] - Remove awareness states",{removed:t,origin:i});let r={added:[],updated:[],removed:[]};t.forEach(t=>{this.states.get(t)&&(this.states.delete(t),r.removed.push(t))}),this.emit("change",[r,i])}},a1=((t,i,r,n)=>{if(i&&"object"==typeof i||"function"==typeof i)for(let s of aN(i))aB.call(t,s)||s===r||aM(t,s,{get:()=>i[s],enumerable:!(n=aF(i,s))||n.enumerable});return t})(aM(null!=(U=aq())?aI(aj(U)):{},"default",{value:U,enumerable:!0}),U),a3=class{constructor(t,i){this.prefix=i,this.debug=(0,a1.default)(t)}log(t,...i){this.debug(`${this.prefix} -`,t,...i)}},a2=class extends aX{constructor(t,i){super(),this.doc=t,this.name="yjsProvider",this._synced=!1,this.state="provider.disconnected",this.isAttached=!1,this.localParticipant=null,this.room=null,this.ioc=null,this.fetch=()=>aZ(this,null,function*(){this.logger.log("Fetching the document"),this._synced=!1;let t=yield function(t,i){return aZ(this,null,function*(){try{let r=yield fetch(`https://io.superviz.com/yjs/${t}:yjs-provider`,{headers:{"sv-api-key":i}});return 200!==r.status?[]:(yield r.json()).events.map(t=>new Uint8Array(t.update.data))}catch{return[]}})}(this.roomId,this.ioc.client.apiKey);this._synced=!0,t.length&&$.cp(this.doc,$.vp(t))}),this.updateDocument=t=>{this.logger.log("Applying remote update",t),$.cp(this.doc,t,this)},this.onDocUpdate=t=>{this.logger.log("Local document update",t),this.beforeSendRealtimeMessage("provider.update",{update:t}),this.room.emit("provider.update",{update:t})},this.onLocalJoinRoom=t=>{var i;if("provider.connected"===this.state||t.id!==this.localParticipant.id)return;this.logger.log("Joined the room",t),null==(i=this.awareness)||i.connect(this.localParticipant.id,this.room),this.changeState("provider.connected"),this.emit("connect",[]);let r=$.ir(this.doc);this.beforeSendRealtimeMessage("provider.update",{update:r}),this.room.emit("provider.update",{update:r}),this.fetch()},this.onConnectionChange=t=>{"DISCONNECTED"===t.state&&(this.logger.log("Disconnected from the room"),this.emit("disconnect",[]))},this.onRemoteDocUpdate=t=>{var i;if((null==(i=t.presence)?void 0:i.id)===this.localParticipant.id)return;this.logger.log("Received remote document update",t);let r=new Uint8Array(t.data.update);this.onReceiveRealtimeMessage("provider.update",{update:r}),this.updateDocument(r)},this.onReceiveRealtimeMessage=(t,i)=>{this.logger.log("Received message from room",{name:t,data:i}),this.emit("message",[{name:t,data:i}])},this.beforeSendRealtimeMessage=(t,i)=>{this.logger.log("Sending message to room",{name:t,data:i}),this.emit("outgoingMessage",[{name:t,data:i}])},this.document=t,this.logger=new a3("SuperVizYjsProvider","[SuperViz | YjsProvider] - "),(null==i?void 0:i.awareness)!==!1&&(this.awareness=new a0(this.doc,this.logger))}attach(t){if(Object.values(t).includes(null)||Object.values(t).includes(void 0)){let t=`${this.name} @ attach - params are required`;throw this.logger.log(t),Error(t)}let{useStore:i,ioc:r,config:n}=t,{isDomainWhitelisted:s,hasJoinedRoom:a,localParticipant:l}=i("global-store");if(!s.value){let t=`Component ${this.name} can't be used because this website's domain is not whitelisted. Please add your domain in https://dashboard.superviz.com/developer`;this.logger.log(t);return}if(!a.value){a.subscribe(()=>this.attach(t));return}this.roomId=n.roomId,this.ioc=r,this.localParticipant=l.value,this.isAttached=!0,this.connect(),this.emit("mount",[])}detach(){if(!this.isAttached){this.logger.log(`${this.name} @ detach - component is not attached`);return}this.logger.log("detached"),this.destroyProvider(),super.destroy(),this.emit("unmount",[])}connect(){"provider.disconnected"===this.state&&(this.logger.log("Connecting to the room"),this.changeState("provider.connecting"),this.doc.on("updateV2",this.onDocUpdate),this.startRealtime())}destroyProvider(){var t;if("provider.disconnected"===this.state){this.logger.log("Can't destroy. Provider disconnected");return}this.logger.log("Destroying the provider"),this.emit("destroy",[]),this._synced=!1,null==(t=this.awareness)||t.destroy(),this.doc.off("updateV2",this.onDocUpdate),this.removeRoomListeners(),this.room&&(this.room.disconnect(),this.room=null),this.changeState("provider.disconnected")}get synced(){return this._synced}createRoom(){this.logger.log("Creating room"),this.room=this.ioc.createRoom("yjs-provider")}addRoomListeners(){this.logger.log("Adding room listeners"),this.room.on("provider.update",this.onRemoteDocUpdate),this.room.presence.on("presence.joined-room",this.onLocalJoinRoom),this.ioc.client.connection.on(this.onConnectionChange)}removeRoomListeners(){var t;this.logger.log("Removing room listeners"),this.room&&(this.room.off("provider.update",this.onRemoteDocUpdate),this.room.presence.off("presence.joined-room")),null==(t=this.ioc)||t.client.connection.off()}startRealtime(){this.createRoom(),this.addRoomListeners()}changeState(t){this.logger.log("Changing state",t),this.emit("state",[t]),this.state=t}};"u">typeof window&&(window.SuperVizYjsProvider=a2)}}]);