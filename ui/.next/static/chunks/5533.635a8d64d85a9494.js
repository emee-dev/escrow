"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5533],{1381:function(t,e,n){n.d(e,{E:function(){return i},a:function(){return s},i:function(){return o}}),(0,n(1589).e)();var i={ATTRIBUTE:1,CHILD:2,PROPERTY:3,BOOLEAN_ATTRIBUTE:4,EVENT:5,ELEMENT:6},s=t=>(...e)=>({_$litDirective$:t,values:e}),o=class{constructor(t){}get _$AU(){return this._$AM._$AU}_$AT(t,e,n){this.t=t,this._$AM=e,this.i=n}_$AS(t,e){return this.update(t,e)}update(t,e){return this.render(...e)}}},2771:function(t,e,n){n.d(e,{j:function(){return f}});var i=n(1381),s=n(7250),o=n(1589);(0,o.e)(),(0,o.e)();var{I:l}=s.J,r=()=>document.createComment(""),a=(t,e,n)=>{var i;let s=t._$AA.parentNode,o=void 0===e?t._$AB:e._$AA;if(void 0===n)n=new l(s.insertBefore(r(),o),s.insertBefore(r(),o),t,t.options);else{let e=n._$AB.nextSibling,l=n._$AM,r=l!==t;if(r){let e;null==(i=n._$AQ)||i.call(n,t),n._$AM=t,void 0!==n._$AP&&(e=t._$AU)!==l._$AU&&n._$AP(e)}if(e!==o||r){let t=n._$AA;for(;t!==e;){let e=t.nextSibling;s.insertBefore(t,o),t=e}}}return n},u=(t,e,n=t)=>(t._$AI(e,n),t),c={},d=(t,e=c)=>t._$AH=e,h=t=>t._$AH,A=t=>{var e;null==(e=t._$AP)||e.call(t,!1,!0);let n=t._$AA,i=t._$AB.nextSibling;for(;n!==i;){let t=n.nextSibling;n.remove(),n=t}},v=(t,e,n)=>{let i=new Map;for(let s=e;s<=n;s++)i.set(t[s],s);return i},f=(0,i.a)(class extends i.i{constructor(t){if(super(t),t.type!==i.E.CHILD)throw Error("repeat() can only be used in text expressions")}dt(t,e,n){let i;void 0===n?n=e:void 0!==e&&(i=e);let s=[],o=[],l=0;for(let e of t)s[l]=i?i(e,l):l,o[l]=n(e,l),l++;return{values:o,keys:s}}render(t,e,n){return this.dt(t,e,n).values}update(t,[e,n,i]){var o;let l=h(t),{values:r,keys:c}=this.dt(e,n,i);if(!Array.isArray(l))return this.ut=c,r;let f=null!=(o=this.ut)?o:this.ut=[],p=[],$,m,_=0,y=l.length-1,E=0,b=r.length-1;for(;_<=y&&E<=b;)if(null===l[_])_++;else if(null===l[y])y--;else if(f[_]===c[E])p[E]=u(l[_],r[E]),_++,E++;else if(f[y]===c[b])p[b]=u(l[y],r[b]),y--,b--;else if(f[_]===c[b])p[b]=u(l[_],r[b]),a(t,p[b+1],l[_]),_++,b--;else if(f[y]===c[E])p[E]=u(l[y],r[E]),a(t,l[_],l[y]),y--,E++;else if(void 0===$&&($=v(c,E,b),m=v(f,_,y)),$.has(f[_])){if($.has(f[y])){let e=m.get(c[E]),n=void 0!==e?l[e]:null;if(null===n){let e=a(t,l[_]);u(e,r[E]),p[E]=e}else p[E]=u(n,r[E]),a(t,l[_],n),l[e]=null;E++}else A(l[y]),y--}else A(l[_]),_++;for(;E<=b;){let e=a(t,p[b+1]);u(e,r[E]),p[E++]=e}for(;_<=y;){let t=l[_++];null!==t&&A(t)}return this.ut=c,d(t,p),s.E}});(0,o.e)()},5533:function(t,e,n){n.r(e),n.d(e,{CommentsContent:function(){return c}});var i=n(2771),s=n(9583),o=n(1589);n(1381);var l=n(3605),r=n(7250);(0,o.e)();var a=(0,l.D)(r.a),u=[a.styles,s.a],c=class extends a{constructor(){super(),this.unselectAnnotation=()=>{this.selectedAnnotation=null},this.unselectAnnotationEsc=t=>{t&&(null==t?void 0:t.key)!=="Escape"||(this.selectedAnnotation=null)},this.selectAnnotation=({detail:t})=>{let{uuid:e}=t;if(this.selectedAnnotation===e){this.selectedAnnotation=null;return}this.selectedAnnotation=e},this.checkLastAnnotation=t=>{var e,n;let i=this.annotations.filter(t=>t.resolved),s=this.annotations.filter(t=>!t.resolved);return"All comments"===this.annotationFilter?t===(null==(e=i[i.length-1])?void 0:e.uuid):t===(null==(n=s[s.length-1])?void 0:n.uuid)},this.annotations=[],this.participantsList=[]}updated(t){super.updated(t),this.updateComplete.then(()=>{let t=this.shadowRoot.querySelector(`[uuid='${this.selectedAnnotation}']`);if(!t)return;let e=this.lastCommentId===this.selectedAnnotation,n=e?0:-150,i=t.getClientRects()[0];i&&(this.scrollBy(0,i.y+n),e&&setTimeout(()=>{this.scrollBy(0,i.y+n)},200))})}connectedCallback(){super.connectedCallback(),window.document.body.addEventListener("select-annotation",this.selectAnnotation),window.document.body.addEventListener("keyup",this.unselectAnnotationEsc),window.document.body.addEventListener("unselect-annotation",this.unselectAnnotation)}disconnectedCallback(){super.disconnectedCallback(),window.document.body.removeEventListener("select-annotation",this.selectAnnotation),window.document.body.removeEventListener("keyup",this.unselectAnnotationEsc),window.document.body.removeEventListener("unselect-annotation",this.unselectAnnotation)}render(){return(0,r.V)` ${(0,i.j)(this.annotations.filter(t=>{var e;return null==(e=t.comments)?void 0:e.length}),t=>t.uuid,t=>(0,r.V)`
        <superviz-comments-annotation-item
          annotation=${JSON.stringify(t)}
          selected="${this.selectedAnnotation}"
          annotationFilter=${this.annotationFilter}
          uuid=${t.uuid}
          ?resolved=${t.resolved}
          isLastComment=${this.checkLastAnnotation(t.uuid)}
          participantsList=${JSON.stringify(this.participantsList)}
        >
        </superviz-comments-annotation-item>
      `)}`}};c.styles=u,c.properties={annotations:{type:Object},selectedAnnotation:{type:String},annotationFilter:{type:String},participantsList:{type:Object}},c=(0,o.D)([(0,r.t)("superviz-comments-content")],c)}}]);