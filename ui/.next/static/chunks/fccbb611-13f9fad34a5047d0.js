"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1023],{7938:function(e,i,r){let n,s,a,o,l,h,u,c,d,p,f,m,g,y,v,_,x,b,w,M,A,S,T,C,P,E,I,z,R,B,k,O;var L=r(5324),N=Object.create,F=Object.defineProperty,D=Object.getOwnPropertyDescriptor,U=Object.getOwnPropertyNames,j=Object.getPrototypeOf,V=Object.prototype.hasOwnProperty,W=(e,i)=>()=>(i||e((i={exports:{}}).exports,i),i.exports),H=(e,i,r,n)=>{if(i&&"object"==typeof i||"function"==typeof i)for(let s of U(i))V.call(e,s)||s===r||F(e,s,{get:()=>i[s],enumerable:!(n=D(i,s))||n.enumerable});return e},q=(e,i,r)=>(r=null!=e?N(j(e)):{},H(e&&e.__esModule?r:F(r,"default",{value:e,enumerable:!0}),e)),G=W((e,i)=>{(function(){var r,n="Expected a function",s="__lodash_hash_undefined__",a="__lodash_placeholder__",o=1/0,l=NaN,h=[["ary",128],["bind",1],["bindKey",2],["curry",8],["curryRight",16],["flip",512],["partial",32],["partialRight",64],["rearg",256]],u="[object Arguments]",c="[object Array]",d="[object Boolean]",p="[object Date]",f="[object Error]",m="[object Function]",g="[object GeneratorFunction]",y="[object Map]",v="[object Number]",_="[object Object]",x="[object Promise]",b="[object RegExp]",w="[object Set]",M="[object String]",A="[object Symbol]",S="[object WeakMap]",T="[object ArrayBuffer]",C="[object DataView]",P="[object Float32Array]",E="[object Float64Array]",I="[object Int8Array]",z="[object Int16Array]",R="[object Int32Array]",B="[object Uint8Array]",k="[object Uint8ClampedArray]",O="[object Uint16Array]",L="[object Uint32Array]",N=/\b__p \+= '';/g,F=/\b(__p \+=) '' \+/g,D=/(__e\(.*?\)|\b__t\)) \+\n'';/g,U=/&(?:amp|lt|gt|quot|#39);/g,j=/[&<>"']/g,V=RegExp(U.source),W=RegExp(j.source),H=/<%-([\s\S]+?)%>/g,q=/<%([\s\S]+?)%>/g,G=/<%=([\s\S]+?)%>/g,J=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,X=/^\w*$/,Y=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Z=/[\\^$.*+?()[\]{}|]/g,K=RegExp(Z.source),$=/^\s+/,Q=/\s/,tt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,te=/\{\n\/\* \[wrapped with (.+)\] \*/,ti=/,? & /,tr=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,tn=/[()=,{}\[\]\/\s]/,ts=/\\(\\)?/g,ta=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,to=/\w*$/,tl=/^[-+]0x[0-9a-f]+$/i,th=/^0b[01]+$/i,tu=/^\[object .+?Constructor\]$/,tc=/^0o[0-7]+$/i,td=/^(?:0|[1-9]\d*)$/,tp=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,tf=/($^)/,tm=/['\n\r\u2028\u2029\\]/g,tg="\ud800-\udfff",ty="\\u0300-\\u036f\\ufe20-\\ufe2f\\u20d0-\\u20ff",tv="\\u2700-\\u27bf",t_="a-z\\xdf-\\xf6\\xf8-\\xff",tx="A-Z\\xc0-\\xd6\\xd8-\\xde",tb="\\ufe0e\\ufe0f",tw="\\xac\\xb1\\xd7\\xf7\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf\\u2000-\\u206f \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",tM="['’]",tA="["+tw+"]",tS="["+ty+"]",tT="["+t_+"]",tC="[^"+tg+tw+"\\d+"+tv+t_+tx+"]",tP="\ud83c[\udffb-\udfff]",tE="[^"+tg+"]",tI="(?:\ud83c[\udde6-\uddff]){2}",tz="[\ud800-\udbff][\udc00-\udfff]",tR="["+tx+"]",tB="\\u200d",tk="(?:"+tT+"|"+tC+")",tO="(?:"+tM+"(?:d|ll|m|re|s|t|ve))?",tL="(?:"+tM+"(?:D|LL|M|RE|S|T|VE))?",tN="(?:"+tS+"|"+tP+")?",tF="["+tb+"]?",tD="(?:"+tB+"(?:"+[tE,tI,tz].join("|")+")"+tF+tN+")*",tU=tF+tN+tD,tj="(?:"+["["+tv+"]",tI,tz].join("|")+")"+tU,tV="(?:"+[tE+tS+"?",tS,tI,tz,"["+tg+"]"].join("|")+")",tW=RegExp(tM,"g"),tH=RegExp(tS,"g"),tq=RegExp(tP+"(?="+tP+")|"+tV+tU,"g"),tG=RegExp([tR+"?"+tT+"+"+tO+"(?="+[tA,tR,"$"].join("|")+")","(?:"+tR+"|"+tC+")+"+tL+"(?="+[tA,tR+tk,"$"].join("|")+")",tR+"?"+tk+"+"+tO,tR+"+"+tL,"\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])","\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])","\\d+",tj].join("|"),"g"),tJ=RegExp("["+tB+tg+ty+tb+"]"),tX=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,tY=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],tZ=-1,tK={};tK[P]=tK[E]=tK[I]=tK[z]=tK[R]=tK[B]=tK[k]=tK[O]=tK[L]=!0,tK[u]=tK[c]=tK[T]=tK[d]=tK[C]=tK[p]=tK[f]=tK[m]=tK[y]=tK[v]=tK[_]=tK[b]=tK[w]=tK[M]=tK[S]=!1;var t$={};t$[u]=t$[c]=t$[T]=t$[C]=t$[d]=t$[p]=t$[P]=t$[E]=t$[I]=t$[z]=t$[R]=t$[y]=t$[v]=t$[_]=t$[b]=t$[w]=t$[M]=t$[A]=t$[B]=t$[k]=t$[O]=t$[L]=!0,t$[f]=t$[m]=t$[S]=!1;var tQ={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},t0=parseFloat,t1=parseInt,t2="object"==typeof window&&window&&window.Object===Object&&window,t3="object"==typeof self&&self&&self.Object===Object&&self,t4=t2||t3||Function("return this")(),t5="object"==typeof e&&e&&!e.nodeType&&e,t6=t5&&"object"==typeof i&&i&&!i.nodeType&&i,t9=t6&&t6.exports===t5,t7=t9&&t2.process,t8=function(){try{return t6&&t6.require&&t6.require("util").types||t7&&t7.binding&&t7.binding("util")}catch{}}(),et=t8&&t8.isArrayBuffer,ee=t8&&t8.isDate,ei=t8&&t8.isMap,er=t8&&t8.isRegExp,en=t8&&t8.isSet,es=t8&&t8.isTypedArray;function ea(e,i,r){switch(r.length){case 0:return e.call(i);case 1:return e.call(i,r[0]);case 2:return e.call(i,r[0],r[1]);case 3:return e.call(i,r[0],r[1],r[2])}return e.apply(i,r)}function eo(e,i,r,n){for(var s=-1,a=null==e?0:e.length;++s<a;){var o=e[s];i(n,o,r(o),e)}return n}function el(e,i){for(var r=-1,n=null==e?0:e.length;++r<n&&!1!==i(e[r],r,e););return e}function eh(e,i){for(var r=-1,n=null==e?0:e.length;++r<n;)if(!i(e[r],r,e))return!1;return!0}function eu(e,i){for(var r=-1,n=null==e?0:e.length,s=0,a=[];++r<n;){var o=e[r];i(o,r,e)&&(a[s++]=o)}return a}function ec(e,i){return!!(null==e?0:e.length)&&eb(e,i,0)>-1}function ed(e,i,r){for(var n=-1,s=null==e?0:e.length;++n<s;)if(r(i,e[n]))return!0;return!1}function ep(e,i){for(var r=-1,n=null==e?0:e.length,s=Array(n);++r<n;)s[r]=i(e[r],r,e);return s}function ef(e,i){for(var r=-1,n=i.length,s=e.length;++r<n;)e[s+r]=i[r];return e}function em(e,i,r,n){var s=-1,a=null==e?0:e.length;for(n&&a&&(r=e[++s]);++s<a;)r=i(r,e[s],s,e);return r}function eg(e,i,r,n){var s=null==e?0:e.length;for(n&&s&&(r=e[--s]);s--;)r=i(r,e[s],s,e);return r}function ey(e,i){for(var r=-1,n=null==e?0:e.length;++r<n;)if(i(e[r],r,e))return!0;return!1}var ev=eS("length");function e_(e,i,r){var n;return r(e,function(e,r,s){if(i(e,r,s))return n=r,!1}),n}function ex(e,i,r,n){for(var s=e.length,a=r+(n?1:-1);n?a--:++a<s;)if(i(e[a],a,e))return a;return -1}function eb(e,i,r){return i==i?function(e,i,r){for(var n=r-1,s=e.length;++n<s;)if(e[n]===i)return n;return -1}(e,i,r):ex(e,eM,r)}function ew(e,i,r,n){for(var s=r-1,a=e.length;++s<a;)if(n(e[s],i))return s;return -1}function eM(e){return e!=e}function eA(e,i){var r=null==e?0:e.length;return r?eP(e,i)/r:l}function eS(e){return function(i){return null==i?r:i[e]}}function eT(e){return function(i){return null==e?r:e[i]}}function eC(e,i,r,n,s){return s(e,function(e,s,a){r=n?(n=!1,e):i(r,e,s,a)}),r}function eP(e,i){for(var n,s=-1,a=e.length;++s<a;){var o=i(e[s]);o!==r&&(n=n===r?o:n+o)}return n}function eE(e,i){for(var r=-1,n=Array(e);++r<e;)n[r]=i(r);return n}function eI(e){return e&&e.slice(0,eG(e)+1).replace($,"")}function ez(e){return function(i){return e(i)}}function eR(e,i){return ep(i,function(i){return e[i]})}function eB(e,i){return e.has(i)}function ek(e,i){for(var r=-1,n=e.length;++r<n&&eb(i,e[r],0)>-1;);return r}function eO(e,i){for(var r=e.length;r--&&eb(i,e[r],0)>-1;);return r}var eL=eT({À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"}),eN=eT({"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"});function eF(e){return"\\"+tQ[e]}function eD(e){return tJ.test(e)}function eU(e){var i=-1,r=Array(e.size);return e.forEach(function(e,n){r[++i]=[n,e]}),r}function ej(e,i){return function(r){return e(i(r))}}function eV(e,i){for(var r=-1,n=e.length,s=0,o=[];++r<n;){var l=e[r];(l===i||l===a)&&(e[r]=a,o[s++]=r)}return o}function eW(e){var i=-1,r=Array(e.size);return e.forEach(function(e){r[++i]=e}),r}function eH(e){return eD(e)?function(e){for(var i=tq.lastIndex=0;tq.test(e);)++i;return i}(e):ev(e)}function eq(e){return eD(e)?e.match(tq)||[]:e.split("")}function eG(e){for(var i=e.length;i--&&Q.test(e.charAt(i)););return i}var eJ=eT({"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"}),eX=function e(i){var Q,tg,ty,tv,t_=(i=null==i?t4:eX.defaults(t4.Object(),i,eX.pick(t4,tY))).Array,tx=i.Date,tb=i.Error,tw=i.Function,tM=i.Math,tA=i.Object,tS=i.RegExp,tT=i.String,tC=i.TypeError,tP=t_.prototype,tE=tw.prototype,tI=tA.prototype,tz=i["__core-js_shared__"],tR=tE.toString,tB=tI.hasOwnProperty,tk=0,tO=(Q=/[^.]+$/.exec(tz&&tz.keys&&tz.keys.IE_PROTO||""))?"Symbol(src)_1."+Q:"",tL=tI.toString,tN=tR.call(tA),tF=t4._,tD=tS("^"+tR.call(tB).replace(Z,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),tU=t9?i.Buffer:r,tj=i.Symbol,tV=i.Uint8Array,tq=tU?tU.allocUnsafe:r,tJ=ej(tA.getPrototypeOf,tA),tQ=tA.create,t2=tI.propertyIsEnumerable,t3=tP.splice,t5=tj?tj.isConcatSpreadable:r,t6=tj?tj.iterator:r,t7=tj?tj.toStringTag:r,t8=function(){try{var e=nm(tA,"defineProperty");return e({},"",{}),e}catch{}}(),ev=i.clearTimeout!==t4.clearTimeout&&i.clearTimeout,eT=tx&&tx.now!==t4.Date.now&&tx.now,eY=i.setTimeout!==t4.setTimeout&&i.setTimeout,eZ=tM.ceil,eK=tM.floor,e$=tA.getOwnPropertySymbols,eQ=tU?tU.isBuffer:r,e0=i.isFinite,e1=tP.join,e2=ej(tA.keys,tA),e3=tM.max,e4=tM.min,e5=tx.now,e6=i.parseInt,e9=tM.random,e7=tP.reverse,e8=nm(i,"DataView"),it=nm(i,"Map"),ie=nm(i,"Promise"),ii=nm(i,"Set"),ir=nm(i,"WeakMap"),is=nm(tA,"create"),ia=ir&&new ir,io={},il=nU(e8),ih=nU(it),iu=nU(ie),ic=nU(ii),id=nU(ir),ip=tj?tj.prototype:r,im=ip?ip.valueOf:r,ig=ip?ip.toString:r;function iy(e){if(sJ(e)&&!sL(e)&&!(e instanceof ib)){if(e instanceof ix)return e;if(tB.call(e,"__wrapped__"))return nj(e)}return new ix(e)}var iv=function(){function e(){}return function(i){if(!sG(i))return{};if(tQ)return tQ(i);e.prototype=i;var n=new e;return e.prototype=r,n}}();function i_(){}function ix(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}function ib(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=4294967295,this.__views__=[]}function iw(e){var i=-1,r=null==e?0:e.length;for(this.clear();++i<r;){var n=e[i];this.set(n[0],n[1])}}function iM(e){var i=-1,r=null==e?0:e.length;for(this.clear();++i<r;){var n=e[i];this.set(n[0],n[1])}}function iA(e){var i=-1,r=null==e?0:e.length;for(this.clear();++i<r;){var n=e[i];this.set(n[0],n[1])}}function iS(e){var i=-1,r=null==e?0:e.length;for(this.__data__=new iA;++i<r;)this.add(e[i])}function iT(e){var i=this.__data__=new iM(e);this.size=i.size}function iC(e,i){var r=sL(e),n=!r&&sO(e),s=!r&&!n&&sU(e),a=!r&&!n&&!s&&s1(e),o=r||n||s||a,l=o?eE(e.length,tT):[],h=l.length;for(var u in e)(i||tB.call(e,u))&&!(o&&("length"==u||s&&("offset"==u||"parent"==u)||a&&("buffer"==u||"byteLength"==u||"byteOffset"==u)||nw(u,h)))&&l.push(u);return l}function iP(e){var i=e.length;return i?e[rd(0,i-1)]:r}function iE(e,i,n){(n===r||sR(e[i],n))&&(n!==r||i in e)||ik(e,i,n)}function iI(e,i,n){var s=e[i];tB.call(e,i)&&sR(s,n)&&(n!==r||i in e)||ik(e,i,n)}function iz(e,i){for(var r=e.length;r--;)if(sR(e[r][0],i))return r;return -1}function iR(e,i,r,n){return ij(e,function(e,s,a){i(n,e,r(e),a)}),n}function iB(e,i){return e&&rH(i,ap(i),e)}function ik(e,i,r){"__proto__"==i&&t8?t8(e,i,{configurable:!0,enumerable:!0,value:r,writable:!0}):e[i]=r}function iO(e,i){for(var n=-1,s=i.length,a=t_(s),o=null==e;++n<s;)a[n]=o?r:al(e,i[n]);return a}function iL(e,i,n){return e==e&&(n!==r&&(e=e<=n?e:n),i!==r&&(e=e>=i?e:i)),e}function iN(e,i,n,s,a,o){var l,h=1&i,c=2&i,f=4&i;if(n&&(l=a?n(e,s,a,o):n(e)),l!==r)return l;if(!sG(e))return e;var x=sL(e);if(x){if(S=e.length,N=new e.constructor(S),S&&"string"==typeof e[0]&&tB.call(e,"index")&&(N.index=e.index,N.input=e.input),l=N,!h)return rW(e,l)}else{var S,N,F,D,U,j=nv(e),V=j==m||j==g;if(sU(e))return rN(e,h);if(j==_||j==u||V&&!a){if(l=c||V?{}:nx(e),!h)return c?(F=(U=l)&&rH(e,af(e),U),rH(e,ny(e),F)):(D=iB(l,e),rH(e,ng(e),D))}else{if(!t$[j])return a?e:{};l=function(e,i,r){var n,s,a=e.constructor;switch(i){case T:return rF(e);case d:case p:return new a(+e);case C:return n=r?rF(e.buffer):e.buffer,new e.constructor(n,e.byteOffset,e.byteLength);case P:case E:case I:case z:case R:case B:case k:case O:case L:return rD(e,r);case y:return new a;case v:case M:return new a(e);case b:return(s=new e.constructor(e.source,to.exec(e))).lastIndex=e.lastIndex,s;case w:return new a;case A:return im?tA(im.call(e)):{}}}(e,j,h)}}o||(o=new iT);var W=o.get(e);if(W)return W;o.set(e,l),s$(e)?e.forEach(function(r){l.add(iN(r,i,n,r,e,o))}):sX(e)&&e.forEach(function(r,s){l.set(s,iN(r,i,n,s,e,o))});var H=f?c?nl:no:c?af:ap,q=x?r:H(e);return el(q||e,function(r,s){q&&(r=e[s=r]),iI(l,s,iN(r,i,n,s,e,o))}),l}function iF(e,i,n){var s=n.length;if(null==e)return!s;for(e=tA(e);s--;){var a=n[s],o=i[a],l=e[a];if(l===r&&!(a in e)||!o(l))return!1}return!0}function iD(e,i,s){if("function"!=typeof e)throw new tC(n);return nB(function(){e.apply(r,s)},i)}function iU(e,i,r,n){var s=-1,a=ec,o=!0,l=e.length,h=[],u=i.length;if(!l)return h;r&&(i=ep(i,ez(r))),n?(a=ed,o=!1):i.length>=200&&(a=eB,o=!1,i=new iS(i));t:for(;++s<l;){var c=e[s],d=null==r?c:r(c);if(c=n||0!==c?c:0,o&&d==d){for(var p=u;p--;)if(i[p]===d)continue t;h.push(c)}else a(i,d,n)||h.push(c)}return h}iy.templateSettings={escape:H,evaluate:q,interpolate:G,variable:"",imports:{_:iy}},iy.prototype=i_.prototype,iy.prototype.constructor=iy,ix.prototype=iv(i_.prototype),ix.prototype.constructor=ix,ib.prototype=iv(i_.prototype),ib.prototype.constructor=ib,iw.prototype.clear=function(){this.__data__=is?is(null):{},this.size=0},iw.prototype.delete=function(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i},iw.prototype.get=function(e){var i=this.__data__;if(is){var n=i[e];return n===s?r:n}return tB.call(i,e)?i[e]:r},iw.prototype.has=function(e){var i=this.__data__;return is?i[e]!==r:tB.call(i,e)},iw.prototype.set=function(e,i){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=is&&i===r?s:i,this},iM.prototype.clear=function(){this.__data__=[],this.size=0},iM.prototype.delete=function(e){var i=this.__data__,r=iz(i,e);return!(r<0)&&(r==i.length-1?i.pop():t3.call(i,r,1),--this.size,!0)},iM.prototype.get=function(e){var i=this.__data__,n=iz(i,e);return n<0?r:i[n][1]},iM.prototype.has=function(e){return iz(this.__data__,e)>-1},iM.prototype.set=function(e,i){var r=this.__data__,n=iz(r,e);return n<0?(++this.size,r.push([e,i])):r[n][1]=i,this},iA.prototype.clear=function(){this.size=0,this.__data__={hash:new iw,map:new(it||iM),string:new iw}},iA.prototype.delete=function(e){var i=np(this,e).delete(e);return this.size-=i?1:0,i},iA.prototype.get=function(e){return np(this,e).get(e)},iA.prototype.has=function(e){return np(this,e).has(e)},iA.prototype.set=function(e,i){var r=np(this,e),n=r.size;return r.set(e,i),this.size+=r.size==n?0:1,this},iS.prototype.add=iS.prototype.push=function(e){return this.__data__.set(e,s),this},iS.prototype.has=function(e){return this.__data__.has(e)},iT.prototype.clear=function(){this.__data__=new iM,this.size=0},iT.prototype.delete=function(e){var i=this.__data__,r=i.delete(e);return this.size=i.size,r},iT.prototype.get=function(e){return this.__data__.get(e)},iT.prototype.has=function(e){return this.__data__.has(e)},iT.prototype.set=function(e,i){var r=this.__data__;if(r instanceof iM){var n=r.__data__;if(!it||n.length<199)return n.push([e,i]),this.size=++r.size,this;r=this.__data__=new iA(n)}return r.set(e,i),this.size=r.size,this};var ij=rJ(iY),iV=rJ(iZ,!0);function iW(e,i){var r=!0;return ij(e,function(e,n,s){return r=!!i(e,n,s)}),r}function iH(e,i,n){for(var s=-1,a=e.length;++s<a;){var o=e[s],l=i(o);if(null!=l&&(h===r?l==l&&!s0(l):n(l,h)))var h=l,u=o}return u}function iq(e,i){var r=[];return ij(e,function(e,n,s){i(e,n,s)&&r.push(e)}),r}function iG(e,i,r,n,s){var a=-1,o=e.length;for(r||(r=nb),s||(s=[]);++a<o;){var l=e[a];i>0&&r(l)?i>1?iG(l,i-1,r,n,s):ef(s,l):n||(s[s.length]=l)}return s}var iJ=rX(),iX=rX(!0);function iY(e,i){return e&&iJ(e,i,ap)}function iZ(e,i){return e&&iX(e,i,ap)}function iK(e,i){return eu(i,function(i){return sW(e[i])})}function i$(e,i){i=rk(i,e);for(var n=0,s=i.length;null!=e&&n<s;)e=e[nD(i[n++])];return n&&n==s?e:r}function iQ(e,i,r){var n=i(e);return sL(e)?n:ef(n,r(e))}function i0(e){return null==e?e===r?"[object Undefined]":"[object Null]":t7&&t7 in tA(e)?function(e){var i=tB.call(e,t7),n=e[t7];try{e[t7]=r;var s=!0}catch{}var a=tL.call(e);return s&&(i?e[t7]=n:delete e[t7]),a}(e):tL.call(e)}function i1(e,i){return e>i}function i2(e,i){return null!=e&&tB.call(e,i)}function i3(e,i){return null!=e&&i in tA(e)}function i4(e,i,n){for(var s=n?ed:ec,a=e[0].length,o=e.length,l=o,h=t_(o),u=1/0,c=[];l--;){var d=e[l];l&&i&&(d=ep(d,ez(i))),u=e4(d.length,u),h[l]=!n&&(i||a>=120&&d.length>=120)?new iS(l&&d):r}d=e[0];var p=-1,f=h[0];t:for(;++p<a&&c.length<u;){var m=d[p],g=i?i(m):m;if(m=n||0!==m?m:0,!(f?eB(f,g):s(c,g,n))){for(l=o;--l;){var y=h[l];if(!(y?eB(y,g):s(e[l],g,n)))continue t}f&&f.push(g),c.push(m)}}return c}function i5(e,i,n){i=rk(i,e);var s=null==(e=nI(e,i))?e:e[nD(n$(i))];return null==s?r:ea(s,e,n)}function i6(e){return sJ(e)&&i0(e)==u}function i9(e,i,n,s,a){return e===i||(null!=e&&null!=i&&(sJ(e)||sJ(i))?function(e,i,n,s,a,o){var l=sL(e),h=sL(i),m=l?c:nv(e),g=h?c:nv(i);m=m==u?_:m,g=g==u?_:g;var x=m==_,S=g==_,P=m==g;if(P&&sU(e)){if(!sU(i))return!1;l=!0,x=!1}if(P&&!x)return o||(o=new iT),l||s1(e)?ns(e,i,n,s,a,o):function(e,i,r,n,s,a,o){switch(r){case C:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)break;e=e.buffer,i=i.buffer;case T:return!(e.byteLength!=i.byteLength||!a(new tV(e),new tV(i)));case d:case p:case v:return sR(+e,+i);case f:return e.name==i.name&&e.message==i.message;case b:case M:return e==i+"";case y:var l=eU;case w:var h=1&n;if(l||(l=eW),e.size!=i.size&&!h)break;var u=o.get(e);if(u)return u==i;n|=2,o.set(e,i);var c=ns(l(e),l(i),n,s,a,o);return o.delete(e),c;case A:if(im)return im.call(e)==im.call(i)}return!1}(e,i,m,n,s,a,o);if(!(1&n)){var E=x&&tB.call(e,"__wrapped__"),I=S&&tB.call(i,"__wrapped__");if(E||I){var z=E?e.value():e,R=I?i.value():i;return o||(o=new iT),a(z,R,n,s,o)}}return!!P&&(o||(o=new iT),function(e,i,n,s,a,o){var l=1&n,h=no(e),u=h.length;if(u!=no(i).length&&!l)return!1;for(var c=u;c--;){var d=h[c];if(!(l?d in i:tB.call(i,d)))return!1}var p=o.get(e),f=o.get(i);if(p&&f)return p==i&&f==e;var m=!0;o.set(e,i),o.set(i,e);for(var g=l;++c<u;){var y=e[d=h[c]],v=i[d];if(s)var _=l?s(v,y,d,i,e,o):s(y,v,d,e,i,o);if(!(_===r?y===v||a(y,v,n,s,o):_)){m=!1;break}g||(g="constructor"==d)}if(m&&!g){var x=e.constructor,b=i.constructor;x!=b&&"constructor"in e&&"constructor"in i&&!("function"==typeof x&&x instanceof x&&"function"==typeof b&&b instanceof b)&&(m=!1)}return o.delete(e),o.delete(i),m}(e,i,n,s,a,o))}(e,i,n,s,i9,a):e!=e&&i!=i)}function i7(e,i,n,s){var a=n.length,o=a,l=!s;if(null==e)return!o;for(e=tA(e);a--;){var h=n[a];if(l&&h[2]?h[1]!==e[h[0]]:!(h[0]in e))return!1}for(;++a<o;){var u=(h=n[a])[0],c=e[u],d=h[1];if(l&&h[2]){if(c===r&&!(u in e))return!1}else{var p=new iT;if(s)var f=s(c,d,u,e,i,p);if(!(f===r?i9(d,c,3,s,p):f))return!1}}return!0}function i8(e){return!(!sG(e)||tO&&tO in e)&&(sW(e)?tD:tu).test(nU(e))}function rt(e){return"function"==typeof e?e:null==e?aD:"object"==typeof e?sL(e)?rs(e[0],e[1]):rn(e):aX(e)}function re(e){if(!nC(e))return e2(e);var i=[];for(var r in tA(e))tB.call(e,r)&&"constructor"!=r&&i.push(r);return i}function ri(e,i){return e<i}function rr(e,i){var r=-1,n=sF(e)?t_(e.length):[];return ij(e,function(e,s,a){n[++r]=i(e,s,a)}),n}function rn(e){var i=nf(e);return 1==i.length&&i[0][2]?nP(i[0][0],i[0][1]):function(r){return r===e||i7(r,e,i)}}function rs(e,i){var n;return nA(e)&&(n=i)==n&&!sG(n)?nP(nD(e),i):function(n){var s=al(n,e);return s===r&&s===i?ah(n,e):i9(i,s,3)}}function ra(e,i,n,s,a){e!==i&&iJ(i,function(o,l){if(a||(a=new iT),sG(o))!function(e,i,n,s,a,o,l){var h=nz(e,n),u=nz(i,n),c=l.get(u);if(c){iE(e,n,c);return}var d=o?o(h,u,n+"",e,i,l):r,p=d===r;if(p){var f=sL(u),m=!f&&sU(u),g=!f&&!m&&s1(u);d=u,f||m||g?sL(h)?d=h:sD(h)?d=rW(h):m?(p=!1,d=rN(u,!0)):g?(p=!1,d=rD(u,!0)):d=[]:sZ(u)||sO(u)?(d=h,sO(h)?d=s8(h):(!sG(h)||sW(h))&&(d=nx(u))):p=!1}p&&(l.set(u,d),a(d,u,s,o,l),l.delete(u)),iE(e,n,d)}(e,i,l,n,ra,s,a);else{var h=s?s(nz(e,l),o,l+"",e,i,a):r;h===r&&(h=o),iE(e,l,h)}},af)}function ro(e,i){var n=e.length;if(n)return nw(i+=i<0?n:0,n)?e[i]:r}function rl(e,i,r){i=i.length?ep(i,function(e){return sL(e)?function(i){return i$(i,1===e.length?e[0]:e)}:e}):[aD];var n=-1;return i=ep(i,ez(nd())),function(e,i){var r=e.length;for(e.sort(i);r--;)e[r]=e[r].value;return e}(rr(e,function(e,r,s){return{criteria:ep(i,function(i){return i(e)}),index:++n,value:e}}),function(e,i){return function(e,i,r){for(var n=-1,s=e.criteria,a=i.criteria,o=s.length,l=r.length;++n<o;){var h=rU(s[n],a[n]);if(h){if(n>=l)return h;return h*("desc"==r[n]?-1:1)}}return e.index-i.index}(e,i,r)})}function rh(e,i,r){for(var n=-1,s=i.length,a={};++n<s;){var o=i[n],l=i$(e,o);r(l,o)&&rm(a,rk(o,e),l)}return a}function ru(e,i,r,n){var s=n?ew:eb,a=-1,o=i.length,l=e;for(e===i&&(i=rW(i)),r&&(l=ep(e,ez(r)));++a<o;)for(var h=0,u=i[a],c=r?r(u):u;(h=s(l,c,h,n))>-1;)l!==e&&t3.call(l,h,1),t3.call(e,h,1);return e}function rc(e,i){for(var r=e?i.length:0,n=r-1;r--;){var s=i[r];if(r==n||s!==a){var a=s;nw(s)?t3.call(e,s,1):rT(e,s)}}return e}function rd(e,i){return e+eK(e9()*(i-e+1))}function rp(e,i){var r="";if(!e||i<1||i>9007199254740991)return r;do i%2&&(r+=e),(i=eK(i/2))&&(e+=e);while(i);return r}function rf(e,i){return nk(nE(e,i,aD),e+"")}function rm(e,i,n,s){if(!sG(e))return e;i=rk(i,e);for(var a=-1,o=i.length,l=o-1,h=e;null!=h&&++a<o;){var u=nD(i[a]),c=n;if("__proto__"===u||"constructor"===u||"prototype"===u)break;if(a!=l){var d=h[u];(c=s?s(d,u,h):r)===r&&(c=sG(d)?d:nw(i[a+1])?[]:{})}iI(h,u,c),h=h[u]}return e}var rg=ia?function(e,i){return ia.set(e,i),e}:aD,ry=t8?function(e,i){return t8(e,"toString",{configurable:!0,enumerable:!1,value:aL(i),writable:!0})}:aD;function rv(e,i,r){var n=-1,s=e.length;i<0&&(i=-i>s?0:s+i),(r=r>s?s:r)<0&&(r+=s),s=i>r?0:r-i>>>0,i>>>=0;for(var a=t_(s);++n<s;)a[n]=e[n+i];return a}function r_(e,i){var r;return ij(e,function(e,n,s){return!(r=i(e,n,s))}),!!r}function rx(e,i,r){var n=0,s=null==e?n:e.length;if("number"==typeof i&&i==i&&s<=2147483647){for(;n<s;){var a=n+s>>>1,o=e[a];null!==o&&!s0(o)&&(r?o<=i:o<i)?n=a+1:s=a}return s}return rb(e,i,aD,r)}function rb(e,i,n,s){var a=0,o=null==e?0:e.length;if(0===o)return 0;i=n(i);for(var l=i!=i,h=null===i,u=s0(i),c=i===r;a<o;){var d=eK((a+o)/2),p=n(e[d]),f=p!==r,m=null===p,g=p==p,y=s0(p);if(l)var v=s||g;else v=c?g&&(s||f):h?g&&f&&(s||!m):u?g&&f&&!m&&(s||!y):!m&&!y&&(s?p<=i:p<i);v?a=d+1:o=d}return e4(o,4294967294)}function rw(e,i){for(var r=-1,n=e.length,s=0,a=[];++r<n;){var o=e[r],l=i?i(o):o;if(!r||!sR(l,h)){var h=l;a[s++]=0===o?0:o}}return a}function rM(e){return"number"==typeof e?e:s0(e)?l:+e}function rA(e){if("string"==typeof e)return e;if(sL(e))return ep(e,rA)+"";if(s0(e))return ig?ig.call(e):"";var i=e+"";return"0"==i&&1/e==-o?"-0":i}function rS(e,i,r){var n=-1,s=ec,a=e.length,o=!0,l=[],h=l;if(r)o=!1,s=ed;else if(a>=200){var u=i?null:r8(e);if(u)return eW(u);o=!1,s=eB,h=new iS}else h=i?[]:l;t:for(;++n<a;){var c=e[n],d=i?i(c):c;if(c=r||0!==c?c:0,o&&d==d){for(var p=h.length;p--;)if(h[p]===d)continue t;i&&h.push(d),l.push(c)}else s(h,d,r)||(h!==l&&h.push(d),l.push(c))}return l}function rT(e,i){return i=rk(i,e),null==(e=nI(e,i))||delete e[nD(n$(i))]}function rC(e,i,r,n){return rm(e,i,r(i$(e,i)),n)}function rP(e,i,r,n){for(var s=e.length,a=n?s:-1;(n?a--:++a<s)&&i(e[a],a,e););return r?rv(e,n?0:a,n?a+1:s):rv(e,n?a+1:0,n?s:a)}function rE(e,i){var r=e;return r instanceof ib&&(r=r.value()),em(i,function(e,i){return i.func.apply(i.thisArg,ef([e],i.args))},r)}function rI(e,i,r){var n=e.length;if(n<2)return n?rS(e[0]):[];for(var s=-1,a=t_(n);++s<n;)for(var o=e[s],l=-1;++l<n;)l!=s&&(a[s]=iU(a[s]||o,e[l],i,r));return rS(iG(a,1),i,r)}function rz(e,i,n){for(var s=-1,a=e.length,o=i.length,l={};++s<a;){var h=s<o?i[s]:r;n(l,e[s],h)}return l}function rR(e){return sD(e)?e:[]}function rB(e){return"function"==typeof e?e:aD}function rk(e,i){return sL(e)?e:nA(e,i)?[e]:nF(at(e))}function rO(e,i,n){var s=e.length;return n=n===r?s:n,!i&&n>=s?e:rv(e,i,n)}var rL=ev||function(e){return t4.clearTimeout(e)};function rN(e,i){if(i)return e.slice();var r=e.length,n=tq?tq(r):new e.constructor(r);return e.copy(n),n}function rF(e){var i=new e.constructor(e.byteLength);return new tV(i).set(new tV(e)),i}function rD(e,i){var r=i?rF(e.buffer):e.buffer;return new e.constructor(r,e.byteOffset,e.length)}function rU(e,i){if(e!==i){var n=e!==r,s=null===e,a=e==e,o=s0(e),l=i!==r,h=null===i,u=i==i,c=s0(i);if(!h&&!c&&!o&&e>i||o&&l&&u&&!h&&!c||s&&l&&u||!n&&u||!a)return 1;if(!s&&!o&&!c&&e<i||c&&n&&a&&!s&&!o||h&&n&&a||!l&&a||!u)return -1}return 0}function rj(e,i,r,n){for(var s=-1,a=e.length,o=r.length,l=-1,h=i.length,u=e3(a-o,0),c=t_(h+u),d=!n;++l<h;)c[l]=i[l];for(;++s<o;)(d||s<a)&&(c[r[s]]=e[s]);for(;u--;)c[l++]=e[s++];return c}function rV(e,i,r,n){for(var s=-1,a=e.length,o=-1,l=r.length,h=-1,u=i.length,c=e3(a-l,0),d=t_(c+u),p=!n;++s<c;)d[s]=e[s];for(var f=s;++h<u;)d[f+h]=i[h];for(;++o<l;)(p||s<a)&&(d[f+r[o]]=e[s++]);return d}function rW(e,i){var r=-1,n=e.length;for(i||(i=t_(n));++r<n;)i[r]=e[r];return i}function rH(e,i,n,s){var a=!n;n||(n={});for(var o=-1,l=i.length;++o<l;){var h=i[o],u=s?s(n[h],e[h],h,n,e):r;u===r&&(u=e[h]),a?ik(n,h,u):iI(n,h,u)}return n}function rq(e,i){return function(r,n){var s=sL(r)?eo:iR,a=i?i():{};return s(r,e,nd(n,2),a)}}function rG(e){return rf(function(i,n){var s=-1,a=n.length,o=a>1?n[a-1]:r,l=a>2?n[2]:r;for(o=e.length>3&&"function"==typeof o?(a--,o):r,l&&nM(n[0],n[1],l)&&(o=a<3?r:o,a=1),i=tA(i);++s<a;){var h=n[s];h&&e(i,h,s,o)}return i})}function rJ(e,i){return function(r,n){if(null==r)return r;if(!sF(r))return e(r,n);for(var s=r.length,a=i?s:-1,o=tA(r);(i?a--:++a<s)&&!1!==n(o[a],a,o););return r}}function rX(e){return function(i,r,n){for(var s=-1,a=tA(i),o=n(i),l=o.length;l--;){var h=o[e?l:++s];if(!1===r(a[h],h,a))break}return i}}function rY(e){return function(i){var n=eD(i=at(i))?eq(i):r,s=n?n[0]:i.charAt(0),a=n?rO(n,1).join(""):i.slice(1);return s[e]()+a}}function rZ(e){return function(i){return em(aB(aS(i).replace(tW,"")),e,"")}}function rK(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var r=iv(e.prototype),n=e.apply(r,i);return sG(n)?n:r}}function r$(e){return function(i,n,s){var a=tA(i);if(!sF(i)){var o=nd(n,3);i=ap(i),n=function(e){return o(a[e],e,a)}}var l=e(i,n,s);return l>-1?a[o?i[l]:l]:r}}function rQ(e){return na(function(i){var s=i.length,a=s,o=ix.prototype.thru;for(e&&i.reverse();a--;){var l=i[a];if("function"!=typeof l)throw new tC(n);if(o&&!h&&"wrapper"==nu(l))var h=new ix([],!0)}for(a=h?a:s;++a<s;){var u=nu(l=i[a]),c="wrapper"==u?nh(l):r;h=c&&nS(c[0])&&424==c[1]&&!c[4].length&&1==c[9]?h[nu(c[0])].apply(h,c[3]):1==l.length&&nS(l)?h[u]():h.thru(l)}return function(){var e=arguments,r=e[0];if(h&&1==e.length&&sL(r))return h.plant(r).value();for(var n=0,a=s?i[n].apply(this,e):r;++n<s;)a=i[n].call(this,a);return a}})}function r0(e,i,n,s,a,o,l,h,u,c){var d=128&i,p=1&i,f=2&i,m=24&i,g=512&i,y=f?r:rK(e);return function v(){for(var _=arguments.length,x=t_(_),b=_;b--;)x[b]=arguments[b];if(m)var w=nc(v),M=function(e,i){for(var r=e.length,n=0;r--;)e[r]===i&&++n;return n}(x,w);if(s&&(x=rj(x,s,a,m)),o&&(x=rV(x,o,l,m)),_-=M,m&&_<c){var A=eV(x,w);return r9(e,i,r0,v.placeholder,n,x,A,h,u,c-_)}var S=p?n:this,T=f?S[e]:e;return _=x.length,h?x=function(e,i){for(var n=e.length,s=e4(i.length,n),a=rW(e);s--;){var o=i[s];e[s]=nw(o,n)?a[o]:r}return e}(x,h):g&&_>1&&x.reverse(),d&&u<_&&(x.length=u),this&&this!==t4&&this instanceof v&&(T=y||rK(T)),T.apply(S,x)}}function r1(e,i){return function(r,n){var s,a;return s=i(n),a={},iY(r,function(i,r,n){e(a,s(i),r,n)}),a}}function r2(e,i){return function(n,s){var a;if(n===r&&s===r)return i;if(n!==r&&(a=n),s!==r){if(a===r)return s;"string"==typeof n||"string"==typeof s?(n=rA(n),s=rA(s)):(n=rM(n),s=rM(s)),a=e(n,s)}return a}}function r3(e){return na(function(i){return i=ep(i,ez(nd())),rf(function(r){var n=this;return e(i,function(e){return ea(e,n,r)})})})}function r4(e,i){var n=(i=i===r?" ":rA(i)).length;if(n<2)return n?rp(i,e):i;var s=rp(i,eZ(e/eH(i)));return eD(i)?rO(eq(s),0,e).join(""):s.slice(0,e)}function r5(e){return function(i,n,s){return s&&"number"!=typeof s&&nM(i,n,s)&&(n=s=r),i=s5(i),n===r?(n=i,i=0):n=s5(n),s=s===r?i<n?1:-1:s5(s),function(e,i,r,n){for(var s=-1,a=e3(eZ((i-e)/(r||1)),0),o=t_(a);a--;)o[n?a:++s]=e,e+=r;return o}(i,n,s,e)}}function r6(e){return function(i,r){return"string"==typeof i&&"string"==typeof r||(i=s7(i),r=s7(r)),e(i,r)}}function r9(e,i,n,s,a,o,l,h,u,c){var d=8&i,p=d?l:r,f=d?r:l,m=d?o:r,g=d?r:o;i|=d?32:64,4&(i&=~(d?64:32))||(i&=-4);var y=[e,i,a,m,p,g,f,h,u,c],v=n.apply(r,y);return nS(e)&&nR(v,y),v.placeholder=s,nO(v,e,i)}function r7(e){var i=tM[e];return function(e,r){if(e=s7(e),(r=null==r?0:e4(s6(r),292))&&e0(e)){var n=(at(e)+"e").split("e");return+((n=(at(i(n[0]+"e"+(+n[1]+r)))+"e").split("e"))[0]+"e"+(+n[1]-r))}return i(e)}}var r8=ii&&1/eW(new ii([,-0]))[1]==o?function(e){return new ii(e)}:aH;function nt(e){return function(i){var r,n,s=nv(i);return s==y?eU(i):s==w?(r=-1,n=Array(i.size),i.forEach(function(e){n[++r]=[e,e]}),n):ep(e(i),function(e){return[e,i[e]]})}}function ne(e,i,s,o,l,h,u,c){var d=2&i;if(!d&&"function"!=typeof e)throw new tC(n);var p=o?o.length:0;if(p||(i&=-97,o=l=r),u=u===r?u:e3(s6(u),0),c=c===r?c:s6(c),p-=l?l.length:0,64&i){var f=o,m=l;o=l=r}var g=d?r:nh(e),y=[e,i,s,o,l,f,m,h,u,c];if(g&&function(e,i){var r=e[1],n=i[1],s=r|n,o=s<131,l=128==n&&8==r||128==n&&256==r&&e[7].length<=i[8]||384==n&&i[7].length<=i[8]&&8==r;if(o||l){1&n&&(e[2]=i[2],s|=1&r?0:4);var h=i[3];if(h){var u=e[3];e[3]=u?rj(u,h,i[4]):h,e[4]=u?eV(e[3],a):i[4]}(h=i[5])&&(u=e[5],e[5]=u?rV(u,h,i[6]):h,e[6]=u?eV(e[5],a):i[6]),(h=i[7])&&(e[7]=h),128&n&&(e[8]=null==e[8]?i[8]:e4(e[8],i[8])),null==e[9]&&(e[9]=i[9]),e[0]=i[0],e[1]=s}}(y,g),e=y[0],i=y[1],s=y[2],o=y[3],l=y[4],(c=y[9]=y[9]===r?d?0:e.length:e3(y[9]-p,0))||!(24&i)||(i&=-25),i&&1!=i)8==i||16==i?(v=e,_=i,x=c,b=rK(v),B=function e(){for(var i=arguments.length,n=t_(i),s=i,a=nc(e);s--;)n[s]=arguments[s];var o=i<3&&n[0]!==a&&n[i-1]!==a?[]:eV(n,a);return(i-=o.length)<x?r9(v,_,r0,e.placeholder,r,n,o,r,r,x-i):ea(this&&this!==t4&&this instanceof e?b:v,this,n)}):32!=i&&33!=i||l.length?B=r0.apply(r,y):(w=e,M=i,A=s,S=o,T=1&M,C=rK(w),B=function e(){for(var i=-1,r=arguments.length,n=-1,s=S.length,a=t_(s+r),o=this&&this!==t4&&this instanceof e?C:w;++n<s;)a[n]=S[n];for(;r--;)a[n++]=arguments[++i];return ea(o,T?A:this,a)});else var v,_,x,b,w,M,A,S,T,C,P,E,I,z,R,B=(P=e,E=i,I=s,z=1&E,R=rK(P),function e(){return(this&&this!==t4&&this instanceof e?R:P).apply(z?I:this,arguments)});return nO((g?rg:nR)(B,y),e,i)}function ni(e,i,n,s){return e===r||sR(e,tI[n])&&!tB.call(s,n)?i:e}function nr(e,i,n,s,a,o){return sG(e)&&sG(i)&&(o.set(i,e),ra(e,i,r,nr,o),o.delete(i)),e}function nn(e){return sZ(e)?r:e}function ns(e,i,n,s,a,o){var l=1&n,h=e.length,u=i.length;if(h!=u&&!(l&&u>h))return!1;var c=o.get(e),d=o.get(i);if(c&&d)return c==i&&d==e;var p=-1,f=!0,m=2&n?new iS:r;for(o.set(e,i),o.set(i,e);++p<h;){var g=e[p],y=i[p];if(s)var v=l?s(y,g,p,i,e,o):s(g,y,p,e,i,o);if(v!==r){if(v)continue;f=!1;break}if(m){if(!ey(i,function(e,i){if(!eB(m,i)&&(g===e||a(g,e,n,s,o)))return m.push(i)})){f=!1;break}}else if(!(g===y||a(g,y,n,s,o))){f=!1;break}}return o.delete(e),o.delete(i),f}function na(e){return nk(nE(e,r,nJ),e+"")}function no(e){return iQ(e,ap,ng)}function nl(e){return iQ(e,af,ny)}var nh=ia?function(e){return ia.get(e)}:aH;function nu(e){for(var i=e.name+"",r=io[i],n=tB.call(io,i)?r.length:0;n--;){var s=r[n],a=s.func;if(null==a||a==e)return s.name}return i}function nc(e){return(tB.call(iy,"placeholder")?iy:e).placeholder}function nd(){var e=iy.iteratee||aU;return e=e===aU?rt:e,arguments.length?e(arguments[0],arguments[1]):e}function np(e,i){var r,n=e.__data__;return("string"==(r=typeof i)||"number"==r||"symbol"==r||"boolean"==r?"__proto__"!==i:null===i)?n["string"==typeof i?"string":"hash"]:n.map}function nf(e){for(var i=ap(e),r=i.length;r--;){var n=i[r],s=e[n];i[r]=[n,s,s==s&&!sG(s)]}return i}function nm(e,i){var n=null==e?r:e[i];return i8(n)?n:r}var ng=e$?function(e){return null==e?[]:eu(e$(e=tA(e)),function(i){return t2.call(e,i)})}:aK,ny=e$?function(e){for(var i=[];e;)ef(i,ng(e)),e=tJ(e);return i}:aK,nv=i0;function n_(e,i,r){i=rk(i,e);for(var n=-1,s=i.length,a=!1;++n<s;){var o=nD(i[n]);if(!(a=null!=e&&r(e,o)))break;e=e[o]}return a||++n!=s?a:!!(s=null==e?0:e.length)&&sq(s)&&nw(o,s)&&(sL(e)||sO(e))}function nx(e){return"function"!=typeof e.constructor||nC(e)?{}:iv(tJ(e))}function nb(e){return sL(e)||sO(e)||!!(t5&&e&&e[t5])}function nw(e,i){var r=typeof e;return!!(i=i??9007199254740991)&&("number"==r||"symbol"!=r&&td.test(e))&&e>-1&&e%1==0&&e<i}function nM(e,i,r){if(!sG(r))return!1;var n=typeof i;return("number"==n?!!(sF(r)&&nw(i,r.length)):"string"==n&&i in r)&&sR(r[i],e)}function nA(e,i){if(sL(e))return!1;var r=typeof e;return!!("number"==r||"symbol"==r||"boolean"==r||null==e||s0(e))||X.test(e)||!J.test(e)||null!=i&&e in tA(i)}function nS(e){var i=nu(e),r=iy[i];if("function"!=typeof r||!(i in ib.prototype))return!1;if(e===r)return!0;var n=nh(r);return!!n&&e===n[0]}(e8&&nv(new e8(new ArrayBuffer(1)))!=C||it&&nv(new it)!=y||ie&&nv(ie.resolve())!=x||ii&&nv(new ii)!=w||ir&&nv(new ir)!=S)&&(nv=function(e){var i=i0(e),n=i==_?e.constructor:r,s=n?nU(n):"";if(s)switch(s){case il:return C;case ih:return y;case iu:return x;case ic:return w;case id:return S}return i});var nT=tz?sW:a$;function nC(e){var i=e&&e.constructor;return e===("function"==typeof i&&i.prototype||tI)}function nP(e,i){return function(n){return null!=n&&n[e]===i&&(i!==r||e in tA(n))}}function nE(e,i,n){return i=e3(i===r?e.length-1:i,0),function(){for(var r=arguments,s=-1,a=e3(r.length-i,0),o=t_(a);++s<a;)o[s]=r[i+s];s=-1;for(var l=t_(i+1);++s<i;)l[s]=r[s];return l[i]=n(o),ea(e,this,l)}}function nI(e,i){return i.length<2?e:i$(e,rv(i,0,-1))}function nz(e,i){if(!("constructor"===i&&"function"==typeof e[i])&&"__proto__"!=i)return e[i]}var nR=nL(rg),nB=eY||function(e,i){return t4.setTimeout(e,i)},nk=nL(ry);function nO(e,i,r){var n,s,a=i+"";return nk(e,function(e,i){var r=i.length;if(!r)return e;var n=r-1;return i[n]=(r>1?"& ":"")+i[n],i=i.join(r>2?", ":" "),e.replace(tt,`{
/* [wrapped with `+i+`] */
`)}(a,(n=(s=a.match(te))?s[1].split(ti):[],el(h,function(e){var i="_."+e[0];r&e[1]&&!ec(n,i)&&n.push(i)}),n.sort())))}function nL(e){var i=0,n=0;return function(){var s=e5(),a=16-(s-n);if(n=s,a>0){if(++i>=800)return arguments[0]}else i=0;return e.apply(r,arguments)}}function nN(e,i){var n=-1,s=e.length,a=s-1;for(i=i===r?s:i;++n<i;){var o=rd(n,a),l=e[o];e[o]=e[n],e[n]=l}return e.length=i,e}var nF=(ty=(tg=sT(function(e){var i=[];return 46===e.charCodeAt(0)&&i.push(""),e.replace(Y,function(e,r,n,s){i.push(n?s.replace(ts,"$1"):r||e)}),i},function(e){return 500===ty.size&&ty.clear(),e})).cache,tg);function nD(e){if("string"==typeof e||s0(e))return e;var i=e+"";return"0"==i&&1/e==-o?"-0":i}function nU(e){if(null!=e){try{return tR.call(e)}catch{}try{return e+""}catch{}}return""}function nj(e){if(e instanceof ib)return e.clone();var i=new ix(e.__wrapped__,e.__chain__);return i.__actions__=rW(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}var nV=rf(function(e,i){return sD(e)?iU(e,iG(i,1,sD,!0)):[]}),nW=rf(function(e,i){var n=n$(i);return sD(n)&&(n=r),sD(e)?iU(e,iG(i,1,sD,!0),nd(n,2)):[]}),nH=rf(function(e,i){var n=n$(i);return sD(n)&&(n=r),sD(e)?iU(e,iG(i,1,sD,!0),r,n):[]});function nq(e,i,r){var n=null==e?0:e.length;if(!n)return -1;var s=null==r?0:s6(r);return s<0&&(s=e3(n+s,0)),ex(e,nd(i,3),s)}function nG(e,i,n){var s=null==e?0:e.length;if(!s)return -1;var a=s-1;return n!==r&&(a=s6(n),a=n<0?e3(s+a,0):e4(a,s-1)),ex(e,nd(i,3),a,!0)}function nJ(e){return(null==e?0:e.length)?iG(e,1):[]}function nX(e){return e&&e.length?e[0]:r}var nY=rf(function(e){var i=ep(e,rR);return i.length&&i[0]===e[0]?i4(i):[]}),nZ=rf(function(e){var i=n$(e),n=ep(e,rR);return i===n$(n)?i=r:n.pop(),n.length&&n[0]===e[0]?i4(n,nd(i,2)):[]}),nK=rf(function(e){var i=n$(e),n=ep(e,rR);return(i="function"==typeof i?i:r)&&n.pop(),n.length&&n[0]===e[0]?i4(n,r,i):[]});function n$(e){var i=null==e?0:e.length;return i?e[i-1]:r}var nQ=rf(n0);function n0(e,i){return e&&e.length&&i&&i.length?ru(e,i):e}var n1=na(function(e,i){var r=null==e?0:e.length,n=iO(e,i);return rc(e,ep(i,function(e){return nw(e,r)?+e:e}).sort(rU)),n});function n2(e){return null==e?e:e7.call(e)}var n3=rf(function(e){return rS(iG(e,1,sD,!0))}),n4=rf(function(e){var i=n$(e);return sD(i)&&(i=r),rS(iG(e,1,sD,!0),nd(i,2))}),n5=rf(function(e){var i=n$(e);return i="function"==typeof i?i:r,rS(iG(e,1,sD,!0),r,i)});function n6(e){if(!(e&&e.length))return[];var i=0;return e=eu(e,function(e){if(sD(e))return i=e3(e.length,i),!0}),eE(i,function(i){return ep(e,eS(i))})}function n9(e,i){if(!(e&&e.length))return[];var n=n6(e);return null==i?n:ep(n,function(e){return ea(i,r,e)})}var n7=rf(function(e,i){return sD(e)?iU(e,i):[]}),n8=rf(function(e){return rI(eu(e,sD))}),st=rf(function(e){var i=n$(e);return sD(i)&&(i=r),rI(eu(e,sD),nd(i,2))}),se=rf(function(e){var i=n$(e);return i="function"==typeof i?i:r,rI(eu(e,sD),r,i)}),si=rf(n6),sr=rf(function(e){var i=e.length,n=i>1?e[i-1]:r;return n="function"==typeof n?(e.pop(),n):r,n9(e,n)});function sn(e){var i=iy(e);return i.__chain__=!0,i}function ss(e,i){return i(e)}var sa=na(function(e){var i=e.length,n=i?e[0]:0,s=this.__wrapped__,a=function(i){return iO(i,e)};return!(i>1)&&!this.__actions__.length&&s instanceof ib&&nw(n)?((s=s.slice(n,+n+(i?1:0))).__actions__.push({func:ss,args:[a],thisArg:r}),new ix(s,this.__chain__).thru(function(e){return i&&!e.length&&e.push(r),e})):this.thru(a)}),so=rq(function(e,i,r){tB.call(e,r)?++e[r]:ik(e,r,1)}),sl=r$(nq),sh=r$(nG);function su(e,i){return(sL(e)?el:ij)(e,nd(i,3))}function sc(e,i){return(sL(e)?function(e,i){for(var r=null==e?0:e.length;r--&&!1!==i(e[r],r,e););return e}:iV)(e,nd(i,3))}var sd=rq(function(e,i,r){tB.call(e,r)?e[r].push(i):ik(e,r,[i])}),sp=rf(function(e,i,r){var n=-1,s="function"==typeof i,a=sF(e)?t_(e.length):[];return ij(e,function(e){a[++n]=s?ea(i,e,r):i5(e,i,r)}),a}),sf=rq(function(e,i,r){ik(e,r,i)});function sm(e,i){return(sL(e)?ep:rr)(e,nd(i,3))}var sg=rq(function(e,i,r){e[r?0:1].push(i)},function(){return[[],[]]}),sy=rf(function(e,i){if(null==e)return[];var r=i.length;return r>1&&nM(e,i[0],i[1])?i=[]:r>2&&nM(i[0],i[1],i[2])&&(i=[i[0]]),rl(e,iG(i,1),[])}),sv=eT||function(){return t4.Date.now()};function s_(e,i,n){return i=n?r:i,i=e&&null==i?e.length:i,ne(e,128,r,r,r,r,i)}function sx(e,i){var s;if("function"!=typeof i)throw new tC(n);return e=s6(e),function(){return--e>0&&(s=i.apply(this,arguments)),e<=1&&(i=r),s}}var sb=rf(function(e,i,r){var n=1;if(r.length){var s=eV(r,nc(sb));n|=32}return ne(e,n,i,r,s)}),sw=rf(function(e,i,r){var n=3;if(r.length){var s=eV(r,nc(sw));n|=32}return ne(i,n,e,r,s)});function sM(e,i,s){var a,o,l,h,u,c,d=0,p=!1,f=!1,m=!0;if("function"!=typeof e)throw new tC(n);function g(i){var n=a,s=o;return a=o=r,d=i,h=e.apply(s,n)}function y(e){var n=e-c,s=e-d;return c===r||n>=i||n<0||f&&s>=l}function v(){var e,r,n,s=sv();if(y(s))return _(s);u=nB(v,(e=s-c,r=s-d,n=i-e,f?e4(n,l-r):n))}function _(e){return u=r,m&&a?g(e):(a=o=r,h)}function x(){var e,n=sv(),s=y(n);if(a=arguments,o=this,c=n,s){if(u===r)return d=e=c,u=nB(v,i),p?g(e):h;if(f)return rL(u),u=nB(v,i),g(c)}return u===r&&(u=nB(v,i)),h}return i=s7(i)||0,sG(s)&&(p=!!s.leading,l=(f="maxWait"in s)?e3(s7(s.maxWait)||0,i):l,m="trailing"in s?!!s.trailing:m),x.cancel=function(){u!==r&&rL(u),d=0,a=c=o=u=r},x.flush=function(){return u===r?h:_(sv())},x}var sA=rf(function(e,i){return iD(e,1,i)}),sS=rf(function(e,i,r){return iD(e,s7(i)||0,r)});function sT(e,i){if("function"!=typeof e||null!=i&&"function"!=typeof i)throw new tC(n);var r=function(){var n=arguments,s=i?i.apply(this,n):n[0],a=r.cache;if(a.has(s))return a.get(s);var o=e.apply(this,n);return r.cache=a.set(s,o)||a,o};return r.cache=new(sT.Cache||iA),r}function sC(e){if("function"!=typeof e)throw new tC(n);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}sT.Cache=iA;var sP=rf(function(e,i){var r=(i=1==i.length&&sL(i[0])?ep(i[0],ez(nd())):ep(iG(i,1),ez(nd()))).length;return rf(function(n){for(var s=-1,a=e4(n.length,r);++s<a;)n[s]=i[s].call(this,n[s]);return ea(e,this,n)})}),sE=rf(function(e,i){var n=eV(i,nc(sE));return ne(e,32,r,i,n)}),sI=rf(function(e,i){var n=eV(i,nc(sI));return ne(e,64,r,i,n)}),sz=na(function(e,i){return ne(e,256,r,r,r,i)});function sR(e,i){return e===i||e!=e&&i!=i}var sB=r6(i1),sk=r6(function(e,i){return e>=i}),sO=i6(function(){return arguments}())?i6:function(e){return sJ(e)&&tB.call(e,"callee")&&!t2.call(e,"callee")},sL=t_.isArray,sN=et?ez(et):function(e){return sJ(e)&&i0(e)==T};function sF(e){return null!=e&&sq(e.length)&&!sW(e)}function sD(e){return sJ(e)&&sF(e)}var sU=eQ||a$,sj=ee?ez(ee):function(e){return sJ(e)&&i0(e)==p};function sV(e){if(!sJ(e))return!1;var i=i0(e);return i==f||"[object DOMException]"==i||"string"==typeof e.message&&"string"==typeof e.name&&!sZ(e)}function sW(e){if(!sG(e))return!1;var i=i0(e);return i==m||i==g||"[object AsyncFunction]"==i||"[object Proxy]"==i}function sH(e){return"number"==typeof e&&e==s6(e)}function sq(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991}function sG(e){var i=typeof e;return null!=e&&("object"==i||"function"==i)}function sJ(e){return null!=e&&"object"==typeof e}var sX=ei?ez(ei):function(e){return sJ(e)&&nv(e)==y};function sY(e){return"number"==typeof e||sJ(e)&&i0(e)==v}function sZ(e){if(!sJ(e)||i0(e)!=_)return!1;var i=tJ(e);if(null===i)return!0;var r=tB.call(i,"constructor")&&i.constructor;return"function"==typeof r&&r instanceof r&&tR.call(r)==tN}var sK=er?ez(er):function(e){return sJ(e)&&i0(e)==b},s$=en?ez(en):function(e){return sJ(e)&&nv(e)==w};function sQ(e){return"string"==typeof e||!sL(e)&&sJ(e)&&i0(e)==M}function s0(e){return"symbol"==typeof e||sJ(e)&&i0(e)==A}var s1=es?ez(es):function(e){return sJ(e)&&sq(e.length)&&!!tK[i0(e)]},s2=r6(ri),s3=r6(function(e,i){return e<=i});function s4(e){if(!e)return[];if(sF(e))return sQ(e)?eq(e):rW(e);if(t6&&e[t6])return function(e){for(var i,r=[];!(i=e.next()).done;)r.push(i.value);return r}(e[t6]());var i=nv(e);return(i==y?eU:i==w?eW:aw)(e)}function s5(e){return e?(e=s7(e))===o||e===-o?(e<0?-1:1)*17976931348623157e292:e==e?e:0:0===e?e:0}function s6(e){var i=s5(e),r=i%1;return i==i?r?i-r:i:0}function s9(e){return e?iL(s6(e),0,4294967295):0}function s7(e){if("number"==typeof e)return e;if(s0(e))return l;if(sG(e)){var i="function"==typeof e.valueOf?e.valueOf():e;e=sG(i)?i+"":i}if("string"!=typeof e)return 0===e?e:+e;e=eI(e);var r=th.test(e);return r||tc.test(e)?t1(e.slice(2),r?2:8):tl.test(e)?l:+e}function s8(e){return rH(e,af(e))}function at(e){return null==e?"":rA(e)}var ae=rG(function(e,i){if(nC(i)||sF(i)){rH(i,ap(i),e);return}for(var r in i)tB.call(i,r)&&iI(e,r,i[r])}),ai=rG(function(e,i){rH(i,af(i),e)}),ar=rG(function(e,i,r,n){rH(i,af(i),e,n)}),an=rG(function(e,i,r,n){rH(i,ap(i),e,n)}),as=na(iO),aa=rf(function(e,i){e=tA(e);var n=-1,s=i.length,a=s>2?i[2]:r;for(a&&nM(i[0],i[1],a)&&(s=1);++n<s;)for(var o=i[n],l=af(o),h=-1,u=l.length;++h<u;){var c=l[h],d=e[c];(d===r||sR(d,tI[c])&&!tB.call(e,c))&&(e[c]=o[c])}return e}),ao=rf(function(e){return e.push(r,nr),ea(ag,r,e)});function al(e,i,n){var s=null==e?r:i$(e,i);return s===r?n:s}function ah(e,i){return null!=e&&n_(e,i,i3)}var au=r1(function(e,i,r){null!=i&&"function"!=typeof i.toString&&(i=tL.call(i)),e[i]=r},aL(aD)),ac=r1(function(e,i,r){null!=i&&"function"!=typeof i.toString&&(i=tL.call(i)),tB.call(e,i)?e[i].push(r):e[i]=[r]},nd),ad=rf(i5);function ap(e){return sF(e)?iC(e):re(e)}function af(e){return sF(e)?iC(e,!0):function(e){if(!sG(e))return function(e){var i=[];if(null!=e)for(var r in tA(e))i.push(r);return i}(e);var i=nC(e),r=[];for(var n in e)"constructor"==n&&(i||!tB.call(e,n))||r.push(n);return r}(e)}var am=rG(function(e,i,r){ra(e,i,r)}),ag=rG(function(e,i,r,n){ra(e,i,r,n)}),ay=na(function(e,i){var r={};if(null==e)return r;var n=!1;i=ep(i,function(i){return i=rk(i,e),n||(n=i.length>1),i}),rH(e,nl(e),r),n&&(r=iN(r,7,nn));for(var s=i.length;s--;)rT(r,i[s]);return r}),av=na(function(e,i){return null==e?{}:rh(e,i,function(i,r){return ah(e,r)})});function a_(e,i){if(null==e)return{};var r=ep(nl(e),function(e){return[e]});return i=nd(i),rh(e,r,function(e,r){return i(e,r[0])})}var ax=nt(ap),ab=nt(af);function aw(e){return null==e?[]:eR(e,ap(e))}var aM=rZ(function(e,i,r){return i=i.toLowerCase(),e+(r?aA(i):i)});function aA(e){return aR(at(e).toLowerCase())}function aS(e){return(e=at(e))&&e.replace(tp,eL).replace(tH,"")}var aT=rZ(function(e,i,r){return e+(r?"-":"")+i.toLowerCase()}),aC=rZ(function(e,i,r){return e+(r?" ":"")+i.toLowerCase()}),aP=rY("toLowerCase"),aE=rZ(function(e,i,r){return e+(r?"_":"")+i.toLowerCase()}),aI=rZ(function(e,i,r){return e+(r?" ":"")+aR(i)}),az=rZ(function(e,i,r){return e+(r?" ":"")+i.toUpperCase()}),aR=rY("toUpperCase");function aB(e,i,n){var s;return e=at(e),(i=n?r:i)===r?(s=e,tX.test(s))?e.match(tG)||[]:e.match(tr)||[]:e.match(i)||[]}var ak=rf(function(e,i){try{return ea(e,r,i)}catch(e){return sV(e)?e:new tb(e)}}),aO=na(function(e,i){return el(i,function(i){ik(e,i=nD(i),sb(e[i],e))}),e});function aL(e){return function(){return e}}var aN=rQ(),aF=rQ(!0);function aD(e){return e}function aU(e){return rt("function"==typeof e?e:iN(e,1))}var aj=rf(function(e,i){return function(r){return i5(r,e,i)}}),aV=rf(function(e,i){return function(r){return i5(e,r,i)}});function aW(e,i,r){var n=ap(i),s=iK(i,n);null!=r||sG(i)&&(s.length||!n.length)||(r=i,i=e,e=this,s=iK(i,ap(i)));var a=!(sG(r)&&"chain"in r)||!!r.chain,o=sW(e);return el(s,function(r){var n=i[r];e[r]=n,o&&(e.prototype[r]=function(){var i=this.__chain__;if(a||i){var r=e(this.__wrapped__);return(r.__actions__=rW(this.__actions__)).push({func:n,args:arguments,thisArg:e}),r.__chain__=i,r}return n.apply(e,ef([this.value()],arguments))})}),e}function aH(){}var aq=r3(ep),aG=r3(eh),aJ=r3(ey);function aX(e){return nA(e)?eS(nD(e)):function(i){return i$(i,e)}}var aY=r5(),aZ=r5(!0);function aK(){return[]}function a$(){return!1}var aQ=r2(function(e,i){return e+i},0),a0=r7("ceil"),a1=r2(function(e,i){return e/i},1),a2=r7("floor"),a3=r2(function(e,i){return e*i},1),a4=r7("round"),a5=r2(function(e,i){return e-i},0);return iy.after=function(e,i){if("function"!=typeof i)throw new tC(n);return e=s6(e),function(){if(--e<1)return i.apply(this,arguments)}},iy.ary=s_,iy.assign=ae,iy.assignIn=ai,iy.assignInWith=ar,iy.assignWith=an,iy.at=as,iy.before=sx,iy.bind=sb,iy.bindAll=aO,iy.bindKey=sw,iy.castArray=function(){if(!arguments.length)return[];var e=arguments[0];return sL(e)?e:[e]},iy.chain=sn,iy.chunk=function(e,i,n){i=(n?nM(e,i,n):i===r)?1:e3(s6(i),0);var s=null==e?0:e.length;if(!s||i<1)return[];for(var a=0,o=0,l=t_(eZ(s/i));a<s;)l[o++]=rv(e,a,a+=i);return l},iy.compact=function(e){for(var i=-1,r=null==e?0:e.length,n=0,s=[];++i<r;){var a=e[i];a&&(s[n++]=a)}return s},iy.concat=function(){var e=arguments.length;if(!e)return[];for(var i=t_(e-1),r=arguments[0],n=e;n--;)i[n-1]=arguments[n];return ef(sL(r)?rW(r):[r],iG(i,1))},iy.cond=function(e){var i=null==e?0:e.length,r=nd();return e=i?ep(e,function(e){if("function"!=typeof e[1])throw new tC(n);return[r(e[0]),e[1]]}):[],rf(function(r){for(var n=-1;++n<i;){var s=e[n];if(ea(s[0],this,r))return ea(s[1],this,r)}})},iy.conforms=function(e){var i,r;return r=ap(i=iN(e,1)),function(e){return iF(e,i,r)}},iy.constant=aL,iy.countBy=so,iy.create=function(e,i){var r=iv(e);return null==i?r:iB(r,i)},iy.curry=function e(i,n,s){n=s?r:n;var a=ne(i,8,r,r,r,r,r,n);return a.placeholder=e.placeholder,a},iy.curryRight=function e(i,n,s){n=s?r:n;var a=ne(i,16,r,r,r,r,r,n);return a.placeholder=e.placeholder,a},iy.debounce=sM,iy.defaults=aa,iy.defaultsDeep=ao,iy.defer=sA,iy.delay=sS,iy.difference=nV,iy.differenceBy=nW,iy.differenceWith=nH,iy.drop=function(e,i,n){var s=null==e?0:e.length;return s?rv(e,(i=n||i===r?1:s6(i))<0?0:i,s):[]},iy.dropRight=function(e,i,n){var s=null==e?0:e.length;return s?rv(e,0,(i=s-(i=n||i===r?1:s6(i)))<0?0:i):[]},iy.dropRightWhile=function(e,i){return e&&e.length?rP(e,nd(i,3),!0,!0):[]},iy.dropWhile=function(e,i){return e&&e.length?rP(e,nd(i,3),!0):[]},iy.fill=function(e,i,n,s){var a=null==e?0:e.length;return a?(n&&"number"!=typeof n&&nM(e,i,n)&&(n=0,s=a),function(e,i,n,s){var a=e.length;for((n=s6(n))<0&&(n=-n>a?0:a+n),(s=s===r||s>a?a:s6(s))<0&&(s+=a),s=n>s?0:s9(s);n<s;)e[n++]=i;return e}(e,i,n,s)):[]},iy.filter=function(e,i){return(sL(e)?eu:iq)(e,nd(i,3))},iy.flatMap=function(e,i){return iG(sm(e,i),1)},iy.flatMapDeep=function(e,i){return iG(sm(e,i),o)},iy.flatMapDepth=function(e,i,n){return n=n===r?1:s6(n),iG(sm(e,i),n)},iy.flatten=nJ,iy.flattenDeep=function(e){return(null==e?0:e.length)?iG(e,o):[]},iy.flattenDepth=function(e,i){return(null==e?0:e.length)?iG(e,i=i===r?1:s6(i)):[]},iy.flip=function(e){return ne(e,512)},iy.flow=aN,iy.flowRight=aF,iy.fromPairs=function(e){for(var i=-1,r=null==e?0:e.length,n={};++i<r;){var s=e[i];n[s[0]]=s[1]}return n},iy.functions=function(e){return null==e?[]:iK(e,ap(e))},iy.functionsIn=function(e){return null==e?[]:iK(e,af(e))},iy.groupBy=sd,iy.initial=function(e){return(null==e?0:e.length)?rv(e,0,-1):[]},iy.intersection=nY,iy.intersectionBy=nZ,iy.intersectionWith=nK,iy.invert=au,iy.invertBy=ac,iy.invokeMap=sp,iy.iteratee=aU,iy.keyBy=sf,iy.keys=ap,iy.keysIn=af,iy.map=sm,iy.mapKeys=function(e,i){var r={};return i=nd(i,3),iY(e,function(e,n,s){ik(r,i(e,n,s),e)}),r},iy.mapValues=function(e,i){var r={};return i=nd(i,3),iY(e,function(e,n,s){ik(r,n,i(e,n,s))}),r},iy.matches=function(e){return rn(iN(e,1))},iy.matchesProperty=function(e,i){return rs(e,iN(i,1))},iy.memoize=sT,iy.merge=am,iy.mergeWith=ag,iy.method=aj,iy.methodOf=aV,iy.mixin=aW,iy.negate=sC,iy.nthArg=function(e){return e=s6(e),rf(function(i){return ro(i,e)})},iy.omit=ay,iy.omitBy=function(e,i){return a_(e,sC(nd(i)))},iy.once=function(e){return sx(2,e)},iy.orderBy=function(e,i,n,s){return null==e?[]:(sL(i)||(i=null==i?[]:[i]),sL(n=s?r:n)||(n=null==n?[]:[n]),rl(e,i,n))},iy.over=aq,iy.overArgs=sP,iy.overEvery=aG,iy.overSome=aJ,iy.partial=sE,iy.partialRight=sI,iy.partition=sg,iy.pick=av,iy.pickBy=a_,iy.property=aX,iy.propertyOf=function(e){return function(i){return null==e?r:i$(e,i)}},iy.pull=nQ,iy.pullAll=n0,iy.pullAllBy=function(e,i,r){return e&&e.length&&i&&i.length?ru(e,i,nd(r,2)):e},iy.pullAllWith=function(e,i,n){return e&&e.length&&i&&i.length?ru(e,i,r,n):e},iy.pullAt=n1,iy.range=aY,iy.rangeRight=aZ,iy.rearg=sz,iy.reject=function(e,i){return(sL(e)?eu:iq)(e,sC(nd(i,3)))},iy.remove=function(e,i){var r=[];if(!(e&&e.length))return r;var n=-1,s=[],a=e.length;for(i=nd(i,3);++n<a;){var o=e[n];i(o,n,e)&&(r.push(o),s.push(n))}return rc(e,s),r},iy.rest=function(e,i){if("function"!=typeof e)throw new tC(n);return rf(e,i=i===r?i:s6(i))},iy.reverse=n2,iy.sampleSize=function(e,i,n){return i=(n?nM(e,i,n):i===r)?1:s6(i),(sL(e)?function(e,i){return nN(rW(e),iL(i,0,e.length))}:function(e,i){var r=aw(e);return nN(r,iL(i,0,r.length))})(e,i)},iy.set=function(e,i,r){return null==e?e:rm(e,i,r)},iy.setWith=function(e,i,n,s){return s="function"==typeof s?s:r,null==e?e:rm(e,i,n,s)},iy.shuffle=function(e){return(sL(e)?function(e){return nN(rW(e))}:function(e){return nN(aw(e))})(e)},iy.slice=function(e,i,n){var s=null==e?0:e.length;return s?(n&&"number"!=typeof n&&nM(e,i,n)?(i=0,n=s):(i=null==i?0:s6(i),n=n===r?s:s6(n)),rv(e,i,n)):[]},iy.sortBy=sy,iy.sortedUniq=function(e){return e&&e.length?rw(e):[]},iy.sortedUniqBy=function(e,i){return e&&e.length?rw(e,nd(i,2)):[]},iy.split=function(e,i,n){return n&&"number"!=typeof n&&nM(e,i,n)&&(i=n=r),(n=n===r?4294967295:n>>>0)?(e=at(e))&&("string"==typeof i||null!=i&&!sK(i))&&!(i=rA(i))&&eD(e)?rO(eq(e),0,n):e.split(i,n):[]},iy.spread=function(e,i){if("function"!=typeof e)throw new tC(n);return i=null==i?0:e3(s6(i),0),rf(function(r){var n=r[i],s=rO(r,0,i);return n&&ef(s,n),ea(e,this,s)})},iy.tail=function(e){var i=null==e?0:e.length;return i?rv(e,1,i):[]},iy.take=function(e,i,n){return e&&e.length?rv(e,0,(i=n||i===r?1:s6(i))<0?0:i):[]},iy.takeRight=function(e,i,n){var s=null==e?0:e.length;return s?rv(e,(i=s-(i=n||i===r?1:s6(i)))<0?0:i,s):[]},iy.takeRightWhile=function(e,i){return e&&e.length?rP(e,nd(i,3),!1,!0):[]},iy.takeWhile=function(e,i){return e&&e.length?rP(e,nd(i,3)):[]},iy.tap=function(e,i){return i(e),e},iy.throttle=function(e,i,r){var s=!0,a=!0;if("function"!=typeof e)throw new tC(n);return sG(r)&&(s="leading"in r?!!r.leading:s,a="trailing"in r?!!r.trailing:a),sM(e,i,{leading:s,maxWait:i,trailing:a})},iy.thru=ss,iy.toArray=s4,iy.toPairs=ax,iy.toPairsIn=ab,iy.toPath=function(e){return sL(e)?ep(e,nD):s0(e)?[e]:rW(nF(at(e)))},iy.toPlainObject=s8,iy.transform=function(e,i,r){var n=sL(e),s=n||sU(e)||s1(e);if(i=nd(i,4),null==r){var a=e&&e.constructor;r=s?n?new a:[]:sG(e)&&sW(a)?iv(tJ(e)):{}}return(s?el:iY)(e,function(e,n,s){return i(r,e,n,s)}),r},iy.unary=function(e){return s_(e,1)},iy.union=n3,iy.unionBy=n4,iy.unionWith=n5,iy.uniq=function(e){return e&&e.length?rS(e):[]},iy.uniqBy=function(e,i){return e&&e.length?rS(e,nd(i,2)):[]},iy.uniqWith=function(e,i){return i="function"==typeof i?i:r,e&&e.length?rS(e,r,i):[]},iy.unset=function(e,i){return null==e||rT(e,i)},iy.unzip=n6,iy.unzipWith=n9,iy.update=function(e,i,r){return null==e?e:rC(e,i,rB(r))},iy.updateWith=function(e,i,n,s){return s="function"==typeof s?s:r,null==e?e:rC(e,i,rB(n),s)},iy.values=aw,iy.valuesIn=function(e){return null==e?[]:eR(e,af(e))},iy.without=n7,iy.words=aB,iy.wrap=function(e,i){return sE(rB(i),e)},iy.xor=n8,iy.xorBy=st,iy.xorWith=se,iy.zip=si,iy.zipObject=function(e,i){return rz(e||[],i||[],iI)},iy.zipObjectDeep=function(e,i){return rz(e||[],i||[],rm)},iy.zipWith=sr,iy.entries=ax,iy.entriesIn=ab,iy.extend=ai,iy.extendWith=ar,aW(iy,iy),iy.add=aQ,iy.attempt=ak,iy.camelCase=aM,iy.capitalize=aA,iy.ceil=a0,iy.clamp=function(e,i,n){return n===r&&(n=i,i=r),n!==r&&(n=(n=s7(n))==n?n:0),i!==r&&(i=(i=s7(i))==i?i:0),iL(s7(e),i,n)},iy.clone=function(e){return iN(e,4)},iy.cloneDeep=function(e){return iN(e,5)},iy.cloneDeepWith=function(e,i){return iN(e,5,i="function"==typeof i?i:r)},iy.cloneWith=function(e,i){return iN(e,4,i="function"==typeof i?i:r)},iy.conformsTo=function(e,i){return null==i||iF(e,i,ap(i))},iy.deburr=aS,iy.defaultTo=function(e,i){return null==e||e!=e?i:e},iy.divide=a1,iy.endsWith=function(e,i,n){e=at(e),i=rA(i);var s=e.length,a=n=n===r?s:iL(s6(n),0,s);return(n-=i.length)>=0&&e.slice(n,a)==i},iy.eq=sR,iy.escape=function(e){return(e=at(e))&&W.test(e)?e.replace(j,eN):e},iy.escapeRegExp=function(e){return(e=at(e))&&K.test(e)?e.replace(Z,"\\$&"):e},iy.every=function(e,i,n){var s=sL(e)?eh:iW;return n&&nM(e,i,n)&&(i=r),s(e,nd(i,3))},iy.find=sl,iy.findIndex=nq,iy.findKey=function(e,i){return e_(e,nd(i,3),iY)},iy.findLast=sh,iy.findLastIndex=nG,iy.findLastKey=function(e,i){return e_(e,nd(i,3),iZ)},iy.floor=a2,iy.forEach=su,iy.forEachRight=sc,iy.forIn=function(e,i){return null==e?e:iJ(e,nd(i,3),af)},iy.forInRight=function(e,i){return null==e?e:iX(e,nd(i,3),af)},iy.forOwn=function(e,i){return e&&iY(e,nd(i,3))},iy.forOwnRight=function(e,i){return e&&iZ(e,nd(i,3))},iy.get=al,iy.gt=sB,iy.gte=sk,iy.has=function(e,i){return null!=e&&n_(e,i,i2)},iy.hasIn=ah,iy.head=nX,iy.identity=aD,iy.includes=function(e,i,r,n){e=sF(e)?e:aw(e),r=r&&!n?s6(r):0;var s=e.length;return r<0&&(r=e3(s+r,0)),sQ(e)?r<=s&&e.indexOf(i,r)>-1:!!s&&eb(e,i,r)>-1},iy.indexOf=function(e,i,r){var n=null==e?0:e.length;if(!n)return -1;var s=null==r?0:s6(r);return s<0&&(s=e3(n+s,0)),eb(e,i,s)},iy.inRange=function(e,i,n){var s,a,o;return i=s5(i),n===r?(n=i,i=0):n=s5(n),(s=e=s7(e))>=e4(a=i,o=n)&&s<e3(a,o)},iy.invoke=ad,iy.isArguments=sO,iy.isArray=sL,iy.isArrayBuffer=sN,iy.isArrayLike=sF,iy.isArrayLikeObject=sD,iy.isBoolean=function(e){return!0===e||!1===e||sJ(e)&&i0(e)==d},iy.isBuffer=sU,iy.isDate=sj,iy.isElement=function(e){return sJ(e)&&1===e.nodeType&&!sZ(e)},iy.isEmpty=function(e){if(null==e)return!0;if(sF(e)&&(sL(e)||"string"==typeof e||"function"==typeof e.splice||sU(e)||s1(e)||sO(e)))return!e.length;var i=nv(e);if(i==y||i==w)return!e.size;if(nC(e))return!re(e).length;for(var r in e)if(tB.call(e,r))return!1;return!0},iy.isEqual=function(e,i){return i9(e,i)},iy.isEqualWith=function(e,i,n){var s=(n="function"==typeof n?n:r)?n(e,i):r;return s===r?i9(e,i,r,n):!!s},iy.isError=sV,iy.isFinite=function(e){return"number"==typeof e&&e0(e)},iy.isFunction=sW,iy.isInteger=sH,iy.isLength=sq,iy.isMap=sX,iy.isMatch=function(e,i){return e===i||i7(e,i,nf(i))},iy.isMatchWith=function(e,i,n){return n="function"==typeof n?n:r,i7(e,i,nf(i),n)},iy.isNaN=function(e){return sY(e)&&e!=+e},iy.isNative=function(e){if(nT(e))throw new tb("Unsupported core-js use. Try https://npms.io/search?q=ponyfill.");return i8(e)},iy.isNil=function(e){return null==e},iy.isNull=function(e){return null===e},iy.isNumber=sY,iy.isObject=sG,iy.isObjectLike=sJ,iy.isPlainObject=sZ,iy.isRegExp=sK,iy.isSafeInteger=function(e){return sH(e)&&e>=-9007199254740991&&e<=9007199254740991},iy.isSet=s$,iy.isString=sQ,iy.isSymbol=s0,iy.isTypedArray=s1,iy.isUndefined=function(e){return e===r},iy.isWeakMap=function(e){return sJ(e)&&nv(e)==S},iy.isWeakSet=function(e){return sJ(e)&&"[object WeakSet]"==i0(e)},iy.join=function(e,i){return null==e?"":e1.call(e,i)},iy.kebabCase=aT,iy.last=n$,iy.lastIndexOf=function(e,i,n){var s=null==e?0:e.length;if(!s)return -1;var a=s;return n!==r&&(a=(a=s6(n))<0?e3(s+a,0):e4(a,s-1)),i==i?function(e,i,r){for(var n=r+1;n--&&e[n]!==i;);return n}(e,i,a):ex(e,eM,a,!0)},iy.lowerCase=aC,iy.lowerFirst=aP,iy.lt=s2,iy.lte=s3,iy.max=function(e){return e&&e.length?iH(e,aD,i1):r},iy.maxBy=function(e,i){return e&&e.length?iH(e,nd(i,2),i1):r},iy.mean=function(e){return eA(e,aD)},iy.meanBy=function(e,i){return eA(e,nd(i,2))},iy.min=function(e){return e&&e.length?iH(e,aD,ri):r},iy.minBy=function(e,i){return e&&e.length?iH(e,nd(i,2),ri):r},iy.stubArray=aK,iy.stubFalse=a$,iy.stubObject=function(){return{}},iy.stubString=function(){return""},iy.stubTrue=function(){return!0},iy.multiply=a3,iy.nth=function(e,i){return e&&e.length?ro(e,s6(i)):r},iy.noConflict=function(){return t4._===this&&(t4._=tF),this},iy.noop=aH,iy.now=sv,iy.pad=function(e,i,r){e=at(e);var n=(i=s6(i))?eH(e):0;if(!i||n>=i)return e;var s=(i-n)/2;return r4(eK(s),r)+e+r4(eZ(s),r)},iy.padEnd=function(e,i,r){e=at(e);var n=(i=s6(i))?eH(e):0;return i&&n<i?e+r4(i-n,r):e},iy.padStart=function(e,i,r){e=at(e);var n=(i=s6(i))?eH(e):0;return i&&n<i?r4(i-n,r)+e:e},iy.parseInt=function(e,i,r){return r||null==i?i=0:i&&(i=+i),e6(at(e).replace($,""),i||0)},iy.random=function(e,i,n){if(n&&"boolean"!=typeof n&&nM(e,i,n)&&(i=n=r),n===r&&("boolean"==typeof i?(n=i,i=r):"boolean"==typeof e&&(n=e,e=r)),e===r&&i===r?(e=0,i=1):(e=s5(e),i===r?(i=e,e=0):i=s5(i)),e>i){var s=e;e=i,i=s}if(n||e%1||i%1){var a=e9();return e4(e+a*(i-e+t0("1e-"+((a+"").length-1))),i)}return rd(e,i)},iy.reduce=function(e,i,r){var n=sL(e)?em:eC,s=arguments.length<3;return n(e,nd(i,4),r,s,ij)},iy.reduceRight=function(e,i,r){var n=sL(e)?eg:eC,s=arguments.length<3;return n(e,nd(i,4),r,s,iV)},iy.repeat=function(e,i,n){return i=(n?nM(e,i,n):i===r)?1:s6(i),rp(at(e),i)},iy.replace=function(){var e=arguments,i=at(e[0]);return e.length<3?i:i.replace(e[1],e[2])},iy.result=function(e,i,n){i=rk(i,e);var s=-1,a=i.length;for(a||(a=1,e=r);++s<a;){var o=null==e?r:e[nD(i[s])];o===r&&(s=a,o=n),e=sW(o)?o.call(e):o}return e},iy.round=a4,iy.runInContext=e,iy.sample=function(e){return(sL(e)?iP:function(e){return iP(aw(e))})(e)},iy.size=function(e){if(null==e)return 0;if(sF(e))return sQ(e)?eH(e):e.length;var i=nv(e);return i==y||i==w?e.size:re(e).length},iy.snakeCase=aE,iy.some=function(e,i,n){var s=sL(e)?ey:r_;return n&&nM(e,i,n)&&(i=r),s(e,nd(i,3))},iy.sortedIndex=function(e,i){return rx(e,i)},iy.sortedIndexBy=function(e,i,r){return rb(e,i,nd(r,2))},iy.sortedIndexOf=function(e,i){var r=null==e?0:e.length;if(r){var n=rx(e,i);if(n<r&&sR(e[n],i))return n}return -1},iy.sortedLastIndex=function(e,i){return rx(e,i,!0)},iy.sortedLastIndexBy=function(e,i,r){return rb(e,i,nd(r,2),!0)},iy.sortedLastIndexOf=function(e,i){if(null==e?0:e.length){var r=rx(e,i,!0)-1;if(sR(e[r],i))return r}return -1},iy.startCase=aI,iy.startsWith=function(e,i,r){return e=at(e),r=null==r?0:iL(s6(r),0,e.length),i=rA(i),e.slice(r,r+i.length)==i},iy.subtract=a5,iy.sum=function(e){return e&&e.length?eP(e,aD):0},iy.sumBy=function(e,i){return e&&e.length?eP(e,nd(i,2)):0},iy.template=function(e,i,n){var s=iy.templateSettings;n&&nM(e,i,n)&&(i=r),e=at(e),i=ar({},i,s,ni);var a,o,l=ar({},i.imports,s.imports,ni),h=ap(l),u=eR(l,h),c=0,d=i.interpolate||tf,p="__p += '",f=tS((i.escape||tf).source+"|"+d.source+"|"+(d===G?ta:tf).source+"|"+(i.evaluate||tf).source+"|$","g"),m="//# sourceURL="+(tB.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++tZ+"]")+`
`;e.replace(f,function(i,r,n,s,l,h){return n||(n=s),p+=e.slice(c,h).replace(tm,eF),r&&(a=!0,p+=`' +
__e(`+r+`) +
'`),l&&(o=!0,p+=`';
`+l+`;
__p += '`),n&&(p+=`' +
((__t = (`+n+`)) == null ? '' : __t) +
'`),c=h+i.length,i}),p+=`';
`;var g=tB.call(i,"variable")&&i.variable;if(g){if(tn.test(g))throw new tb("Invalid `variable` option passed into `_.template`")}else p=`with (obj) {
`+p+`
}
`;p=(o?p.replace(N,""):p).replace(F,"$1").replace(D,"$1;"),p="function("+(g||"obj")+`) {
`+(g?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(a?", __e = _.escape":"")+(o?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+p+`return __p
}`;var y=ak(function(){return tw(h,m+"return "+p).apply(r,u)});if(y.source=p,sV(y))throw y;return y},iy.times=function(e,i){if((e=s6(e))<1||e>9007199254740991)return[];var r=4294967295,n=e4(e,4294967295);i=nd(i),e-=4294967295;for(var s=eE(n,i);++r<e;)i(r);return s},iy.toFinite=s5,iy.toInteger=s6,iy.toLength=s9,iy.toLower=function(e){return at(e).toLowerCase()},iy.toNumber=s7,iy.toSafeInteger=function(e){return e?iL(s6(e),-9007199254740991,9007199254740991):0===e?e:0},iy.toString=at,iy.toUpper=function(e){return at(e).toUpperCase()},iy.trim=function(e,i,n){if((e=at(e))&&(n||i===r))return eI(e);if(!e||!(i=rA(i)))return e;var s=eq(e),a=eq(i),o=ek(s,a),l=eO(s,a)+1;return rO(s,o,l).join("")},iy.trimEnd=function(e,i,n){if((e=at(e))&&(n||i===r))return e.slice(0,eG(e)+1);if(!e||!(i=rA(i)))return e;var s=eq(e),a=eO(s,eq(i))+1;return rO(s,0,a).join("")},iy.trimStart=function(e,i,n){if((e=at(e))&&(n||i===r))return e.replace($,"");if(!e||!(i=rA(i)))return e;var s=eq(e),a=ek(s,eq(i));return rO(s,a).join("")},iy.truncate=function(e,i){var n=30,s="...";if(sG(i)){var a="separator"in i?i.separator:a;n="length"in i?s6(i.length):n,s="omission"in i?rA(i.omission):s}var o=(e=at(e)).length;if(eD(e)){var l=eq(e);o=l.length}if(n>=o)return e;var h=n-eH(s);if(h<1)return s;var u=l?rO(l,0,h).join(""):e.slice(0,h);if(a===r)return u+s;if(l&&(h+=u.length-h),sK(a)){if(e.slice(h).search(a)){var c,d=u;for(a.global||(a=tS(a.source,at(to.exec(a))+"g")),a.lastIndex=0;c=a.exec(d);)var p=c.index;u=u.slice(0,p===r?h:p)}}else if(e.indexOf(rA(a),h)!=h){var f=u.lastIndexOf(a);f>-1&&(u=u.slice(0,f))}return u+s},iy.unescape=function(e){return(e=at(e))&&V.test(e)?e.replace(U,eJ):e},iy.uniqueId=function(e){var i=++tk;return at(e)+i},iy.upperCase=az,iy.upperFirst=aR,iy.each=su,iy.eachRight=sc,iy.first=nX,aW(iy,(tv={},iY(iy,function(e,i){tB.call(iy.prototype,i)||(tv[i]=e)}),tv),{chain:!1}),iy.VERSION="4.17.21",el(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){iy[e].placeholder=iy}),el(["drop","take"],function(e,i){ib.prototype[e]=function(n){n=n===r?1:e3(s6(n),0);var s=this.__filtered__&&!i?new ib(this):this.clone();return s.__filtered__?s.__takeCount__=e4(n,s.__takeCount__):s.__views__.push({size:e4(n,4294967295),type:e+(s.__dir__<0?"Right":"")}),s},ib.prototype[e+"Right"]=function(i){return this.reverse()[e](i).reverse()}}),el(["filter","map","takeWhile"],function(e,i){var r=i+1,n=1==r||3==r;ib.prototype[e]=function(e){var i=this.clone();return i.__iteratees__.push({iteratee:nd(e,3),type:r}),i.__filtered__=i.__filtered__||n,i}}),el(["head","last"],function(e,i){var r="take"+(i?"Right":"");ib.prototype[e]=function(){return this[r](1).value()[0]}}),el(["initial","tail"],function(e,i){var r="drop"+(i?"":"Right");ib.prototype[e]=function(){return this.__filtered__?new ib(this):this[r](1)}}),ib.prototype.compact=function(){return this.filter(aD)},ib.prototype.find=function(e){return this.filter(e).head()},ib.prototype.findLast=function(e){return this.reverse().find(e)},ib.prototype.invokeMap=rf(function(e,i){return"function"==typeof e?new ib(this):this.map(function(r){return i5(r,e,i)})}),ib.prototype.reject=function(e){return this.filter(sC(nd(e)))},ib.prototype.slice=function(e,i){e=s6(e);var n=this;return n.__filtered__&&(e>0||i<0)?new ib(n):(e<0?n=n.takeRight(-e):e&&(n=n.drop(e)),i!==r&&(n=(i=s6(i))<0?n.dropRight(-i):n.take(i-e)),n)},ib.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},ib.prototype.toArray=function(){return this.take(4294967295)},iY(ib.prototype,function(e,i){var n=/^(?:filter|find|map|reject)|While$/.test(i),s=/^(?:head|last)$/.test(i),a=iy[s?"take"+("last"==i?"Right":""):i],o=s||/^find/.test(i);a&&(iy.prototype[i]=function(){var i=this.__wrapped__,l=s?[1]:arguments,h=i instanceof ib,u=l[0],c=h||sL(i),d=function(e){var i=a.apply(iy,ef([e],l));return s&&p?i[0]:i};c&&n&&"function"==typeof u&&1!=u.length&&(h=c=!1);var p=this.__chain__,f=!!this.__actions__.length,m=o&&!p,g=h&&!f;if(!o&&c){i=g?i:new ib(this);var y=e.apply(i,l);return y.__actions__.push({func:ss,args:[d],thisArg:r}),new ix(y,p)}return m&&g?e.apply(this,l):(y=this.thru(d),m?s?y.value()[0]:y.value():y)})}),el(["pop","push","shift","sort","splice","unshift"],function(e){var i=tP[e],r=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",n=/^(?:pop|shift)$/.test(e);iy.prototype[e]=function(){var e=arguments;if(n&&!this.__chain__){var s=this.value();return i.apply(sL(s)?s:[],e)}return this[r](function(r){return i.apply(sL(r)?r:[],e)})}}),iY(ib.prototype,function(e,i){var r=iy[i];if(r){var n=r.name+"";tB.call(io,n)||(io[n]=[]),io[n].push({name:i,func:r})}}),io[r0(r,2).name]=[{name:"wrapper",func:r}],ib.prototype.clone=function(){var e=new ib(this.__wrapped__);return e.__actions__=rW(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=rW(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=rW(this.__views__),e},ib.prototype.reverse=function(){if(this.__filtered__){var e=new ib(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e},ib.prototype.value=function(){var e=this.__wrapped__.value(),i=this.__dir__,r=sL(e),n=i<0,s=r?e.length:0,a=function(e,i,r){for(var n=-1,s=r.length;++n<s;){var a=r[n],o=a.size;switch(a.type){case"drop":e+=o;break;case"dropRight":i-=o;break;case"take":i=e4(i,e+o);break;case"takeRight":e=e3(e,i-o)}}return{start:e,end:i}}(0,s,this.__views__),o=a.start,l=a.end,h=l-o,u=n?l:o-1,c=this.__iteratees__,d=c.length,p=0,f=e4(h,this.__takeCount__);if(!r||!n&&s==h&&f==h)return rE(e,this.__actions__);var m=[];t:for(;h--&&p<f;){u+=i;for(var g=-1,y=e[u];++g<d;){var v=c[g],_=v.iteratee,x=v.type,b=_(y);if(2==x)y=b;else if(!b){if(1==x)continue t;break t}}m[p++]=y}return m},iy.prototype.at=sa,iy.prototype.chain=function(){return sn(this)},iy.prototype.commit=function(){return new ix(this.value(),this.__chain__)},iy.prototype.next=function(){this.__values__===r&&(this.__values__=s4(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}},iy.prototype.plant=function(e){for(var i,n=this;n instanceof i_;){var s=nj(n);s.__index__=0,s.__values__=r,i?a.__wrapped__=s:i=s;var a=s;n=n.__wrapped__}return a.__wrapped__=e,i},iy.prototype.reverse=function(){var e=this.__wrapped__;if(e instanceof ib){var i=e;return this.__actions__.length&&(i=new ib(this)),(i=i.reverse()).__actions__.push({func:ss,args:[n2],thisArg:r}),new ix(i,this.__chain__)}return this.thru(n2)},iy.prototype.toJSON=iy.prototype.valueOf=iy.prototype.value=function(){return rE(this.__wrapped__,this.__actions__)},iy.prototype.first=iy.prototype.head,t6&&(iy.prototype[t6]=function(){return this}),iy}();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(t4._=eX,define(function(){return eX})):t6?((t6.exports=eX)._=eX,t5._=eX):t4._=eX}).call(e)}),J=W((e,i)=>{function r(e,i,r,n){return Math.round(e/r)+" "+n+(i>=1.5*r?"s":"")}i.exports=function(e,i){i=i||{};var n,s,a=typeof e;if("string"===a&&e.length>0)return function(e){if(!((e=String(e)).length>100)){var i=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(i){var r=parseFloat(i[1]);switch((i[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*r;case"weeks":case"week":case"w":return 6048e5*r;case"days":case"day":case"d":return 864e5*r;case"hours":case"hour":case"hrs":case"hr":case"h":return 36e5*r;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*r;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*r;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}(e);if("number"===a&&isFinite(e))return i.long?(n=Math.abs(e))>=864e5?r(e,n,864e5,"day"):n>=36e5?r(e,n,36e5,"hour"):n>=6e4?r(e,n,6e4,"minute"):n>=1e3?r(e,n,1e3,"second"):e+" ms":(s=Math.abs(e))>=864e5?Math.round(e/864e5)+"d":s>=36e5?Math.round(e/36e5)+"h":s>=6e4?Math.round(e/6e4)+"m":s>=1e3?Math.round(e/1e3)+"s":e+"ms";throw Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}}),X=W((e,i)=>{i.exports=function(e){function i(e){let n,s=null,a,o;function l(...e){if(!l.enabled)return;let r=Number(new Date),s=r-(n||r);l.diff=s,l.prev=n,l.curr=r,n=r,e[0]=i.coerce(e[0]),"string"!=typeof e[0]&&e.unshift("%O");let a=0;e[0]=e[0].replace(/%([a-zA-Z%])/g,(r,n)=>{if("%%"===r)return"%";a++;let s=i.formatters[n];if("function"==typeof s){let i=e[a];r=s.call(l,i),e.splice(a,1),a--}return r}),i.formatArgs.call(l,e),(l.log||i.log).apply(l,e)}return l.namespace=e,l.useColors=i.useColors(),l.color=i.selectColor(e),l.extend=r,l.destroy=i.destroy,Object.defineProperty(l,"enabled",{enumerable:!0,configurable:!1,get:()=>null!==s?s:(a!==i.namespaces&&(a=i.namespaces,o=i.enabled(e)),o),set:e=>{s=e}}),"function"==typeof i.init&&i.init(l),l}function r(e,r){let n=i(this.namespace+(typeof r>"u"?":":r)+e);return n.log=this.log,n}function n(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return i.debug=i,i.default=i,i.coerce=function(e){return e instanceof Error?e.stack||e.message:e},i.disable=function(){let e=[...i.names.map(n),...i.skips.map(n).map(e=>"-"+e)].join(",");return i.enable(""),e},i.enable=function(e){i.save(e),i.namespaces=e,i.names=[],i.skips=[];let r,n=("string"==typeof e?e:"").split(/[\s,]+/),s=n.length;for(r=0;r<s;r++)n[r]&&("-"===(e=n[r].replace(/\*/g,".*?"))[0]?i.skips.push(RegExp("^"+e.slice(1)+"$")):i.names.push(RegExp("^"+e+"$")))},i.enabled=function(e){let r,n;if("*"===e[e.length-1])return!0;for(r=0,n=i.skips.length;r<n;r++)if(i.skips[r].test(e))return!1;for(r=0,n=i.names.length;r<n;r++)if(i.names[r].test(e))return!0;return!1},i.humanize=J(),i.destroy=function(){console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`.")},Object.keys(e).forEach(r=>{i[r]=e[r]}),i.names=[],i.skips=[],i.formatters={},i.selectColor=function(e){let r=0;for(let i=0;i<e.length;i++)r=(r<<5)-r+e.charCodeAt(i)|0;return i.colors[Math.abs(r)%i.colors.length]},i.enable(i.load()),i}}),Y=W((e,i)=>{let r;e.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+i.exports.humanize(this.diff),!this.useColors)return;let r="color: "+this.color;e.splice(1,0,r,"color: inherit");let n=0,s=0;e[0].replace(/%[a-zA-Z%]/g,e=>{"%%"!==e&&(n++,"%c"===e&&(s=n))}),e.splice(s,0,r)},e.save=function(i){try{i?e.storage.setItem("debug",i):e.storage.removeItem("debug")}catch{}},e.load=function(){let i;try{i=e.storage.getItem("debug")}catch{}return!i&&"u">typeof L&&"env"in L&&(i=L.env.DEBUG),i},e.useColors=function(){let e;return"u">typeof window&&!!window.process&&("renderer"===window.process.type||!!window.process.__nwjs)||!("u">typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("u">typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"u">typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"u">typeof navigator&&navigator.userAgent&&(e=navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/))&&parseInt(e[1],10)>=31||"u">typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},e.storage=function(){try{return localStorage}catch{}}(),e.destroy=(r=!1,()=>{r||(r=!0,console.warn("Instance method `debug.destroy()` is deprecated and no longer does anything. It will be removed in the next major version of `debug`."))}),e.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],e.log=console.debug||console.log||(()=>{}),i.exports=X()(e);var{formatters:n}=i.exports;n.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}),Z=W((e,i)=>{i.exports=function(e){var i=typeof e;return null!=e&&("object"==i||"function"==i)}}),K=W((e,i)=>{var r="object"==typeof window&&window&&window.Object===Object&&window;i.exports=r}),$=W((e,i)=>{var r=K(),n="object"==typeof self&&self&&self.Object===Object&&self,s=r||n||Function("return this")();i.exports=s}),Q=W((e,i)=>{var r=$();i.exports=function(){return r.Date.now()}}),tt=W((e,i)=>{var r=/\s/;i.exports=function(e){for(var i=e.length;i--&&r.test(e.charAt(i)););return i}}),te=W((e,i)=>{var r=tt(),n=/^\s+/;i.exports=function(e){return e&&e.slice(0,r(e)+1).replace(n,"")}}),ti=W((e,i)=>{var r=$().Symbol;i.exports=r}),tr=W((e,i)=>{var r=ti(),n=Object.prototype,s=n.hasOwnProperty,a=n.toString,o=r?r.toStringTag:void 0;i.exports=function(e){var i=s.call(e,o),r=e[o];try{e[o]=void 0;var n=!0}catch{}var l=a.call(e);return n&&(i?e[o]=r:delete e[o]),l}}),tn=W((e,i)=>{var r=Object.prototype.toString;i.exports=function(e){return r.call(e)}}),ts=W((e,i)=>{var r=ti(),n=tr(),s=tn(),a=r?r.toStringTag:void 0;i.exports=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":a&&a in Object(e)?n(e):s(e)}}),ta=W((e,i)=>{i.exports=function(e){return null!=e&&"object"==typeof e}}),to=W((e,i)=>{var r=ts(),n=ta();i.exports=function(e){return"symbol"==typeof e||n(e)&&"[object Symbol]"==r(e)}}),tl=W((e,i)=>{var r=te(),n=Z(),s=to(),a=NaN,o=/^[-+]0x[0-9a-f]+$/i,l=/^0b[01]+$/i,h=/^0o[0-7]+$/i,u=parseInt;i.exports=function(e){if("number"==typeof e)return e;if(s(e))return a;if(n(e)){var i="function"==typeof e.valueOf?e.valueOf():e;e=n(i)?i+"":i}if("string"!=typeof e)return 0===e?e:+e;e=r(e);var c=l.test(e);return c||h.test(e)?u(e.slice(2),c?2:8):o.test(e)?a:+e}}),th=W((e,i)=>{var r=Z(),n=Q(),s=tl(),a=Math.max,o=Math.min;i.exports=function(e,i,l){var h,u,c,d,p,f,m=0,g=!1,y=!1,v=!0;if("function"!=typeof e)throw TypeError("Expected a function");function _(i){var r=h,n=u;return h=u=void 0,m=i,d=e.apply(n,r)}function x(e){var r=e-f,n=e-m;return void 0===f||r>=i||r<0||y&&n>=c}function b(){var e,r,s,a=n();if(x(a))return w(a);p=setTimeout(b,(e=a-f,r=a-m,s=i-e,y?o(s,c-r):s))}function w(e){return p=void 0,v&&h?_(e):(h=u=void 0,d)}function M(){var e,r=n(),s=x(r);if(h=arguments,u=this,f=r,s){if(void 0===p)return m=e=f,p=setTimeout(b,i),g?_(e):d;if(y)return clearTimeout(p),p=setTimeout(b,i),_(f)}return void 0===p&&(p=setTimeout(b,i)),d}return i=s(i)||0,r(l)&&(g=!!l.leading,c=(y="maxWait"in l)?a(s(l.maxWait)||0,i):c,v="trailing"in l?!!l.trailing:v),M.cancel=function(){void 0!==p&&clearTimeout(p),m=0,h=f=u=p=void 0},M.flush=function(){return void 0===p?d:w(n())},M}}),tu=W((e,i)=>{var r=th(),n=Z();i.exports=function(e,i,s){var a=!0,o=!0;if("function"!=typeof e)throw TypeError("Expected a function");return n(s)&&(a="leading"in s?!!s.leading:a,o="trailing"in s?!!s.trailing:o),r(e,i,{leading:a,maxWait:i,trailing:o})}}),tc=q(G()),td="attached",tp="srgb",tf="srgb-linear",tm="display-p3-linear",tg="linear",ty="srgb",tv="rec709",t_=class{addEventListener(e,i){void 0===this._listeners&&(this._listeners={});let r=this._listeners;void 0===r[e]&&(r[e]=[]),-1===r[e].indexOf(i)&&r[e].push(i)}hasEventListener(e,i){if(void 0===this._listeners)return!1;let r=this._listeners;return void 0!==r[e]&&-1!==r[e].indexOf(i)}removeEventListener(e,i){if(void 0===this._listeners)return;let r=this._listeners[e];if(void 0!==r){let e=r.indexOf(i);-1!==e&&r.splice(e,1)}}dispatchEvent(e){if(void 0===this._listeners)return;let i=this._listeners[e.type];if(void 0!==i){e.target=this;let r=i.slice(0);for(let i=0,n=r.length;i<n;i++)r[i].call(this,e);e.target=null}}},tx=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],tb=Math.PI/180,tw=180/Math.PI;function tM(){let e=4294967295*Math.random()|0,i=4294967295*Math.random()|0,r=4294967295*Math.random()|0,n=4294967295*Math.random()|0;return(tx[255&e]+tx[e>>8&255]+tx[e>>16&255]+tx[e>>24&255]+"-"+tx[255&i]+tx[i>>8&255]+"-"+tx[i>>16&15|64]+tx[i>>24&255]+"-"+tx[63&r|128]+tx[r>>8&255]+"-"+tx[r>>16&255]+tx[r>>24&255]+tx[255&n]+tx[n>>8&255]+tx[n>>16&255]+tx[n>>24&255]).toLowerCase()}function tA(e,i,r){return Math.max(i,Math.min(r,e))}function tS(e,i){switch(i.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw Error("Invalid component type.")}}function tT(e,i){switch(i.constructor){case Float32Array:return e;case Uint32Array:return Math.round(4294967295*e);case Uint16Array:return Math.round(65535*e);case Uint8Array:return Math.round(255*e);case Int32Array:return Math.round(2147483647*e);case Int16Array:return Math.round(32767*e);case Int8Array:return Math.round(127*e);default:throw Error("Invalid component type.")}}var tC={radToDeg:function(e){return e*tw}},tP=class e{constructor(i=0,r=0){e.prototype.isVector2=!0,this.x=i,this.y=r}get width(){return this.x}set width(e){this.x=e}get height(){return this.y}set height(e){this.y=e}set(e,i){return this.x=e,this.y=i,this}setScalar(e){return this.x=e,this.y=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;default:throw Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;default:throw Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y)}copy(e){return this.x=e.x,this.y=e.y,this}add(e){return this.x+=e.x,this.y+=e.y,this}addScalar(e){return this.x+=e,this.y+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this}subScalar(e){return this.x-=e,this.y-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this}multiply(e){return this.x*=e.x,this.y*=e.y,this}multiplyScalar(e){return this.x*=e,this.y*=e,this}divide(e){return this.x/=e.x,this.y/=e.y,this}divideScalar(e){return this.multiplyScalar(1/e)}applyMatrix3(e){let i=this.x,r=this.y,n=e.elements;return this.x=n[0]*i+n[3]*r+n[6],this.y=n[1]*i+n[4]*r+n[7],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this}clampLength(e,i){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(i,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(e){let i=Math.sqrt(this.lengthSq()*e.lengthSq());return 0===i?Math.PI/2:Math.acos(tA(this.dot(e)/i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let i=this.x-e.x,r=this.y-e.y;return i*i+r*r}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this}lerpVectors(e,i,r){return this.x=e.x+(i.x-e.x)*r,this.y=e.y+(i.y-e.y)*r,this}equals(e){return e.x===this.x&&e.y===this.y}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this}rotateAround(e,i){let r=Math.cos(i),n=Math.sin(i),s=this.x-e.x,a=this.y-e.y;return this.x=s*r-a*n+e.x,this.y=s*n+a*r+e.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}},tE=class e{constructor(i,r,n,s,a,o,l,h,u){e.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],void 0!==i&&this.set(i,r,n,s,a,o,l,h,u)}set(e,i,r,n,s,a,o,l,h){let u=this.elements;return u[0]=e,u[1]=n,u[2]=o,u[3]=i,u[4]=s,u[5]=l,u[6]=r,u[7]=a,u[8]=h,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(e){let i=this.elements,r=e.elements;return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],this}extractBasis(e,i,r){return e.setFromMatrix3Column(this,0),i.setFromMatrix3Column(this,1),r.setFromMatrix3Column(this,2),this}setFromMatrix4(e){let i=e.elements;return this.set(i[0],i[4],i[8],i[1],i[5],i[9],i[2],i[6],i[10]),this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){let r=e.elements,n=i.elements,s=this.elements,a=r[0],o=r[3],l=r[6],h=r[1],u=r[4],c=r[7],d=r[2],p=r[5],f=r[8],m=n[0],g=n[3],y=n[6],v=n[1],_=n[4],x=n[7],b=n[2],w=n[5],M=n[8];return s[0]=a*m+o*v+l*b,s[3]=a*g+o*_+l*w,s[6]=a*y+o*x+l*M,s[1]=h*m+u*v+c*b,s[4]=h*g+u*_+c*w,s[7]=h*y+u*x+c*M,s[2]=d*m+p*v+f*b,s[5]=d*g+p*_+f*w,s[8]=d*y+p*x+f*M,this}multiplyScalar(e){let i=this.elements;return i[0]*=e,i[3]*=e,i[6]*=e,i[1]*=e,i[4]*=e,i[7]*=e,i[2]*=e,i[5]*=e,i[8]*=e,this}determinant(){let e=this.elements,i=e[0],r=e[1],n=e[2],s=e[3],a=e[4],o=e[5],l=e[6],h=e[7],u=e[8];return i*a*u-i*o*h-r*s*u+r*o*l+n*s*h-n*a*l}invert(){let e=this.elements,i=e[0],r=e[1],n=e[2],s=e[3],a=e[4],o=e[5],l=e[6],h=e[7],u=e[8],c=u*a-o*h,d=o*l-u*s,p=h*s-a*l,f=i*c+r*d+n*p;if(0===f)return this.set(0,0,0,0,0,0,0,0,0);let m=1/f;return e[0]=c*m,e[1]=(n*h-u*r)*m,e[2]=(o*r-n*a)*m,e[3]=d*m,e[4]=(u*i-n*l)*m,e[5]=(n*s-o*i)*m,e[6]=p*m,e[7]=(r*l-h*i)*m,e[8]=(a*i-r*s)*m,this}transpose(){let e,i=this.elements;return e=i[1],i[1]=i[3],i[3]=e,e=i[2],i[2]=i[6],i[6]=e,e=i[5],i[5]=i[7],i[7]=e,this}getNormalMatrix(e){return this.setFromMatrix4(e).invert().transpose()}transposeIntoArray(e){let i=this.elements;return e[0]=i[0],e[1]=i[3],e[2]=i[6],e[3]=i[1],e[4]=i[4],e[5]=i[7],e[6]=i[2],e[7]=i[5],e[8]=i[8],this}setUvTransform(e,i,r,n,s,a,o){let l=Math.cos(s),h=Math.sin(s);return this.set(r*l,r*h,-r*(l*a+h*o)+a+e,-n*h,n*l,-n*(-h*a+l*o)+o+i,0,0,1),this}scale(e,i){return this.premultiply(tI.makeScale(e,i)),this}rotate(e){return this.premultiply(tI.makeRotation(-e)),this}translate(e,i){return this.premultiply(tI.makeTranslation(e,i)),this}makeTranslation(e,i){return e.isVector2?this.set(1,0,e.x,0,1,e.y,0,0,1):this.set(1,0,e,0,1,i,0,0,1),this}makeRotation(e){let i=Math.cos(e),r=Math.sin(e);return this.set(i,-r,0,r,i,0,0,0,1),this}makeScale(e,i){return this.set(e,0,0,0,i,0,0,0,1),this}equals(e){let i=this.elements,r=e.elements;for(let e=0;e<9;e++)if(i[e]!==r[e])return!1;return!0}fromArray(e,i=0){for(let r=0;r<9;r++)this.elements[r]=e[r+i];return this}toArray(e=[],i=0){let r=this.elements;return e[i]=r[0],e[i+1]=r[1],e[i+2]=r[2],e[i+3]=r[3],e[i+4]=r[4],e[i+5]=r[5],e[i+6]=r[6],e[i+7]=r[7],e[i+8]=r[8],e}clone(){return new this.constructor().fromArray(this.elements)}},tI=new tE;function tz(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}var tR={};function tB(e){e in tR||(tR[e]=!0,console.warn(e))}var tk=new tE().set(.8224621,.177538,0,.0331941,.9668058,0,.0170827,.0723974,.9105199),tO=new tE().set(1.2249401,-.2249404,0,-.0420569,1.0420571,0,-.0196376,-.0786361,1.0982735),tL={[tf]:{transfer:tg,primaries:tv,luminanceCoefficients:[.2126,.7152,.0722],toReference:e=>e,fromReference:e=>e},[tp]:{transfer:ty,primaries:tv,luminanceCoefficients:[.2126,.7152,.0722],toReference:e=>e.convertSRGBToLinear(),fromReference:e=>e.convertLinearToSRGB()},[tm]:{transfer:tg,primaries:"p3",luminanceCoefficients:[.2289,.6917,.0793],toReference:e=>e.applyMatrix3(tO),fromReference:e=>e.applyMatrix3(tk)},"display-p3":{transfer:ty,primaries:"p3",luminanceCoefficients:[.2289,.6917,.0793],toReference:e=>e.convertSRGBToLinear().applyMatrix3(tO),fromReference:e=>e.applyMatrix3(tk).convertLinearToSRGB()}},tN=new Set([tf,tm]),tF={enabled:!0,_workingColorSpace:tf,get workingColorSpace(){return this._workingColorSpace},set workingColorSpace(t){if(!tN.has(t))throw Error(`Unsupported working color space, "${t}".`);this._workingColorSpace=t},convert:function(e,i,r){if(!1===this.enabled||i===r||!i||!r)return e;let n=tL[i].toReference;return(0,tL[r].fromReference)(n(e))},fromWorkingColorSpace:function(e,i){return this.convert(e,this._workingColorSpace,i)},toWorkingColorSpace:function(e,i){return this.convert(e,i,this._workingColorSpace)},getPrimaries:function(e){return tL[e].primaries},getTransfer:function(e){return""===e?tg:tL[e].transfer},getLuminanceCoefficients:function(e,i=this._workingColorSpace){return e.fromArray(tL[i].luminanceCoefficients)}};function tD(e){return e<.04045?.0773993808*e:Math.pow(.9478672986*e+.0521327014,2.4)}function tU(e){return e<.0031308?12.92*e:1.055*Math.pow(e,.41666)-.055}var tj,tV=class{static getDataURL(e){let i;if(/^data:/i.test(e.src)||typeof HTMLCanvasElement>"u")return e.src;if(e instanceof HTMLCanvasElement)i=e;else{void 0===tj&&(tj=tz("canvas")),tj.width=e.width,tj.height=e.height;let r=tj.getContext("2d");e instanceof ImageData?r.putImageData(e,0,0):r.drawImage(e,0,0,e.width,e.height),i=tj}return i.width>2048||i.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",e),i.toDataURL("image/jpeg",.6)):i.toDataURL("image/png")}static sRGBToLinear(e){if("u">typeof HTMLImageElement&&e instanceof HTMLImageElement||"u">typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"u">typeof ImageBitmap&&e instanceof ImageBitmap){let i=tz("canvas");i.width=e.width,i.height=e.height;let r=i.getContext("2d");r.drawImage(e,0,0,e.width,e.height);let n=r.getImageData(0,0,e.width,e.height),s=n.data;for(let e=0;e<s.length;e++)s[e]=255*tD(s[e]/255);return r.putImageData(n,0,0),i}if(!e.data)return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),e;{let i=e.data.slice(0);for(let e=0;e<i.length;e++)i instanceof Uint8Array||i instanceof Uint8ClampedArray?i[e]=Math.floor(255*tD(i[e]/255)):i[e]=tD(i[e]);return{data:i,width:e.width,height:e.height}}}},tW=0,tH=class{constructor(e=null){this.isSource=!0,Object.defineProperty(this,"id",{value:tW++}),this.uuid=tM(),this.data=e,this.dataReady=!0,this.version=0}set needsUpdate(e){!0===e&&this.version++}toJSON(e){let i=void 0===e||"string"==typeof e;if(!i&&void 0!==e.images[this.uuid])return e.images[this.uuid];let r={uuid:this.uuid,url:""},n=this.data;if(null!==n){let e;if(Array.isArray(n)){e=[];for(let i=0,r=n.length;i<r;i++)n[i].isDataTexture?e.push(tq(n[i].image)):e.push(tq(n[i]))}else e=tq(n);r.url=e}return i||(e.images[this.uuid]=r),r}};function tq(e){return"u">typeof HTMLImageElement&&e instanceof HTMLImageElement||"u">typeof HTMLCanvasElement&&e instanceof HTMLCanvasElement||"u">typeof ImageBitmap&&e instanceof ImageBitmap?tV.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}var tG=0,tJ=class e extends t_{constructor(i=e.DEFAULT_IMAGE,r=e.DEFAULT_MAPPING,n=1001,s=1001,a=1006,o=1008,l=1023,h=1009,u=e.DEFAULT_ANISOTROPY,c=""){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:tG++}),this.uuid=tM(),this.name="",this.source=new tH(i),this.mipmaps=[],this.mapping=r,this.channel=0,this.wrapS=n,this.wrapT=s,this.magFilter=a,this.minFilter=o,this.anisotropy=u,this.format=l,this.internalFormat=null,this.type=h,this.offset=new tP(0,0),this.repeat=new tP(1,1),this.center=new tP(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new tE,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=c,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(e=null){this.source.data=e}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(e){return this.name=e.name,this.source=e.source,this.mipmaps=e.mipmaps.slice(0),this.mapping=e.mapping,this.channel=e.channel,this.wrapS=e.wrapS,this.wrapT=e.wrapT,this.magFilter=e.magFilter,this.minFilter=e.minFilter,this.anisotropy=e.anisotropy,this.format=e.format,this.internalFormat=e.internalFormat,this.type=e.type,this.offset.copy(e.offset),this.repeat.copy(e.repeat),this.center.copy(e.center),this.rotation=e.rotation,this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrix.copy(e.matrix),this.generateMipmaps=e.generateMipmaps,this.premultiplyAlpha=e.premultiplyAlpha,this.flipY=e.flipY,this.unpackAlignment=e.unpackAlignment,this.colorSpace=e.colorSpace,this.userData=JSON.parse(JSON.stringify(e.userData)),this.needsUpdate=!0,this}toJSON(e){let i=void 0===e||"string"==typeof e;if(!i&&void 0!==e.textures[this.uuid])return e.textures[this.uuid];let r={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(e).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(r.userData=this.userData),i||(e.textures[this.uuid]=r),r}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(e){if(300!==this.mapping)return e;if(e.applyMatrix3(this.matrix),e.x<0||e.x>1)switch(this.wrapS){case 1e3:e.x=e.x-Math.floor(e.x);break;case 1001:e.x=e.x<0?0:1;break;case 1002:1===Math.abs(Math.floor(e.x)%2)?e.x=Math.ceil(e.x)-e.x:e.x=e.x-Math.floor(e.x)}if(e.y<0||e.y>1)switch(this.wrapT){case 1e3:e.y=e.y-Math.floor(e.y);break;case 1001:e.y=e.y<0?0:1;break;case 1002:1===Math.abs(Math.floor(e.y)%2)?e.y=Math.ceil(e.y)-e.y:e.y=e.y-Math.floor(e.y)}return this.flipY&&(e.y=1-e.y),e}set needsUpdate(e){!0===e&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(e){!0===e&&this.pmremVersion++}};tJ.DEFAULT_IMAGE=null,tJ.DEFAULT_MAPPING=300,tJ.DEFAULT_ANISOTROPY=1;var tX=class e{constructor(i=0,r=0,n=0,s=1){e.prototype.isVector4=!0,this.x=i,this.y=r,this.z=n,this.w=s}get width(){return this.z}set width(e){this.z=e}get height(){return this.w}set height(e){this.w=e}set(e,i,r,n){return this.x=e,this.y=i,this.z=r,this.w=n,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this.w=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setW(e){return this.w=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;case 3:this.w=i;break;default:throw Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this.w=void 0!==e.w?e.w:1,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this.w+=e.w,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this.w+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this.w=e.w+i.w,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this.w+=e.w*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this.w-=e.w,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this.w-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this.w=e.w-i.w,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this.w*=e.w,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this.w*=e,this}applyMatrix4(e){let i=this.x,r=this.y,n=this.z,s=this.w,a=e.elements;return this.x=a[0]*i+a[4]*r+a[8]*n+a[12]*s,this.y=a[1]*i+a[5]*r+a[9]*n+a[13]*s,this.z=a[2]*i+a[6]*r+a[10]*n+a[14]*s,this.w=a[3]*i+a[7]*r+a[11]*n+a[15]*s,this}divideScalar(e){return this.multiplyScalar(1/e)}setAxisAngleFromQuaternion(e){this.w=2*Math.acos(e.w);let i=Math.sqrt(1-e.w*e.w);return i<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=e.x/i,this.y=e.y/i,this.z=e.z/i),this}setAxisAngleFromRotationMatrix(e){let i,r,n,s,a=e.elements,o=a[0],l=a[4],h=a[8],u=a[1],c=a[5],d=a[9],p=a[2],f=a[6],m=a[10];if(.01>Math.abs(l-u)&&.01>Math.abs(h-p)&&.01>Math.abs(d-f)){if(.1>Math.abs(l+u)&&.1>Math.abs(h+p)&&.1>Math.abs(d+f)&&.1>Math.abs(o+c+m-3))return this.set(1,0,0,0),this;i=Math.PI;let e=(o+1)/2,a=(c+1)/2,g=(m+1)/2,y=(l+u)/4,v=(h+p)/4,_=(d+f)/4;return e>a&&e>g?e<.01?(r=0,n=.707106781,s=.707106781):(n=y/(r=Math.sqrt(e)),s=v/r):a>g?a<.01?(r=.707106781,n=0,s=.707106781):(r=y/(n=Math.sqrt(a)),s=_/n):g<.01?(r=.707106781,n=.707106781,s=0):(r=v/(s=Math.sqrt(g)),n=_/s),this.set(r,n,s,i),this}let g=Math.sqrt((f-d)*(f-d)+(h-p)*(h-p)+(u-l)*(u-l));return .001>Math.abs(g)&&(g=1),this.x=(f-d)/g,this.y=(h-p)/g,this.z=(u-l)/g,this.w=Math.acos((o+c+m-1)/2),this}setFromMatrixPosition(e){let i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this.w=i[15],this}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this.w=Math.min(this.w,e.w),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this.w=Math.max(this.w,e.w),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this.w=Math.max(e.w,Math.min(i.w,this.w)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this.w=Math.max(e,Math.min(i,this.w)),this}clampLength(e,i){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(i,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z+this.w*e.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this.w+=(e.w-this.w)*i,this}lerpVectors(e,i,r){return this.x=e.x+(i.x-e.x)*r,this.y=e.y+(i.y-e.y)*r,this.z=e.z+(i.z-e.z)*r,this.w=e.w+(i.w-e.w)*r,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z&&e.w===this.w}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this.w=e[i+3],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e[i+3]=this.w,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this.w=e.getW(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}},tY=class{constructor(e=0,i=0,r=0,n=1){this.isQuaternion=!0,this._x=e,this._y=i,this._z=r,this._w=n}static slerpFlat(e,i,r,n,s,a,o){let l=r[n+0],h=r[n+1],u=r[n+2],c=r[n+3],d=s[a+0],p=s[a+1],f=s[a+2],m=s[a+3];if(0===o){e[i+0]=l,e[i+1]=h,e[i+2]=u,e[i+3]=c;return}if(1===o){e[i+0]=d,e[i+1]=p,e[i+2]=f,e[i+3]=m;return}if(c!==m||l!==d||h!==p||u!==f){let e=1-o,i=l*d+h*p+u*f+c*m,r=i>=0?1:-1,n=1-i*i;if(n>Number.EPSILON){let s=Math.sqrt(n),a=Math.atan2(s,i*r);e=Math.sin(e*a)/s,o=Math.sin(o*a)/s}let s=o*r;if(l=l*e+d*s,h=h*e+p*s,u=u*e+f*s,c=c*e+m*s,e===1-o){let e=1/Math.sqrt(l*l+h*h+u*u+c*c);l*=e,h*=e,u*=e,c*=e}}e[i]=l,e[i+1]=h,e[i+2]=u,e[i+3]=c}static multiplyQuaternionsFlat(e,i,r,n,s,a){let o=r[n],l=r[n+1],h=r[n+2],u=r[n+3],c=s[a],d=s[a+1],p=s[a+2],f=s[a+3];return e[i]=o*f+u*c+l*p-h*d,e[i+1]=l*f+u*d+h*c-o*p,e[i+2]=h*f+u*p+o*d-l*c,e[i+3]=u*f-o*c-l*d-h*p,e}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get w(){return this._w}set w(e){this._w=e,this._onChangeCallback()}set(e,i,r,n){return this._x=e,this._y=i,this._z=r,this._w=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(e){return this._x=e.x,this._y=e.y,this._z=e.z,this._w=e.w,this._onChangeCallback(),this}setFromEuler(e,i=!0){let r=e._x,n=e._y,s=e._z,a=e._order,o=Math.cos,l=Math.sin,h=o(r/2),u=o(n/2),c=o(s/2),d=l(r/2),p=l(n/2),f=l(s/2);switch(a){case"XYZ":this._x=d*u*c+h*p*f,this._y=h*p*c-d*u*f,this._z=h*u*f+d*p*c,this._w=h*u*c-d*p*f;break;case"YXZ":this._x=d*u*c+h*p*f,this._y=h*p*c-d*u*f,this._z=h*u*f-d*p*c,this._w=h*u*c+d*p*f;break;case"ZXY":this._x=d*u*c-h*p*f,this._y=h*p*c+d*u*f,this._z=h*u*f+d*p*c,this._w=h*u*c-d*p*f;break;case"ZYX":this._x=d*u*c-h*p*f,this._y=h*p*c+d*u*f,this._z=h*u*f-d*p*c,this._w=h*u*c+d*p*f;break;case"YZX":this._x=d*u*c+h*p*f,this._y=h*p*c+d*u*f,this._z=h*u*f-d*p*c,this._w=h*u*c-d*p*f;break;case"XZY":this._x=d*u*c-h*p*f,this._y=h*p*c-d*u*f,this._z=h*u*f+d*p*c,this._w=h*u*c+d*p*f;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+a)}return!0===i&&this._onChangeCallback(),this}setFromAxisAngle(e,i){let r=i/2,n=Math.sin(r);return this._x=e.x*n,this._y=e.y*n,this._z=e.z*n,this._w=Math.cos(r),this._onChangeCallback(),this}setFromRotationMatrix(e){let i=e.elements,r=i[0],n=i[4],s=i[8],a=i[1],o=i[5],l=i[9],h=i[2],u=i[6],c=i[10],d=r+o+c;if(d>0){let e=.5/Math.sqrt(d+1);this._w=.25/e,this._x=(u-l)*e,this._y=(s-h)*e,this._z=(a-n)*e}else if(r>o&&r>c){let e=2*Math.sqrt(1+r-o-c);this._w=(u-l)/e,this._x=.25*e,this._y=(n+a)/e,this._z=(s+h)/e}else if(o>c){let e=2*Math.sqrt(1+o-r-c);this._w=(s-h)/e,this._x=(n+a)/e,this._y=.25*e,this._z=(l+u)/e}else{let e=2*Math.sqrt(1+c-r-o);this._w=(a-n)/e,this._x=(s+h)/e,this._y=(l+u)/e,this._z=.25*e}return this._onChangeCallback(),this}setFromUnitVectors(e,i){let r=e.dot(i)+1;return r<Number.EPSILON?(r=0,Math.abs(e.x)>Math.abs(e.z)?(this._x=-e.y,this._y=e.x,this._z=0):(this._x=0,this._y=-e.z,this._z=e.y)):(this._x=e.y*i.z-e.z*i.y,this._y=e.z*i.x-e.x*i.z,this._z=e.x*i.y-e.y*i.x),this._w=r,this.normalize()}angleTo(e){return 2*Math.acos(Math.abs(tA(this.dot(e),-1,1)))}rotateTowards(e,i){let r=this.angleTo(e);return 0===r||this.slerp(e,Math.min(1,i/r)),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(e){return this._x*e._x+this._y*e._y+this._z*e._z+this._w*e._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let e=this.length();return 0===e?(this._x=0,this._y=0,this._z=0,this._w=1):(e=1/e,this._x=this._x*e,this._y=this._y*e,this._z=this._z*e,this._w=this._w*e),this._onChangeCallback(),this}multiply(e){return this.multiplyQuaternions(this,e)}premultiply(e){return this.multiplyQuaternions(e,this)}multiplyQuaternions(e,i){let r=e._x,n=e._y,s=e._z,a=e._w,o=i._x,l=i._y,h=i._z,u=i._w;return this._x=r*u+a*o+n*h-s*l,this._y=n*u+a*l+s*o-r*h,this._z=s*u+a*h+r*l-n*o,this._w=a*u-r*o-n*l-s*h,this._onChangeCallback(),this}slerp(e,i){if(0===i)return this;if(1===i)return this.copy(e);let r=this._x,n=this._y,s=this._z,a=this._w,o=a*e._w+r*e._x+n*e._y+s*e._z;if(o<0?(this._w=-e._w,this._x=-e._x,this._y=-e._y,this._z=-e._z,o=-o):this.copy(e),o>=1)return this._w=a,this._x=r,this._y=n,this._z=s,this;let l=1-o*o;if(l<=Number.EPSILON){let e=1-i;return this._w=e*a+i*this._w,this._x=e*r+i*this._x,this._y=e*n+i*this._y,this._z=e*s+i*this._z,this.normalize(),this}let h=Math.sqrt(l),u=Math.atan2(h,o),c=Math.sin((1-i)*u)/h,d=Math.sin(i*u)/h;return this._w=a*c+this._w*d,this._x=r*c+this._x*d,this._y=n*c+this._y*d,this._z=s*c+this._z*d,this._onChangeCallback(),this}slerpQuaternions(e,i,r){return this.copy(e).slerp(i,r)}random(){let e=2*Math.PI*Math.random(),i=2*Math.PI*Math.random(),r=Math.random(),n=Math.sqrt(1-r),s=Math.sqrt(r);return this.set(n*Math.sin(e),n*Math.cos(e),s*Math.sin(i),s*Math.cos(i))}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._w===this._w}fromArray(e,i=0){return this._x=e[i],this._y=e[i+1],this._z=e[i+2],this._w=e[i+3],this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._w,e}fromBufferAttribute(e,i){return this._x=e.getX(i),this._y=e.getY(i),this._z=e.getZ(i),this._w=e.getW(i),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}},tZ=class e{constructor(i=0,r=0,n=0){e.prototype.isVector3=!0,this.x=i,this.y=r,this.z=n}set(e,i,r){return void 0===r&&(r=this.z),this.x=e,this.y=i,this.z=r,this}setScalar(e){return this.x=e,this.y=e,this.z=e,this}setX(e){return this.x=e,this}setY(e){return this.y=e,this}setZ(e){return this.z=e,this}setComponent(e,i){switch(e){case 0:this.x=i;break;case 1:this.y=i;break;case 2:this.z=i;break;default:throw Error("index is out of range: "+e)}return this}getComponent(e){switch(e){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw Error("index is out of range: "+e)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(e){return this.x=e.x,this.y=e.y,this.z=e.z,this}add(e){return this.x+=e.x,this.y+=e.y,this.z+=e.z,this}addScalar(e){return this.x+=e,this.y+=e,this.z+=e,this}addVectors(e,i){return this.x=e.x+i.x,this.y=e.y+i.y,this.z=e.z+i.z,this}addScaledVector(e,i){return this.x+=e.x*i,this.y+=e.y*i,this.z+=e.z*i,this}sub(e){return this.x-=e.x,this.y-=e.y,this.z-=e.z,this}subScalar(e){return this.x-=e,this.y-=e,this.z-=e,this}subVectors(e,i){return this.x=e.x-i.x,this.y=e.y-i.y,this.z=e.z-i.z,this}multiply(e){return this.x*=e.x,this.y*=e.y,this.z*=e.z,this}multiplyScalar(e){return this.x*=e,this.y*=e,this.z*=e,this}multiplyVectors(e,i){return this.x=e.x*i.x,this.y=e.y*i.y,this.z=e.z*i.z,this}applyEuler(e){return this.applyQuaternion(t$.setFromEuler(e))}applyAxisAngle(e,i){return this.applyQuaternion(t$.setFromAxisAngle(e,i))}applyMatrix3(e){let i=this.x,r=this.y,n=this.z,s=e.elements;return this.x=s[0]*i+s[3]*r+s[6]*n,this.y=s[1]*i+s[4]*r+s[7]*n,this.z=s[2]*i+s[5]*r+s[8]*n,this}applyNormalMatrix(e){return this.applyMatrix3(e).normalize()}applyMatrix4(e){let i=this.x,r=this.y,n=this.z,s=e.elements,a=1/(s[3]*i+s[7]*r+s[11]*n+s[15]);return this.x=(s[0]*i+s[4]*r+s[8]*n+s[12])*a,this.y=(s[1]*i+s[5]*r+s[9]*n+s[13])*a,this.z=(s[2]*i+s[6]*r+s[10]*n+s[14])*a,this}applyQuaternion(e){let i=this.x,r=this.y,n=this.z,s=e.x,a=e.y,o=e.z,l=e.w,h=2*(a*n-o*r),u=2*(o*i-s*n),c=2*(s*r-a*i);return this.x=i+l*h+a*c-o*u,this.y=r+l*u+o*h-s*c,this.z=n+l*c+s*u-a*h,this}project(e){return this.applyMatrix4(e.matrixWorldInverse).applyMatrix4(e.projectionMatrix)}unproject(e){return this.applyMatrix4(e.projectionMatrixInverse).applyMatrix4(e.matrixWorld)}transformDirection(e){let i=this.x,r=this.y,n=this.z,s=e.elements;return this.x=s[0]*i+s[4]*r+s[8]*n,this.y=s[1]*i+s[5]*r+s[9]*n,this.z=s[2]*i+s[6]*r+s[10]*n,this.normalize()}divide(e){return this.x/=e.x,this.y/=e.y,this.z/=e.z,this}divideScalar(e){return this.multiplyScalar(1/e)}min(e){return this.x=Math.min(this.x,e.x),this.y=Math.min(this.y,e.y),this.z=Math.min(this.z,e.z),this}max(e){return this.x=Math.max(this.x,e.x),this.y=Math.max(this.y,e.y),this.z=Math.max(this.z,e.z),this}clamp(e,i){return this.x=Math.max(e.x,Math.min(i.x,this.x)),this.y=Math.max(e.y,Math.min(i.y,this.y)),this.z=Math.max(e.z,Math.min(i.z,this.z)),this}clampScalar(e,i){return this.x=Math.max(e,Math.min(i,this.x)),this.y=Math.max(e,Math.min(i,this.y)),this.z=Math.max(e,Math.min(i,this.z)),this}clampLength(e,i){let r=this.length();return this.divideScalar(r||1).multiplyScalar(Math.max(e,Math.min(i,r)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(e){return this.normalize().multiplyScalar(e)}lerp(e,i){return this.x+=(e.x-this.x)*i,this.y+=(e.y-this.y)*i,this.z+=(e.z-this.z)*i,this}lerpVectors(e,i,r){return this.x=e.x+(i.x-e.x)*r,this.y=e.y+(i.y-e.y)*r,this.z=e.z+(i.z-e.z)*r,this}cross(e){return this.crossVectors(this,e)}crossVectors(e,i){let r=e.x,n=e.y,s=e.z,a=i.x,o=i.y,l=i.z;return this.x=n*l-s*o,this.y=s*a-r*l,this.z=r*o-n*a,this}projectOnVector(e){let i=e.lengthSq();if(0===i)return this.set(0,0,0);let r=e.dot(this)/i;return this.copy(e).multiplyScalar(r)}projectOnPlane(e){return tK.copy(this).projectOnVector(e),this.sub(tK)}reflect(e){return this.sub(tK.copy(e).multiplyScalar(2*this.dot(e)))}angleTo(e){let i=Math.sqrt(this.lengthSq()*e.lengthSq());return 0===i?Math.PI/2:Math.acos(tA(this.dot(e)/i,-1,1))}distanceTo(e){return Math.sqrt(this.distanceToSquared(e))}distanceToSquared(e){let i=this.x-e.x,r=this.y-e.y,n=this.z-e.z;return i*i+r*r+n*n}manhattanDistanceTo(e){return Math.abs(this.x-e.x)+Math.abs(this.y-e.y)+Math.abs(this.z-e.z)}setFromSpherical(e){return this.setFromSphericalCoords(e.radius,e.phi,e.theta)}setFromSphericalCoords(e,i,r){let n=Math.sin(i)*e;return this.x=n*Math.sin(r),this.y=Math.cos(i)*e,this.z=n*Math.cos(r),this}setFromCylindrical(e){return this.setFromCylindricalCoords(e.radius,e.theta,e.y)}setFromCylindricalCoords(e,i,r){return this.x=e*Math.sin(i),this.y=r,this.z=e*Math.cos(i),this}setFromMatrixPosition(e){let i=e.elements;return this.x=i[12],this.y=i[13],this.z=i[14],this}setFromMatrixScale(e){let i=this.setFromMatrixColumn(e,0).length(),r=this.setFromMatrixColumn(e,1).length(),n=this.setFromMatrixColumn(e,2).length();return this.x=i,this.y=r,this.z=n,this}setFromMatrixColumn(e,i){return this.fromArray(e.elements,4*i)}setFromMatrix3Column(e,i){return this.fromArray(e.elements,3*i)}setFromEuler(e){return this.x=e._x,this.y=e._y,this.z=e._z,this}setFromColor(e){return this.x=e.r,this.y=e.g,this.z=e.b,this}equals(e){return e.x===this.x&&e.y===this.y&&e.z===this.z}fromArray(e,i=0){return this.x=e[i],this.y=e[i+1],this.z=e[i+2],this}toArray(e=[],i=0){return e[i]=this.x,e[i+1]=this.y,e[i+2]=this.z,e}fromBufferAttribute(e,i){return this.x=e.getX(i),this.y=e.getY(i),this.z=e.getZ(i),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){let e=Math.random()*Math.PI*2,i=2*Math.random()-1,r=Math.sqrt(1-i*i);return this.x=r*Math.cos(e),this.y=i,this.z=r*Math.sin(e),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}},tK=new tZ,t$=new tY,tQ=class{constructor(e=new tZ(1/0,1/0,1/0),i=new tZ(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=e,this.max=i}set(e,i){return this.min.copy(e),this.max.copy(i),this}setFromArray(e){this.makeEmpty();for(let i=0,r=e.length;i<r;i+=3)this.expandByPoint(t1.fromArray(e,i));return this}setFromBufferAttribute(e){this.makeEmpty();for(let i=0,r=e.count;i<r;i++)this.expandByPoint(t1.fromBufferAttribute(e,i));return this}setFromPoints(e){this.makeEmpty();for(let i=0,r=e.length;i<r;i++)this.expandByPoint(e[i]);return this}setFromCenterAndSize(e,i){let r=t1.copy(i).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}setFromObject(e,i=!1){return this.makeEmpty(),this.expandByObject(e,i)}clone(){return new this.constructor().copy(this)}copy(e){return this.min.copy(e.min),this.max.copy(e.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(e){return this.isEmpty()?e.set(0,0,0):e.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(e){return this.isEmpty()?e.set(0,0,0):e.subVectors(this.max,this.min)}expandByPoint(e){return this.min.min(e),this.max.max(e),this}expandByVector(e){return this.min.sub(e),this.max.add(e),this}expandByScalar(e){return this.min.addScalar(-e),this.max.addScalar(e),this}expandByObject(e,i=!1){e.updateWorldMatrix(!1,!1);let r=e.geometry;if(void 0!==r){let n=r.getAttribute("position");if(!0===i&&void 0!==n&&!0!==e.isInstancedMesh)for(let i=0,r=n.count;i<r;i++)!0===e.isMesh?e.getVertexPosition(i,t1):t1.fromBufferAttribute(n,i),t1.applyMatrix4(e.matrixWorld),this.expandByPoint(t1);else void 0!==e.boundingBox?(null===e.boundingBox&&e.computeBoundingBox(),t2.copy(e.boundingBox)):(null===r.boundingBox&&r.computeBoundingBox(),t2.copy(r.boundingBox)),t2.applyMatrix4(e.matrixWorld),this.union(t2)}let n=e.children;for(let e=0,r=n.length;e<r;e++)this.expandByObject(n[e],i);return this}containsPoint(e){return e.x>=this.min.x&&e.x<=this.max.x&&e.y>=this.min.y&&e.y<=this.max.y&&e.z>=this.min.z&&e.z<=this.max.z}containsBox(e){return this.min.x<=e.min.x&&e.max.x<=this.max.x&&this.min.y<=e.min.y&&e.max.y<=this.max.y&&this.min.z<=e.min.z&&e.max.z<=this.max.z}getParameter(e,i){return i.set((e.x-this.min.x)/(this.max.x-this.min.x),(e.y-this.min.y)/(this.max.y-this.min.y),(e.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(e){return e.max.x>=this.min.x&&e.min.x<=this.max.x&&e.max.y>=this.min.y&&e.min.y<=this.max.y&&e.max.z>=this.min.z&&e.min.z<=this.max.z}intersectsSphere(e){return this.clampPoint(e.center,t1),t1.distanceToSquared(e.center)<=e.radius*e.radius}intersectsPlane(e){let i,r;return e.normal.x>0?(i=e.normal.x*this.min.x,r=e.normal.x*this.max.x):(i=e.normal.x*this.max.x,r=e.normal.x*this.min.x),e.normal.y>0?(i+=e.normal.y*this.min.y,r+=e.normal.y*this.max.y):(i+=e.normal.y*this.max.y,r+=e.normal.y*this.min.y),e.normal.z>0?(i+=e.normal.z*this.min.z,r+=e.normal.z*this.max.z):(i+=e.normal.z*this.max.z,r+=e.normal.z*this.min.z),i<=-e.constant&&r>=-e.constant}intersectsTriangle(e){if(this.isEmpty())return!1;this.getCenter(t8),et.subVectors(this.max,t8),t3.subVectors(e.a,t8),t4.subVectors(e.b,t8),t5.subVectors(e.c,t8),t6.subVectors(t4,t3),t9.subVectors(t5,t4),t7.subVectors(t3,t5);let i=[0,-t6.z,t6.y,0,-t9.z,t9.y,0,-t7.z,t7.y,t6.z,0,-t6.x,t9.z,0,-t9.x,t7.z,0,-t7.x,-t6.y,t6.x,0,-t9.y,t9.x,0,-t7.y,t7.x,0];return!!(er(i,t3,t4,t5,et)&&er(i=[1,0,0,0,1,0,0,0,1],t3,t4,t5,et))&&(ee.crossVectors(t6,t9),er(i=[ee.x,ee.y,ee.z],t3,t4,t5,et))}clampPoint(e,i){return i.copy(e).clamp(this.min,this.max)}distanceToPoint(e){return this.clampPoint(e,t1).distanceTo(e)}getBoundingSphere(e){return this.isEmpty()?e.makeEmpty():(this.getCenter(e.center),e.radius=.5*this.getSize(t1).length()),e}intersect(e){return this.min.max(e.min),this.max.min(e.max),this.isEmpty()&&this.makeEmpty(),this}union(e){return this.min.min(e.min),this.max.max(e.max),this}applyMatrix4(e){return this.isEmpty()||(t0[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t0[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t0[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t0[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t0[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t0[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t0[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t0[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(t0)),this}translate(e){return this.min.add(e),this.max.add(e),this}equals(e){return e.min.equals(this.min)&&e.max.equals(this.max)}},t0=[new tZ,new tZ,new tZ,new tZ,new tZ,new tZ,new tZ,new tZ],t1=new tZ,t2=new tQ,t3=new tZ,t4=new tZ,t5=new tZ,t6=new tZ,t9=new tZ,t7=new tZ,t8=new tZ,et=new tZ,ee=new tZ,ei=new tZ;function er(e,i,r,n,s){for(let a=0,o=e.length-3;a<=o;a+=3){ei.fromArray(e,a);let o=s.x*Math.abs(ei.x)+s.y*Math.abs(ei.y)+s.z*Math.abs(ei.z),l=i.dot(ei),h=r.dot(ei),u=n.dot(ei);if(Math.max(-Math.max(l,h,u),Math.min(l,h,u))>o)return!1}return!0}var en=new tQ,es=new tZ,ea=new tZ,eo=class{constructor(e=new tZ,i=-1){this.isSphere=!0,this.center=e,this.radius=i}set(e,i){return this.center.copy(e),this.radius=i,this}setFromPoints(e,i){let r=this.center;void 0!==i?r.copy(i):en.setFromPoints(e).getCenter(r);let n=0;for(let i=0,s=e.length;i<s;i++)n=Math.max(n,r.distanceToSquared(e[i]));return this.radius=Math.sqrt(n),this}copy(e){return this.center.copy(e.center),this.radius=e.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(e){return e.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(e){return e.distanceTo(this.center)-this.radius}intersectsSphere(e){let i=this.radius+e.radius;return e.center.distanceToSquared(this.center)<=i*i}intersectsBox(e){return e.intersectsSphere(this)}intersectsPlane(e){return Math.abs(e.distanceToPoint(this.center))<=this.radius}clampPoint(e,i){let r=this.center.distanceToSquared(e);return i.copy(e),r>this.radius*this.radius&&(i.sub(this.center).normalize(),i.multiplyScalar(this.radius).add(this.center)),i}getBoundingBox(e){return this.isEmpty()?e.makeEmpty():(e.set(this.center,this.center),e.expandByScalar(this.radius)),e}applyMatrix4(e){return this.center.applyMatrix4(e),this.radius=this.radius*e.getMaxScaleOnAxis(),this}translate(e){return this.center.add(e),this}expandByPoint(e){if(this.isEmpty())return this.center.copy(e),this.radius=0,this;es.subVectors(e,this.center);let i=es.lengthSq();if(i>this.radius*this.radius){let e=Math.sqrt(i),r=(e-this.radius)*.5;this.center.addScaledVector(es,r/e),this.radius+=r}return this}union(e){return e.isEmpty()||(this.isEmpty()?this.copy(e):!0===this.center.equals(e.center)?this.radius=Math.max(this.radius,e.radius):(ea.subVectors(e.center,this.center).setLength(e.radius),this.expandByPoint(es.copy(e.center).add(ea)),this.expandByPoint(es.copy(e.center).sub(ea)))),this}equals(e){return e.center.equals(this.center)&&e.radius===this.radius}clone(){return new this.constructor().copy(this)}},el=new tZ,eh=new tZ,eu=new tZ,ec=new tZ,ed=new tZ,ep=new tZ,ef=new tZ,em=class{constructor(e=new tZ,i=new tZ(0,0,-1)){this.origin=e,this.direction=i}set(e,i){return this.origin.copy(e),this.direction.copy(i),this}copy(e){return this.origin.copy(e.origin),this.direction.copy(e.direction),this}at(e,i){return i.copy(this.origin).addScaledVector(this.direction,e)}lookAt(e){return this.direction.copy(e).sub(this.origin).normalize(),this}recast(e){return this.origin.copy(this.at(e,el)),this}closestPointToPoint(e,i){i.subVectors(e,this.origin);let r=i.dot(this.direction);return r<0?i.copy(this.origin):i.copy(this.origin).addScaledVector(this.direction,r)}distanceToPoint(e){return Math.sqrt(this.distanceSqToPoint(e))}distanceSqToPoint(e){let i=el.subVectors(e,this.origin).dot(this.direction);return i<0?this.origin.distanceToSquared(e):(el.copy(this.origin).addScaledVector(this.direction,i),el.distanceToSquared(e))}distanceSqToSegment(e,i,r,n){eh.copy(e).add(i).multiplyScalar(.5),eu.copy(i).sub(e).normalize(),ec.copy(this.origin).sub(eh);let s=.5*e.distanceTo(i),a=-this.direction.dot(eu),o=ec.dot(this.direction),l=-ec.dot(eu),h=ec.lengthSq(),u=Math.abs(1-a*a),c,d,p,f;if(u>0){if(c=a*l-o,d=a*o-l,f=s*u,c>=0){if(d>=-f){if(d<=f){let e=1/u;c*=e,d*=e,p=c*(c+a*d+2*o)+d*(a*c+d+2*l)+h}else p=-(c=Math.max(0,-(a*(d=s)+o)))*c+d*(d+2*l)+h}else p=-(c=Math.max(0,-(a*(d=-s)+o)))*c+d*(d+2*l)+h}else d<=-f?(d=(c=Math.max(0,-(-a*s+o)))>0?-s:Math.min(Math.max(-s,-l),s),p=-c*c+d*(d+2*l)+h):d<=f?(c=0,p=(d=Math.min(Math.max(-s,-l),s))*(d+2*l)+h):(d=(c=Math.max(0,-(a*s+o)))>0?s:Math.min(Math.max(-s,-l),s),p=-c*c+d*(d+2*l)+h)}else d=a>0?-s:s,p=-(c=Math.max(0,-(a*d+o)))*c+d*(d+2*l)+h;return r&&r.copy(this.origin).addScaledVector(this.direction,c),n&&n.copy(eh).addScaledVector(eu,d),p}intersectSphere(e,i){el.subVectors(e.center,this.origin);let r=el.dot(this.direction),n=el.dot(el)-r*r,s=e.radius*e.radius;if(n>s)return null;let a=Math.sqrt(s-n),o=r-a,l=r+a;return l<0?null:o<0?this.at(l,i):this.at(o,i)}intersectsSphere(e){return this.distanceSqToPoint(e.center)<=e.radius*e.radius}distanceToPlane(e){let i=e.normal.dot(this.direction);if(0===i)return 0===e.distanceToPoint(this.origin)?0:null;let r=-(this.origin.dot(e.normal)+e.constant)/i;return r>=0?r:null}intersectPlane(e,i){let r=this.distanceToPlane(e);return null===r?null:this.at(r,i)}intersectsPlane(e){let i=e.distanceToPoint(this.origin);return 0===i||e.normal.dot(this.direction)*i<0}intersectBox(e,i){let r,n,s,a,o,l,h=1/this.direction.x,u=1/this.direction.y,c=1/this.direction.z,d=this.origin;return h>=0?(r=(e.min.x-d.x)*h,n=(e.max.x-d.x)*h):(r=(e.max.x-d.x)*h,n=(e.min.x-d.x)*h),u>=0?(s=(e.min.y-d.y)*u,a=(e.max.y-d.y)*u):(s=(e.max.y-d.y)*u,a=(e.min.y-d.y)*u),r>a||s>n||((s>r||isNaN(r))&&(r=s),(a<n||isNaN(n))&&(n=a),c>=0?(o=(e.min.z-d.z)*c,l=(e.max.z-d.z)*c):(o=(e.max.z-d.z)*c,l=(e.min.z-d.z)*c),r>l||o>n)||((o>r||r!=r)&&(r=o),(l<n||n!=n)&&(n=l),n<0)?null:this.at(r>=0?r:n,i)}intersectsBox(e){return null!==this.intersectBox(e,el)}intersectTriangle(e,i,r,n,s){ed.subVectors(i,e),ep.subVectors(r,e),ef.crossVectors(ed,ep);let a=this.direction.dot(ef),o;if(a>0){if(n)return null;o=1}else{if(!(a<0))return null;o=-1,a=-a}ec.subVectors(this.origin,e);let l=o*this.direction.dot(ep.crossVectors(ec,ep));if(l<0)return null;let h=o*this.direction.dot(ed.cross(ec));if(h<0||l+h>a)return null;let u=-o*ec.dot(ef);return u<0?null:this.at(u/a,s)}applyMatrix4(e){return this.origin.applyMatrix4(e),this.direction.transformDirection(e),this}equals(e){return e.origin.equals(this.origin)&&e.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}},eg=class e{constructor(i,r,n,s,a,o,l,h,u,c,d,p,f,m,g,y){e.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],void 0!==i&&this.set(i,r,n,s,a,o,l,h,u,c,d,p,f,m,g,y)}set(e,i,r,n,s,a,o,l,h,u,c,d,p,f,m,g){let y=this.elements;return y[0]=e,y[4]=i,y[8]=r,y[12]=n,y[1]=s,y[5]=a,y[9]=o,y[13]=l,y[2]=h,y[6]=u,y[10]=c,y[14]=d,y[3]=p,y[7]=f,y[11]=m,y[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new e().fromArray(this.elements)}copy(e){let i=this.elements,r=e.elements;return i[0]=r[0],i[1]=r[1],i[2]=r[2],i[3]=r[3],i[4]=r[4],i[5]=r[5],i[6]=r[6],i[7]=r[7],i[8]=r[8],i[9]=r[9],i[10]=r[10],i[11]=r[11],i[12]=r[12],i[13]=r[13],i[14]=r[14],i[15]=r[15],this}copyPosition(e){let i=this.elements,r=e.elements;return i[12]=r[12],i[13]=r[13],i[14]=r[14],this}setFromMatrix3(e){let i=e.elements;return this.set(i[0],i[3],i[6],0,i[1],i[4],i[7],0,i[2],i[5],i[8],0,0,0,0,1),this}extractBasis(e,i,r){return e.setFromMatrixColumn(this,0),i.setFromMatrixColumn(this,1),r.setFromMatrixColumn(this,2),this}makeBasis(e,i,r){return this.set(e.x,i.x,r.x,0,e.y,i.y,r.y,0,e.z,i.z,r.z,0,0,0,0,1),this}extractRotation(e){let i=this.elements,r=e.elements,n=1/ey.setFromMatrixColumn(e,0).length(),s=1/ey.setFromMatrixColumn(e,1).length(),a=1/ey.setFromMatrixColumn(e,2).length();return i[0]=r[0]*n,i[1]=r[1]*n,i[2]=r[2]*n,i[3]=0,i[4]=r[4]*s,i[5]=r[5]*s,i[6]=r[6]*s,i[7]=0,i[8]=r[8]*a,i[9]=r[9]*a,i[10]=r[10]*a,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromEuler(e){let i=this.elements,r=e.x,n=e.y,s=e.z,a=Math.cos(r),o=Math.sin(r),l=Math.cos(n),h=Math.sin(n),u=Math.cos(s),c=Math.sin(s);if("XYZ"===e.order){let e=a*u,r=a*c,n=o*u,s=o*c;i[0]=l*u,i[4]=-l*c,i[8]=h,i[1]=r+n*h,i[5]=e-s*h,i[9]=-o*l,i[2]=s-e*h,i[6]=n+r*h,i[10]=a*l}else if("YXZ"===e.order){let e=l*u,r=l*c,n=h*u,s=h*c;i[0]=e+s*o,i[4]=n*o-r,i[8]=a*h,i[1]=a*c,i[5]=a*u,i[9]=-o,i[2]=r*o-n,i[6]=s+e*o,i[10]=a*l}else if("ZXY"===e.order){let e=l*u,r=l*c,n=h*u,s=h*c;i[0]=e-s*o,i[4]=-a*c,i[8]=n+r*o,i[1]=r+n*o,i[5]=a*u,i[9]=s-e*o,i[2]=-a*h,i[6]=o,i[10]=a*l}else if("ZYX"===e.order){let e=a*u,r=a*c,n=o*u,s=o*c;i[0]=l*u,i[4]=n*h-r,i[8]=e*h+s,i[1]=l*c,i[5]=s*h+e,i[9]=r*h-n,i[2]=-h,i[6]=o*l,i[10]=a*l}else if("YZX"===e.order){let e=a*l,r=a*h,n=o*l,s=o*h;i[0]=l*u,i[4]=s-e*c,i[8]=n*c+r,i[1]=c,i[5]=a*u,i[9]=-o*u,i[2]=-h*u,i[6]=r*c+n,i[10]=e-s*c}else if("XZY"===e.order){let e=a*l,r=a*h,n=o*l,s=o*h;i[0]=l*u,i[4]=-c,i[8]=h*u,i[1]=e*c+s,i[5]=a*u,i[9]=r*c-n,i[2]=n*c-r,i[6]=o*u,i[10]=s*c+e}return i[3]=0,i[7]=0,i[11]=0,i[12]=0,i[13]=0,i[14]=0,i[15]=1,this}makeRotationFromQuaternion(e){return this.compose(e_,e,ex)}lookAt(e,i,r){let n=this.elements;return eM.subVectors(e,i),0===eM.lengthSq()&&(eM.z=1),eM.normalize(),eb.crossVectors(r,eM),0===eb.lengthSq()&&(1===Math.abs(r.z)?eM.x+=1e-4:eM.z+=1e-4,eM.normalize(),eb.crossVectors(r,eM)),eb.normalize(),ew.crossVectors(eM,eb),n[0]=eb.x,n[4]=ew.x,n[8]=eM.x,n[1]=eb.y,n[5]=ew.y,n[9]=eM.y,n[2]=eb.z,n[6]=ew.z,n[10]=eM.z,this}multiply(e){return this.multiplyMatrices(this,e)}premultiply(e){return this.multiplyMatrices(e,this)}multiplyMatrices(e,i){let r=e.elements,n=i.elements,s=this.elements,a=r[0],o=r[4],l=r[8],h=r[12],u=r[1],c=r[5],d=r[9],p=r[13],f=r[2],m=r[6],g=r[10],y=r[14],v=r[3],_=r[7],x=r[11],b=r[15],w=n[0],M=n[4],A=n[8],S=n[12],T=n[1],C=n[5],P=n[9],E=n[13],I=n[2],z=n[6],R=n[10],B=n[14],k=n[3],O=n[7],L=n[11],N=n[15];return s[0]=a*w+o*T+l*I+h*k,s[4]=a*M+o*C+l*z+h*O,s[8]=a*A+o*P+l*R+h*L,s[12]=a*S+o*E+l*B+h*N,s[1]=u*w+c*T+d*I+p*k,s[5]=u*M+c*C+d*z+p*O,s[9]=u*A+c*P+d*R+p*L,s[13]=u*S+c*E+d*B+p*N,s[2]=f*w+m*T+g*I+y*k,s[6]=f*M+m*C+g*z+y*O,s[10]=f*A+m*P+g*R+y*L,s[14]=f*S+m*E+g*B+y*N,s[3]=v*w+_*T+x*I+b*k,s[7]=v*M+_*C+x*z+b*O,s[11]=v*A+_*P+x*R+b*L,s[15]=v*S+_*E+x*B+b*N,this}multiplyScalar(e){let i=this.elements;return i[0]*=e,i[4]*=e,i[8]*=e,i[12]*=e,i[1]*=e,i[5]*=e,i[9]*=e,i[13]*=e,i[2]*=e,i[6]*=e,i[10]*=e,i[14]*=e,i[3]*=e,i[7]*=e,i[11]*=e,i[15]*=e,this}determinant(){let e=this.elements,i=e[0],r=e[4],n=e[8],s=e[12],a=e[1],o=e[5],l=e[9],h=e[13],u=e[2],c=e[6],d=e[10],p=e[14];return e[3]*(+s*l*c-n*h*c-s*o*d+r*h*d+n*o*p-r*l*p)+e[7]*(+i*l*p-i*h*d+s*a*d-n*a*p+n*h*u-s*l*u)+e[11]*(+i*h*c-i*o*p-s*a*c+r*a*p+s*o*u-r*h*u)+e[15]*(-n*o*u-i*l*c+i*o*d+n*a*c-r*a*d+r*l*u)}transpose(){let e=this.elements,i;return i=e[1],e[1]=e[4],e[4]=i,i=e[2],e[2]=e[8],e[8]=i,i=e[6],e[6]=e[9],e[9]=i,i=e[3],e[3]=e[12],e[12]=i,i=e[7],e[7]=e[13],e[13]=i,i=e[11],e[11]=e[14],e[14]=i,this}setPosition(e,i,r){let n=this.elements;return e.isVector3?(n[12]=e.x,n[13]=e.y,n[14]=e.z):(n[12]=e,n[13]=i,n[14]=r),this}invert(){let e=this.elements,i=e[0],r=e[1],n=e[2],s=e[3],a=e[4],o=e[5],l=e[6],h=e[7],u=e[8],c=e[9],d=e[10],p=e[11],f=e[12],m=e[13],g=e[14],y=e[15],v=c*g*h-m*d*h+m*l*p-o*g*p-c*l*y+o*d*y,_=f*d*h-u*g*h-f*l*p+a*g*p+u*l*y-a*d*y,x=u*m*h-f*c*h+f*o*p-a*m*p-u*o*y+a*c*y,b=f*c*l-u*m*l-f*o*d+a*m*d+u*o*g-a*c*g,w=i*v+r*_+n*x+s*b;if(0===w)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);let M=1/w;return e[0]=v*M,e[1]=(m*d*s-c*g*s-m*n*p+r*g*p+c*n*y-r*d*y)*M,e[2]=(o*g*s-m*l*s+m*n*h-r*g*h-o*n*y+r*l*y)*M,e[3]=(c*l*s-o*d*s-c*n*h+r*d*h+o*n*p-r*l*p)*M,e[4]=_*M,e[5]=(u*g*s-f*d*s+f*n*p-i*g*p-u*n*y+i*d*y)*M,e[6]=(f*l*s-a*g*s-f*n*h+i*g*h+a*n*y-i*l*y)*M,e[7]=(a*d*s-u*l*s+u*n*h-i*d*h-a*n*p+i*l*p)*M,e[8]=x*M,e[9]=(f*c*s-u*m*s-f*r*p+i*m*p+u*r*y-i*c*y)*M,e[10]=(a*m*s-f*o*s+f*r*h-i*m*h-a*r*y+i*o*y)*M,e[11]=(u*o*s-a*c*s-u*r*h+i*c*h+a*r*p-i*o*p)*M,e[12]=b*M,e[13]=(u*m*n-f*c*n+f*r*d-i*m*d-u*r*g+i*c*g)*M,e[14]=(f*o*n-a*m*n-f*r*l+i*m*l+a*r*g-i*o*g)*M,e[15]=(a*c*n-u*o*n+u*r*l-i*c*l-a*r*d+i*o*d)*M,this}scale(e){let i=this.elements,r=e.x,n=e.y,s=e.z;return i[0]*=r,i[4]*=n,i[8]*=s,i[1]*=r,i[5]*=n,i[9]*=s,i[2]*=r,i[6]*=n,i[10]*=s,i[3]*=r,i[7]*=n,i[11]*=s,this}getMaxScaleOnAxis(){let e=this.elements;return Math.sqrt(Math.max(e[0]*e[0]+e[1]*e[1]+e[2]*e[2],e[4]*e[4]+e[5]*e[5]+e[6]*e[6],e[8]*e[8]+e[9]*e[9]+e[10]*e[10]))}makeTranslation(e,i,r){return e.isVector3?this.set(1,0,0,e.x,0,1,0,e.y,0,0,1,e.z,0,0,0,1):this.set(1,0,0,e,0,1,0,i,0,0,1,r,0,0,0,1),this}makeRotationX(e){let i=Math.cos(e),r=Math.sin(e);return this.set(1,0,0,0,0,i,-r,0,0,r,i,0,0,0,0,1),this}makeRotationY(e){let i=Math.cos(e),r=Math.sin(e);return this.set(i,0,r,0,0,1,0,0,-r,0,i,0,0,0,0,1),this}makeRotationZ(e){let i=Math.cos(e),r=Math.sin(e);return this.set(i,-r,0,0,r,i,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(e,i){let r=Math.cos(i),n=Math.sin(i),s=1-r,a=e.x,o=e.y,l=e.z,h=s*a,u=s*o;return this.set(h*a+r,h*o-n*l,h*l+n*o,0,h*o+n*l,u*o+r,u*l-n*a,0,h*l-n*o,u*l+n*a,s*l*l+r,0,0,0,0,1),this}makeScale(e,i,r){return this.set(e,0,0,0,0,i,0,0,0,0,r,0,0,0,0,1),this}makeShear(e,i,r,n,s,a){return this.set(1,r,s,0,e,1,a,0,i,n,1,0,0,0,0,1),this}compose(e,i,r){let n=this.elements,s=i._x,a=i._y,o=i._z,l=i._w,h=s+s,u=a+a,c=o+o,d=s*h,p=s*u,f=s*c,m=a*u,g=a*c,y=o*c,v=l*h,_=l*u,x=l*c,b=r.x,w=r.y,M=r.z;return n[0]=(1-(m+y))*b,n[1]=(p+x)*b,n[2]=(f-_)*b,n[3]=0,n[4]=(p-x)*w,n[5]=(1-(d+y))*w,n[6]=(g+v)*w,n[7]=0,n[8]=(f+_)*M,n[9]=(g-v)*M,n[10]=(1-(d+m))*M,n[11]=0,n[12]=e.x,n[13]=e.y,n[14]=e.z,n[15]=1,this}decompose(e,i,r){let n=this.elements,s=ey.set(n[0],n[1],n[2]).length(),a=ey.set(n[4],n[5],n[6]).length(),o=ey.set(n[8],n[9],n[10]).length();0>this.determinant()&&(s=-s),e.x=n[12],e.y=n[13],e.z=n[14],ev.copy(this);let l=1/s,h=1/a,u=1/o;return ev.elements[0]*=l,ev.elements[1]*=l,ev.elements[2]*=l,ev.elements[4]*=h,ev.elements[5]*=h,ev.elements[6]*=h,ev.elements[8]*=u,ev.elements[9]*=u,ev.elements[10]*=u,i.setFromRotationMatrix(ev),r.x=s,r.y=a,r.z=o,this}makePerspective(e,i,r,n,s,a,o=2e3){let l=this.elements,h,u;if(2e3===o)h=-(a+s)/(a-s),u=-2*a*s/(a-s);else if(2001===o)h=-a/(a-s),u=-a*s/(a-s);else throw Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+o);return l[0]=2*s/(i-e),l[4]=0,l[8]=(i+e)/(i-e),l[12]=0,l[1]=0,l[5]=2*s/(r-n),l[9]=(r+n)/(r-n),l[13]=0,l[2]=0,l[6]=0,l[10]=h,l[14]=u,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(e,i,r,n,s,a,o=2e3){let l=this.elements,h=1/(i-e),u=1/(r-n),c=1/(a-s),d,p;if(2e3===o)d=(a+s)*c,p=-2*c;else if(2001===o)d=s*c,p=-1*c;else throw Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+o);return l[0]=2*h,l[4]=0,l[8]=0,l[12]=-((i+e)*h),l[1]=0,l[5]=2*u,l[9]=0,l[13]=-((r+n)*u),l[2]=0,l[6]=0,l[10]=p,l[14]=-d,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(e){let i=this.elements,r=e.elements;for(let e=0;e<16;e++)if(i[e]!==r[e])return!1;return!0}fromArray(e,i=0){for(let r=0;r<16;r++)this.elements[r]=e[r+i];return this}toArray(e=[],i=0){let r=this.elements;return e[i]=r[0],e[i+1]=r[1],e[i+2]=r[2],e[i+3]=r[3],e[i+4]=r[4],e[i+5]=r[5],e[i+6]=r[6],e[i+7]=r[7],e[i+8]=r[8],e[i+9]=r[9],e[i+10]=r[10],e[i+11]=r[11],e[i+12]=r[12],e[i+13]=r[13],e[i+14]=r[14],e[i+15]=r[15],e}},ey=new tZ,ev=new eg,e_=new tZ(0,0,0),ex=new tZ(1,1,1),eb=new tZ,ew=new tZ,eM=new tZ,eA=new eg,eS=new tY,eT=class e{constructor(i=0,r=0,n=0,s=e.DEFAULT_ORDER){this.isEuler=!0,this._x=i,this._y=r,this._z=n,this._order=s}get x(){return this._x}set x(e){this._x=e,this._onChangeCallback()}get y(){return this._y}set y(e){this._y=e,this._onChangeCallback()}get z(){return this._z}set z(e){this._z=e,this._onChangeCallback()}get order(){return this._order}set order(e){this._order=e,this._onChangeCallback()}set(e,i,r,n=this._order){return this._x=e,this._y=i,this._z=r,this._order=n,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(e){return this._x=e._x,this._y=e._y,this._z=e._z,this._order=e._order,this._onChangeCallback(),this}setFromRotationMatrix(e,i=this._order,r=!0){let n=e.elements,s=n[0],a=n[4],o=n[8],l=n[1],h=n[5],u=n[9],c=n[2],d=n[6],p=n[10];switch(i){case"XYZ":this._y=Math.asin(tA(o,-1,1)),.9999999>Math.abs(o)?(this._x=Math.atan2(-u,p),this._z=Math.atan2(-a,s)):(this._x=Math.atan2(d,h),this._z=0);break;case"YXZ":this._x=Math.asin(-tA(u,-1,1)),.9999999>Math.abs(u)?(this._y=Math.atan2(o,p),this._z=Math.atan2(l,h)):(this._y=Math.atan2(-c,s),this._z=0);break;case"ZXY":this._x=Math.asin(tA(d,-1,1)),.9999999>Math.abs(d)?(this._y=Math.atan2(-c,p),this._z=Math.atan2(-a,h)):(this._y=0,this._z=Math.atan2(l,s));break;case"ZYX":this._y=Math.asin(-tA(c,-1,1)),.9999999>Math.abs(c)?(this._x=Math.atan2(d,p),this._z=Math.atan2(l,s)):(this._x=0,this._z=Math.atan2(-a,h));break;case"YZX":this._z=Math.asin(tA(l,-1,1)),.9999999>Math.abs(l)?(this._x=Math.atan2(-u,h),this._y=Math.atan2(-c,s)):(this._x=0,this._y=Math.atan2(o,p));break;case"XZY":this._z=Math.asin(-tA(a,-1,1)),.9999999>Math.abs(a)?(this._x=Math.atan2(d,h),this._y=Math.atan2(o,s)):(this._x=Math.atan2(-u,p),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+i)}return this._order=i,!0===r&&this._onChangeCallback(),this}setFromQuaternion(e,i,r){return eA.makeRotationFromQuaternion(e),this.setFromRotationMatrix(eA,i,r)}setFromVector3(e,i=this._order){return this.set(e.x,e.y,e.z,i)}reorder(e){return eS.setFromEuler(this),this.setFromQuaternion(eS,e)}equals(e){return e._x===this._x&&e._y===this._y&&e._z===this._z&&e._order===this._order}fromArray(e){return this._x=e[0],this._y=e[1],this._z=e[2],void 0!==e[3]&&(this._order=e[3]),this._onChangeCallback(),this}toArray(e=[],i=0){return e[i]=this._x,e[i+1]=this._y,e[i+2]=this._z,e[i+3]=this._order,e}_onChange(e){return this._onChangeCallback=e,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}};eT.DEFAULT_ORDER="XYZ";var eC=class{constructor(){this.mask=1}set(e){this.mask=(1<<e|0)>>>0}enable(e){this.mask|=1<<e|0}enableAll(){this.mask=-1}toggle(e){this.mask^=1<<e|0}disable(e){this.mask&=~(1<<e|0)}disableAll(){this.mask=0}test(e){return(this.mask&e.mask)!=0}isEnabled(e){return(this.mask&(1<<e|0))!=0}},eP=0,eE=new tZ,eI=new tY,ez=new eg,eR=new tZ,eB=new tZ,ek=new tZ,eO=new tY,eL=new tZ(1,0,0),eN=new tZ(0,1,0),eF=new tZ(0,0,1),eD={type:"added"},eU={type:"removed"},ej={type:"childadded",child:null},eV={type:"childremoved",child:null},eW=class e extends t_{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:eP++}),this.uuid=tM(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=e.DEFAULT_UP.clone();let i=new tZ,r=new eT,n=new tY,s=new tZ(1,1,1);r._onChange(function(){n.setFromEuler(r,!1)}),n._onChange(function(){r.setFromQuaternion(n,void 0,!1)}),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:i},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:s},modelViewMatrix:{value:new eg},normalMatrix:{value:new tE}}),this.matrix=new eg,this.matrixWorld=new eg,this.matrixAutoUpdate=e.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=e.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new eC,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(e){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(e),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(e){return this.quaternion.premultiply(e),this}setRotationFromAxisAngle(e,i){this.quaternion.setFromAxisAngle(e,i)}setRotationFromEuler(e){this.quaternion.setFromEuler(e,!0)}setRotationFromMatrix(e){this.quaternion.setFromRotationMatrix(e)}setRotationFromQuaternion(e){this.quaternion.copy(e)}rotateOnAxis(e,i){return eI.setFromAxisAngle(e,i),this.quaternion.multiply(eI),this}rotateOnWorldAxis(e,i){return eI.setFromAxisAngle(e,i),this.quaternion.premultiply(eI),this}rotateX(e){return this.rotateOnAxis(eL,e)}rotateY(e){return this.rotateOnAxis(eN,e)}rotateZ(e){return this.rotateOnAxis(eF,e)}translateOnAxis(e,i){return eE.copy(e).applyQuaternion(this.quaternion),this.position.add(eE.multiplyScalar(i)),this}translateX(e){return this.translateOnAxis(eL,e)}translateY(e){return this.translateOnAxis(eN,e)}translateZ(e){return this.translateOnAxis(eF,e)}localToWorld(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(this.matrixWorld)}worldToLocal(e){return this.updateWorldMatrix(!0,!1),e.applyMatrix4(ez.copy(this.matrixWorld).invert())}lookAt(e,i,r){e.isVector3?eR.copy(e):eR.set(e,i,r);let n=this.parent;this.updateWorldMatrix(!0,!1),eB.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?ez.lookAt(eB,eR,this.up):ez.lookAt(eR,eB,this.up),this.quaternion.setFromRotationMatrix(ez),n&&(ez.extractRotation(n.matrixWorld),eI.setFromRotationMatrix(ez),this.quaternion.premultiply(eI.invert()))}add(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return e===this?console.error("THREE.Object3D.add: object can't be added as a child of itself.",e):e&&e.isObject3D?(e.removeFromParent(),e.parent=this,this.children.push(e),e.dispatchEvent(eD),ej.child=e,this.dispatchEvent(ej),ej.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",e),this}remove(e){if(arguments.length>1){for(let e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}let i=this.children.indexOf(e);return -1!==i&&(e.parent=null,this.children.splice(i,1),e.dispatchEvent(eU),eV.child=e,this.dispatchEvent(eV),eV.child=null),this}removeFromParent(){let e=this.parent;return null!==e&&e.remove(this),this}clear(){return this.remove(...this.children)}attach(e){return this.updateWorldMatrix(!0,!1),ez.copy(this.matrixWorld).invert(),null!==e.parent&&(e.parent.updateWorldMatrix(!0,!1),ez.multiply(e.parent.matrixWorld)),e.applyMatrix4(ez),e.removeFromParent(),e.parent=this,this.children.push(e),e.updateWorldMatrix(!1,!0),e.dispatchEvent(eD),ej.child=e,this.dispatchEvent(ej),ej.child=null,this}getObjectById(e){return this.getObjectByProperty("id",e)}getObjectByName(e){return this.getObjectByProperty("name",e)}getObjectByProperty(e,i){if(this[e]===i)return this;for(let r=0,n=this.children.length;r<n;r++){let n=this.children[r].getObjectByProperty(e,i);if(void 0!==n)return n}}getObjectsByProperty(e,i,r=[]){this[e]===i&&r.push(this);let n=this.children;for(let s=0,a=n.length;s<a;s++)n[s].getObjectsByProperty(e,i,r);return r}getWorldPosition(e){return this.updateWorldMatrix(!0,!1),e.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(eB,e,ek),e}getWorldScale(e){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(eB,eO,e),e}getWorldDirection(e){this.updateWorldMatrix(!0,!1);let i=this.matrixWorld.elements;return e.set(i[8],i[9],i[10]).normalize()}raycast(){}traverse(e){e(this);let i=this.children;for(let r=0,n=i.length;r<n;r++)i[r].traverse(e)}traverseVisible(e){if(!1===this.visible)return;e(this);let i=this.children;for(let r=0,n=i.length;r<n;r++)i[r].traverseVisible(e)}traverseAncestors(e){let i=this.parent;null!==i&&(e(i),i.traverseAncestors(e))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(e){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||e)&&(!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,e=!0);let i=this.children;for(let r=0,n=i.length;r<n;r++)i[r].updateMatrixWorld(e)}updateWorldMatrix(e,i){let r=this.parent;if(!0===e&&null!==r&&r.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),!0===this.matrixWorldAutoUpdate&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),!0===i){let e=this.children;for(let i=0,r=e.length;i<r;i++)e[i].updateWorldMatrix(!1,!0)}}toJSON(e){let i=void 0===e||"string"==typeof e,r={};i&&(e={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},r.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});let n={};function s(i,r){return void 0===i[r.uuid]&&(i[r.uuid]=r.toJSON(e)),r.uuid}if(n.uuid=this.uuid,n.type=this.type,""!==this.name&&(n.name=this.name),!0===this.castShadow&&(n.castShadow=!0),!0===this.receiveShadow&&(n.receiveShadow=!0),!1===this.visible&&(n.visible=!1),!1===this.frustumCulled&&(n.frustumCulled=!1),0!==this.renderOrder&&(n.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(n.userData=this.userData),n.layers=this.layers.mask,n.matrix=this.matrix.toArray(),n.up=this.up.toArray(),!1===this.matrixAutoUpdate&&(n.matrixAutoUpdate=!1),this.isInstancedMesh&&(n.type="InstancedMesh",n.count=this.count,n.instanceMatrix=this.instanceMatrix.toJSON(),null!==this.instanceColor&&(n.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(n.type="BatchedMesh",n.perObjectFrustumCulled=this.perObjectFrustumCulled,n.sortObjects=this.sortObjects,n.drawRanges=this._drawRanges,n.reservedRanges=this._reservedRanges,n.visibility=this._visibility,n.active=this._active,n.bounds=this._bounds.map(e=>({boxInitialized:e.boxInitialized,boxMin:e.box.min.toArray(),boxMax:e.box.max.toArray(),sphereInitialized:e.sphereInitialized,sphereRadius:e.sphere.radius,sphereCenter:e.sphere.center.toArray()})),n.maxInstanceCount=this._maxInstanceCount,n.maxVertexCount=this._maxVertexCount,n.maxIndexCount=this._maxIndexCount,n.geometryInitialized=this._geometryInitialized,n.geometryCount=this._geometryCount,n.matricesTexture=this._matricesTexture.toJSON(e),null!==this._colorsTexture&&(n.colorsTexture=this._colorsTexture.toJSON(e)),null!==this.boundingSphere&&(n.boundingSphere={center:n.boundingSphere.center.toArray(),radius:n.boundingSphere.radius}),null!==this.boundingBox&&(n.boundingBox={min:n.boundingBox.min.toArray(),max:n.boundingBox.max.toArray()})),this.isScene)this.background&&(this.background.isColor?n.background=this.background.toJSON():this.background.isTexture&&(n.background=this.background.toJSON(e).uuid)),this.environment&&this.environment.isTexture&&!0!==this.environment.isRenderTargetTexture&&(n.environment=this.environment.toJSON(e).uuid);else if(this.isMesh||this.isLine||this.isPoints){n.geometry=s(e.geometries,this.geometry);let i=this.geometry.parameters;if(void 0!==i&&void 0!==i.shapes){let r=i.shapes;if(Array.isArray(r))for(let i=0,n=r.length;i<n;i++){let n=r[i];s(e.shapes,n)}else s(e.shapes,r)}}if(this.isSkinnedMesh&&(n.bindMode=this.bindMode,n.bindMatrix=this.bindMatrix.toArray(),void 0!==this.skeleton&&(s(e.skeletons,this.skeleton),n.skeleton=this.skeleton.uuid)),void 0!==this.material){if(Array.isArray(this.material)){let i=[];for(let r=0,n=this.material.length;r<n;r++)i.push(s(e.materials,this.material[r]));n.material=i}else n.material=s(e.materials,this.material)}if(this.children.length>0){n.children=[];for(let i=0;i<this.children.length;i++)n.children.push(this.children[i].toJSON(e).object)}if(this.animations.length>0){n.animations=[];for(let i=0;i<this.animations.length;i++){let r=this.animations[i];n.animations.push(s(e.animations,r))}}if(i){let i=a(e.geometries),n=a(e.materials),s=a(e.textures),o=a(e.images),l=a(e.shapes),h=a(e.skeletons),u=a(e.animations),c=a(e.nodes);i.length>0&&(r.geometries=i),n.length>0&&(r.materials=n),s.length>0&&(r.textures=s),o.length>0&&(r.images=o),l.length>0&&(r.shapes=l),h.length>0&&(r.skeletons=h),u.length>0&&(r.animations=u),c.length>0&&(r.nodes=c)}return r.object=n,r;function a(e){let i=[];for(let r in e){let n=e[r];delete n.metadata,i.push(n)}return i}}clone(e){return new this.constructor().copy(this,e)}copy(e,i=!0){if(this.name=e.name,this.up.copy(e.up),this.position.copy(e.position),this.rotation.order=e.rotation.order,this.quaternion.copy(e.quaternion),this.scale.copy(e.scale),this.matrix.copy(e.matrix),this.matrixWorld.copy(e.matrixWorld),this.matrixAutoUpdate=e.matrixAutoUpdate,this.matrixWorldAutoUpdate=e.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=e.matrixWorldNeedsUpdate,this.layers.mask=e.layers.mask,this.visible=e.visible,this.castShadow=e.castShadow,this.receiveShadow=e.receiveShadow,this.frustumCulled=e.frustumCulled,this.renderOrder=e.renderOrder,this.animations=e.animations.slice(),this.userData=JSON.parse(JSON.stringify(e.userData)),!0===i)for(let i=0;i<e.children.length;i++){let r=e.children[i];this.add(r.clone())}return this}};eW.DEFAULT_UP=new tZ(0,1,0),eW.DEFAULT_MATRIX_AUTO_UPDATE=!0,eW.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;var eH=new tZ,eq=new tZ,eG=new tZ,eJ=new tZ,eX=new tZ,eY=new tZ,eZ=new tZ,eK=new tZ,e$=new tZ,eQ=new tZ,e0=class e{constructor(e=new tZ,i=new tZ,r=new tZ){this.a=e,this.b=i,this.c=r}static getNormal(e,i,r,n){n.subVectors(r,i),eH.subVectors(e,i),n.cross(eH);let s=n.lengthSq();return s>0?n.multiplyScalar(1/Math.sqrt(s)):n.set(0,0,0)}static getBarycoord(e,i,r,n,s){eH.subVectors(n,i),eq.subVectors(r,i),eG.subVectors(e,i);let a=eH.dot(eH),o=eH.dot(eq),l=eH.dot(eG),h=eq.dot(eq),u=eq.dot(eG),c=a*h-o*o;if(0===c)return s.set(0,0,0),null;let d=1/c,p=(h*l-o*u)*d,f=(a*u-o*l)*d;return s.set(1-p-f,f,p)}static containsPoint(e,i,r,n){return null!==this.getBarycoord(e,i,r,n,eJ)&&eJ.x>=0&&eJ.y>=0&&eJ.x+eJ.y<=1}static getInterpolation(e,i,r,n,s,a,o,l){return null===this.getBarycoord(e,i,r,n,eJ)?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(s,eJ.x),l.addScaledVector(a,eJ.y),l.addScaledVector(o,eJ.z),l)}static isFrontFacing(e,i,r,n){return eH.subVectors(r,i),eq.subVectors(e,i),0>eH.cross(eq).dot(n)}set(e,i,r){return this.a.copy(e),this.b.copy(i),this.c.copy(r),this}setFromPointsAndIndices(e,i,r,n){return this.a.copy(e[i]),this.b.copy(e[r]),this.c.copy(e[n]),this}setFromAttributeAndIndices(e,i,r,n){return this.a.fromBufferAttribute(e,i),this.b.fromBufferAttribute(e,r),this.c.fromBufferAttribute(e,n),this}clone(){return new this.constructor().copy(this)}copy(e){return this.a.copy(e.a),this.b.copy(e.b),this.c.copy(e.c),this}getArea(){return eH.subVectors(this.c,this.b),eq.subVectors(this.a,this.b),.5*eH.cross(eq).length()}getMidpoint(e){return e.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(i){return e.getNormal(this.a,this.b,this.c,i)}getPlane(e){return e.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(i,r){return e.getBarycoord(i,this.a,this.b,this.c,r)}getInterpolation(i,r,n,s,a){return e.getInterpolation(i,this.a,this.b,this.c,r,n,s,a)}containsPoint(i){return e.containsPoint(i,this.a,this.b,this.c)}isFrontFacing(i){return e.isFrontFacing(this.a,this.b,this.c,i)}intersectsBox(e){return e.intersectsTriangle(this)}closestPointToPoint(e,i){let r=this.a,n=this.b,s=this.c,a,o;eX.subVectors(n,r),eY.subVectors(s,r),eK.subVectors(e,r);let l=eX.dot(eK),h=eY.dot(eK);if(l<=0&&h<=0)return i.copy(r);e$.subVectors(e,n);let u=eX.dot(e$),c=eY.dot(e$);if(u>=0&&c<=u)return i.copy(n);let d=l*c-u*h;if(d<=0&&l>=0&&u<=0)return a=l/(l-u),i.copy(r).addScaledVector(eX,a);eQ.subVectors(e,s);let p=eX.dot(eQ),f=eY.dot(eQ);if(f>=0&&p<=f)return i.copy(s);let m=p*h-l*f;if(m<=0&&h>=0&&f<=0)return o=h/(h-f),i.copy(r).addScaledVector(eY,o);let g=u*f-p*c;if(g<=0&&c-u>=0&&p-f>=0)return eZ.subVectors(s,n),o=(c-u)/(c-u+(p-f)),i.copy(n).addScaledVector(eZ,o);let y=1/(g+m+d);return a=m*y,o=d*y,i.copy(r).addScaledVector(eX,a).addScaledVector(eY,o)}equals(e){return e.a.equals(this.a)&&e.b.equals(this.b)&&e.c.equals(this.c)}},e1={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},e2={h:0,s:0,l:0},e3={h:0,s:0,l:0};function e4(e,i,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(i-e)*6*r:r<.5?i:r<2/3?e+(i-e)*6*(2/3-r):e}var e5=class{constructor(e,i,r){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(e,i,r)}set(e,i,r){return void 0===i&&void 0===r?e&&e.isColor?this.copy(e):"number"==typeof e?this.setHex(e):"string"==typeof e&&this.setStyle(e):this.setRGB(e,i,r),this}setScalar(e){return this.r=e,this.g=e,this.b=e,this}setHex(e,i=tp){return e=Math.floor(e),this.r=(e>>16&255)/255,this.g=(e>>8&255)/255,this.b=(255&e)/255,tF.toWorkingColorSpace(this,i),this}setRGB(e,i,r,n=tF.workingColorSpace){return this.r=e,this.g=i,this.b=r,tF.toWorkingColorSpace(this,n),this}setHSL(e,i,r,n=tF.workingColorSpace){if(e=(e%1+1)%1,i=tA(i,0,1),r=tA(r,0,1),0===i)this.r=this.g=this.b=r;else{let n=r<=.5?r*(1+i):r+i-r*i,s=2*r-n;this.r=e4(s,n,e+1/3),this.g=e4(s,n,e),this.b=e4(s,n,e-1/3)}return tF.toWorkingColorSpace(this,n),this}setStyle(e,i=tp){let r;function n(i){void 0!==i&&1>parseFloat(i)&&console.warn("THREE.Color: Alpha component of "+e+" will be ignored.")}if(r=/^(\w+)\(([^\)]*)\)/.exec(e)){let s,a=r[1],o=r[2];switch(a){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setRGB(Math.min(255,parseInt(s[1],10))/255,Math.min(255,parseInt(s[2],10))/255,Math.min(255,parseInt(s[3],10))/255,i);if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setRGB(Math.min(100,parseInt(s[1],10))/100,Math.min(100,parseInt(s[2],10))/100,Math.min(100,parseInt(s[3],10))/100,i);break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(o))return n(s[4]),this.setHSL(parseFloat(s[1])/360,parseFloat(s[2])/100,parseFloat(s[3])/100,i);break;default:console.warn("THREE.Color: Unknown color model "+e)}}else if(r=/^\#([A-Fa-f\d]+)$/.exec(e)){let n=r[1],s=n.length;if(3===s)return this.setRGB(parseInt(n.charAt(0),16)/15,parseInt(n.charAt(1),16)/15,parseInt(n.charAt(2),16)/15,i);if(6===s)return this.setHex(parseInt(n,16),i);console.warn("THREE.Color: Invalid hex color "+e)}else if(e&&e.length>0)return this.setColorName(e,i);return this}setColorName(e,i=tp){let r=e1[e.toLowerCase()];return void 0!==r?this.setHex(r,i):console.warn("THREE.Color: Unknown color "+e),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(e){return this.r=e.r,this.g=e.g,this.b=e.b,this}copySRGBToLinear(e){return this.r=tD(e.r),this.g=tD(e.g),this.b=tD(e.b),this}copyLinearToSRGB(e){return this.r=tU(e.r),this.g=tU(e.g),this.b=tU(e.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(e=tp){return tF.fromWorkingColorSpace(e6.copy(this),e),65536*Math.round(tA(255*e6.r,0,255))+256*Math.round(tA(255*e6.g,0,255))+Math.round(tA(255*e6.b,0,255))}getHexString(e=tp){return("000000"+this.getHex(e).toString(16)).slice(-6)}getHSL(e,i=tF.workingColorSpace){tF.fromWorkingColorSpace(e6.copy(this),i);let r=e6.r,n=e6.g,s=e6.b,a=Math.max(r,n,s),o=Math.min(r,n,s),l,h,u=(o+a)/2;if(o===a)l=0,h=0;else{let e=a-o;switch(h=u<=.5?e/(a+o):e/(2-a-o),a){case r:l=(n-s)/e+(n<s?6:0);break;case n:l=(s-r)/e+2;break;case s:l=(r-n)/e+4}l/=6}return e.h=l,e.s=h,e.l=u,e}getRGB(e,i=tF.workingColorSpace){return tF.fromWorkingColorSpace(e6.copy(this),i),e.r=e6.r,e.g=e6.g,e.b=e6.b,e}getStyle(e=tp){tF.fromWorkingColorSpace(e6.copy(this),e);let i=e6.r,r=e6.g,n=e6.b;return e!==tp?`color(${e} ${i.toFixed(3)} ${r.toFixed(3)} ${n.toFixed(3)})`:`rgb(${Math.round(255*i)},${Math.round(255*r)},${Math.round(255*n)})`}offsetHSL(e,i,r){return this.getHSL(e2),this.setHSL(e2.h+e,e2.s+i,e2.l+r)}add(e){return this.r+=e.r,this.g+=e.g,this.b+=e.b,this}addColors(e,i){return this.r=e.r+i.r,this.g=e.g+i.g,this.b=e.b+i.b,this}addScalar(e){return this.r+=e,this.g+=e,this.b+=e,this}sub(e){return this.r=Math.max(0,this.r-e.r),this.g=Math.max(0,this.g-e.g),this.b=Math.max(0,this.b-e.b),this}multiply(e){return this.r*=e.r,this.g*=e.g,this.b*=e.b,this}multiplyScalar(e){return this.r*=e,this.g*=e,this.b*=e,this}lerp(e,i){return this.r+=(e.r-this.r)*i,this.g+=(e.g-this.g)*i,this.b+=(e.b-this.b)*i,this}lerpColors(e,i,r){return this.r=e.r+(i.r-e.r)*r,this.g=e.g+(i.g-e.g)*r,this.b=e.b+(i.b-e.b)*r,this}lerpHSL(e,i){var r,n,s;this.getHSL(e2),e.getHSL(e3);let a=(r=e2.h,(1-i)*r+i*e3.h),o=(n=e2.s,(1-i)*n+i*e3.s),l=(s=e2.l,(1-i)*s+i*e3.l);return this.setHSL(a,o,l),this}setFromVector3(e){return this.r=e.x,this.g=e.y,this.b=e.z,this}applyMatrix3(e){let i=this.r,r=this.g,n=this.b,s=e.elements;return this.r=s[0]*i+s[3]*r+s[6]*n,this.g=s[1]*i+s[4]*r+s[7]*n,this.b=s[2]*i+s[5]*r+s[8]*n,this}equals(e){return e.r===this.r&&e.g===this.g&&e.b===this.b}fromArray(e,i=0){return this.r=e[i],this.g=e[i+1],this.b=e[i+2],this}toArray(e=[],i=0){return e[i]=this.r,e[i+1]=this.g,e[i+2]=this.b,e}fromBufferAttribute(e,i){return this.r=e.getX(i),this.g=e.getY(i),this.b=e.getZ(i),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}},e6=new e5;e5.NAMES=e1;var e9=0,e7=class extends t_{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:e9++}),this.uuid=tM(),this.name="",this.type="Material",this.blending=1,this.side=0,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=204,this.blendDst=205,this.blendEquation=100,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new e5(0,0,0),this.blendAlpha=0,this.depthFunc=3,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=519,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=7680,this.stencilZFail=7680,this.stencilZPass=7680,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(e){this._alphaTest>0!=e>0&&this.version++,this._alphaTest=e}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(e){if(void 0!==e)for(let i in e){let r=e[i];if(void 0===r){console.warn(`THREE.Material: parameter '${i}' has value of undefined.`);continue}let n=this[i];if(void 0===n){console.warn(`THREE.Material: '${i}' is not a property of THREE.${this.type}.`);continue}n&&n.isColor?n.set(r):n&&n.isVector3&&r&&r.isVector3?n.copy(r):this[i]=r}}toJSON(e){let i=void 0===e||"string"==typeof e;i&&(e={textures:{},images:{}});let r={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};function n(e){let i=[];for(let r in e){let n=e[r];delete n.metadata,i.push(n)}return i}if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),void 0!==this.sheen&&(r.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(r.sheenColor=this.sheenColor.getHex()),void 0!==this.sheenRoughness&&(r.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),void 0!==this.emissiveIntensity&&1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.specularIntensity&&(r.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(r.specularColor=this.specularColor.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearcoat&&(r.clearcoat=this.clearcoat),void 0!==this.clearcoatRoughness&&(r.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(r.clearcoatMap=this.clearcoatMap.toJSON(e).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(r.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(e).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(r.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(e).uuid,r.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),void 0!==this.dispersion&&(r.dispersion=this.dispersion),void 0!==this.iridescence&&(r.iridescence=this.iridescence),void 0!==this.iridescenceIOR&&(r.iridescenceIOR=this.iridescenceIOR),void 0!==this.iridescenceThicknessRange&&(r.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(r.iridescenceMap=this.iridescenceMap.toJSON(e).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(r.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(e).uuid),void 0!==this.anisotropy&&(r.anisotropy=this.anisotropy),void 0!==this.anisotropyRotation&&(r.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(r.anisotropyMap=this.anisotropyMap.toJSON(e).uuid),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(e).uuid),this.matcap&&this.matcap.isTexture&&(r.matcap=this.matcap.toJSON(e).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(e).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(e).uuid,r.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(r.aoMap=this.aoMap.toJSON(e).uuid,r.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(e).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(e).uuid,r.normalMapType=this.normalMapType,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(e).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(e).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(e).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(e).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(e).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(r.specularIntensityMap=this.specularIntensityMap.toJSON(e).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(r.specularColorMap=this.specularColorMap.toJSON(e).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(e).uuid,void 0!==this.combine&&(r.combine=this.combine)),void 0!==this.envMapRotation&&(r.envMapRotation=this.envMapRotation.toArray()),void 0!==this.envMapIntensity&&(r.envMapIntensity=this.envMapIntensity),void 0!==this.reflectivity&&(r.reflectivity=this.reflectivity),void 0!==this.refractionRatio&&(r.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(e).uuid),void 0!==this.transmission&&(r.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(r.transmissionMap=this.transmissionMap.toJSON(e).uuid),void 0!==this.thickness&&(r.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(r.thicknessMap=this.thicknessMap.toJSON(e).uuid),void 0!==this.attenuationDistance&&this.attenuationDistance!==1/0&&(r.attenuationDistance=this.attenuationDistance),void 0!==this.attenuationColor&&(r.attenuationColor=this.attenuationColor.getHex()),void 0!==this.size&&(r.size=this.size),null!==this.shadowSide&&(r.shadowSide=this.shadowSide),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),1!==this.blending&&(r.blending=this.blending),0!==this.side&&(r.side=this.side),!0===this.vertexColors&&(r.vertexColors=!0),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=!0),204!==this.blendSrc&&(r.blendSrc=this.blendSrc),205!==this.blendDst&&(r.blendDst=this.blendDst),100!==this.blendEquation&&(r.blendEquation=this.blendEquation),null!==this.blendSrcAlpha&&(r.blendSrcAlpha=this.blendSrcAlpha),null!==this.blendDstAlpha&&(r.blendDstAlpha=this.blendDstAlpha),null!==this.blendEquationAlpha&&(r.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(r.blendColor=this.blendColor.getHex()),0!==this.blendAlpha&&(r.blendAlpha=this.blendAlpha),3!==this.depthFunc&&(r.depthFunc=this.depthFunc),!1===this.depthTest&&(r.depthTest=this.depthTest),!1===this.depthWrite&&(r.depthWrite=this.depthWrite),!1===this.colorWrite&&(r.colorWrite=this.colorWrite),255!==this.stencilWriteMask&&(r.stencilWriteMask=this.stencilWriteMask),519!==this.stencilFunc&&(r.stencilFunc=this.stencilFunc),0!==this.stencilRef&&(r.stencilRef=this.stencilRef),255!==this.stencilFuncMask&&(r.stencilFuncMask=this.stencilFuncMask),7680!==this.stencilFail&&(r.stencilFail=this.stencilFail),7680!==this.stencilZFail&&(r.stencilZFail=this.stencilZFail),7680!==this.stencilZPass&&(r.stencilZPass=this.stencilZPass),!0===this.stencilWrite&&(r.stencilWrite=this.stencilWrite),void 0!==this.rotation&&0!==this.rotation&&(r.rotation=this.rotation),!0===this.polygonOffset&&(r.polygonOffset=!0),0!==this.polygonOffsetFactor&&(r.polygonOffsetFactor=this.polygonOffsetFactor),0!==this.polygonOffsetUnits&&(r.polygonOffsetUnits=this.polygonOffsetUnits),void 0!==this.linewidth&&1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.alphaHash&&(r.alphaHash=!0),!0===this.alphaToCoverage&&(r.alphaToCoverage=!0),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=!0),!0===this.forceSinglePass&&(r.forceSinglePass=!0),!0===this.wireframe&&(r.wireframe=!0),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.flatShading&&(r.flatShading=!0),!1===this.visible&&(r.visible=!1),!1===this.toneMapped&&(r.toneMapped=!1),!1===this.fog&&(r.fog=!1),Object.keys(this.userData).length>0&&(r.userData=this.userData),i){let i=n(e.textures),s=n(e.images);i.length>0&&(r.textures=i),s.length>0&&(r.images=s)}return r}clone(){return new this.constructor().copy(this)}copy(e){this.name=e.name,this.blending=e.blending,this.side=e.side,this.vertexColors=e.vertexColors,this.opacity=e.opacity,this.transparent=e.transparent,this.blendSrc=e.blendSrc,this.blendDst=e.blendDst,this.blendEquation=e.blendEquation,this.blendSrcAlpha=e.blendSrcAlpha,this.blendDstAlpha=e.blendDstAlpha,this.blendEquationAlpha=e.blendEquationAlpha,this.blendColor.copy(e.blendColor),this.blendAlpha=e.blendAlpha,this.depthFunc=e.depthFunc,this.depthTest=e.depthTest,this.depthWrite=e.depthWrite,this.stencilWriteMask=e.stencilWriteMask,this.stencilFunc=e.stencilFunc,this.stencilRef=e.stencilRef,this.stencilFuncMask=e.stencilFuncMask,this.stencilFail=e.stencilFail,this.stencilZFail=e.stencilZFail,this.stencilZPass=e.stencilZPass,this.stencilWrite=e.stencilWrite;let i=e.clippingPlanes,r=null;if(null!==i){let e=i.length;r=Array(e);for(let n=0;n!==e;++n)r[n]=i[n].clone()}return this.clippingPlanes=r,this.clipIntersection=e.clipIntersection,this.clipShadows=e.clipShadows,this.shadowSide=e.shadowSide,this.colorWrite=e.colorWrite,this.precision=e.precision,this.polygonOffset=e.polygonOffset,this.polygonOffsetFactor=e.polygonOffsetFactor,this.polygonOffsetUnits=e.polygonOffsetUnits,this.dithering=e.dithering,this.alphaTest=e.alphaTest,this.alphaHash=e.alphaHash,this.alphaToCoverage=e.alphaToCoverage,this.premultipliedAlpha=e.premultipliedAlpha,this.forceSinglePass=e.forceSinglePass,this.visible=e.visible,this.toneMapped=e.toneMapped,this.userData=JSON.parse(JSON.stringify(e.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(e){!0===e&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}onBeforeRender(){console.warn("Material: onBeforeRender() has been removed.")}},e8=class extends e7{constructor(e){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new e5(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new eT,this.combine=0,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.specularMap=e.specularMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.combine=e.combine,this.reflectivity=e.reflectivity,this.refractionRatio=e.refractionRatio,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.fog=e.fog,this}},it=new tZ,ie=new tP,ii=class{constructor(e,i,r=!1){if(Array.isArray(e))throw TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=e,this.itemSize=i,this.count=void 0!==e?e.length/i:0,this.normalized=r,this.usage=35044,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.gpuType=1015,this.version=0}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return tB("THREE.BufferAttribute: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,i){this.updateRanges.push({start:e,count:i})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.name=e.name,this.array=new e.array.constructor(e.array),this.itemSize=e.itemSize,this.count=e.count,this.normalized=e.normalized,this.usage=e.usage,this.gpuType=e.gpuType,this}copyAt(e,i,r){e*=this.itemSize,r*=i.itemSize;for(let n=0,s=this.itemSize;n<s;n++)this.array[e+n]=i.array[r+n];return this}copyArray(e){return this.array.set(e),this}applyMatrix3(e){if(2===this.itemSize)for(let i=0,r=this.count;i<r;i++)ie.fromBufferAttribute(this,i),ie.applyMatrix3(e),this.setXY(i,ie.x,ie.y);else if(3===this.itemSize)for(let i=0,r=this.count;i<r;i++)it.fromBufferAttribute(this,i),it.applyMatrix3(e),this.setXYZ(i,it.x,it.y,it.z);return this}applyMatrix4(e){for(let i=0,r=this.count;i<r;i++)it.fromBufferAttribute(this,i),it.applyMatrix4(e),this.setXYZ(i,it.x,it.y,it.z);return this}applyNormalMatrix(e){for(let i=0,r=this.count;i<r;i++)it.fromBufferAttribute(this,i),it.applyNormalMatrix(e),this.setXYZ(i,it.x,it.y,it.z);return this}transformDirection(e){for(let i=0,r=this.count;i<r;i++)it.fromBufferAttribute(this,i),it.transformDirection(e),this.setXYZ(i,it.x,it.y,it.z);return this}set(e,i=0){return this.array.set(e,i),this}getComponent(e,i){let r=this.array[e*this.itemSize+i];return this.normalized&&(r=tS(r,this.array)),r}setComponent(e,i,r){return this.normalized&&(r=tT(r,this.array)),this.array[e*this.itemSize+i]=r,this}getX(e){let i=this.array[e*this.itemSize];return this.normalized&&(i=tS(i,this.array)),i}setX(e,i){return this.normalized&&(i=tT(i,this.array)),this.array[e*this.itemSize]=i,this}getY(e){let i=this.array[e*this.itemSize+1];return this.normalized&&(i=tS(i,this.array)),i}setY(e,i){return this.normalized&&(i=tT(i,this.array)),this.array[e*this.itemSize+1]=i,this}getZ(e){let i=this.array[e*this.itemSize+2];return this.normalized&&(i=tS(i,this.array)),i}setZ(e,i){return this.normalized&&(i=tT(i,this.array)),this.array[e*this.itemSize+2]=i,this}getW(e){let i=this.array[e*this.itemSize+3];return this.normalized&&(i=tS(i,this.array)),i}setW(e,i){return this.normalized&&(i=tT(i,this.array)),this.array[e*this.itemSize+3]=i,this}setXY(e,i,r){return e*=this.itemSize,this.normalized&&(i=tT(i,this.array),r=tT(r,this.array)),this.array[e+0]=i,this.array[e+1]=r,this}setXYZ(e,i,r,n){return e*=this.itemSize,this.normalized&&(i=tT(i,this.array),r=tT(r,this.array),n=tT(n,this.array)),this.array[e+0]=i,this.array[e+1]=r,this.array[e+2]=n,this}setXYZW(e,i,r,n,s){return e*=this.itemSize,this.normalized&&(i=tT(i,this.array),r=tT(r,this.array),n=tT(n,this.array),s=tT(s,this.array)),this.array[e+0]=i,this.array[e+1]=r,this.array[e+2]=n,this.array[e+3]=s,this}onUpload(e){return this.onUploadCallback=e,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){let e={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return""!==this.name&&(e.name=this.name),35044!==this.usage&&(e.usage=this.usage),e}},ir=class extends ii{constructor(e,i,r){super(new Uint16Array(e),i,r)}},is=class extends ii{constructor(e,i,r){super(new Uint32Array(e),i,r)}},ia=class extends ii{constructor(e,i,r){super(new Float32Array(e),i,r)}},io=0,il=new eg,ih=new eW,iu=new tZ,ic=new tQ,id=new tQ,ip=new tZ,im=class e extends t_{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:io++}),this.uuid=tM(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(e){return Array.isArray(e)?this.index=new(!function(e){for(let i=e.length-1;i>=0;--i)if(e[i]>=65535)return!0;return!1}(e)?ir:is)(e,1):this.index=e,this}getAttribute(e){return this.attributes[e]}setAttribute(e,i){return this.attributes[e]=i,this}deleteAttribute(e){return delete this.attributes[e],this}hasAttribute(e){return void 0!==this.attributes[e]}addGroup(e,i,r=0){this.groups.push({start:e,count:i,materialIndex:r})}clearGroups(){this.groups=[]}setDrawRange(e,i){this.drawRange.start=e,this.drawRange.count=i}applyMatrix4(e){let i=this.attributes.position;void 0!==i&&(i.applyMatrix4(e),i.needsUpdate=!0);let r=this.attributes.normal;if(void 0!==r){let i=new tE().getNormalMatrix(e);r.applyNormalMatrix(i),r.needsUpdate=!0}let n=this.attributes.tangent;return void 0!==n&&(n.transformDirection(e),n.needsUpdate=!0),null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this}applyQuaternion(e){return il.makeRotationFromQuaternion(e),this.applyMatrix4(il),this}rotateX(e){return il.makeRotationX(e),this.applyMatrix4(il),this}rotateY(e){return il.makeRotationY(e),this.applyMatrix4(il),this}rotateZ(e){return il.makeRotationZ(e),this.applyMatrix4(il),this}translate(e,i,r){return il.makeTranslation(e,i,r),this.applyMatrix4(il),this}scale(e,i,r){return il.makeScale(e,i,r),this.applyMatrix4(il),this}lookAt(e){return ih.lookAt(e),ih.updateMatrix(),this.applyMatrix4(ih.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(iu).negate(),this.translate(iu.x,iu.y,iu.z),this}setFromPoints(e){let i=[];for(let r=0,n=e.length;r<n;r++){let n=e[r];i.push(n.x,n.y,n.z||0)}return this.setAttribute("position",new ia(i,3)),this}computeBoundingBox(){null===this.boundingBox&&(this.boundingBox=new tQ);let e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new tZ(-1/0,-1/0,-1/0),new tZ(1/0,1/0,1/0));return}if(void 0!==e){if(this.boundingBox.setFromBufferAttribute(e),i)for(let e=0,r=i.length;e<r;e++){let r=i[e];ic.setFromBufferAttribute(r),this.morphTargetsRelative?(ip.addVectors(this.boundingBox.min,ic.min),this.boundingBox.expandByPoint(ip),ip.addVectors(this.boundingBox.max,ic.max),this.boundingBox.expandByPoint(ip)):(this.boundingBox.expandByPoint(ic.min),this.boundingBox.expandByPoint(ic.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){null===this.boundingSphere&&(this.boundingSphere=new eo);let e=this.attributes.position,i=this.morphAttributes.position;if(e&&e.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new tZ,1/0);return}if(e){let r=this.boundingSphere.center;if(ic.setFromBufferAttribute(e),i)for(let e=0,r=i.length;e<r;e++){let r=i[e];id.setFromBufferAttribute(r),this.morphTargetsRelative?(ip.addVectors(ic.min,id.min),ic.expandByPoint(ip),ip.addVectors(ic.max,id.max),ic.expandByPoint(ip)):(ic.expandByPoint(id.min),ic.expandByPoint(id.max))}ic.getCenter(r);let n=0;for(let i=0,s=e.count;i<s;i++)ip.fromBufferAttribute(e,i),n=Math.max(n,r.distanceToSquared(ip));if(i)for(let s=0,a=i.length;s<a;s++){let a=i[s],o=this.morphTargetsRelative;for(let i=0,s=a.count;i<s;i++)ip.fromBufferAttribute(a,i),o&&(iu.fromBufferAttribute(e,i),ip.add(iu)),n=Math.max(n,r.distanceToSquared(ip))}this.boundingSphere.radius=Math.sqrt(n),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){let e=this.index,i=this.attributes;if(null===e||void 0===i.position||void 0===i.normal||void 0===i.uv){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}let r=i.position,n=i.normal,s=i.uv;!1===this.hasAttribute("tangent")&&this.setAttribute("tangent",new ii(new Float32Array(4*r.count),4));let a=this.getAttribute("tangent"),o=[],l=[];for(let e=0;e<r.count;e++)o[e]=new tZ,l[e]=new tZ;let h=new tZ,u=new tZ,c=new tZ,d=new tP,p=new tP,f=new tP,m=new tZ,g=new tZ,y=this.groups;0===y.length&&(y=[{start:0,count:e.count}]);for(let i=0,n=y.length;i<n;++i){let n=y[i],a=n.start,v=n.count;for(let i=a,n=a+v;i<n;i+=3)!function(e,i,n){h.fromBufferAttribute(r,e),u.fromBufferAttribute(r,i),c.fromBufferAttribute(r,n),d.fromBufferAttribute(s,e),p.fromBufferAttribute(s,i),f.fromBufferAttribute(s,n),u.sub(h),c.sub(h),p.sub(d),f.sub(d);let a=1/(p.x*f.y-f.x*p.y);isFinite(a)&&(m.copy(u).multiplyScalar(f.y).addScaledVector(c,-p.y).multiplyScalar(a),g.copy(c).multiplyScalar(p.x).addScaledVector(u,-f.x).multiplyScalar(a),o[e].add(m),o[i].add(m),o[n].add(m),l[e].add(g),l[i].add(g),l[n].add(g))}(e.getX(i+0),e.getX(i+1),e.getX(i+2))}let v=new tZ,_=new tZ,x=new tZ,b=new tZ;function w(e){x.fromBufferAttribute(n,e),b.copy(x);let i=o[e];v.copy(i),v.sub(x.multiplyScalar(x.dot(i))).normalize(),_.crossVectors(b,i);let r=0>_.dot(l[e])?-1:1;a.setXYZW(e,v.x,v.y,v.z,r)}for(let i=0,r=y.length;i<r;++i){let r=y[i],n=r.start,s=r.count;for(let i=n,r=n+s;i<r;i+=3)w(e.getX(i+0)),w(e.getX(i+1)),w(e.getX(i+2))}}computeVertexNormals(){let e=this.index,i=this.getAttribute("position");if(void 0!==i){let r=this.getAttribute("normal");if(void 0===r)r=new ii(new Float32Array(3*i.count),3),this.setAttribute("normal",r);else for(let e=0,i=r.count;e<i;e++)r.setXYZ(e,0,0,0);let n=new tZ,s=new tZ,a=new tZ,o=new tZ,l=new tZ,h=new tZ,u=new tZ,c=new tZ;if(e)for(let d=0,p=e.count;d<p;d+=3){let p=e.getX(d+0),f=e.getX(d+1),m=e.getX(d+2);n.fromBufferAttribute(i,p),s.fromBufferAttribute(i,f),a.fromBufferAttribute(i,m),u.subVectors(a,s),c.subVectors(n,s),u.cross(c),o.fromBufferAttribute(r,p),l.fromBufferAttribute(r,f),h.fromBufferAttribute(r,m),o.add(u),l.add(u),h.add(u),r.setXYZ(p,o.x,o.y,o.z),r.setXYZ(f,l.x,l.y,l.z),r.setXYZ(m,h.x,h.y,h.z)}else for(let e=0,o=i.count;e<o;e+=3)n.fromBufferAttribute(i,e+0),s.fromBufferAttribute(i,e+1),a.fromBufferAttribute(i,e+2),u.subVectors(a,s),c.subVectors(n,s),u.cross(c),r.setXYZ(e+0,u.x,u.y,u.z),r.setXYZ(e+1,u.x,u.y,u.z),r.setXYZ(e+2,u.x,u.y,u.z);this.normalizeNormals(),r.needsUpdate=!0}}normalizeNormals(){let e=this.attributes.normal;for(let i=0,r=e.count;i<r;i++)ip.fromBufferAttribute(e,i),ip.normalize(),e.setXYZ(i,ip.x,ip.y,ip.z)}toNonIndexed(){function i(e,i){let r=e.array,n=e.itemSize,s=e.normalized,a=new r.constructor(i.length*n),o=0,l=0;for(let s=0,h=i.length;s<h;s++){o=e.isInterleavedBufferAttribute?i[s]*e.data.stride+e.offset:i[s]*n;for(let e=0;e<n;e++)a[l++]=r[o++]}return new ii(a,n,s)}if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;let r=new e,n=this.index.array,s=this.attributes;for(let e in s){let a=i(s[e],n);r.setAttribute(e,a)}let a=this.morphAttributes;for(let e in a){let s=[],o=a[e];for(let e=0,r=o.length;e<r;e++){let r=i(o[e],n);s.push(r)}r.morphAttributes[e]=s}r.morphTargetsRelative=this.morphTargetsRelative;let o=this.groups;for(let e=0,i=o.length;e<i;e++){let i=o[e];r.addGroup(i.start,i.count,i.materialIndex)}return r}toJSON(){let e={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(e.uuid=this.uuid,e.type=this.type,""!==this.name&&(e.name=this.name),Object.keys(this.userData).length>0&&(e.userData=this.userData),void 0!==this.parameters){let i=this.parameters;for(let r in i)void 0!==i[r]&&(e[r]=i[r]);return e}e.data={attributes:{}};let i=this.index;null!==i&&(e.data.index={type:i.array.constructor.name,array:Array.prototype.slice.call(i.array)});let r=this.attributes;for(let i in r){let n=r[i];e.data.attributes[i]=n.toJSON(e.data)}let n={},s=!1;for(let i in this.morphAttributes){let r=this.morphAttributes[i],a=[];for(let i=0,n=r.length;i<n;i++){let n=r[i];a.push(n.toJSON(e.data))}a.length>0&&(n[i]=a,s=!0)}s&&(e.data.morphAttributes=n,e.data.morphTargetsRelative=this.morphTargetsRelative);let a=this.groups;a.length>0&&(e.data.groups=JSON.parse(JSON.stringify(a)));let o=this.boundingSphere;return null!==o&&(e.data.boundingSphere={center:o.center.toArray(),radius:o.radius}),e}clone(){return new this.constructor().copy(this)}copy(e){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;let i={};this.name=e.name;let r=e.index;null!==r&&this.setIndex(r.clone(i));let n=e.attributes;for(let e in n){let r=n[e];this.setAttribute(e,r.clone(i))}let s=e.morphAttributes;for(let e in s){let r=[],n=s[e];for(let e=0,s=n.length;e<s;e++)r.push(n[e].clone(i));this.morphAttributes[e]=r}this.morphTargetsRelative=e.morphTargetsRelative;let a=e.groups;for(let e=0,i=a.length;e<i;e++){let i=a[e];this.addGroup(i.start,i.count,i.materialIndex)}let o=e.boundingBox;null!==o&&(this.boundingBox=o.clone());let l=e.boundingSphere;return null!==l&&(this.boundingSphere=l.clone()),this.drawRange.start=e.drawRange.start,this.drawRange.count=e.drawRange.count,this.userData=e.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}},ig=new eg,iy=new em,iv=new eo,i_=new tZ,ix=new tZ,ib=new tZ,iw=new tZ,iM=new tZ,iA=new tZ,iS=new tP,iT=new tP,iC=new tP,iP=new tZ,iE=new tZ,iI=new tZ,iz=new tZ,iR=new tZ,iB=class extends eW{constructor(e=new im,i=new e8){super(),this.isMesh=!0,this.type="Mesh",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),void 0!==e.morphTargetInfluences&&(this.morphTargetInfluences=e.morphTargetInfluences.slice()),void 0!==e.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},e.morphTargetDictionary)),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}updateMorphTargets(){let e=this.geometry.morphAttributes,i=Object.keys(e);if(i.length>0){let r=e[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,i=r.length;e<i;e++){let i=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}}}getVertexPosition(e,i){let r=this.geometry,n=r.attributes.position,s=r.morphAttributes.position,a=r.morphTargetsRelative;i.fromBufferAttribute(n,e);let o=this.morphTargetInfluences;if(s&&o){iA.set(0,0,0);for(let r=0,n=s.length;r<n;r++){let n=o[r],l=s[r];0!==n&&(iM.fromBufferAttribute(l,e),a?iA.addScaledVector(iM,n):iA.addScaledVector(iM.sub(i),n))}i.add(iA)}return i}raycast(e,i){let r=this.geometry,n=this.material,s=this.matrixWorld;void 0===n||(null===r.boundingSphere&&r.computeBoundingSphere(),iv.copy(r.boundingSphere),iv.applyMatrix4(s),iy.copy(e.ray).recast(e.near),!1===iv.containsPoint(iy.origin)&&(null===iy.intersectSphere(iv,i_)||iy.origin.distanceToSquared(i_)>(e.far-e.near)**2)||(ig.copy(s).invert(),iy.copy(e.ray).applyMatrix4(ig),null!==r.boundingBox&&!1===iy.intersectsBox(r.boundingBox)||this._computeIntersections(e,i,iy)))}_computeIntersections(e,i,r){let n,s=this.geometry,a=this.material,o=s.index,l=s.attributes.position,h=s.attributes.uv,u=s.attributes.uv1,c=s.attributes.normal,d=s.groups,p=s.drawRange;if(null!==o){if(Array.isArray(a))for(let s=0,l=d.length;s<l;s++){let l=d[s],f=a[l.materialIndex],m=Math.max(l.start,p.start),g=Math.min(o.count,Math.min(l.start+l.count,p.start+p.count));for(let s=m;s<g;s+=3)(n=ik(this,f,e,r,h,u,c,o.getX(s),o.getX(s+1),o.getX(s+2)))&&(n.faceIndex=Math.floor(s/3),n.face.materialIndex=l.materialIndex,i.push(n))}else{let s=Math.max(0,p.start),l=Math.min(o.count,p.start+p.count);for(let d=s;d<l;d+=3)(n=ik(this,a,e,r,h,u,c,o.getX(d),o.getX(d+1),o.getX(d+2)))&&(n.faceIndex=Math.floor(d/3),i.push(n))}}else if(void 0!==l){if(Array.isArray(a))for(let s=0,o=d.length;s<o;s++){let o=d[s],f=a[o.materialIndex],m=Math.max(o.start,p.start),g=Math.min(l.count,Math.min(o.start+o.count,p.start+p.count));for(let s=m;s<g;s+=3)(n=ik(this,f,e,r,h,u,c,s,s+1,s+2))&&(n.faceIndex=Math.floor(s/3),n.face.materialIndex=o.materialIndex,i.push(n))}else{let s=Math.max(0,p.start),o=Math.min(l.count,p.start+p.count);for(let l=s;l<o;l+=3)(n=ik(this,a,e,r,h,u,c,l,l+1,l+2))&&(n.faceIndex=Math.floor(l/3),i.push(n))}}}};function ik(e,i,r,n,s,a,o,l,h,u){e.getVertexPosition(l,ix),e.getVertexPosition(h,ib),e.getVertexPosition(u,iw);let c=function(e,i,r,n,s,a,o,l){if(null===(1===i.side?n.intersectTriangle(o,a,s,!0,l):n.intersectTriangle(s,a,o,0===i.side,l)))return null;iR.copy(l),iR.applyMatrix4(e.matrixWorld);let h=r.ray.origin.distanceTo(iR);return h<r.near||h>r.far?null:{distance:h,point:iR.clone(),object:e}}(e,i,r,n,ix,ib,iw,iz);if(c){s&&(iS.fromBufferAttribute(s,l),iT.fromBufferAttribute(s,h),iC.fromBufferAttribute(s,u),c.uv=e0.getInterpolation(iz,ix,ib,iw,iS,iT,iC,new tP)),a&&(iS.fromBufferAttribute(a,l),iT.fromBufferAttribute(a,h),iC.fromBufferAttribute(a,u),c.uv1=e0.getInterpolation(iz,ix,ib,iw,iS,iT,iC,new tP)),o&&(iP.fromBufferAttribute(o,l),iE.fromBufferAttribute(o,h),iI.fromBufferAttribute(o,u),c.normal=e0.getInterpolation(iz,ix,ib,iw,iP,iE,iI,new tZ),c.normal.dot(n.direction)>0&&c.normal.multiplyScalar(-1));let e={a:l,b:h,c:u,normal:new tZ,materialIndex:0};e0.getNormal(ix,ib,iw,e.normal),c.face=e}return c}function iO(e){let i={};for(let r=0;r<e.length;r++){let n=function(e){let i={};for(let r in e)for(let n in i[r]={},e[r]){let s=e[r][n];s&&(s.isColor||s.isMatrix3||s.isMatrix4||s.isVector2||s.isVector3||s.isVector4||s.isTexture||s.isQuaternion)?s.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),i[r][n]=null):i[r][n]=s.clone():Array.isArray(s)?i[r][n]=s.slice():i[r][n]=s}return i}(e[r]);for(let e in n)i[e]=n[e]}return i}var iL=class extends eW{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new eg,this.projectionMatrix=new eg,this.projectionMatrixInverse=new eg,this.coordinateSystem=2e3}copy(e,i){return super.copy(e,i),this.matrixWorldInverse.copy(e.matrixWorldInverse),this.projectionMatrix.copy(e.projectionMatrix),this.projectionMatrixInverse.copy(e.projectionMatrixInverse),this.coordinateSystem=e.coordinateSystem,this}getWorldDirection(e){return super.getWorldDirection(e).negate()}updateMatrixWorld(e){super.updateMatrixWorld(e),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(e,i){super.updateWorldMatrix(e,i),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}},iN=new tZ,iF=new tP,iD=new tP,iU=class extends iL{constructor(e=50,i=1,r=.1,n=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=e,this.zoom=1,this.near=r,this.far=n,this.focus=10,this.aspect=i,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.fov=e.fov,this.zoom=e.zoom,this.near=e.near,this.far=e.far,this.focus=e.focus,this.aspect=e.aspect,this.view=null===e.view?null:Object.assign({},e.view),this.filmGauge=e.filmGauge,this.filmOffset=e.filmOffset,this}setFocalLength(e){let i=.5*this.getFilmHeight()/e;this.fov=2*tw*Math.atan(i),this.updateProjectionMatrix()}getFocalLength(){let e=Math.tan(.5*tb*this.fov);return .5*this.getFilmHeight()/e}getEffectiveFOV(){return 2*tw*Math.atan(Math.tan(.5*tb*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(e,i,r){iN.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),i.set(iN.x,iN.y).multiplyScalar(-e/iN.z),iN.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(iN.x,iN.y).multiplyScalar(-e/iN.z)}getViewSize(e,i){return this.getViewBounds(e,iF,iD),i.subVectors(iD,iF)}setViewOffset(e,i,r,n,s,a){this.aspect=e/i,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=r,this.view.offsetY=n,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=this.near,i=e*Math.tan(.5*tb*this.fov)/this.zoom,r=2*i,n=this.aspect*r,s=-.5*n,a=this.view;if(null!==this.view&&this.view.enabled){let e=a.fullWidth,o=a.fullHeight;s+=a.offsetX*n/e,i-=a.offsetY*r/o,n*=a.width/e,r*=a.height/o}let o=this.filmOffset;0!==o&&(s+=e*o/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+n,i,i-r,e,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let i=super.toJSON(e);return i.object.fov=this.fov,i.object.zoom=this.zoom,i.object.near=this.near,i.object.far=this.far,i.object.focus=this.focus,i.object.aspect=this.aspect,null!==this.view&&(i.object.view=Object.assign({},this.view)),i.object.filmGauge=this.filmGauge,i.object.filmOffset=this.filmOffset,i}},ij=new tZ,iV=new tZ,iW=new tE,iH=class{constructor(e=new tZ(1,0,0),i=0){this.isPlane=!0,this.normal=e,this.constant=i}set(e,i){return this.normal.copy(e),this.constant=i,this}setComponents(e,i,r,n){return this.normal.set(e,i,r),this.constant=n,this}setFromNormalAndCoplanarPoint(e,i){return this.normal.copy(e),this.constant=-i.dot(this.normal),this}setFromCoplanarPoints(e,i,r){let n=ij.subVectors(r,i).cross(iV.subVectors(e,i)).normalize();return this.setFromNormalAndCoplanarPoint(n,e),this}copy(e){return this.normal.copy(e.normal),this.constant=e.constant,this}normalize(){let e=1/this.normal.length();return this.normal.multiplyScalar(e),this.constant*=e,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(e){return this.normal.dot(e)+this.constant}distanceToSphere(e){return this.distanceToPoint(e.center)-e.radius}projectPoint(e,i){return i.copy(e).addScaledVector(this.normal,-this.distanceToPoint(e))}intersectLine(e,i){let r=e.delta(ij),n=this.normal.dot(r);if(0===n)return 0===this.distanceToPoint(e.start)?i.copy(e.start):null;let s=-(e.start.dot(this.normal)+this.constant)/n;return s<0||s>1?null:i.copy(e.start).addScaledVector(r,s)}intersectsLine(e){let i=this.distanceToPoint(e.start),r=this.distanceToPoint(e.end);return i<0&&r>0||r<0&&i>0}intersectsBox(e){return e.intersectsPlane(this)}intersectsSphere(e){return e.intersectsPlane(this)}coplanarPoint(e){return e.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(e,i){let r=i||iW.getNormalMatrix(e),n=this.coplanarPoint(ij).applyMatrix4(e),s=this.normal.applyMatrix3(r).normalize();return this.constant=-n.dot(s),this}translate(e){return this.constant-=e.dot(this.normal),this}equals(e){return e.normal.equals(this.normal)&&e.constant===this.constant}clone(){return new this.constructor().copy(this)}},iq=new eo,iG=new tZ,iJ=class{constructor(e=new iH,i=new iH,r=new iH,n=new iH,s=new iH,a=new iH){this.planes=[e,i,r,n,s,a]}set(e,i,r,n,s,a){let o=this.planes;return o[0].copy(e),o[1].copy(i),o[2].copy(r),o[3].copy(n),o[4].copy(s),o[5].copy(a),this}copy(e){let i=this.planes;for(let r=0;r<6;r++)i[r].copy(e.planes[r]);return this}setFromProjectionMatrix(e,i=2e3){let r=this.planes,n=e.elements,s=n[0],a=n[1],o=n[2],l=n[3],h=n[4],u=n[5],c=n[6],d=n[7],p=n[8],f=n[9],m=n[10],g=n[11],y=n[12],v=n[13],_=n[14],x=n[15];if(r[0].setComponents(l-s,d-h,g-p,x-y).normalize(),r[1].setComponents(l+s,d+h,g+p,x+y).normalize(),r[2].setComponents(l+a,d+u,g+f,x+v).normalize(),r[3].setComponents(l-a,d-u,g-f,x-v).normalize(),r[4].setComponents(l-o,d-c,g-m,x-_).normalize(),2e3===i)r[5].setComponents(l+o,d+c,g+m,x+_).normalize();else if(2001===i)r[5].setComponents(o,c,m,_).normalize();else throw Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+i);return this}intersectsObject(e){if(void 0!==e.boundingSphere)null===e.boundingSphere&&e.computeBoundingSphere(),iq.copy(e.boundingSphere).applyMatrix4(e.matrixWorld);else{let i=e.geometry;null===i.boundingSphere&&i.computeBoundingSphere(),iq.copy(i.boundingSphere).applyMatrix4(e.matrixWorld)}return this.intersectsSphere(iq)}intersectsSprite(e){return iq.center.set(0,0,0),iq.radius=.7071067811865476,iq.applyMatrix4(e.matrixWorld),this.intersectsSphere(iq)}intersectsSphere(e){let i=this.planes,r=e.center,n=-e.radius;for(let e=0;e<6;e++)if(i[e].distanceToPoint(r)<n)return!1;return!0}intersectsBox(e){let i=this.planes;for(let r=0;r<6;r++){let n=i[r];if(iG.x=n.normal.x>0?e.max.x:e.min.x,iG.y=n.normal.y>0?e.max.y:e.min.y,iG.z=n.normal.z>0?e.max.z:e.min.z,0>n.distanceToPoint(iG))return!1}return!0}containsPoint(e){let i=this.planes;for(let r=0;r<6;r++)if(0>i[r].distanceToPoint(e))return!1;return!0}clone(){return new this.constructor().copy(this)}},iX=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,iY=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,iZ=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,iK=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,i$=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,iQ=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,i0=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,i1=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,i2=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,i3=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,i4=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,i5=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,i6=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,i9=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,i7=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,i8=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rt=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,re=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ri=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,rr=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rn=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,rs=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,ra=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,ro=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rl=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,rh=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,ru=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,rc=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,rd=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,rp=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,rf=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,rm=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,rg=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,ry=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,rv={common:{diffuse:{value:new e5(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new tE},alphaMap:{value:null},alphaMapTransform:{value:new tE},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new tE}},envmap:{envMap:{value:null},envMapRotation:{value:new tE},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new tE}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new tE}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new tE},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new tE},normalScale:{value:new tP(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new tE},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new tE}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new tE}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new tE}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new e5(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new e5(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new tE},alphaTest:{value:0},uvTransform:{value:new tE}},sprite:{diffuse:{value:new e5(16777215)},opacity:{value:1},center:{value:new tP(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new tE},alphaMap:{value:null},alphaMapTransform:{value:new tE},alphaTest:{value:0}}},r_={basic:{uniforms:iO([rv.common,rv.specularmap,rv.envmap,rv.aomap,rv.lightmap,rv.fog]),vertexShader:i7,fragmentShader:i8},lambert:{uniforms:iO([rv.common,rv.specularmap,rv.envmap,rv.aomap,rv.lightmap,rv.emissivemap,rv.bumpmap,rv.normalmap,rv.displacementmap,rv.fog,rv.lights,{emissive:{value:new e5(0)}}]),vertexShader:rt,fragmentShader:re},phong:{uniforms:iO([rv.common,rv.specularmap,rv.envmap,rv.aomap,rv.lightmap,rv.emissivemap,rv.bumpmap,rv.normalmap,rv.displacementmap,rv.fog,rv.lights,{emissive:{value:new e5(0)},specular:{value:new e5(1118481)},shininess:{value:30}}]),vertexShader:ra,fragmentShader:ro},standard:{uniforms:iO([rv.common,rv.envmap,rv.aomap,rv.lightmap,rv.emissivemap,rv.bumpmap,rv.normalmap,rv.displacementmap,rv.roughnessmap,rv.metalnessmap,rv.fog,rv.lights,{emissive:{value:new e5(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:rl,fragmentShader:rh},toon:{uniforms:iO([rv.common,rv.aomap,rv.lightmap,rv.emissivemap,rv.bumpmap,rv.normalmap,rv.displacementmap,rv.gradientmap,rv.fog,rv.lights,{emissive:{value:new e5(0)}}]),vertexShader:ru,fragmentShader:rc},matcap:{uniforms:iO([rv.common,rv.bumpmap,rv.normalmap,rv.displacementmap,rv.fog,{matcap:{value:null}}]),vertexShader:ri,fragmentShader:rr},points:{uniforms:iO([rv.points,rv.fog]),vertexShader:rd,fragmentShader:rp},dashed:{uniforms:iO([rv.common,rv.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:i6,fragmentShader:i9},depth:{uniforms:iO([rv.common,rv.displacementmap]),vertexShader:i0,fragmentShader:i1},normal:{uniforms:iO([rv.common,rv.bumpmap,rv.normalmap,rv.displacementmap,{opacity:{value:1}}]),vertexShader:rn,fragmentShader:rs},sprite:{uniforms:iO([rv.sprite,rv.fog]),vertexShader:rg,fragmentShader:ry},background:{uniforms:{uvTransform:{value:new tE},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:iX,fragmentShader:iY},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new tE}},vertexShader:iZ,fragmentShader:iK},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:i$,fragmentShader:iQ},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:i4,fragmentShader:i5},distanceRGBA:{uniforms:iO([rv.common,rv.displacementmap,{referencePosition:{value:new tZ},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:i2,fragmentShader:i3},shadow:{uniforms:iO([rv.lights,rv.fog,{color:{value:new e5(0)},opacity:{value:1}}]),vertexShader:rf,fragmentShader:rm}};r_.physical={uniforms:iO([r_.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new tE},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new tE},clearcoatNormalScale:{value:new tP(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new tE},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new tE},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new tE},sheen:{value:0},sheenColor:{value:new e5(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new tE},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new tE},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new tE},transmissionSamplerSize:{value:new tP},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new tE},attenuationDistance:{value:0},attenuationColor:{value:new e5(0)},specularColor:{value:new e5(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new tE},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new tE},anisotropyVector:{value:new tP},anisotropyMap:{value:null},anisotropyMapTransform:{value:new tE}}]),vertexShader:rl,fragmentShader:rh};var rx=class extends iL{constructor(e=-1,i=1,r=1,n=-1,s=.1,a=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=e,this.right=i,this.top=r,this.bottom=n,this.near=s,this.far=a,this.updateProjectionMatrix()}copy(e,i){return super.copy(e,i),this.left=e.left,this.right=e.right,this.top=e.top,this.bottom=e.bottom,this.near=e.near,this.far=e.far,this.zoom=e.zoom,this.view=null===e.view?null:Object.assign({},e.view),this}setViewOffset(e,i,r,n,s,a){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=e,this.view.fullHeight=i,this.view.offsetX=r,this.view.offsetY=n,this.view.width=s,this.view.height=a,this.updateProjectionMatrix()}clearViewOffset(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){let e=(this.right-this.left)/(2*this.zoom),i=(this.top-this.bottom)/(2*this.zoom),r=(this.right+this.left)/2,n=(this.top+this.bottom)/2,s=r-e,a=r+e,o=n+i,l=n-i;if(null!==this.view&&this.view.enabled){let e=(this.right-this.left)/this.view.fullWidth/this.zoom,i=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=e*this.view.offsetX,a=s+e*this.view.width,o-=i*this.view.offsetY,l=o-i*this.view.height}this.projectionMatrix.makeOrthographic(s,a,o,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(e){let i=super.toJSON(e);return i.object.zoom=this.zoom,i.object.left=this.left,i.object.right=this.right,i.object.top=this.top,i.object.bottom=this.bottom,i.object.near=this.near,i.object.far=this.far,null!==this.view&&(i.object.view=Object.assign({},this.view)),i}},rb=(1+Math.sqrt(5))/2,rw=1/rb;new tZ(-rb,rw,0),new tZ(rb,rw,0),new tZ(-rw,0,rb),new tZ(rw,0,rb),new tZ(0,rb,-rw),new tZ(0,rb,rw),new tZ(-1,1,-1),new tZ(1,1,-1),new tZ(-1,1,1),new tZ(1,1,1);var rM,rA=class extends eW{constructor(){super(),this.isGroup=!0,this.type="Group"}},rS=class{constructor(e,i){this.isInterleavedBuffer=!0,this.array=e,this.stride=i,this.count=void 0!==e?e.length/i:0,this.usage=35044,this._updateRange={offset:0,count:-1},this.updateRanges=[],this.version=0,this.uuid=tM()}onUploadCallback(){}set needsUpdate(e){!0===e&&this.version++}get updateRange(){return tB("THREE.InterleavedBuffer: updateRange() is deprecated and will be removed in r169. Use addUpdateRange() instead."),this._updateRange}setUsage(e){return this.usage=e,this}addUpdateRange(e,i){this.updateRanges.push({start:e,count:i})}clearUpdateRanges(){this.updateRanges.length=0}copy(e){return this.array=new e.array.constructor(e.array),this.count=e.count,this.stride=e.stride,this.usage=e.usage,this}copyAt(e,i,r){e*=this.stride,r*=i.stride;for(let n=0,s=this.stride;n<s;n++)this.array[e+n]=i.array[r+n];return this}set(e,i=0){return this.array.set(e,i),this}clone(e){void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=tM()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);let i=new this.array.constructor(e.arrayBuffers[this.array.buffer._uuid]),r=new this.constructor(i,this.stride);return r.setUsage(this.usage),r}onUpload(e){return this.onUploadCallback=e,this}toJSON(e){return void 0===e.arrayBuffers&&(e.arrayBuffers={}),void 0===this.array.buffer._uuid&&(this.array.buffer._uuid=tM()),void 0===e.arrayBuffers[this.array.buffer._uuid]&&(e.arrayBuffers[this.array.buffer._uuid]=Array.from(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}},rT=new tZ,rC=class e{constructor(e,i,r,n=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=e,this.itemSize=i,this.offset=r,this.normalized=n}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(e){this.data.needsUpdate=e}applyMatrix4(e){for(let i=0,r=this.data.count;i<r;i++)rT.fromBufferAttribute(this,i),rT.applyMatrix4(e),this.setXYZ(i,rT.x,rT.y,rT.z);return this}applyNormalMatrix(e){for(let i=0,r=this.count;i<r;i++)rT.fromBufferAttribute(this,i),rT.applyNormalMatrix(e),this.setXYZ(i,rT.x,rT.y,rT.z);return this}transformDirection(e){for(let i=0,r=this.count;i<r;i++)rT.fromBufferAttribute(this,i),rT.transformDirection(e),this.setXYZ(i,rT.x,rT.y,rT.z);return this}getComponent(e,i){let r=this.array[e*this.data.stride+this.offset+i];return this.normalized&&(r=tS(r,this.array)),r}setComponent(e,i,r){return this.normalized&&(r=tT(r,this.array)),this.data.array[e*this.data.stride+this.offset+i]=r,this}setX(e,i){return this.normalized&&(i=tT(i,this.array)),this.data.array[e*this.data.stride+this.offset]=i,this}setY(e,i){return this.normalized&&(i=tT(i,this.array)),this.data.array[e*this.data.stride+this.offset+1]=i,this}setZ(e,i){return this.normalized&&(i=tT(i,this.array)),this.data.array[e*this.data.stride+this.offset+2]=i,this}setW(e,i){return this.normalized&&(i=tT(i,this.array)),this.data.array[e*this.data.stride+this.offset+3]=i,this}getX(e){let i=this.data.array[e*this.data.stride+this.offset];return this.normalized&&(i=tS(i,this.array)),i}getY(e){let i=this.data.array[e*this.data.stride+this.offset+1];return this.normalized&&(i=tS(i,this.array)),i}getZ(e){let i=this.data.array[e*this.data.stride+this.offset+2];return this.normalized&&(i=tS(i,this.array)),i}getW(e){let i=this.data.array[e*this.data.stride+this.offset+3];return this.normalized&&(i=tS(i,this.array)),i}setXY(e,i,r){return e=e*this.data.stride+this.offset,this.normalized&&(i=tT(i,this.array),r=tT(r,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=r,this}setXYZ(e,i,r,n){return e=e*this.data.stride+this.offset,this.normalized&&(i=tT(i,this.array),r=tT(r,this.array),n=tT(n,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=r,this.data.array[e+2]=n,this}setXYZW(e,i,r,n,s){return e=e*this.data.stride+this.offset,this.normalized&&(i=tT(i,this.array),r=tT(r,this.array),n=tT(n,this.array),s=tT(s,this.array)),this.data.array[e+0]=i,this.data.array[e+1]=r,this.data.array[e+2]=n,this.data.array[e+3]=s,this}clone(i){if(void 0!==i)return void 0===i.interleavedBuffers&&(i.interleavedBuffers={}),void 0===i.interleavedBuffers[this.data.uuid]&&(i.interleavedBuffers[this.data.uuid]=this.data.clone(i)),new e(i.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized);{console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let i=0;i<this.count;i++){let r=i*this.data.stride+this.offset;for(let i=0;i<this.itemSize;i++)e.push(this.data.array[r+i])}return new ii(new this.array.constructor(e),this.itemSize,this.normalized)}}toJSON(e){if(void 0!==e)return void 0===e.interleavedBuffers&&(e.interleavedBuffers={}),void 0===e.interleavedBuffers[this.data.uuid]&&(e.interleavedBuffers[this.data.uuid]=this.data.toJSON(e)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized};{console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interleaved buffer attribute will de-interleave buffer data.");let e=[];for(let i=0;i<this.count;i++){let r=i*this.data.stride+this.offset;for(let i=0;i<this.itemSize;i++)e.push(this.data.array[r+i])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:e,normalized:this.normalized}}}},rP=class extends e7{constructor(e){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new e5(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.rotation=e.rotation,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},rE=new tZ,rI=new tZ,rz=new tZ,rR=new tP,rB=new tP,rk=new eg,rO=new tZ,rL=new tZ,rN=new tZ,rF=new tP,rD=new tP,rU=new tP,rj=class extends eW{constructor(e=new rP){if(super(),this.isSprite=!0,this.type="Sprite",void 0===rM){rM=new im;let e=new rS(new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),5);rM.setIndex([0,1,2,0,2,3]),rM.setAttribute("position",new rC(e,3,0,!1)),rM.setAttribute("uv",new rC(e,2,3,!1))}this.geometry=rM,this.material=e,this.center=new tP(.5,.5)}raycast(e,i){null===e.camera&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),rI.setFromMatrixScale(this.matrixWorld),rk.copy(e.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(e.camera.matrixWorldInverse,this.matrixWorld),rz.setFromMatrixPosition(this.modelViewMatrix),e.camera.isPerspectiveCamera&&!1===this.material.sizeAttenuation&&rI.multiplyScalar(-rz.z);let r=this.material.rotation,n,s;0!==r&&(s=Math.cos(r),n=Math.sin(r));let a=this.center;rV(rO.set(-.5,-.5,0),rz,a,rI,n,s),rV(rL.set(.5,-.5,0),rz,a,rI,n,s),rV(rN.set(.5,.5,0),rz,a,rI,n,s),rF.set(0,0),rD.set(1,0),rU.set(1,1);let o=e.ray.intersectTriangle(rO,rL,rN,!1,rE);if(null===o&&(rV(rL.set(-.5,.5,0),rz,a,rI,n,s),rD.set(0,1),null===(o=e.ray.intersectTriangle(rO,rN,rL,!1,rE))))return;let l=e.ray.origin.distanceTo(rE);l<e.near||l>e.far||i.push({distance:l,point:rE.clone(),uv:e0.getInterpolation(rE,rO,rL,rN,rF,rD,rU,new tP),face:null,object:this})}copy(e,i){return super.copy(e,i),void 0!==e.center&&this.center.copy(e.center),this.material=e.material,this}};function rV(e,i,r,n,s,a){rR.subVectors(e,r).addScalar(.5).multiply(n),void 0!==s?(rB.x=a*rR.x-s*rR.y,rB.y=s*rR.x+a*rR.y):rB.copy(rR),e.copy(i),e.x+=rB.x,e.y+=rB.y,e.applyMatrix4(rk)}var rW=new tZ,rH=new tX,rq=new tX,rG=new tZ,rJ=new eg,rX=new tZ,rY=new eo,rZ=new eg,rK=new em,r$=class extends iB{constructor(e,i){super(e,i),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode=td,this.bindMatrix=new eg,this.bindMatrixInverse=new eg,this.boundingBox=null,this.boundingSphere=null}computeBoundingBox(){let e=this.geometry;null===this.boundingBox&&(this.boundingBox=new tQ),this.boundingBox.makeEmpty();let i=e.getAttribute("position");for(let e=0;e<i.count;e++)this.getVertexPosition(e,rX),this.boundingBox.expandByPoint(rX)}computeBoundingSphere(){let e=this.geometry;null===this.boundingSphere&&(this.boundingSphere=new eo),this.boundingSphere.makeEmpty();let i=e.getAttribute("position");for(let e=0;e<i.count;e++)this.getVertexPosition(e,rX),this.boundingSphere.expandByPoint(rX)}copy(e,i){return super.copy(e,i),this.bindMode=e.bindMode,this.bindMatrix.copy(e.bindMatrix),this.bindMatrixInverse.copy(e.bindMatrixInverse),this.skeleton=e.skeleton,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}raycast(e,i){let r=this.material,n=this.matrixWorld;void 0===r||(null===this.boundingSphere&&this.computeBoundingSphere(),rY.copy(this.boundingSphere),rY.applyMatrix4(n),!1===e.ray.intersectsSphere(rY)||(rZ.copy(n).invert(),rK.copy(e.ray).applyMatrix4(rZ),null!==this.boundingBox&&!1===rK.intersectsBox(this.boundingBox)||this._computeIntersections(e,i,rK)))}getVertexPosition(e,i){return super.getVertexPosition(e,i),this.applyBoneTransform(e,i),i}bind(e,i){this.skeleton=e,void 0===i&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),i=this.matrixWorld),this.bindMatrix.copy(i),this.bindMatrixInverse.copy(i).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){let e=new tX,i=this.geometry.attributes.skinWeight;for(let r=0,n=i.count;r<n;r++){e.fromBufferAttribute(i,r);let n=1/e.manhattanLength();n!==1/0?e.multiplyScalar(n):e.set(1,0,0,0),i.setXYZW(r,e.x,e.y,e.z,e.w)}}updateMatrixWorld(e){super.updateMatrixWorld(e),this.bindMode===td?this.bindMatrixInverse.copy(this.matrixWorld).invert():"detached"===this.bindMode?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}applyBoneTransform(e,i){let r=this.skeleton,n=this.geometry;rH.fromBufferAttribute(n.attributes.skinIndex,e),rq.fromBufferAttribute(n.attributes.skinWeight,e),rW.copy(i).applyMatrix4(this.bindMatrix),i.set(0,0,0);for(let e=0;e<4;e++){let n=rq.getComponent(e);if(0!==n){let s=rH.getComponent(e);rJ.multiplyMatrices(r.bones[s].matrixWorld,r.boneInverses[s]),i.addScaledVector(rG.copy(rW).applyMatrix4(rJ),n)}}return i.applyMatrix4(this.bindMatrixInverse)}},rQ=class extends eW{constructor(){super(),this.isBone=!0,this.type="Bone"}},r0=class extends tJ{constructor(e=null,i=1,r=1,n,s,a,o,l,h=1003,u=1003,c,d){super(null,a,o,l,h,u,n,s,c,d),this.isDataTexture=!0,this.image={data:e,width:i,height:r},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}},r1=new eg,r2=new eg,r3=class e{constructor(e=[],i=[]){this.uuid=tM(),this.bones=e.slice(0),this.boneInverses=i,this.boneMatrices=null,this.boneTexture=null,this.init()}init(){let e=this.bones,i=this.boneInverses;if(this.boneMatrices=new Float32Array(16*e.length),0===i.length)this.calculateInverses();else if(e.length!==i.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let e=0,i=this.bones.length;e<i;e++)this.boneInverses.push(new eg)}}calculateInverses(){this.boneInverses.length=0;for(let e=0,i=this.bones.length;e<i;e++){let i=new eg;this.bones[e]&&i.copy(this.bones[e].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let e=0,i=this.bones.length;e<i;e++){let i=this.bones[e];i&&i.matrixWorld.copy(this.boneInverses[e]).invert()}for(let e=0,i=this.bones.length;e<i;e++){let i=this.bones[e];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){let e=this.bones,i=this.boneInverses,r=this.boneMatrices,n=this.boneTexture;for(let n=0,s=e.length;n<s;n++){let s=e[n]?e[n].matrixWorld:r2;r1.multiplyMatrices(s,i[n]),r1.toArray(r,16*n)}null!==n&&(n.needsUpdate=!0)}clone(){return new e(this.bones,this.boneInverses)}computeBoneTexture(){let e=Math.sqrt(4*this.bones.length),i=new Float32Array((e=Math.max(e=4*Math.ceil(e/4),4))*e*4);i.set(this.boneMatrices);let r=new r0(i,e,e,1023,1015);return r.needsUpdate=!0,this.boneMatrices=i,this.boneTexture=r,this}getBoneByName(e){for(let i=0,r=this.bones.length;i<r;i++){let r=this.bones[i];if(r.name===e)return r}}dispose(){null!==this.boneTexture&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(e,i){this.uuid=e.uuid;for(let r=0,n=e.bones.length;r<n;r++){let n=e.bones[r],s=i[n];void 0===s&&(console.warn("THREE.Skeleton: No bone found with UUID:",n),s=new rQ),this.bones.push(s),this.boneInverses.push(new eg().fromArray(e.boneInverses[r]))}return this.init(),this}toJSON(){let e={metadata:{version:4.6,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};e.uuid=this.uuid;let i=this.bones,r=this.boneInverses;for(let n=0,s=i.length;n<s;n++){let s=i[n];e.bones.push(s.uuid);let a=r[n];e.boneInverses.push(a.toArray())}return e}},r4=class extends ii{constructor(e,i,r,n=1){super(e,i,r),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=n}copy(e){return super.copy(e),this.meshPerAttribute=e.meshPerAttribute,this}toJSON(){let e=super.toJSON();return e.meshPerAttribute=this.meshPerAttribute,e.isInstancedBufferAttribute=!0,e}},r5=new eg,r6=new eg,r9=[],r7=new tQ,r8=new eg,nt=new iB,ne=new eo,ni=class extends iB{constructor(e,i,r){super(e,i),this.isInstancedMesh=!0,this.instanceMatrix=new r4(new Float32Array(16*r),16),this.instanceColor=null,this.morphTexture=null,this.count=r,this.boundingBox=null,this.boundingSphere=null;for(let e=0;e<r;e++)this.setMatrixAt(e,r8)}computeBoundingBox(){let e=this.geometry,i=this.count;null===this.boundingBox&&(this.boundingBox=new tQ),null===e.boundingBox&&e.computeBoundingBox(),this.boundingBox.makeEmpty();for(let r=0;r<i;r++)this.getMatrixAt(r,r5),r7.copy(e.boundingBox).applyMatrix4(r5),this.boundingBox.union(r7)}computeBoundingSphere(){let e=this.geometry,i=this.count;null===this.boundingSphere&&(this.boundingSphere=new eo),null===e.boundingSphere&&e.computeBoundingSphere(),this.boundingSphere.makeEmpty();for(let r=0;r<i;r++)this.getMatrixAt(r,r5),ne.copy(e.boundingSphere).applyMatrix4(r5),this.boundingSphere.union(ne)}copy(e,i){return super.copy(e,i),this.instanceMatrix.copy(e.instanceMatrix),null!==e.morphTexture&&(this.morphTexture=e.morphTexture.clone()),null!==e.instanceColor&&(this.instanceColor=e.instanceColor.clone()),this.count=e.count,null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone()),null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),this}getColorAt(e,i){i.fromArray(this.instanceColor.array,3*e)}getMatrixAt(e,i){i.fromArray(this.instanceMatrix.array,16*e)}getMorphAt(e,i){let r=i.morphTargetInfluences,n=this.morphTexture.source.data.data,s=e*(r.length+1)+1;for(let e=0;e<r.length;e++)r[e]=n[s+e]}raycast(e,i){let r=this.matrixWorld,n=this.count;if(nt.geometry=this.geometry,nt.material=this.material,void 0!==nt.material&&(null===this.boundingSphere&&this.computeBoundingSphere(),ne.copy(this.boundingSphere),ne.applyMatrix4(r),!1!==e.ray.intersectsSphere(ne)))for(let s=0;s<n;s++){this.getMatrixAt(s,r5),r6.multiplyMatrices(r,r5),nt.matrixWorld=r6,nt.raycast(e,r9);for(let e=0,r=r9.length;e<r;e++){let r=r9[e];r.instanceId=s,r.object=this,i.push(r)}r9.length=0}}setColorAt(e,i){null===this.instanceColor&&(this.instanceColor=new r4(new Float32Array(3*this.instanceMatrix.count).fill(1),3)),i.toArray(this.instanceColor.array,3*e)}setMatrixAt(e,i){i.toArray(this.instanceMatrix.array,16*e)}setMorphAt(e,i){let r=i.morphTargetInfluences,n=r.length+1;null===this.morphTexture&&(this.morphTexture=new r0(new Float32Array(n*this.count),n,this.count,1028,1015));let s=this.morphTexture.source.data.data,a=0;for(let e=0;e<r.length;e++)a+=r[e];let o=this.geometry.morphTargetsRelative?1:1-a,l=n*e;s[l]=o,s.set(r,l+1)}updateMorphTargets(){}dispose(){return this.dispatchEvent({type:"dispose"}),null!==this.morphTexture&&(this.morphTexture.dispose(),this.morphTexture=null),this}},nr=class extends e7{constructor(e){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new e5(16777215),this.map=null,this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.linewidth=e.linewidth,this.linecap=e.linecap,this.linejoin=e.linejoin,this.fog=e.fog,this}},nn=new tZ,ns=new tZ,na=new eg,no=new em,nl=new eo,nh=new tZ,nu=new tZ,nc=class extends eW{constructor(e=new im,i=new nr){super(),this.isLine=!0,this.type="Line",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}computeLineDistances(){let e=this.geometry;if(null===e.index){let i=e.attributes.position,r=[0];for(let e=1,n=i.count;e<n;e++)nn.fromBufferAttribute(i,e-1),ns.fromBufferAttribute(i,e),r[e]=r[e-1],r[e]+=nn.distanceTo(ns);e.setAttribute("lineDistance",new ia(r,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(e,i){let r=this.geometry,n=this.matrixWorld,s=e.params.Line.threshold,a=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),nl.copy(r.boundingSphere),nl.applyMatrix4(n),nl.radius+=s,!1===e.ray.intersectsSphere(nl))return;na.copy(n).invert(),no.copy(e.ray).applyMatrix4(na);let o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,h=this.isLineSegments?2:1,u=r.index,c=r.attributes.position;if(null!==u){let r=Math.max(0,a.start),n=Math.min(u.count,a.start+a.count);for(let s=r,a=n-1;s<a;s+=h){let r=nd(this,e,no,l,u.getX(s),u.getX(s+1));r&&i.push(r)}if(this.isLineLoop){let s=nd(this,e,no,l,u.getX(n-1),u.getX(r));s&&i.push(s)}}else{let r=Math.max(0,a.start),n=Math.min(c.count,a.start+a.count);for(let s=r,a=n-1;s<a;s+=h){let r=nd(this,e,no,l,s,s+1);r&&i.push(r)}if(this.isLineLoop){let s=nd(this,e,no,l,n-1,r);s&&i.push(s)}}}updateMorphTargets(){let e=this.geometry.morphAttributes,i=Object.keys(e);if(i.length>0){let r=e[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,i=r.length;e<i;e++){let i=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}}}};function nd(e,i,r,n,s,a){let o=e.geometry.attributes.position;if(nn.fromBufferAttribute(o,s),ns.fromBufferAttribute(o,a),r.distanceSqToSegment(nn,ns,nh,nu)>n)return;nh.applyMatrix4(e.matrixWorld);let l=i.ray.origin.distanceTo(nh);if(!(l<i.near||l>i.far))return{distance:l,point:nu.clone().applyMatrix4(e.matrixWorld),index:s,face:null,faceIndex:null,object:e}}var np=new tZ,nf=new tZ,nm=class extends nc{constructor(e,i){super(e,i),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){let e=this.geometry;if(null===e.index){let i=e.attributes.position,r=[];for(let e=0,n=i.count;e<n;e+=2)np.fromBufferAttribute(i,e),nf.fromBufferAttribute(i,e+1),r[e]=0===e?0:r[e-1],r[e+1]=r[e]+np.distanceTo(nf);e.setAttribute("lineDistance",new ia(r,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}},ng=class extends nc{constructor(e,i){super(e,i),this.isLineLoop=!0,this.type="LineLoop"}},ny=class extends e7{constructor(e){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new e5(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.color.copy(e.color),this.map=e.map,this.alphaMap=e.alphaMap,this.size=e.size,this.sizeAttenuation=e.sizeAttenuation,this.fog=e.fog,this}},nv=new eg,n_=new em,nx=new eo,nb=new tZ,nw=class extends eW{constructor(e=new im,i=new ny){super(),this.isPoints=!0,this.type="Points",this.geometry=e,this.material=i,this.updateMorphTargets()}copy(e,i){return super.copy(e,i),this.material=Array.isArray(e.material)?e.material.slice():e.material,this.geometry=e.geometry,this}raycast(e,i){let r=this.geometry,n=this.matrixWorld,s=e.params.Points.threshold,a=r.drawRange;if(null===r.boundingSphere&&r.computeBoundingSphere(),nx.copy(r.boundingSphere),nx.applyMatrix4(n),nx.radius+=s,!1===e.ray.intersectsSphere(nx))return;nv.copy(n).invert(),n_.copy(e.ray).applyMatrix4(nv);let o=s/((this.scale.x+this.scale.y+this.scale.z)/3),l=o*o,h=r.index,u=r.attributes.position;if(null!==h){let r=Math.max(0,a.start),s=Math.min(h.count,a.start+a.count);for(let a=r;a<s;a++){let r=h.getX(a);nb.fromBufferAttribute(u,r),nM(nb,r,l,n,e,i,this)}}else{let r=Math.max(0,a.start),s=Math.min(u.count,a.start+a.count);for(let a=r;a<s;a++)nb.fromBufferAttribute(u,a),nM(nb,a,l,n,e,i,this)}}updateMorphTargets(){let e=this.geometry.morphAttributes,i=Object.keys(e);if(i.length>0){let r=e[i[0]];if(void 0!==r){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let e=0,i=r.length;e<i;e++){let i=r[e].name||String(e);this.morphTargetInfluences.push(0),this.morphTargetDictionary[i]=e}}}}};function nM(e,i,r,n,s,a,o){let l=n_.distanceSqToPoint(e);if(l<r){let r=new tZ;n_.closestPointToPoint(e,r),r.applyMatrix4(n);let h=s.ray.origin.distanceTo(r);if(h<s.near||h>s.far)return;a.push({distance:h,distanceToRay:Math.sqrt(l),point:r,index:i,face:null,object:o})}}var nA=class{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(e,i){let r=this.getUtoTmapping(e);return this.getPoint(r,i)}getPoints(e=5){let i=[];for(let r=0;r<=e;r++)i.push(this.getPoint(r/e));return i}getSpacedPoints(e=5){let i=[];for(let r=0;r<=e;r++)i.push(this.getPointAt(r/e));return i}getLength(){let e=this.getLengths();return e[e.length-1]}getLengths(e=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===e+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;let i=[],r,n=this.getPoint(0),s=0;i.push(0);for(let a=1;a<=e;a++)i.push(s+=(r=this.getPoint(a/e)).distanceTo(n)),n=r;return this.cacheArcLengths=i,i}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(e,i){let r=this.getLengths(),n=0,s=r.length,a;a=i||e*r[s-1];let o=0,l=s-1,h;for(;o<=l;)if((h=r[n=Math.floor(o+(l-o)/2)]-a)<0)o=n+1;else if(h>0)l=n-1;else{l=n;break}if(r[n=l]===a)return n/(s-1);let u=r[n],c=r[n+1]-u;return(n+(a-u)/c)/(s-1)}getTangent(e,i){let r=e-1e-4,n=e+1e-4;r<0&&(r=0),n>1&&(n=1);let s=this.getPoint(r),a=this.getPoint(n),o=i||(s.isVector2?new tP:new tZ);return o.copy(a).sub(s).normalize(),o}getTangentAt(e,i){let r=this.getUtoTmapping(e);return this.getTangent(r,i)}computeFrenetFrames(e,i){let r=new tZ,n=[],s=[],a=[],o=new tZ,l=new eg;for(let i=0;i<=e;i++){let r=i/e;n[i]=this.getTangentAt(r,new tZ)}s[0]=new tZ,a[0]=new tZ;let h=Number.MAX_VALUE,u=Math.abs(n[0].x),c=Math.abs(n[0].y),d=Math.abs(n[0].z);u<=h&&(h=u,r.set(1,0,0)),c<=h&&(h=c,r.set(0,1,0)),d<=h&&r.set(0,0,1),o.crossVectors(n[0],r).normalize(),s[0].crossVectors(n[0],o),a[0].crossVectors(n[0],s[0]);for(let i=1;i<=e;i++){if(s[i]=s[i-1].clone(),a[i]=a[i-1].clone(),o.crossVectors(n[i-1],n[i]),o.length()>Number.EPSILON){o.normalize();let e=Math.acos(tA(n[i-1].dot(n[i]),-1,1));s[i].applyMatrix4(l.makeRotationAxis(o,e))}a[i].crossVectors(n[i],s[i])}if(!0===i){let i=Math.acos(tA(s[0].dot(s[e]),-1,1));i/=e,n[0].dot(o.crossVectors(s[0],s[e]))>0&&(i=-i);for(let r=1;r<=e;r++)s[r].applyMatrix4(l.makeRotationAxis(n[r],i*r)),a[r].crossVectors(n[r],s[r])}return{tangents:n,normals:s,binormals:a}}clone(){return new this.constructor().copy(this)}copy(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}toJSON(){let e={metadata:{version:4.6,type:"Curve",generator:"Curve.toJSON"}};return e.arcLengthDivisions=this.arcLengthDivisions,e.type=this.type,e}fromJSON(e){return this.arcLengthDivisions=e.arcLengthDivisions,this}},nS=class extends nA{constructor(e=0,i=0,r=1,n=1,s=0,a=2*Math.PI,o=!1,l=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=e,this.aY=i,this.xRadius=r,this.yRadius=n,this.aStartAngle=s,this.aEndAngle=a,this.aClockwise=o,this.aRotation=l}getPoint(e,i=new tP){let r=2*Math.PI,n=this.aEndAngle-this.aStartAngle,s=Math.abs(n)<Number.EPSILON;for(;n<0;)n+=r;for(;n>r;)n-=r;n<Number.EPSILON&&(n=s?0:r),!0!==this.aClockwise||s||(n===r?n=-r:n-=r);let a=this.aStartAngle+e*n,o=this.aX+this.xRadius*Math.cos(a),l=this.aY+this.yRadius*Math.sin(a);if(0!==this.aRotation){let e=Math.cos(this.aRotation),i=Math.sin(this.aRotation),r=o-this.aX,n=l-this.aY;o=r*e-n*i+this.aX,l=r*i+n*e+this.aY}return i.set(o,l)}copy(e){return super.copy(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}toJSON(){let e=super.toJSON();return e.aX=this.aX,e.aY=this.aY,e.xRadius=this.xRadius,e.yRadius=this.yRadius,e.aStartAngle=this.aStartAngle,e.aEndAngle=this.aEndAngle,e.aClockwise=this.aClockwise,e.aRotation=this.aRotation,e}fromJSON(e){return super.fromJSON(e),this.aX=e.aX,this.aY=e.aY,this.xRadius=e.xRadius,this.yRadius=e.yRadius,this.aStartAngle=e.aStartAngle,this.aEndAngle=e.aEndAngle,this.aClockwise=e.aClockwise,this.aRotation=e.aRotation,this}},nT=class extends nS{constructor(e,i,r,n,s,a){super(e,i,r,r,n,s,a),this.isArcCurve=!0,this.type="ArcCurve"}};function nC(){let e=0,i=0,r=0,n=0;function s(s,a,o,l){e=s,i=o,r=-3*s+3*a-2*o-l,n=2*s-2*a+o+l}return{initCatmullRom:function(e,i,r,n,a){s(i,r,a*(r-e),a*(n-i))},initNonuniformCatmullRom:function(e,i,r,n,a,o,l){let h=(i-e)/a-(r-e)/(a+o)+(r-i)/o,u=(r-i)/o-(n-i)/(o+l)+(n-r)/l;s(i,r,h*=o,u*=o)},calc:function(s){let a=s*s;return e+i*s+r*a+a*s*n}}}var nP=new tZ,nE=new nC,nI=new nC,nz=new nC,nR=class extends nA{constructor(e=[],i=!1,r="centripetal",n=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=e,this.closed=i,this.curveType=r,this.tension=n}getPoint(e,i=new tZ){let r,n,s=this.points,a=s.length,o=(a-(this.closed?0:1))*e,l=Math.floor(o),h=o-l;this.closed?l+=l>0?0:(Math.floor(Math.abs(l)/a)+1)*a:0===h&&l===a-1&&(l=a-2,h=1),this.closed||l>0?r=s[(l-1)%a]:(nP.subVectors(s[0],s[1]).add(s[0]),r=nP);let u=s[l%a],c=s[(l+1)%a];if(this.closed||l+2<a?n=s[(l+2)%a]:(nP.subVectors(s[a-1],s[a-2]).add(s[a-1]),n=nP),"centripetal"===this.curveType||"chordal"===this.curveType){let e="chordal"===this.curveType?.5:.25,i=Math.pow(r.distanceToSquared(u),e),s=Math.pow(u.distanceToSquared(c),e),a=Math.pow(c.distanceToSquared(n),e);s<1e-4&&(s=1),i<1e-4&&(i=s),a<1e-4&&(a=s),nE.initNonuniformCatmullRom(r.x,u.x,c.x,n.x,i,s,a),nI.initNonuniformCatmullRom(r.y,u.y,c.y,n.y,i,s,a),nz.initNonuniformCatmullRom(r.z,u.z,c.z,n.z,i,s,a)}else"catmullrom"===this.curveType&&(nE.initCatmullRom(r.x,u.x,c.x,n.x,this.tension),nI.initCatmullRom(r.y,u.y,c.y,n.y,this.tension),nz.initCatmullRom(r.z,u.z,c.z,n.z,this.tension));return i.set(nE.calc(h),nI.calc(h),nz.calc(h)),i}copy(e){super.copy(e),this.points=[];for(let i=0,r=e.points.length;i<r;i++){let r=e.points[i];this.points.push(r.clone())}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}toJSON(){let e=super.toJSON();e.points=[];for(let i=0,r=this.points.length;i<r;i++){let r=this.points[i];e.points.push(r.toArray())}return e.closed=this.closed,e.curveType=this.curveType,e.tension=this.tension,e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,r=e.points.length;i<r;i++){let r=e.points[i];this.points.push(new tZ().fromArray(r))}return this.closed=e.closed,this.curveType=e.curveType,this.tension=e.tension,this}};function nB(e,i,r,n,s){let a=(n-i)*.5,o=(s-r)*.5,l=e*e;return e*l*(2*r-2*n+a+o)+(-3*r+3*n-2*a-o)*l+a*e+r}function nk(e,i,r,n){let s;return(s=1-e)*s*i+2*(1-e)*e*r+e*e*n}function nO(e,i,r,n,s){let a,o;return(a=1-e)*a*a*i+3*(o=1-e)*o*e*r+3*(1-e)*e*e*n+e*e*e*s}var nL=class extends nA{constructor(e=new tP,i=new tP,r=new tP,n=new tP){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=e,this.v1=i,this.v2=r,this.v3=n}getPoint(e,i=new tP){let r=this.v0,n=this.v1,s=this.v2,a=this.v3;return i.set(nO(e,r.x,n.x,s.x,a.x),nO(e,r.y,n.y,s.y,a.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},nN=class extends nA{constructor(e=new tZ,i=new tZ,r=new tZ,n=new tZ){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=e,this.v1=i,this.v2=r,this.v3=n}getPoint(e,i=new tZ){let r=this.v0,n=this.v1,s=this.v2,a=this.v3;return i.set(nO(e,r.x,n.x,s.x,a.x),nO(e,r.y,n.y,s.y,a.y),nO(e,r.z,n.z,s.z,a.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this.v3.copy(e.v3),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e.v3=this.v3.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this.v3.fromArray(e.v3),this}},nF=class extends nA{constructor(e=new tP,i=new tP){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=e,this.v2=i}getPoint(e,i=new tP){return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i=new tP){return i.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,i){return this.getTangent(e,i)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},nD=class extends nA{constructor(e=new tZ,i=new tZ){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=e,this.v2=i}getPoint(e,i=new tZ){return 1===e?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(e).add(this.v1)),i}getPointAt(e,i){return this.getPoint(e,i)}getTangent(e,i=new tZ){return i.subVectors(this.v2,this.v1).normalize()}getTangentAt(e,i){return this.getTangent(e,i)}copy(e){return super.copy(e),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},nU=class extends nA{constructor(e=new tP,i=new tP,r=new tP){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=e,this.v1=i,this.v2=r}getPoint(e,i=new tP){let r=this.v0,n=this.v1,s=this.v2;return i.set(nk(e,r.x,n.x,s.x),nk(e,r.y,n.y,s.y)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},nj=class extends nA{constructor(e=new tZ,i=new tZ,r=new tZ){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=e,this.v1=i,this.v2=r}getPoint(e,i=new tZ){let r=this.v0,n=this.v1,s=this.v2;return i.set(nk(e,r.x,n.x,s.x),nk(e,r.y,n.y,s.y),nk(e,r.z,n.z,s.z)),i}copy(e){return super.copy(e),this.v0.copy(e.v0),this.v1.copy(e.v1),this.v2.copy(e.v2),this}toJSON(){let e=super.toJSON();return e.v0=this.v0.toArray(),e.v1=this.v1.toArray(),e.v2=this.v2.toArray(),e}fromJSON(e){return super.fromJSON(e),this.v0.fromArray(e.v0),this.v1.fromArray(e.v1),this.v2.fromArray(e.v2),this}},nV=Object.freeze({__proto__:null,ArcCurve:nT,CatmullRomCurve3:nR,CubicBezierCurve:nL,CubicBezierCurve3:nN,EllipseCurve:nS,LineCurve:nF,LineCurve3:nD,QuadraticBezierCurve:nU,QuadraticBezierCurve3:nj,SplineCurve:class extends nA{constructor(e=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=e}getPoint(e,i=new tP){let r=this.points,n=(r.length-1)*e,s=Math.floor(n),a=n-s,o=r[0===s?s:s-1],l=r[s],h=r[s>r.length-2?r.length-1:s+1],u=r[s>r.length-3?r.length-1:s+2];return i.set(nB(a,o.x,l.x,h.x,u.x),nB(a,o.y,l.y,h.y,u.y)),i}copy(e){super.copy(e),this.points=[];for(let i=0,r=e.points.length;i<r;i++){let r=e.points[i];this.points.push(r.clone())}return this}toJSON(){let e=super.toJSON();e.points=[];for(let i=0,r=this.points.length;i<r;i++){let r=this.points[i];e.points.push(r.toArray())}return e}fromJSON(e){super.fromJSON(e),this.points=[];for(let i=0,r=e.points.length;i<r;i++){let r=e.points[i];this.points.push(new tP().fromArray(r))}return this}}}),nW=class e extends im{constructor(e=new nj(new tZ(-1,-1,0),new tZ(-1,1,0),new tZ(1,1,0)),i=64,r=1,n=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:e,tubularSegments:i,radius:r,radialSegments:n,closed:s};let a=e.computeFrenetFrames(i,s);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals;let o=new tZ,l=new tZ,h=new tP,u=new tZ,c=[],d=[],p=[],f=[];function m(s){u=e.getPointAt(s/i,u);let h=a.normals[s],p=a.binormals[s];for(let e=0;e<=n;e++){let i=e/n*Math.PI*2,s=Math.sin(i),a=-Math.cos(i);l.x=a*h.x+s*p.x,l.y=a*h.y+s*p.y,l.z=a*h.z+s*p.z,l.normalize(),d.push(l.x,l.y,l.z),o.x=u.x+r*l.x,o.y=u.y+r*l.y,o.z=u.z+r*l.z,c.push(o.x,o.y,o.z)}}(function(){for(let e=0;e<i;e++)m(e);m(!1===s?i:0),function(){for(let e=0;e<=i;e++)for(let r=0;r<=n;r++)h.x=e/i,h.y=r/n,p.push(h.x,h.y)}(),function(){for(let e=1;e<=i;e++)for(let i=1;i<=n;i++){let r=(n+1)*(e-1)+(i-1),s=(n+1)*e+(i-1),a=(n+1)*e+i,o=(n+1)*(e-1)+i;f.push(r,s,o),f.push(s,a,o)}}()})(),this.setIndex(f),this.setAttribute("position",new ia(c,3)),this.setAttribute("normal",new ia(d,3)),this.setAttribute("uv",new ia(p,2))}copy(e){return super.copy(e),this.parameters=Object.assign({},e.parameters),this}toJSON(){let e=super.toJSON();return e.path=this.parameters.path.toJSON(),e}static fromJSON(i){return new e(new nV[i.path.type]().fromJSON(i.path),i.tubularSegments,i.radius,i.radialSegments,i.closed)}},nH=class extends e7{constructor(e){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new e5(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new e5(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=0,this.normalScale=new tP(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new eT,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(e)}copy(e){return super.copy(e),this.defines={STANDARD:""},this.color.copy(e.color),this.roughness=e.roughness,this.metalness=e.metalness,this.map=e.map,this.lightMap=e.lightMap,this.lightMapIntensity=e.lightMapIntensity,this.aoMap=e.aoMap,this.aoMapIntensity=e.aoMapIntensity,this.emissive.copy(e.emissive),this.emissiveMap=e.emissiveMap,this.emissiveIntensity=e.emissiveIntensity,this.bumpMap=e.bumpMap,this.bumpScale=e.bumpScale,this.normalMap=e.normalMap,this.normalMapType=e.normalMapType,this.normalScale.copy(e.normalScale),this.displacementMap=e.displacementMap,this.displacementScale=e.displacementScale,this.displacementBias=e.displacementBias,this.roughnessMap=e.roughnessMap,this.metalnessMap=e.metalnessMap,this.alphaMap=e.alphaMap,this.envMap=e.envMap,this.envMapRotation.copy(e.envMapRotation),this.envMapIntensity=e.envMapIntensity,this.wireframe=e.wireframe,this.wireframeLinewidth=e.wireframeLinewidth,this.wireframeLinecap=e.wireframeLinecap,this.wireframeLinejoin=e.wireframeLinejoin,this.flatShading=e.flatShading,this.fog=e.fog,this}},nq=class extends nH{constructor(e){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.anisotropyRotation=0,this.anisotropyMap=null,this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new tP(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return tA(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(e){this.ior=(1+.4*e)/(1-.4*e)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new e5(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=1/0,this.attenuationColor=new e5(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new e5(1,1,1),this.specularColorMap=null,this._anisotropy=0,this._clearcoat=0,this._dispersion=0,this._iridescence=0,this._sheen=0,this._transmission=0,this.setValues(e)}get anisotropy(){return this._anisotropy}set anisotropy(e){this._anisotropy>0!=e>0&&this.version++,this._anisotropy=e}get clearcoat(){return this._clearcoat}set clearcoat(e){this._clearcoat>0!=e>0&&this.version++,this._clearcoat=e}get iridescence(){return this._iridescence}set iridescence(e){this._iridescence>0!=e>0&&this.version++,this._iridescence=e}get dispersion(){return this._dispersion}set dispersion(e){this._dispersion>0!=e>0&&this.version++,this._dispersion=e}get sheen(){return this._sheen}set sheen(e){this._sheen>0!=e>0&&this.version++,this._sheen=e}get transmission(){return this._transmission}set transmission(e){this._transmission>0!=e>0&&this.version++,this._transmission=e}copy(e){return super.copy(e),this.defines={STANDARD:"",PHYSICAL:""},this.anisotropy=e.anisotropy,this.anisotropyRotation=e.anisotropyRotation,this.anisotropyMap=e.anisotropyMap,this.clearcoat=e.clearcoat,this.clearcoatMap=e.clearcoatMap,this.clearcoatRoughness=e.clearcoatRoughness,this.clearcoatRoughnessMap=e.clearcoatRoughnessMap,this.clearcoatNormalMap=e.clearcoatNormalMap,this.clearcoatNormalScale.copy(e.clearcoatNormalScale),this.dispersion=e.dispersion,this.ior=e.ior,this.iridescence=e.iridescence,this.iridescenceMap=e.iridescenceMap,this.iridescenceIOR=e.iridescenceIOR,this.iridescenceThicknessRange=[...e.iridescenceThicknessRange],this.iridescenceThicknessMap=e.iridescenceThicknessMap,this.sheen=e.sheen,this.sheenColor.copy(e.sheenColor),this.sheenColorMap=e.sheenColorMap,this.sheenRoughness=e.sheenRoughness,this.sheenRoughnessMap=e.sheenRoughnessMap,this.transmission=e.transmission,this.transmissionMap=e.transmissionMap,this.thickness=e.thickness,this.thicknessMap=e.thicknessMap,this.attenuationDistance=e.attenuationDistance,this.attenuationColor.copy(e.attenuationColor),this.specularIntensity=e.specularIntensity,this.specularIntensityMap=e.specularIntensityMap,this.specularColor.copy(e.specularColor),this.specularColorMap=e.specularColorMap,this}};function nG(e,i,r){return e&&e.constructor!==i?"number"==typeof i.BYTES_PER_ELEMENT?new i(e):Array.prototype.slice.call(e):e}function nJ(e,i,r){let n=e.length,s=new e.constructor(n);for(let a=0,o=0;o!==n;++a){let n=r[a]*i;for(let r=0;r!==i;++r)s[o++]=e[n+r]}return s}function nX(e,i,r,n){let s=1,a=e[0];for(;void 0!==a&&void 0===a[n];)a=e[s++];if(void 0===a)return;let o=a[n];if(void 0!==o){if(Array.isArray(o))do void 0!==(o=a[n])&&(i.push(a.time),r.push.apply(r,o)),a=e[s++];while(void 0!==a);else if(void 0!==o.toArray)do void 0!==(o=a[n])&&(i.push(a.time),o.toArray(r,r.length)),a=e[s++];while(void 0!==a);else do void 0!==(o=a[n])&&(i.push(a.time),r.push(o)),a=e[s++];while(void 0!==a)}}var nY=class{constructor(e,i,r,n){this.parameterPositions=e,this._cachedIndex=0,this.resultBuffer=void 0!==n?n:new i.constructor(r),this.sampleValues=i,this.valueSize=r,this.settings=null,this.DefaultSettings_={}}evaluate(e){let i=this.parameterPositions,r=this._cachedIndex,n=i[r],s=i[r-1];t:{e:{let a;i:{r:if(!(e<n)){for(let a=r+2;;){if(void 0===n){if(e<s)break r;return r=i.length,this._cachedIndex=r,this.copySampleValue_(r-1)}if(r===a)break;if(s=n,e<(n=i[++r]))break e}a=i.length;break i}if(!(e>=s)){let o=i[1];e<o&&(r=2,s=o);for(let a=r-2;;){if(void 0===s)return this._cachedIndex=0,this.copySampleValue_(0);if(r===a)break;if(n=s,e>=(s=i[--r-1]))break e}a=r,r=0;break i}break t}for(;r<a;){let n=r+a>>>1;e<i[n]?a=n:r=n+1}if(n=i[r],void 0===(s=i[r-1]))return this._cachedIndex=0,this.copySampleValue_(0);if(void 0===n)return r=i.length,this._cachedIndex=r,this.copySampleValue_(r-1)}this._cachedIndex=r,this.intervalChanged_(r,s,n)}return this.interpolate_(r,s,e,n)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(e){let i=this.resultBuffer,r=this.sampleValues,n=this.valueSize,s=e*n;for(let e=0;e!==n;++e)i[e]=r[s+e];return i}interpolate_(){throw Error("call to abstract method")}intervalChanged_(){}},nZ=class extends nY{constructor(e,i,r,n){super(e,i,r,n),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:2400,endingEnd:2400}}intervalChanged_(e,i,r){let n=this.parameterPositions,s=e-2,a=e+1,o=n[s],l=n[a];if(void 0===o)switch(this.getSettings_().endingStart){case 2401:s=e,o=2*i-r;break;case 2402:s=n.length-2,o=i+n[s]-n[s+1];break;default:s=e,o=r}if(void 0===l)switch(this.getSettings_().endingEnd){case 2401:a=e,l=2*r-i;break;case 2402:a=1,l=r+n[1]-n[0];break;default:a=e-1,l=i}let h=(r-i)*.5,u=this.valueSize;this._weightPrev=h/(i-o),this._weightNext=h/(l-r),this._offsetPrev=s*u,this._offsetNext=a*u}interpolate_(e,i,r,n){let s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,h=l-o,u=this._offsetPrev,c=this._offsetNext,d=this._weightPrev,p=this._weightNext,f=(r-i)/(n-i),m=f*f,g=m*f,y=-d*g+2*d*m-d*f,v=(1+d)*g+(-1.5-2*d)*m+(-.5+d)*f+1,_=(-1-p)*g+(1.5+p)*m+.5*f,x=p*g-p*m;for(let e=0;e!==o;++e)s[e]=y*a[u+e]+v*a[h+e]+_*a[l+e]+x*a[c+e];return s}},nK=class extends nY{constructor(e,i,r,n){super(e,i,r,n)}interpolate_(e,i,r,n){let s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=e*o,h=l-o,u=(r-i)/(n-i),c=1-u;for(let e=0;e!==o;++e)s[e]=a[h+e]*c+a[l+e]*u;return s}},n$=class extends nY{constructor(e,i,r,n){super(e,i,r,n)}interpolate_(e){return this.copySampleValue_(e-1)}},nQ=class{constructor(e,i,r,n){if(void 0===e)throw Error("THREE.KeyframeTrack: track name is undefined");if(void 0===i||0===i.length)throw Error("THREE.KeyframeTrack: no keyframes in track named "+e);this.name=e,this.times=nG(i,this.TimeBufferType),this.values=nG(r,this.ValueBufferType),this.setInterpolation(n||this.DefaultInterpolation)}static toJSON(e){let i=e.constructor,r;if(i.toJSON!==this.toJSON)r=i.toJSON(e);else{r={name:e.name,times:nG(e.times,Array),values:nG(e.values,Array)};let i=e.getInterpolation();i!==e.DefaultInterpolation&&(r.interpolation=i)}return r.type=e.ValueTypeName,r}InterpolantFactoryMethodDiscrete(e){return new n$(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodLinear(e){return new nK(this.times,this.values,this.getValueSize(),e)}InterpolantFactoryMethodSmooth(e){return new nZ(this.times,this.values,this.getValueSize(),e)}setInterpolation(e){let i;switch(e){case 2300:i=this.InterpolantFactoryMethodDiscrete;break;case 2301:i=this.InterpolantFactoryMethodLinear;break;case 2302:i=this.InterpolantFactoryMethodSmooth}if(void 0===i){let i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(e!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw Error(i)}return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=i,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return 2300;case this.InterpolantFactoryMethodLinear:return 2301;case this.InterpolantFactoryMethodSmooth:return 2302}}getValueSize(){return this.values.length/this.times.length}shift(e){if(0!==e){let i=this.times;for(let r=0,n=i.length;r!==n;++r)i[r]+=e}return this}scale(e){if(1!==e){let i=this.times;for(let r=0,n=i.length;r!==n;++r)i[r]*=e}return this}trim(e,i){let r=this.times,n=r.length,s=0,a=n-1;for(;s!==n&&r[s]<e;)++s;for(;-1!==a&&r[a]>i;)--a;if(++a,0!==s||a!==n){s>=a&&(s=(a=Math.max(a,1))-1);let e=this.getValueSize();this.times=r.slice(s,a),this.values=this.values.slice(s*e,a*e)}return this}validate(){var e;let i=!0,r=this.getValueSize();r-Math.floor(r)!=0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),i=!1);let n=this.times,s=this.values,a=n.length;0===a&&(console.error("THREE.KeyframeTrack: Track is empty.",this),i=!1);let o=null;for(let e=0;e!==a;e++){let r=n[e];if("number"==typeof r&&isNaN(r)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,e,r),i=!1;break}if(null!==o&&o>r){console.error("THREE.KeyframeTrack: Out of order keys.",this,e,r,o),i=!1;break}o=r}if(void 0!==s&&ArrayBuffer.isView(e=s)&&!(e instanceof DataView))for(let e=0,r=s.length;e!==r;++e){let r=s[e];if(isNaN(r)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,e,r),i=!1;break}}return i}optimize(){let e=this.times.slice(),i=this.values.slice(),r=this.getValueSize(),n=2302===this.getInterpolation(),s=e.length-1,a=1;for(let o=1;o<s;++o){let s=!1,l=e[o];if(l!==e[o+1]&&(1!==o||l!==e[0])){if(n)s=!0;else{let e=o*r,n=e-r,a=e+r;for(let o=0;o!==r;++o){let r=i[e+o];if(r!==i[n+o]||r!==i[a+o]){s=!0;break}}}}if(s){if(o!==a){e[a]=e[o];let n=o*r,s=a*r;for(let e=0;e!==r;++e)i[s+e]=i[n+e]}++a}}if(s>0){e[a]=e[s];for(let e=s*r,n=a*r,o=0;o!==r;++o)i[n+o]=i[e+o];++a}return a!==e.length?(this.times=e.slice(0,a),this.values=i.slice(0,a*r)):(this.times=e,this.values=i),this}clone(){let e=this.times.slice(),i=this.values.slice(),r=new this.constructor(this.name,e,i);return r.createInterpolant=this.createInterpolant,r}};nQ.prototype.TimeBufferType=Float32Array,nQ.prototype.ValueBufferType=Float32Array,nQ.prototype.DefaultInterpolation=2301;var n0=class extends nQ{constructor(e,i,r){super(e,i,r)}};n0.prototype.ValueTypeName="bool",n0.prototype.ValueBufferType=Array,n0.prototype.DefaultInterpolation=2300,n0.prototype.InterpolantFactoryMethodLinear=void 0,n0.prototype.InterpolantFactoryMethodSmooth=void 0;var n1=class extends nQ{};n1.prototype.ValueTypeName="color";var n2=class extends nQ{};n2.prototype.ValueTypeName="number";var n3=class extends nY{constructor(e,i,r,n){super(e,i,r,n)}interpolate_(e,i,r,n){let s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=(r-i)/(n-i),h=e*o;for(let e=h+o;h!==e;h+=4)tY.slerpFlat(s,0,a,h-o,a,h,l);return s}},n4=class extends nQ{InterpolantFactoryMethodLinear(e){return new n3(this.times,this.values,this.getValueSize(),e)}};n4.prototype.ValueTypeName="quaternion",n4.prototype.InterpolantFactoryMethodSmooth=void 0;var n5=class extends nQ{constructor(e,i,r){super(e,i,r)}};n5.prototype.ValueTypeName="string",n5.prototype.ValueBufferType=Array,n5.prototype.DefaultInterpolation=2300,n5.prototype.InterpolantFactoryMethodLinear=void 0,n5.prototype.InterpolantFactoryMethodSmooth=void 0;var n6=class extends nQ{};n6.prototype.ValueTypeName="vector";var n9=class{constructor(e="",i=-1,r=[],n=2500){this.name=e,this.tracks=r,this.duration=i,this.blendMode=n,this.uuid=tM(),this.duration<0&&this.resetDuration()}static parse(e){let i=[],r=e.tracks,n=1/(e.fps||1);for(let e=0,s=r.length;e!==s;++e)i.push((function(e){if(void 0===e.type)throw Error("THREE.KeyframeTrack: track type undefined, can not parse");let i=function(e){switch(e.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return n2;case"vector":case"vector2":case"vector3":case"vector4":return n6;case"color":return n1;case"quaternion":return n4;case"bool":case"boolean":return n0;case"string":return n5}throw Error("THREE.KeyframeTrack: Unsupported typeName: "+e)}(e.type);if(void 0===e.times){let i=[],r=[];nX(e.keys,i,r,"value"),e.times=i,e.values=r}return void 0!==i.parse?i.parse(e):new i(e.name,e.times,e.values,e.interpolation)})(r[e]).scale(n));let s=new this(e.name,e.duration,i,e.blendMode);return s.uuid=e.uuid,s}static toJSON(e){let i=[],r=e.tracks,n={name:e.name,duration:e.duration,tracks:i,uuid:e.uuid,blendMode:e.blendMode};for(let e=0,n=r.length;e!==n;++e)i.push(nQ.toJSON(r[e]));return n}static CreateFromMorphTargetSequence(e,i,r,n){let s=i.length,a=[];for(let e=0;e<s;e++){let o=[],l=[];o.push((e+s-1)%s,e,(e+1)%s),l.push(0,1,0);let h=function(e){let i=e.length,r=Array(i);for(let e=0;e!==i;++e)r[e]=e;return r.sort(function(i,r){return e[i]-e[r]}),r}(o);o=nJ(o,1,h),l=nJ(l,1,h),n||0!==o[0]||(o.push(s),l.push(l[0])),a.push(new n2(".morphTargetInfluences["+i[e].name+"]",o,l).scale(1/r))}return new this(e,-1,a)}static findByName(e,i){let r=e;Array.isArray(e)||(r=e.geometry&&e.geometry.animations||e.animations);for(let e=0;e<r.length;e++)if(r[e].name===i)return r[e];return null}static CreateClipsFromMorphTargetSequences(e,i,r){let n={},s=/^([\w-]*?)([\d]+)$/;for(let i=0,r=e.length;i<r;i++){let r=e[i],a=r.name.match(s);if(a&&a.length>1){let e=a[1],i=n[e];i||(n[e]=i=[]),i.push(r)}}let a=[];for(let e in n)a.push(this.CreateFromMorphTargetSequence(e,n[e],i,r));return a}static parseAnimation(e,i){if(!e)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;let r=function(e,i,r,n,s){if(0!==r.length){let a=[],o=[];nX(r,a,o,n),0!==a.length&&s.push(new e(i,a,o))}},n=[],s=e.name||"default",a=e.fps||30,o=e.blendMode,l=e.length||-1,h=e.hierarchy||[];for(let e=0;e<h.length;e++){let s=h[e].keys;if(!(!s||0===s.length)){if(s[0].morphTargets){let e={},i;for(i=0;i<s.length;i++)if(s[i].morphTargets)for(let r=0;r<s[i].morphTargets.length;r++)e[s[i].morphTargets[r]]=-1;for(let r in e){let e=[],a=[];for(let n=0;n!==s[i].morphTargets.length;++n){let n=s[i];e.push(n.time),a.push(n.morphTarget===r?1:0)}n.push(new n2(".morphTargetInfluence["+r+"]",e,a))}l=e.length*a}else{let a=".bones["+i[e].name+"]";r(n6,a+".position",s,"pos",n),r(n4,a+".quaternion",s,"rot",n),r(n6,a+".scale",s,"scl",n)}}}return 0===n.length?null:new this(s,l,n,o)}resetDuration(){let e=this.tracks,i=0;for(let r=0,n=e.length;r!==n;++r){let e=this.tracks[r];i=Math.max(i,e.times[e.times.length-1])}return this.duration=i,this}trim(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].trim(0,this.duration);return this}validate(){let e=!0;for(let i=0;i<this.tracks.length;i++)e=e&&this.tracks[i].validate();return e}optimize(){for(let e=0;e<this.tracks.length;e++)this.tracks[e].optimize();return this}clone(){let e=[];for(let i=0;i<this.tracks.length;i++)e.push(this.tracks[i].clone());return new this.constructor(this.name,this.duration,e,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}},n7={enabled:!1,files:{},add:function(e,i){!1!==this.enabled&&(this.files[e]=i)},get:function(e){if(!1!==this.enabled)return this.files[e]},remove:function(e){delete this.files[e]}},n8=new class{constructor(e,i,r){let n=this,s=!1,a=0,o=0,l,h=[];this.onStart=void 0,this.onLoad=e,this.onProgress=i,this.onError=r,this.itemStart=function(e){o++,!1===s&&void 0!==n.onStart&&n.onStart(e,a,o),s=!0},this.itemEnd=function(e){a++,void 0!==n.onProgress&&n.onProgress(e,a,o),a===o&&(s=!1,void 0!==n.onLoad&&n.onLoad())},this.itemError=function(e){void 0!==n.onError&&n.onError(e)},this.resolveURL=function(e){return l?l(e):e},this.setURLModifier=function(e){return l=e,this},this.addHandler=function(e,i){return h.push(e,i),this},this.removeHandler=function(e){let i=h.indexOf(e);return -1!==i&&h.splice(i,2),this},this.getHandler=function(e){for(let i=0,r=h.length;i<r;i+=2){let r=h[i],n=h[i+1];if(r.global&&(r.lastIndex=0),r.test(e))return n}return null}}},st=class{constructor(e){this.manager=void 0!==e?e:n8,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(e,i){let r=this;return new Promise(function(n,s){r.load(e,n,i,s)})}parse(){}setCrossOrigin(e){return this.crossOrigin=e,this}setWithCredentials(e){return this.withCredentials=e,this}setPath(e){return this.path=e,this}setResourcePath(e){return this.resourcePath=e,this}setRequestHeader(e){return this.requestHeader=e,this}};st.DEFAULT_MATERIAL_NAME="__DEFAULT";var se={},si=class extends Error{constructor(e,i){super(e),this.response=i}},sr=class extends st{constructor(e){super(e)}load(e,i,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let s=n7.get(e);if(void 0!==s)return this.manager.itemStart(e),setTimeout(()=>{i&&i(s),this.manager.itemEnd(e)},0),s;if(void 0!==se[e]){se[e].push({onLoad:i,onProgress:r,onError:n});return}se[e]=[],se[e].push({onLoad:i,onProgress:r,onError:n});let a=new Request(e,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),o=this.mimeType,l=this.responseType;fetch(a).then(i=>{if(200===i.status||0===i.status){if(0===i.status&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream>"u"||void 0===i.body||void 0===i.body.getReader)return i;let r=se[e],n=i.body.getReader(),s=i.headers.get("X-File-Size")||i.headers.get("Content-Length"),a=s?parseInt(s):0,o=0!==a,l=0;return new Response(new ReadableStream({start(e){(function i(){n.read().then(({done:n,value:s})=>{if(n)e.close();else{let n=new ProgressEvent("progress",{lengthComputable:o,loaded:l+=s.byteLength,total:a});for(let e=0,i=r.length;e<i;e++){let i=r[e];i.onProgress&&i.onProgress(n)}e.enqueue(s),i()}},i=>{e.error(i)})})()}}))}throw new si(`fetch for "${i.url}" responded with ${i.status}: ${i.statusText}`,i)}).then(e=>{switch(l){case"arraybuffer":return e.arrayBuffer();case"blob":return e.blob();case"document":return e.text().then(e=>new DOMParser().parseFromString(e,o));case"json":return e.json();default:if(void 0===o)return e.text();{let i=/charset="?([^;"\s]*)"?/i.exec(o),r=new TextDecoder(i&&i[1]?i[1].toLowerCase():void 0);return e.arrayBuffer().then(e=>r.decode(e))}}}).then(i=>{n7.add(e,i);let r=se[e];delete se[e];for(let e=0,n=r.length;e<n;e++){let n=r[e];n.onLoad&&n.onLoad(i)}}).catch(i=>{let r=se[e];if(void 0===r)throw this.manager.itemError(e),i;delete se[e];for(let e=0,n=r.length;e<n;e++){let n=r[e];n.onError&&n.onError(i)}this.manager.itemError(e)}).finally(()=>{this.manager.itemEnd(e)}),this.manager.itemStart(e)}setResponseType(e){return this.responseType=e,this}setMimeType(e){return this.mimeType=e,this}},sn=class extends st{constructor(e){super(e)}load(e,i,r,n){void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let s=this,a=n7.get(e);if(void 0!==a)return s.manager.itemStart(e),setTimeout(function(){i&&i(a),s.manager.itemEnd(e)},0),a;let o=tz("img");function l(){u(),n7.add(e,this),i&&i(this),s.manager.itemEnd(e)}function h(i){u(),n&&n(i),s.manager.itemError(e),s.manager.itemEnd(e)}function u(){o.removeEventListener("load",l,!1),o.removeEventListener("error",h,!1)}return o.addEventListener("load",l,!1),o.addEventListener("error",h,!1),"data:"!==e.slice(0,5)&&void 0!==this.crossOrigin&&(o.crossOrigin=this.crossOrigin),s.manager.itemStart(e),o.src=e,o}},ss=class extends st{constructor(e){super(e)}load(e,i,r,n){let s=new tJ,a=new sn(this.manager);return a.setCrossOrigin(this.crossOrigin),a.setPath(this.path),a.load(e,function(e){s.image=e,s.needsUpdate=!0,void 0!==i&&i(s)},r,n),s}},sa=class extends eW{constructor(e,i=1){super(),this.isLight=!0,this.type="Light",this.color=new e5(e),this.intensity=i}dispose(){}copy(e,i){return super.copy(e,i),this.color.copy(e.color),this.intensity=e.intensity,this}toJSON(e){let i=super.toJSON(e);return i.object.color=this.color.getHex(),i.object.intensity=this.intensity,void 0!==this.groundColor&&(i.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(i.object.distance=this.distance),void 0!==this.angle&&(i.object.angle=this.angle),void 0!==this.decay&&(i.object.decay=this.decay),void 0!==this.penumbra&&(i.object.penumbra=this.penumbra),void 0!==this.shadow&&(i.object.shadow=this.shadow.toJSON()),void 0!==this.target&&(i.object.target=this.target.uuid),i}},so=new eg,sl=new tZ,sh=new tZ,su=class{constructor(e){this.camera=e,this.intensity=1,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new tP(512,512),this.map=null,this.mapPass=null,this.matrix=new eg,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new iJ,this._frameExtents=new tP(1,1),this._viewportCount=1,this._viewports=[new tX(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(e){let i=this.camera,r=this.matrix;sl.setFromMatrixPosition(e.matrixWorld),i.position.copy(sl),sh.setFromMatrixPosition(e.target.matrixWorld),i.lookAt(sh),i.updateMatrixWorld(),so.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(so),r.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),r.multiply(so)}getViewport(e){return this._viewports[e]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(e){return this.camera=e.camera.clone(),this.intensity=e.intensity,this.bias=e.bias,this.radius=e.radius,this.mapSize.copy(e.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){let e={};return 1!==this.intensity&&(e.intensity=this.intensity),0!==this.bias&&(e.bias=this.bias),0!==this.normalBias&&(e.normalBias=this.normalBias),1!==this.radius&&(e.radius=this.radius),(512!==this.mapSize.x||512!==this.mapSize.y)&&(e.mapSize=this.mapSize.toArray()),e.camera=this.camera.toJSON(!1).object,delete e.camera.matrix,e}},sc=class extends su{constructor(){super(new iU(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(e){let i=this.camera,r=2*tw*e.angle*this.focus,n=this.mapSize.width/this.mapSize.height,s=e.distance||i.far;(r!==i.fov||n!==i.aspect||s!==i.far)&&(i.fov=r,i.aspect=n,i.far=s,i.updateProjectionMatrix()),super.updateMatrices(e)}copy(e){return super.copy(e),this.focus=e.focus,this}},sd=class extends sa{constructor(e,i,r=0,n=Math.PI/3,s=0,a=2){super(e,i),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(eW.DEFAULT_UP),this.updateMatrix(),this.target=new eW,this.distance=r,this.angle=n,this.penumbra=s,this.decay=a,this.map=null,this.shadow=new sc}get power(){return this.intensity*Math.PI}set power(e){this.intensity=e/Math.PI}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.angle=e.angle,this.penumbra=e.penumbra,this.decay=e.decay,this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},sp=new eg,sf=new tZ,sm=new tZ,sg=class extends su{constructor(){super(new iU(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new tP(4,2),this._viewportCount=6,this._viewports=[new tX(2,1,1,1),new tX(0,1,1,1),new tX(3,1,1,1),new tX(1,1,1,1),new tX(3,0,1,1),new tX(1,0,1,1)],this._cubeDirections=[new tZ(1,0,0),new tZ(-1,0,0),new tZ(0,0,1),new tZ(0,0,-1),new tZ(0,1,0),new tZ(0,-1,0)],this._cubeUps=[new tZ(0,1,0),new tZ(0,1,0),new tZ(0,1,0),new tZ(0,1,0),new tZ(0,0,1),new tZ(0,0,-1)]}updateMatrices(e,i=0){let r=this.camera,n=this.matrix,s=e.distance||r.far;s!==r.far&&(r.far=s,r.updateProjectionMatrix()),sf.setFromMatrixPosition(e.matrixWorld),r.position.copy(sf),sm.copy(r.position),sm.add(this._cubeDirections[i]),r.up.copy(this._cubeUps[i]),r.lookAt(sm),r.updateMatrixWorld(),n.makeTranslation(-sf.x,-sf.y,-sf.z),sp.multiplyMatrices(r.projectionMatrix,r.matrixWorldInverse),this._frustum.setFromProjectionMatrix(sp)}},sy=class extends sa{constructor(e,i,r=0,n=2){super(e,i),this.isPointLight=!0,this.type="PointLight",this.distance=r,this.decay=n,this.shadow=new sg}get power(){return 4*this.intensity*Math.PI}set power(e){this.intensity=e/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(e,i){return super.copy(e,i),this.distance=e.distance,this.decay=e.decay,this.shadow=e.shadow.clone(),this}},sv=class extends su{constructor(){super(new rx(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}},s_=class extends sa{constructor(e,i){super(e,i),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(eW.DEFAULT_UP),this.updateMatrix(),this.target=new eW,this.shadow=new sv}dispose(){this.shadow.dispose()}copy(e){return super.copy(e),this.target=e.target.clone(),this.shadow=e.shadow.clone(),this}},sx=class{static decodeText(e){if(console.warn("THREE.LoaderUtils: decodeText() has been deprecated with r165 and will be removed with r175. Use TextDecoder instead."),"u">typeof TextDecoder)return new TextDecoder().decode(e);let i="";for(let r=0,n=e.length;r<n;r++)i+=String.fromCharCode(e[r]);try{return decodeURIComponent(escape(i))}catch{return i}}static extractUrlBase(e){let i=e.lastIndexOf("/");return -1===i?"./":e.slice(0,i+1)}static resolveURL(e,i){return"string"!=typeof e||""===e?"":(/^https?:\/\//i.test(i)&&/^\//.test(e)&&(i=i.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(e)||/^data:.*,.*$/i.test(e)||/^blob:.*$/i.test(e)?e:i+e)}},sb=class extends st{constructor(e){super(e),this.isImageBitmapLoader=!0,typeof createImageBitmap>"u"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch>"u"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(e){return this.options=e,this}load(e,i,r,n){void 0===e&&(e=""),void 0!==this.path&&(e=this.path+e),e=this.manager.resolveURL(e);let s=this,a=n7.get(e);if(void 0!==a){if(s.manager.itemStart(e),a.then){a.then(r=>{i&&i(r),s.manager.itemEnd(e)}).catch(e=>{n&&n(e)});return}return setTimeout(function(){i&&i(a),s.manager.itemEnd(e)},0),a}let o={};o.credentials="anonymous"===this.crossOrigin?"same-origin":"include",o.headers=this.requestHeader;let l=fetch(e,o).then(function(e){return e.blob()}).then(function(e){return createImageBitmap(e,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(r){return n7.add(e,r),i&&i(r),s.manager.itemEnd(e),r}).catch(function(i){n&&n(i),n7.remove(e),s.manager.itemError(e),s.manager.itemEnd(e)});n7.add(e,l),s.manager.itemStart(e)}},sw=class{constructor(e=!0){this.autoStart=e,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=sM(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let e=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){let i=sM();e=(i-this.oldTime)/1e3,this.oldTime=i,this.elapsedTime+=e}return e}};function sM(){return(typeof performance>"u"?Date:performance).now()}var sA=class{constructor(e,i,r){let n,s,a;switch(this.binding=e,this.valueSize=r,i){case"quaternion":n=this._slerp,s=this._slerpAdditive,a=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(6*r),this._workIndex=5;break;case"string":case"bool":n=this._select,s=this._select,a=this._setAdditiveIdentityOther,this.buffer=Array(5*r);break;default:n=this._lerp,s=this._lerpAdditive,a=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(5*r)}this._mixBufferRegion=n,this._mixBufferRegionAdditive=s,this._setIdentity=a,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(e,i){let r=this.buffer,n=this.valueSize,s=e*n+n,a=this.cumulativeWeight;if(0===a){for(let e=0;e!==n;++e)r[s+e]=r[e];a=i}else{a+=i;let e=i/a;this._mixBufferRegion(r,s,0,e,n)}this.cumulativeWeight=a}accumulateAdditive(e){let i=this.buffer,r=this.valueSize,n=r*this._addIndex;0===this.cumulativeWeightAdditive&&this._setIdentity(),this._mixBufferRegionAdditive(i,n,0,e,r),this.cumulativeWeightAdditive+=e}apply(e){let i=this.valueSize,r=this.buffer,n=e*i+i,s=this.cumulativeWeight,a=this.cumulativeWeightAdditive,o=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){let e=i*this._origIndex;this._mixBufferRegion(r,n,e,1-s,i)}a>0&&this._mixBufferRegionAdditive(r,n,this._addIndex*i,1,i);for(let e=i,s=i+i;e!==s;++e)if(r[e]!==r[e+i]){o.setValue(r,n);break}}saveOriginalState(){let e=this.binding,i=this.buffer,r=this.valueSize,n=r*this._origIndex;e.getValue(i,n);for(let e=r;e!==n;++e)i[e]=i[n+e%r];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){let e=3*this.valueSize;this.binding.setValue(this.buffer,e)}_setAdditiveIdentityNumeric(){let e=this._addIndex*this.valueSize,i=e+this.valueSize;for(let r=e;r<i;r++)this.buffer[r]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){let e=this._origIndex*this.valueSize,i=this._addIndex*this.valueSize;for(let r=0;r<this.valueSize;r++)this.buffer[i+r]=this.buffer[e+r]}_select(e,i,r,n,s){if(n>=.5)for(let n=0;n!==s;++n)e[i+n]=e[r+n]}_slerp(e,i,r,n){tY.slerpFlat(e,i,e,i,e,r,n)}_slerpAdditive(e,i,r,n,s){let a=this._workIndex*s;tY.multiplyQuaternionsFlat(e,a,e,i,e,r),tY.slerpFlat(e,i,e,i,e,a,n)}_lerp(e,i,r,n,s){let a=1-n;for(let o=0;o!==s;++o){let s=i+o;e[s]=e[s]*a+e[r+o]*n}}_lerpAdditive(e,i,r,n,s){for(let a=0;a!==s;++a){let s=i+a;e[s]=e[s]+e[r+a]*n}}},sS="\\[\\]\\.:\\/",sT=RegExp("["+sS+"]","g"),sC="[^"+sS+"]",sP="[^"+sS.replace("\\.","")+"]",sE=RegExp("^"+/((?:WC+[\/:])*)/.source.replace("WC",sC)+/(WCOD+)?/.source.replace("WCOD",sP)+/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",sC)+/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",sC)+"$"),sI=["material","materials","bones","map"],sz=class{constructor(e,i,r){let n=r||sR.parseTrackName(i);this._targetGroup=e,this._bindings=e.subscribe_(i,n)}getValue(e,i){this.bind();let r=this._targetGroup.nCachedObjects_,n=this._bindings[r];void 0!==n&&n.getValue(e,i)}setValue(e,i){let r=this._bindings;for(let n=this._targetGroup.nCachedObjects_,s=r.length;n!==s;++n)r[n].setValue(e,i)}bind(){let e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=e.length;i!==r;++i)e[i].bind()}unbind(){let e=this._bindings;for(let i=this._targetGroup.nCachedObjects_,r=e.length;i!==r;++i)e[i].unbind()}},sR=class e{constructor(i,r,n){this.path=r,this.parsedPath=n||e.parseTrackName(r),this.node=e.findNode(i,this.parsedPath.nodeName),this.rootNode=i,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(i,r,n){return i&&i.isAnimationObjectGroup?new e.Composite(i,r,n):new e(i,r,n)}static sanitizeNodeName(e){return e.replace(/\s/g,"_").replace(sT,"")}static parseTrackName(e){let i=sE.exec(e);if(null===i)throw Error("PropertyBinding: Cannot parse trackName: "+e);let r={nodeName:i[2],objectName:i[3],objectIndex:i[4],propertyName:i[5],propertyIndex:i[6]},n=r.nodeName&&r.nodeName.lastIndexOf(".");if(void 0!==n&&-1!==n){let e=r.nodeName.substring(n+1);-1!==sI.indexOf(e)&&(r.nodeName=r.nodeName.substring(0,n),r.objectName=e)}if(null===r.propertyName||0===r.propertyName.length)throw Error("PropertyBinding: can not parse propertyName from trackName: "+e);return r}static findNode(e,i){if(void 0===i||""===i||"."===i||-1===i||i===e.name||i===e.uuid)return e;if(e.skeleton){let r=e.skeleton.getBoneByName(i);if(void 0!==r)return r}if(e.children){let r=function(e){for(let n=0;n<e.length;n++){let s=e[n];if(s.name===i||s.uuid===i)return s;let a=r(s.children);if(a)return a}return null},n=r(e.children);if(n)return n}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(e,i){e[i]=this.targetObject[this.propertyName]}_getValue_array(e,i){let r=this.resolvedProperty;for(let n=0,s=r.length;n!==s;++n)e[i++]=r[n]}_getValue_arrayElement(e,i){e[i]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(e,i){this.resolvedProperty.toArray(e,i)}_setValue_direct(e,i){this.targetObject[this.propertyName]=e[i]}_setValue_direct_setNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(e,i){this.targetObject[this.propertyName]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(e,i){let r=this.resolvedProperty;for(let n=0,s=r.length;n!==s;++n)r[n]=e[i++]}_setValue_array_setNeedsUpdate(e,i){let r=this.resolvedProperty;for(let n=0,s=r.length;n!==s;++n)r[n]=e[i++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(e,i){let r=this.resolvedProperty;for(let n=0,s=r.length;n!==s;++n)r[n]=e[i++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(e,i){this.resolvedProperty[this.propertyIndex]=e[i]}_setValue_arrayElement_setNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty[this.propertyIndex]=e[i],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(e,i){this.resolvedProperty.fromArray(e,i)}_setValue_fromArray_setNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(e,i){this.resolvedProperty.fromArray(e,i),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(e,i){this.bind(),this.getValue(e,i)}_setValue_unbound(e,i){this.bind(),this.setValue(e,i)}bind(){let i=this.node,r=this.parsedPath,n=r.objectName,s=r.propertyName,a=r.propertyIndex;if(i||(i=e.findNode(this.rootNode,r.nodeName),this.node=i),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!i){console.warn("THREE.PropertyBinding: No target node found for track: "+this.path+".");return}if(n){let e=r.objectIndex;switch(n){case"materials":if(!i.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!i.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}i=i.material.materials;break;case"bones":if(!i.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}i=i.skeleton.bones;for(let r=0;r<i.length;r++)if(i[r].name===e){e=r;break}break;case"map":if("map"in i){i=i.map;break}if(!i.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!i.material.map){console.error("THREE.PropertyBinding: Can not bind to material.map as node.material does not have a map.",this);return}i=i.material.map;break;default:if(void 0===i[n]){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}i=i[n]}if(void 0!==e){if(void 0===i[e]){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,i);return}i=i[e]}}let o=i[s];if(void 0===o){console.error("THREE.PropertyBinding: Trying to update property for track: "+r.nodeName+"."+s+" but it wasn't found.",i);return}let l=this.Versioning.None;this.targetObject=i,void 0!==i.needsUpdate?l=this.Versioning.NeedsUpdate:void 0!==i.matrixWorldNeedsUpdate&&(l=this.Versioning.MatrixWorldNeedsUpdate);let h=this.BindingType.Direct;if(void 0!==a){if("morphTargetInfluences"===s){if(!i.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!i.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}void 0!==i.morphTargetDictionary[a]&&(a=i.morphTargetDictionary[a])}h=this.BindingType.ArrayElement,this.resolvedProperty=o,this.propertyIndex=a}else void 0!==o.fromArray&&void 0!==o.toArray?(h=this.BindingType.HasFromToArray,this.resolvedProperty=o):Array.isArray(o)?(h=this.BindingType.EntireArray,this.resolvedProperty=o):this.propertyName=s;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][l]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}};sR.Composite=sz,sR.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},sR.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},sR.prototype.GetterByBindingType=[sR.prototype._getValue_direct,sR.prototype._getValue_array,sR.prototype._getValue_arrayElement,sR.prototype._getValue_toArray],sR.prototype.SetterByBindingTypeAndVersioning=[[sR.prototype._setValue_direct,sR.prototype._setValue_direct_setNeedsUpdate,sR.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[sR.prototype._setValue_array,sR.prototype._setValue_array_setNeedsUpdate,sR.prototype._setValue_array_setMatrixWorldNeedsUpdate],[sR.prototype._setValue_arrayElement,sR.prototype._setValue_arrayElement_setNeedsUpdate,sR.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[sR.prototype._setValue_fromArray,sR.prototype._setValue_fromArray_setNeedsUpdate,sR.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];var sB=class{constructor(e,i,r=null,n=i.blendMode){this._mixer=e,this._clip=i,this._localRoot=r,this.blendMode=n;let s=i.tracks,a=s.length,o=Array(a),l={endingStart:2400,endingEnd:2400};for(let e=0;e!==a;++e){let i=s[e].createInterpolant(null);o[e]=i,i.settings=l}this._interpolantSettings=l,this._interpolants=o,this._propertyBindings=Array(a),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=2201,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(e){return this._startTime=e,this}setLoop(e,i){return this.loop=e,this.repetitions=i,this}setEffectiveWeight(e){return this.weight=e,this._effectiveWeight=this.enabled?e:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(e){return this._scheduleFading(e,0,1)}fadeOut(e){return this._scheduleFading(e,1,0)}crossFadeFrom(e,i,r){if(e.fadeOut(i),this.fadeIn(i),r){let r=this._clip.duration,n=e._clip.duration;e.warp(1,n/r,i),this.warp(r/n,1,i)}return this}crossFadeTo(e,i,r){return e.crossFadeFrom(this,i,r)}stopFading(){let e=this._weightInterpolant;return null!==e&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}setEffectiveTimeScale(e){return this.timeScale=e,this._effectiveTimeScale=this.paused?0:e,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(e){return this.timeScale=this._clip.duration/e,this.stopWarping()}syncWith(e){return this.time=e.time,this.timeScale=e.timeScale,this.stopWarping()}halt(e){return this.warp(this._effectiveTimeScale,0,e)}warp(e,i,r){let n=this._mixer,s=n.time,a=this.timeScale,o=this._timeScaleInterpolant;null===o&&(o=n._lendControlInterpolant(),this._timeScaleInterpolant=o);let l=o.parameterPositions,h=o.sampleValues;return l[0]=s,l[1]=s+r,h[0]=e/a,h[1]=i/a,this}stopWarping(){let e=this._timeScaleInterpolant;return null!==e&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(e)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(e,i,r,n){if(!this.enabled){this._updateWeight(e);return}let s=this._startTime;if(null!==s){let n=(e-s)*r;n<0||0===r?i=0:(this._startTime=null,i=r*n)}i*=this._updateTimeScale(e);let a=this._updateTime(i),o=this._updateWeight(e);if(o>0){let e=this._interpolants,i=this._propertyBindings;if(2501===this.blendMode)for(let r=0,n=e.length;r!==n;++r)e[r].evaluate(a),i[r].accumulateAdditive(o);else for(let r=0,s=e.length;r!==s;++r)e[r].evaluate(a),i[r].accumulate(n,o)}}_updateWeight(e){let i=0;if(this.enabled){i=this.weight;let r=this._weightInterpolant;if(null!==r){let n=r.evaluate(e)[0];i*=n,e>r.parameterPositions[1]&&(this.stopFading(),0===n&&(this.enabled=!1))}}return this._effectiveWeight=i,i}_updateTimeScale(e){let i=0;if(!this.paused){i=this.timeScale;let r=this._timeScaleInterpolant;null!==r&&(i*=r.evaluate(e)[0],e>r.parameterPositions[1]&&(this.stopWarping(),0===i?this.paused=!0:this.timeScale=i))}return this._effectiveTimeScale=i,i}_updateTime(e){let i=this._clip.duration,r=this.loop,n=this.time+e,s=this._loopCount,a=2202===r;if(0===e)return -1===s?n:a&&(1&s)==1?i-n:n;if(2200===r){-1===s&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(n>=i)n=i;else if(n<0)n=0;else{this.time=n;break t}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e<0?-1:1})}}else{if(-1===s&&(e>=0?(s=0,this._setEndings(!0,0===this.repetitions,a)):this._setEndings(0===this.repetitions,!0,a)),n>=i||n<0){let r=Math.floor(n/i);n-=i*r,s+=Math.abs(r);let o=this.repetitions-s;if(o<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,n=e>0?i:0,this.time=n,this._mixer.dispatchEvent({type:"finished",action:this,direction:e>0?1:-1});else{if(1===o){let i=e<0;this._setEndings(i,!i,a)}else this._setEndings(!1,!1,a);this._loopCount=s,this.time=n,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:r})}}else this.time=n;if(a&&(1&s)==1)return i-n}return n}_setEndings(e,i,r){let n=this._interpolantSettings;r?(n.endingStart=2401,n.endingEnd=2401):(e?n.endingStart=this.zeroSlopeAtStart?2401:2400:n.endingStart=2402,i?n.endingEnd=this.zeroSlopeAtEnd?2401:2400:n.endingEnd=2402)}_scheduleFading(e,i,r){let n=this._mixer,s=n.time,a=this._weightInterpolant;null===a&&(a=n._lendControlInterpolant(),this._weightInterpolant=a);let o=a.parameterPositions,l=a.sampleValues;return o[0]=s,l[0]=i,o[1]=s+e,l[1]=r,this}},sk=new Float32Array(1),sO=class extends t_{constructor(e){super(),this._root=e,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(e,i){let r=e._localRoot||this._root,n=e._clip.tracks,s=n.length,a=e._propertyBindings,o=e._interpolants,l=r.uuid,h=this._bindingsByRootAndName,u=h[l];void 0===u&&(u={},h[l]=u);for(let e=0;e!==s;++e){let s=n[e],h=s.name,c=u[h];if(void 0!==c)++c.referenceCount,a[e]=c;else{if(void 0!==(c=a[e])){null===c._cacheIndex&&(++c.referenceCount,this._addInactiveBinding(c,l,h));continue}let n=i&&i._propertyBindings[e].binding.parsedPath;c=new sA(sR.create(r,h,n),s.ValueTypeName,s.getValueSize()),++c.referenceCount,this._addInactiveBinding(c,l,h),a[e]=c}o[e].resultBuffer=c.buffer}}_activateAction(e){if(!this._isActiveAction(e)){if(null===e._cacheIndex){let i=(e._localRoot||this._root).uuid,r=e._clip.uuid,n=this._actionsByClip[r];this._bindAction(e,n&&n.knownActions[0]),this._addInactiveAction(e,r,i)}let i=e._propertyBindings;for(let e=0,r=i.length;e!==r;++e){let r=i[e];0==r.useCount++&&(this._lendBinding(r),r.saveOriginalState())}this._lendAction(e)}}_deactivateAction(e){if(this._isActiveAction(e)){let i=e._propertyBindings;for(let e=0,r=i.length;e!==r;++e){let r=i[e];0==--r.useCount&&(r.restoreOriginalState(),this._takeBackBinding(r))}this._takeBackAction(e)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;let e=this;this.stats={actions:{get total(){return e._actions.length},get inUse(){return e._nActiveActions}},bindings:{get total(){return e._bindings.length},get inUse(){return e._nActiveBindings}},controlInterpolants:{get total(){return e._controlInterpolants.length},get inUse(){return e._nActiveControlInterpolants}}}}_isActiveAction(e){let i=e._cacheIndex;return null!==i&&i<this._nActiveActions}_addInactiveAction(e,i,r){let n=this._actions,s=this._actionsByClip,a=s[i];if(void 0===a)a={knownActions:[e],actionByRoot:{}},e._byClipCacheIndex=0,s[i]=a;else{let i=a.knownActions;e._byClipCacheIndex=i.length,i.push(e)}e._cacheIndex=n.length,n.push(e),a.actionByRoot[r]=e}_removeInactiveAction(e){let i=this._actions,r=i[i.length-1],n=e._cacheIndex;r._cacheIndex=n,i[n]=r,i.pop(),e._cacheIndex=null;let s=e._clip.uuid,a=this._actionsByClip,o=a[s],l=o.knownActions,h=l[l.length-1],u=e._byClipCacheIndex;h._byClipCacheIndex=u,l[u]=h,l.pop(),e._byClipCacheIndex=null;let c=o.actionByRoot,d=(e._localRoot||this._root).uuid;delete c[d],0===l.length&&delete a[s],this._removeInactiveBindingsForAction(e)}_removeInactiveBindingsForAction(e){let i=e._propertyBindings;for(let e=0,r=i.length;e!==r;++e){let r=i[e];0==--r.referenceCount&&this._removeInactiveBinding(r)}}_lendAction(e){let i=this._actions,r=e._cacheIndex,n=this._nActiveActions++,s=i[n];e._cacheIndex=n,i[n]=e,s._cacheIndex=r,i[r]=s}_takeBackAction(e){let i=this._actions,r=e._cacheIndex,n=--this._nActiveActions,s=i[n];e._cacheIndex=n,i[n]=e,s._cacheIndex=r,i[r]=s}_addInactiveBinding(e,i,r){let n=this._bindingsByRootAndName,s=this._bindings,a=n[i];void 0===a&&(a={},n[i]=a),a[r]=e,e._cacheIndex=s.length,s.push(e)}_removeInactiveBinding(e){let i=this._bindings,r=e.binding,n=r.rootNode.uuid,s=r.path,a=this._bindingsByRootAndName,o=a[n],l=i[i.length-1],h=e._cacheIndex;l._cacheIndex=h,i[h]=l,i.pop(),delete o[s],0===Object.keys(o).length&&delete a[n]}_lendBinding(e){let i=this._bindings,r=e._cacheIndex,n=this._nActiveBindings++,s=i[n];e._cacheIndex=n,i[n]=e,s._cacheIndex=r,i[r]=s}_takeBackBinding(e){let i=this._bindings,r=e._cacheIndex,n=--this._nActiveBindings,s=i[n];e._cacheIndex=n,i[n]=e,s._cacheIndex=r,i[r]=s}_lendControlInterpolant(){let e=this._controlInterpolants,i=this._nActiveControlInterpolants++,r=e[i];return void 0===r&&((r=new nK(new Float32Array(2),new Float32Array(2),1,sk)).__cacheIndex=i,e[i]=r),r}_takeBackControlInterpolant(e){let i=this._controlInterpolants,r=e.__cacheIndex,n=--this._nActiveControlInterpolants,s=i[n];e.__cacheIndex=n,i[n]=e,s.__cacheIndex=r,i[r]=s}clipAction(e,i,r){let n=i||this._root,s=n.uuid,a="string"==typeof e?n9.findByName(n,e):e,o=null!==a?a.uuid:e,l=this._actionsByClip[o],h=null;if(void 0===r&&(r=null!==a?a.blendMode:2500),void 0!==l){let e=l.actionByRoot[s];if(void 0!==e&&e.blendMode===r)return e;h=l.knownActions[0],null===a&&(a=h._clip)}if(null===a)return null;let u=new sB(this,a,i,r);return this._bindAction(u,h),this._addInactiveAction(u,o,s),u}existingAction(e,i){let r=i||this._root,n=r.uuid,s="string"==typeof e?n9.findByName(r,e):e,a=s?s.uuid:e,o=this._actionsByClip[a];return void 0!==o&&o.actionByRoot[n]||null}stopAllAction(){let e=this._actions,i=this._nActiveActions;for(let r=i-1;r>=0;--r)e[r].stop();return this}update(e){e*=this.timeScale;let i=this._actions,r=this._nActiveActions,n=this.time+=e,s=Math.sign(e),a=this._accuIndex^=1;for(let o=0;o!==r;++o)i[o]._update(n,e,s,a);let o=this._bindings,l=this._nActiveBindings;for(let e=0;e!==l;++e)o[e].apply(a);return this}setTime(e){this.time=0;for(let e=0;e<this._actions.length;e++)this._actions[e].time=0;return this.update(e)}getRoot(){return this._root}uncacheClip(e){let i=this._actions,r=e.uuid,n=this._actionsByClip,s=n[r];if(void 0!==s){let e=s.knownActions;for(let r=0,n=e.length;r!==n;++r){let n=e[r];this._deactivateAction(n);let s=n._cacheIndex,a=i[i.length-1];n._cacheIndex=null,n._byClipCacheIndex=null,a._cacheIndex=s,i[s]=a,i.pop(),this._removeInactiveBindingsForAction(n)}delete n[r]}}uncacheRoot(e){let i=e.uuid,r=this._actionsByClip;for(let e in r){let n=r[e].actionByRoot[i];void 0!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}let n=this._bindingsByRootAndName[i];if(void 0!==n)for(let e in n){let i=n[e];i.restoreOriginalState(),this._removeInactiveBinding(i)}}uncacheAction(e,i){let r=this.existingAction(e,i);null!==r&&(this._deactivateAction(r),this._removeInactiveAction(r))}},sL=new eg,sN=class{constructor(e,i,r=0,n=1/0){this.ray=new em(e,i),this.near=r,this.far=n,this.camera=null,this.layers=new eC,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(e,i){this.ray.set(e,i)}setFromCamera(e,i){i.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(i.matrixWorld),this.ray.direction.set(e.x,e.y,.5).unproject(i).sub(this.ray.origin).normalize(),this.camera=i):i.isOrthographicCamera?(this.ray.origin.set(e.x,e.y,(i.near+i.far)/(i.near-i.far)).unproject(i),this.ray.direction.set(0,0,-1).transformDirection(i.matrixWorld),this.camera=i):console.error("THREE.Raycaster: Unsupported camera type: "+i.type)}setFromXRController(e){return sL.identity().extractRotation(e.matrixWorld),this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(0,0,-1).applyMatrix4(sL),this}intersectObject(e,i=!0,r=[]){return sD(e,this,r,i),r.sort(sF),r}intersectObjects(e,i=!0,r=[]){for(let n=0,s=e.length;n<s;n++)sD(e[n],this,r,i);return r.sort(sF),r}};function sF(e,i){return e.distance-i.distance}function sD(e,i,r,n){let s=!0;if(e.layers.test(i.layers)&&!1===e.raycast(i,r)&&(s=!1),!0===s&&!0===n){let n=e.children;for(let e=0,s=n.length;e<s;e++)sD(n[e],i,r,!0)}}var sU=new tZ,sj=new tZ,sV=class{constructor(e=new tZ,i=new tZ){this.start=e,this.end=i}set(e,i){return this.start.copy(e),this.end.copy(i),this}copy(e){return this.start.copy(e.start),this.end.copy(e.end),this}getCenter(e){return e.addVectors(this.start,this.end).multiplyScalar(.5)}delta(e){return e.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(e,i){return this.delta(i).multiplyScalar(e).add(this.start)}closestPointToPointParameter(e,i){sU.subVectors(e,this.start),sj.subVectors(this.end,this.start);let r=sj.dot(sj),n=sj.dot(sU)/r;return i&&(n=tA(n,0,1)),n}closestPointToPoint(e,i,r){let n=this.closestPointToPointParameter(e,i);return this.delta(r).multiplyScalar(n).add(this.start)}applyMatrix4(e){return this.start.applyMatrix4(e),this.end.applyMatrix4(e),this}equals(e){return e.start.equals(this.start)&&e.end.equals(this.end)}clone(){return new this.constructor().copy(this)}};"u">typeof __THREE_DEVTOOLS__&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:"167"}})),"u">typeof window&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__="167");var sW=Symbol("SKIP_GENERATION");function sH(e){return(e.index?e.index.count:e.attributes.position.count)/3}function sq(e){let i=sH(e),r=e.drawRange,n=r.start/3,s=(r.start+r.count)/3,a=Math.max(0,n),o=Math.min(i,s)-a;return[{offset:Math.floor(a),count:Math.floor(o)}]}function sG(e){if(!e.groups||!e.groups.length)return sq(e);let i=[],r=new Set,n=e.drawRange,s=n.start/3,a=(n.start+n.count)/3;for(let i of e.groups){let e=i.start/3,n=(i.start+i.count)/3;r.add(Math.max(s,e)),r.add(Math.min(a,n))}let o=Array.from(r.values()).sort((e,i)=>e-i);for(let e=0;e<o.length-1;e++){let r=o[e],n=o[e+1];i.push({offset:Math.floor(r),count:Math.floor(n-r)})}return i}function sJ(e,i,r,n,s){let a=1/0,o=1/0,l=1/0,h=-1/0,u=-1/0,c=-1/0,d=1/0,p=1/0,f=1/0,m=-1/0,g=-1/0,y=-1/0;for(let n=6*i,s=(i+r)*6;n<s;n+=6){let i=e[n+0],r=e[n+1],s=i-r,v=i+r;s<a&&(a=s),v>h&&(h=v),i<d&&(d=i),i>m&&(m=i);let _=e[n+2],x=e[n+3],b=_-x,w=_+x;b<o&&(o=b),w>u&&(u=w),_<p&&(p=_),_>g&&(g=_);let M=e[n+4],A=e[n+5],S=M-A,T=M+A;S<l&&(l=S),T>c&&(c=T),M<f&&(f=M),M>y&&(y=M)}n[0]=a,n[1]=o,n[2]=l,n[3]=h,n[4]=u,n[5]=c,s[0]=d,s[1]=p,s[2]=f,s[3]=m,s[4]=g,s[5]=y}function sX(e,i,r){return r.min.x=i[e],r.min.y=i[e+1],r.min.z=i[e+2],r.max.x=i[e+3],r.max.y=i[e+4],r.max.z=i[e+5],r}function sY(e){let i=-1,r=-1/0;for(let n=0;n<3;n++){let s=e[n+3]-e[n];s>r&&(r=s,i=n)}return i}function sZ(e,i,r){let n,s;for(let a=0;a<3;a++){let o=a+3;n=e[a],s=i[a],r[a]=n<s?n:s,n=e[o],s=i[o],r[o]=n>s?n:s}}function sK(e,i,r){for(let n=0;n<3;n++){let s=i[e+2*n],a=i[e+2*n+1],o=s-a,l=s+a;o<r[n]&&(r[n]=o),l>r[n+3]&&(r[n+3]=l)}}function s$(e){let i=e[3]-e[0],r=e[4]-e[1],n=e[5]-e[2];return 2*(i*r+r*n+n*i)}var sQ=(e,i)=>e.candidate-i.candidate,s0=Array(32).fill().map(()=>({count:0,bounds:new Float32Array(6),rightCacheBounds:new Float32Array(6),leftCacheBounds:new Float32Array(6),candidate:0})),s1=new Float32Array(6),s2=class{constructor(){this.boundingData=new Float32Array(6)}};function s3(e,i,r,n,s,a){let o=n,l=n+s-1,h=a.pos,u=2*a.axis;for(;;){for(;o<=l&&r[6*o+u]<h;)o++;for(;o<=l&&r[6*l+u]>=h;)l--;if(!(o<l))return o;for(let e=0;e<3;e++){let r=i[3*o+e];i[3*o+e]=i[3*l+e],i[3*l+e]=r}for(let e=0;e<6;e++){let i=r[6*o+e];r[6*o+e]=r[6*l+e],r[6*l+e]=i}o++,l--}}function s4(e,i,r,n,s,a){let o=n,l=n+s-1,h=a.pos,u=2*a.axis;for(;;){for(;o<=l&&r[6*o+u]<h;)o++;for(;o<=l&&r[6*l+u]>=h;)l--;if(!(o<l))return o;{let i=e[o];e[o]=e[l],e[l]=i;for(let e=0;e<6;e++){let i=r[6*o+e];r[6*o+e]=r[6*l+e],r[6*l+e]=i}o++,l--}}}function s5(e,i){return 65535===i[e+15]}function s6(e,i){return i[e+14]}var s9=class{constructor(){this.min=1/0,this.max=-1/0}setFromPointsField(e,i){let r=1/0,n=-1/0;for(let s=0,a=e.length;s<a;s++){let a=e[s][i];r=a<r?a:r,n=a>n?a:n}this.min=r,this.max=n}setFromPoints(e,i){let r=1/0,n=-1/0;for(let s=0,a=i.length;s<a;s++){let a=i[s],o=e.dot(a);r=o<r?o:r,n=o>n?o:n}this.min=r,this.max=n}isSeparated(e){return this.min>e.max||e.min>this.max}};s9.prototype.setFromBox=(n=new tZ,function(e,i){let r=i.min,s=i.max,a=1/0,o=-1/0;for(let i=0;i<=1;i++)for(let l=0;l<=1;l++)for(let h=0;h<=1;h++){n.x=r.x*i+s.x*(1-i),n.y=r.y*l+s.y*(1-l),n.z=r.z*h+s.z*(1-h);let u=e.dot(n);a=Math.min(u,a),o=Math.max(u,o)}this.min=a,this.max=o});var s7=(s=new tZ,a=new tZ,o=new tZ,function(e,i,r){let n=e.start,l=i.start;o.subVectors(n,l),s.subVectors(e.end,e.start),a.subVectors(i.end,i.start);let h=o.dot(a),u=a.dot(s),c=a.dot(a),d=o.dot(s),p=s.dot(s)*c-u*u,f,m;f=0!==p?(h*u-d*c)/p:0,m=(h+f*u)/c,r.x=f,r.y=m}),s8=(l=new tP,h=new tZ,u=new tZ,function(e,i,r,n){s7(e,i,l);let s=l.x,a=l.y;if(s>=0&&s<=1&&a>=0&&a<=1){e.at(s,r),i.at(a,n);return}if(s>=0&&s<=1){a<0?i.at(0,n):i.at(1,n),e.closestPointToPoint(n,!0,r);return}if(a>=0&&a<=1){s<0?e.at(0,r):e.at(1,r),i.closestPointToPoint(r,!0,n);return}{let o,l;if(o=s<0?e.start:e.end,l=a<0?i.start:i.end,e.closestPointToPoint(l,!0,h),i.closestPointToPoint(o,!0,u),h.distanceToSquared(l)<=u.distanceToSquared(o)){r.copy(h),n.copy(l);return}r.copy(o),n.copy(u);return}}),at=(c=new tZ,d=new tZ,p=new iH,f=new sV,function(e,i){let{radius:r,center:n}=e,{a:s,b:a,c:o}=i;if(f.start=s,f.end=a,f.closestPointToPoint(n,!0,c).distanceTo(n)<=r||(f.start=s,f.end=o,f.closestPointToPoint(n,!0,c).distanceTo(n)<=r)||(f.start=a,f.end=o,f.closestPointToPoint(n,!0,c).distanceTo(n)<=r))return!0;let l=i.getPlane(p);if(Math.abs(l.distanceToPoint(n))<=r){let e=l.projectPoint(n,d);if(i.containsPoint(e))return!0}return!1});function ae(e){return 1e-15>Math.abs(e)}var ai=class extends e0{constructor(...e){super(...e),this.isExtendedTriangle=!0,this.satAxes=[,,,,].fill().map(()=>new tZ),this.satBounds=[,,,,].fill().map(()=>new s9),this.points=[this.a,this.b,this.c],this.sphere=new eo,this.plane=new iH,this.needsUpdate=!0}intersectsSphere(e){return at(e,this)}update(){let e=this.a,i=this.b,r=this.c,n=this.points,s=this.satAxes,a=this.satBounds,o=s[0],l=a[0];this.getNormal(o),l.setFromPoints(o,n);let h=s[1],u=a[1];h.subVectors(e,i),u.setFromPoints(h,n);let c=s[2],d=a[2];c.subVectors(i,r),d.setFromPoints(c,n);let p=s[3],f=a[3];p.subVectors(r,e),f.setFromPoints(p,n),this.sphere.setFromPoints(this.points),this.plane.setFromNormalAndCoplanarPoint(o,e),this.needsUpdate=!1}};ai.prototype.closestPointToSegment=(m=new tZ,g=new tZ,y=new sV,function(e,i=null,r=null){let{start:n,end:s}=e,a=this.points,o,l=1/0;for(let n=0;n<3;n++){let s=(n+1)%3;y.start.copy(a[n]),y.end.copy(a[s]),s8(y,e,m,g),(o=m.distanceToSquared(g))<l&&(l=o,i&&i.copy(m),r&&r.copy(g))}return this.closestPointToPoint(n,m),(o=n.distanceToSquared(m))<l&&(l=o,i&&i.copy(m),r&&r.copy(n)),this.closestPointToPoint(s,m),(o=s.distanceToSquared(m))<l&&(l=o,i&&i.copy(m),r&&r.copy(s)),Math.sqrt(l)}),ai.prototype.intersectsTriangle=function(){let e=new ai,i=[,,,],r=[,,,],n=new s9,s=new s9,a=new tZ,o=new tZ,l=new tZ,h=new tZ,u=new tZ,c=new sV,d=new sV,p=new sV,f=new tZ;function m(e,i,r){let n=e.points,s=0,a=-1;for(let e=0;e<3;e++){let{start:l,end:h}=c;l.copy(n[e]),h.copy(n[(e+1)%3]),c.delta(o);let u=ae(i.distanceToPoint(l));if(ae(i.normal.dot(o))&&u){r.copy(c),s=2;break}let d=i.intersectLine(c,f);if(!d&&u&&f.copy(l),(d||u)&&!ae(f.distanceTo(h))){if(s<=1)(1===s?r.start:r.end).copy(f),u&&(a=s);else if(s>=2){(1===a?r.start:r.end).copy(f),s=2;break}if(2==++s&&-1===a)break}}return s}return function(o,c=null,f=!1){this.needsUpdate&&this.update(),o.isExtendedTriangle?o.needsUpdate&&o.update():(e.copy(o),e.update(),o=e);let g=this.plane,y=o.plane;if(Math.abs(g.normal.dot(y.normal))>1-1e-10){let e=this.satBounds,l=this.satAxes;r[0]=o.a,r[1]=o.b,r[2]=o.c;for(let i=0;i<4;i++){let s=e[i],a=l[i];if(n.setFromPoints(a,r),s.isSeparated(n))return!1}let h=o.satBounds,u=o.satAxes;i[0]=this.a,i[1]=this.b,i[2]=this.c;for(let e=0;e<4;e++){let r=h[e],s=u[e];if(n.setFromPoints(s,i),r.isSeparated(n))return!1}for(let e=0;e<4;e++){let o=l[e];for(let e=0;e<4;e++){let l=u[e];if(a.crossVectors(o,l),n.setFromPoints(a,i),s.setFromPoints(a,r),n.isSeparated(s))return!1}}return c&&(f||console.warn("ExtendedTriangle.intersectsTriangle: Triangles are coplanar which does not support an output edge. Setting edge to 0, 0, 0."),c.start.set(0,0,0),c.end.set(0,0,0)),!0}{let e=m(this,y,d);if(1===e&&o.containsPoint(d.end))return c&&(c.start.copy(d.end),c.end.copy(d.end)),!0;if(2!==e)return!1;let i=m(o,g,p);if(1===i&&this.containsPoint(p.end))return c&&(c.start.copy(p.end),c.end.copy(p.end)),!0;if(2!==i)return!1;if(d.delta(l),p.delta(h),0>l.dot(h)){let e=p.start;p.start=p.end,p.end=e}let r=d.start.dot(l),n=d.end.dot(l),s=p.start.dot(l),a=p.end.dot(l);return(r===a||s===n||n<s!=r<a)&&(c&&(u.subVectors(d.start,p.start),u.dot(l)>0?c.start.copy(d.start):c.start.copy(p.start),u.subVectors(d.end,p.end),0>u.dot(l)?c.end.copy(d.end):c.end.copy(p.end)),!0)}}}(),ai.prototype.distanceToPoint=(v=new tZ,function(e){return this.closestPointToPoint(e,v),e.distanceTo(v)}),ai.prototype.distanceToTriangle=(_=new tZ,x=new tZ,b=["a","b","c"],w=new sV,M=new sV,function(e,i=null,r=null){let n=i||r?w:null;if(this.intersectsTriangle(e,n))return(i||r)&&(i&&n.getCenter(i),r&&n.getCenter(r)),0;let s=1/0;for(let n=0;n<3;n++){let a,o=b[n],l=e[o];this.closestPointToPoint(l,_),(a=l.distanceToSquared(_))<s&&(s=a,i&&i.copy(_),r&&r.copy(l));let h=this[o];e.closestPointToPoint(h,_),(a=h.distanceToSquared(_))<s&&(s=a,i&&i.copy(h),r&&r.copy(_))}for(let n=0;n<3;n++){let a=b[n],o=b[(n+1)%3];w.set(this[a],this[o]);for(let n=0;n<3;n++){let a=b[n],o=b[(n+1)%3];M.set(e[a],e[o]),s8(w,M,_,x);let l=_.distanceToSquared(x);l<s&&(s=l,i&&i.copy(_),r&&r.copy(x))}}return Math.sqrt(s)});var ar=class{constructor(e,i,r){this.isOrientedBox=!0,this.min=new tZ,this.max=new tZ,this.matrix=new eg,this.invMatrix=new eg,this.points=Array(8).fill().map(()=>new tZ),this.satAxes=[,,,].fill().map(()=>new tZ),this.satBounds=[,,,].fill().map(()=>new s9),this.alignedSatBounds=[,,,].fill().map(()=>new s9),this.needsUpdate=!1,e&&this.min.copy(e),i&&this.max.copy(i),r&&this.matrix.copy(r)}set(e,i,r){this.min.copy(e),this.max.copy(i),this.matrix.copy(r),this.needsUpdate=!0}copy(e){this.min.copy(e.min),this.max.copy(e.max),this.matrix.copy(e.matrix),this.needsUpdate=!0}};ar.prototype.update=function(){let e=this.matrix,i=this.min,r=this.max,n=this.points;for(let s=0;s<=1;s++)for(let a=0;a<=1;a++)for(let o=0;o<=1;o++){let l=n[1*s|2*a|4*o];l.x=s?r.x:i.x,l.y=a?r.y:i.y,l.z=o?r.z:i.z,l.applyMatrix4(e)}let s=this.satBounds,a=this.satAxes,o=n[0];for(let e=0;e<3;e++){let i=a[e],r=s[e],l=n[1<<e];i.subVectors(o,l),r.setFromPoints(i,n)}let l=this.alignedSatBounds;l[0].setFromPointsField(n,"x"),l[1].setFromPointsField(n,"y"),l[2].setFromPointsField(n,"z"),this.invMatrix.copy(this.matrix).invert(),this.needsUpdate=!1},ar.prototype.intersectsBox=(A=new s9,function(e){this.needsUpdate&&this.update();let i=e.min,r=e.max,n=this.satBounds,s=this.satAxes,a=this.alignedSatBounds;if(A.min=i.x,A.max=r.x,a[0].isSeparated(A)||(A.min=i.y,A.max=r.y,a[1].isSeparated(A))||(A.min=i.z,A.max=r.z,a[2].isSeparated(A)))return!1;for(let i=0;i<3;i++){let r=s[i],a=n[i];if(A.setFromBox(r,e),a.isSeparated(A))return!1}return!0}),ar.prototype.intersectsTriangle=(S=new ai,T=[,,,],C=new s9,P=new s9,E=new tZ,function(e){this.needsUpdate&&this.update(),e.isExtendedTriangle?e.needsUpdate&&e.update():(S.copy(e),S.update(),e=S);let i=this.satBounds,r=this.satAxes;T[0]=e.a,T[1]=e.b,T[2]=e.c;for(let e=0;e<3;e++){let n=i[e],s=r[e];if(C.setFromPoints(s,T),n.isSeparated(C))return!1}let n=e.satBounds,s=e.satAxes,a=this.points;for(let e=0;e<3;e++){let i=n[e],r=s[e];if(C.setFromPoints(r,a),i.isSeparated(C))return!1}for(let e=0;e<3;e++){let i=r[e];for(let e=0;e<4;e++){let r=s[e];if(E.crossVectors(i,r),C.setFromPoints(E,T),P.setFromPoints(E,a),C.isSeparated(P))return!1}}return!0}),ar.prototype.closestPointToPoint=function(e,i){return this.needsUpdate&&this.update(),i.copy(e).applyMatrix4(this.invMatrix).clamp(this.min,this.max).applyMatrix4(this.matrix),i},ar.prototype.distanceToPoint=(I=new tZ,function(e){return this.closestPointToPoint(e,I),e.distanceTo(I)}),ar.prototype.distanceToBox=(z=["x","y","z"],R=Array(12).fill().map(()=>new sV),B=Array(12).fill().map(()=>new sV),k=new tZ,O=new tZ,function(e,i=0,r=null,n=null){if(this.needsUpdate&&this.update(),this.intersectsBox(e))return(r||n)&&(e.getCenter(O),this.closestPointToPoint(O,k),e.closestPointToPoint(k,O),r&&r.copy(k),n&&n.copy(O)),0;let s=i*i,a=e.min,o=e.max,l=this.points,h=1/0;for(let e=0;e<8;e++){let i=l[e];O.copy(i).clamp(a,o);let u=i.distanceToSquared(O);if(u<h&&(h=u,r&&r.copy(i),n&&n.copy(O),u<s))return Math.sqrt(u)}let u=0;for(let e=0;e<3;e++)for(let i=0;i<=1;i++)for(let r=0;r<=1;r++){let n=(e+1)%3,s=(e+2)%3,h=i<<n|r<<s,c=1<<e|i<<n|r<<s,d=l[h],p=l[c];R[u].set(d,p);let f=z[e],m=z[n],g=z[s],y=B[u],v=y.start,_=y.end;v[f]=a[f],v[m]=i?a[m]:o[m],v[g]=r?a[g]:o[m],_[f]=o[f],_[m]=i?a[m]:o[m],_[g]=r?a[g]:o[m],u++}for(let e=0;e<=1;e++)for(let i=0;i<=1;i++)for(let l=0;l<=1;l++){O.x=e?o.x:a.x,O.y=i?o.y:a.y,O.z=l?o.z:a.z,this.closestPointToPoint(O,k);let u=O.distanceToSquared(k);if(u<h&&(h=u,r&&r.copy(k),n&&n.copy(O),u<s))return Math.sqrt(u)}for(let e=0;e<12;e++){let i=R[e];for(let e=0;e<12;e++){s8(i,B[e],k,O);let a=k.distanceToSquared(O);if(a<h&&(h=a,r&&r.copy(k),n&&n.copy(O),a<s))return Math.sqrt(a)}}return Math.sqrt(h)});var an,as,aa,ao,al,ah,au=class{constructor(e){this._getNewPrimitive=e,this._primitives=[]}getPrimitive(){let e=this._primitives;return 0===e.length?this._getNewPrimitive():e.pop()}releasePrimitive(e){this._primitives.push(e)}},ac=new class extends au{constructor(){super(()=>new ai)}},ad=new class{constructor(){this.float32Array=null,this.uint16Array=null,this.uint32Array=null;let e=[],i=null;this.setBuffer=r=>{i&&e.push(i),i=r,this.float32Array=new Float32Array(r),this.uint16Array=new Uint16Array(r),this.uint32Array=new Uint32Array(r)},this.clearBuffer=()=>{i=null,this.float32Array=null,this.uint16Array=null,this.uint32Array=null,0!==e.length&&this.setBuffer(e.pop())}}},ap=[],af=new au(()=>new tQ),am=new tZ,ag=new tZ,ay=new tZ,av=new tZ,a_=new tZ,ax=new tP,ab=new tP,aw=new tP,aM=new tZ,aA=new tZ,aS=new tZ,aT=new tZ;function aC(e,i,r,n,s,a,o){let l=3*n,h=l+0,u=l+1,c=l+2,d=e.index;e.index&&(h=d.getX(h),u=d.getX(u),c=d.getX(c));let{position:p,normal:f,uv:m,uv1:g}=e.attributes,y=function(e,i,r,n,s,a,o,l,h,u,c){ay.fromBufferAttribute(i,a),av.fromBufferAttribute(i,o),a_.fromBufferAttribute(i,l);let d=function(e,i,r,n,s,a,o,l){if(null===(1===a?e.intersectTriangle(n,r,i,!0,s):e.intersectTriangle(i,r,n,2!==a,s)))return null;let h=e.origin.distanceTo(s);return h<o||h>l?null:{distance:h,point:s.clone()}}(e,ay,av,a_,aT,h,u,c);if(d){n&&(ax.fromBufferAttribute(n,a),ab.fromBufferAttribute(n,o),aw.fromBufferAttribute(n,l),d.uv=e0.getInterpolation(aT,ay,av,a_,ax,ab,aw,new tP)),s&&(ax.fromBufferAttribute(s,a),ab.fromBufferAttribute(s,o),aw.fromBufferAttribute(s,l),d.uv1=e0.getInterpolation(aT,ay,av,a_,ax,ab,aw,new tP)),r&&(aM.fromBufferAttribute(r,a),aA.fromBufferAttribute(r,o),aS.fromBufferAttribute(r,l),d.normal=e0.getInterpolation(aT,ay,av,a_,aM,aA,aS,new tZ),d.normal.dot(e.direction)>0&&d.normal.multiplyScalar(-1));let i={a,b:o,c:l,normal:new tZ,materialIndex:0};e0.getNormal(ay,av,a_,i.normal),d.face=i,d.faceIndex=a}return d}(r,p,f,m,g,h,u,c,i,a,o);return y?(y.faceIndex=n,s&&s.push(y),y):null}function aP(e,i,r,n){let s=e.a,a=e.b,o=e.c,l=i,h=i+1,u=i+2;r&&(l=r.getX(l),h=r.getX(h),u=r.getX(u)),s.x=n.getX(l),s.y=n.getY(l),s.z=n.getZ(l),a.x=n.getX(h),a.y=n.getY(h),a.z=n.getZ(h),o.x=n.getX(u),o.y=n.getY(u),o.z=n.getZ(u)}function aE(e,i,r,n,s,a,o){let{geometry:l}=r,{index:h}=l,u=l.attributes.position;for(let r=e,l=i+e;r<l;r++){let e;if(aP(o,3*(e=r),h,u),o.needsUpdate=!0,n(o,e,s,a))return!0}return!1}function aI(e,i,r,n,s){let a,o,l,h,u,c,d=1/r.direction.x,p=1/r.direction.y,f=1/r.direction.z,m=r.origin.x,g=r.origin.y,y=r.origin.z,v=i[e],_=i[e+3],x=i[e+1],b=i[e+3+1],w=i[e+2],M=i[e+3+2];return d>=0?(a=(v-m)*d,o=(_-m)*d):(a=(_-m)*d,o=(v-m)*d),p>=0?(l=(x-g)*p,h=(b-g)*p):(l=(b-g)*p,h=(x-g)*p),!(a>h)&&!(l>o)&&((l>a||isNaN(a))&&(a=l),(h<o||isNaN(o))&&(o=h),f>=0?(u=(w-y)*f,c=(M-y)*f):(u=(M-y)*f,c=(w-y)*f),!(a>c)&&!(u>o))&&((u>a||a!=a)&&(a=u),(c<o||o!=o)&&(o=c),a<=s&&o>=n)}function az(e,i,r,n,s,a,o){let{geometry:l}=r,{index:h}=l,u=l.attributes.position;for(let l=e,c=i+e;l<c;l++){let e;if(aP(o,3*(e=r.resolveTriangleIndex(l)),h,u),o.needsUpdate=!0,n(o,e,s,a))return!0}return!1}function aR(e,i,r,n,s,a,o){ad.setBuffer(e._roots[i]),function e(i,r,n,s,a,o,l){let{float32Array:h,uint16Array:u,uint32Array:c}=ad,d=2*i;if(s5(d,u))!function(e,i,r,n,s,a,o,l){let{geometry:h,_indirectBuffer:u}=e;for(let e=n,u=n+s;e<u;e++)aC(h,i,r,e,a,o,l)}(r,n,s,c[i+6],s6(d,u),a,o,l);else{let u=i+8;aI(u,h,s,o,l)&&e(u,r,n,s,a,o,l);let d=c[i+6];aI(d,h,s,o,l)&&e(d,r,n,s,a,o,l)}}(0,e,r,n,s,a,o),ad.clearBuffer()}var aB=["x","y","z"];function ak(e,i,r,n,s,a){ad.setBuffer(e._roots[i]);let o=function e(i,r,n,s,a,o){let{float32Array:l,uint16Array:h,uint32Array:u}=ad,c=2*i;if(s5(c,h))return function(e,i,r,n,s,a,o){let{geometry:l,_indirectBuffer:h}=e,u=1/0,c=null;for(let e=n,h=n+s;e<h;e++){let n;(n=aC(l,i,r,e,null,a,o))&&n.distance<u&&(c=n,u=n.distance)}return c}(r,n,s,u[i+6],s6(c,h),a,o);{let h=u[i+7],c=aB[h],d=s.direction[c]>=0,p,f;d?(p=i+8,f=u[i+6]):(p=u[i+6],f=i+8);let m=aI(p,l,s,a,o)?e(p,r,n,s,a,o):null;if(m){let e=m.point[c];if(d?e<=l[f+h]:e>=l[f+h+3])return m}let g=aI(f,l,s,a,o)?e(f,r,n,s,a,o):null;return m&&g?m.distance<=g.distance?m:g:m||g||null}}(0,e,r,n,s,a);return ad.clearBuffer(),o}var aO=new tQ,aL=new ai,aN=new ai,aF=new eg,aD=new ar,aU=new ar;function aj(e,i,r,n){ad.setBuffer(e._roots[i]);let s=function e(i,r,n,s,a=null){let{float32Array:o,uint16Array:l,uint32Array:h}=ad,u=2*i;if(null===a&&(n.boundingBox||n.computeBoundingBox(),aD.set(n.boundingBox.min,n.boundingBox.max,s),a=aD),s5(u,l)){let e=r.geometry,a=e.index,c=e.attributes.position,d=n.index,p=n.attributes.position,f=h[i+6],m=s6(u,l);if(aF.copy(s).invert(),n.boundsTree)return sX(i,o,aU),aU.matrix.copy(aF),aU.needsUpdate=!0,n.boundsTree.shapecast({intersectsBounds:e=>aU.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(s),e.b.applyMatrix4(s),e.c.applyMatrix4(s),e.needsUpdate=!0;for(let i=3*f,r=(m+f)*3;i<r;i+=3)if(aP(aN,i,a,c),aN.needsUpdate=!0,e.intersectsTriangle(aN))return!0;return!1}});for(let e=3*f,i=(m+f)*3;e<i;e+=3){aP(aL,e,a,c),aL.a.applyMatrix4(aF),aL.b.applyMatrix4(aF),aL.c.applyMatrix4(aF),aL.needsUpdate=!0;for(let e=0,i=d.count;e<i;e+=3)if(aP(aN,e,d,p),aN.needsUpdate=!0,aL.intersectsTriangle(aN))return!0}}else{let l=i+8,u=h[i+6];return sX(l,o,aO),!!(a.intersectsBox(aO)&&e(l,r,n,s,a)||(sX(u,o,aO),a.intersectsBox(aO)&&e(u,r,n,s,a)))}}(0,e,r,n);return ad.clearBuffer(),s}var aV=new eg,aW=new ar,aH=new ar,aq=new tZ,aG=new tZ,aJ=new tZ,aX=new tZ;function aY(e,i,r,n,s,a,o){ad.setBuffer(e._roots[i]),function e(i,r,n,s,a,o,l){let{float32Array:h,uint16Array:u,uint32Array:c}=ad,d=2*i;if(s5(d,u))!function(e,i,r,n,s,a,o,l){let{geometry:h,_indirectBuffer:u}=e;for(let e=n,c=n+s;e<c;e++)aC(h,i,r,u?u[e]:e,a,o,l)}(r,n,s,c[i+6],s6(d,u),a,o,l);else{let u=i+8;aI(u,h,s,o,l)&&e(u,r,n,s,a,o,l);let d=c[i+6];aI(d,h,s,o,l)&&e(d,r,n,s,a,o,l)}}(0,e,r,n,s,a,o),ad.clearBuffer()}var aZ=["x","y","z"];function aK(e,i,r,n,s,a){ad.setBuffer(e._roots[i]);let o=function e(i,r,n,s,a,o){let{float32Array:l,uint16Array:h,uint32Array:u}=ad,c=2*i;if(s5(c,h))return function(e,i,r,n,s,a,o){let{geometry:l,_indirectBuffer:h}=e,u=1/0,c=null;for(let e=n,d=n+s;e<d;e++){let n;(n=aC(l,i,r,h?h[e]:e,null,a,o))&&n.distance<u&&(c=n,u=n.distance)}return c}(r,n,s,u[i+6],s6(c,h),a,o);{let h=u[i+7],c=aZ[h],d=s.direction[c]>=0,p,f;d?(p=i+8,f=u[i+6]):(p=u[i+6],f=i+8);let m=aI(p,l,s,a,o)?e(p,r,n,s,a,o):null;if(m){let e=m.point[c];if(d?e<=l[f+h]:e>=l[f+h+3])return m}let g=aI(f,l,s,a,o)?e(f,r,n,s,a,o):null;return m&&g?m.distance<=g.distance?m:g:m||g||null}}(0,e,r,n,s,a);return ad.clearBuffer(),o}var a$=new tQ,aQ=new ai,a0=new ai,a1=new eg,a2=new ar,a3=new ar;function a4(e,i,r,n){ad.setBuffer(e._roots[i]);let s=function e(i,r,n,s,a=null){let{float32Array:o,uint16Array:l,uint32Array:h}=ad,u=2*i;if(null===a&&(n.boundingBox||n.computeBoundingBox(),a2.set(n.boundingBox.min,n.boundingBox.max,s),a=a2),s5(u,l)){let e=r.geometry,a=e.index,c=e.attributes.position,d=n.index,p=n.attributes.position,f=h[i+6],m=s6(u,l);if(a1.copy(s).invert(),n.boundsTree)return sX(i,o,a3),a3.matrix.copy(a1),a3.needsUpdate=!0,n.boundsTree.shapecast({intersectsBounds:e=>a3.intersectsBox(e),intersectsTriangle:e=>{e.a.applyMatrix4(s),e.b.applyMatrix4(s),e.c.applyMatrix4(s),e.needsUpdate=!0;for(let i=f,n=m+f;i<n;i++)if(aP(a0,3*r.resolveTriangleIndex(i),a,c),a0.needsUpdate=!0,e.intersectsTriangle(a0))return!0;return!1}});for(let e=f,i=m+f;e<i;e++){aP(aQ,3*r.resolveTriangleIndex(e),a,c),aQ.a.applyMatrix4(a1),aQ.b.applyMatrix4(a1),aQ.c.applyMatrix4(a1),aQ.needsUpdate=!0;for(let e=0,i=d.count;e<i;e+=3)if(aP(a0,e,d,p),a0.needsUpdate=!0,aQ.intersectsTriangle(a0))return!0}}else{let l=i+8,u=h[i+6];return sX(l,o,a$),!!(a.intersectsBox(a$)&&e(l,r,n,s,a)||(sX(u,o,a$),a.intersectsBox(a$)&&e(u,r,n,s,a)))}}(0,e,r,n);return ad.clearBuffer(),s}var a5=new eg,a6=new ar,a9=new ar,a7=new tZ,a8=new tZ,ot=new tZ,oe=new tZ,oi=new ad.constructor,or=new ad.constructor,on=new au(()=>new tQ),os=new tQ,oa=new tQ,oo=new tQ,ol=new tQ,oh=!1,ou=new ar,oc=new tQ,od={strategy:0,maxDepth:40,maxLeafTris:10,useSharedArrayBuffer:!1,setBoundingBox:!0,onProgress:null,indirect:!1,verbose:!0},op=class e{static serialize(e,i={}){i={cloneBuffers:!0,...i};let r=e.geometry,n=e._roots,s=e._indirectBuffer,a=r.getIndex();return i.cloneBuffers?{roots:n.map(e=>e.slice()),index:a?a.array.slice():null,indirectBuffer:s?s.slice():null}:{roots:n,index:a?a.array:null,indirectBuffer:s}}static deserialize(i,r,n={}){n={setIndex:!0,indirect:!!i.indirectBuffer,...n};let{index:s,roots:a,indirectBuffer:o}=i,l=new e(r,{...n,[sW]:!0});if(l._roots=a,l._indirectBuffer=o||null,n.setIndex){let e=r.getIndex();if(null===e){let e=new ii(i.index,1,!1);r.setIndex(e)}else e.array!==s&&(e.array.set(s),e.needsUpdate=!0)}return l}get indirect(){return!!this._indirectBuffer}constructor(e,i={}){var r,n;let s,a,o,l;if(e.isBufferGeometry){if(e.index&&e.index.isInterleavedBufferAttribute)throw Error("MeshBVH: InterleavedBufferAttribute is not supported for the index attribute.")}else throw Error("MeshBVH: Only BufferGeometries are supported.");if((i=Object.assign({...od,[sW]:!1},i)).useSharedArrayBuffer&&!("u">typeof SharedArrayBuffer))throw Error("MeshBVH: SharedArrayBuffer is not available.");this.geometry=e,this._roots=null,this._indirectBuffer=null,i[sW]||(r=this,n=i,s=r.geometry,n.indirect&&(r._indirectBuffer=function(e,i){let r=(e.index?e.index.count:e.attributes.position.count)/3,n=r>65536,s=n?4:2,a=i?new SharedArrayBuffer(r*s):new ArrayBuffer(r*s),o=n?new Uint32Array(a):new Uint16Array(a);for(let e=0,i=o.length;e<i;e++)o[e]=e;return o}(s,n.useSharedArrayBuffer),function(e){if(0===e.groups.length)return!1;let i=sH(e),r=sG(e).sort((e,i)=>e.offset-i.offset),n=r[r.length-1];n.count=Math.min(i-n.offset,n.count);let s=0;return r.forEach(({count:e})=>s+=e),i!==s}(s)&&!n.verbose&&console.warn('MeshBVH: Provided geometry contains groups that do not fully span the vertex contents while using the "indirect" option. BVH may incorrectly report intersections on unrendered portions of the geometry.')),r._indirectBuffer||function(e,i){if(!e.index){let r=e.attributes.position.count,n=function(e,i=ArrayBuffer){return e>65535?new Uint32Array(new i(4*e)):new Uint16Array(new i(2*e))}(r,i.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer);e.setIndex(new ii(n,1));for(let e=0;e<r;e++)n[e]=e}}(s,n),a=n.useSharedArrayBuffer?SharedArrayBuffer:ArrayBuffer,o=function(e,i=null,r=null,n=null){let s=e.attributes.position,a=e.index?e.index.array:null,o=sH(e),l=s.normalized,h;null===i?(h=new Float32Array(24*o),r=0,n=o):(h=i,r=r||0,n=n||o);let u=s.array,c=s.offset||0,d=3;s.isInterleavedBufferAttribute&&(d=s.data.stride);let p=["getX","getY","getZ"];for(let e=r;e<r+n;e++){let i=3*e,r=6*e,n=i+0,o=i+1,f=i+2;a&&(n=a[n],o=a[o],f=a[f]),l||(n=n*d+c,o=o*d+c,f=f*d+c);for(let e=0;e<3;e++){let i,a,c;l?(i=s[p[e]](n),a=s[p[e]](o),c=s[p[e]](f)):(i=u[n+e],a=u[o+e],c=u[f+e]);let d=i;a<d&&(d=a),c<d&&(d=c);let m=i;a>m&&(m=a),c>m&&(m=c);let g=(m-d)/2,y=2*e;h[r+y+0]=d+g,h[r+y+1]=g+(Math.abs(d)+g)*5960464477539063e-23}}return h}(s),l=n.indirect?sq(s):sG(s),r._roots=l.map(e=>{let i=function(e,i,r,n,s){let{maxDepth:a,verbose:o,maxLeafTris:l,strategy:h,onProgress:u,indirect:c}=s,d=e._indirectBuffer,p=e.geometry,f=p.index?p.index.array:null,m=c?s4:s3,g=sH(p),y=new Float32Array(6),v=!1,_=new s2;return sJ(i,r,n,_.boundingData,y),function e(r,n,s,u=null,c=0){if(!v&&c>=a&&(v=!0,o&&(console.warn(`MeshBVH: Max depth of ${a} reached when generating BVH. Consider increasing maxDepth.`),console.warn(p))),s<=l||c>=a)return x(n+s),r.offset=n,r.count=s,r;let g=function(e,i,r,n,s,a){let o=-1,l=0;if(0===a)-1!==(o=sY(i))&&(l=(i[o]+i[o+3])/2);else if(1===a)-1!==(o=sY(e))&&(l=function(e,i,r,n){let s=0;for(let a=i,o=i+r;a<o;a++)s+=e[6*a+2*n];return s/r}(r,n,s,o));else if(2===a){let a=s$(e),h=1.25*s,u=6*n,c=(n+s)*6;for(let e=0;e<3;e++){let n=i[e],d=(i[e+3]-n)/32;if(s<8){let i=[...s0];i.length=s;let n=0;for(let s=u;s<c;s+=6,n++){let a=i[n];a.candidate=r[s+2*e],a.count=0;let{bounds:o,leftCacheBounds:l,rightCacheBounds:h}=a;for(let e=0;e<3;e++)h[e]=1/0,h[e+3]=-1/0,l[e]=1/0,l[e+3]=-1/0,o[e]=1/0,o[e+3]=-1/0;sK(s,r,o)}i.sort(sQ);let d=s;for(let e=0;e<d;e++){let r=i[e];for(;e+1<d&&i[e+1].candidate===r.candidate;)i.splice(e+1,1),d--}for(let n=u;n<c;n+=6){let s=r[n+2*e];for(let e=0;e<d;e++){let a=i[e];s>=a.candidate?sK(n,r,a.rightCacheBounds):(sK(n,r,a.leftCacheBounds),a.count++)}}for(let r=0;r<d;r++){let n=i[r],u=n.count,c=s-n.count,d=n.leftCacheBounds,p=n.rightCacheBounds,f=0;0!==u&&(f=s$(d)/a);let m=0;0!==c&&(m=s$(p)/a);let g=1+1.25*(f*u+m*c);g<h&&(o=e,h=g,l=n.candidate)}}else{for(let e=0;e<32;e++){let i=s0[e];i.count=0,i.candidate=n+d+e*d;let r=i.bounds;for(let e=0;e<3;e++)r[e]=1/0,r[e+3]=-1/0}for(let i=u;i<c;i+=6){let s=~~((r[i+2*e]-n)/d);s>=32&&(s=31);let a=s0[s];a.count++,sK(i,r,a.bounds)}let i=s0[31];!function(e,i){i.set(e)}(i.bounds,i.rightCacheBounds);for(let e=30;e>=0;e--){let i=s0[e],r=s0[e+1];sZ(i.bounds,r.rightCacheBounds,i.rightCacheBounds)}let p=0;for(let i=0;i<31;i++){let r=s0[i],n=r.count,u=r.bounds,c=s0[i+1].rightCacheBounds;0!==n&&(0===p?function(e,i){i.set(e)}(u,s1):sZ(u,s1,s1));let d=0,f=0;0!==(p+=n)&&(d=s$(s1)/a);let m=s-p;0!==m&&(f=s$(c)/a);let g=1+1.25*(d*p+f*m);g<h&&(o=e,h=g,l=r.candidate)}}}}else console.warn(`MeshBVH: Invalid build strategy value ${a} used.`);return{axis:o,pos:l}}(r.boundingData,u,i,n,s,h);if(-1===g.axis)return x(n+s),r.offset=n,r.count=s,r;let _=m(d,f,i,n,s,g);if(_===n||_===n+s)x(n+s),r.offset=n,r.count=s;else{r.splitAxis=g.axis;let a=new s2,o=_-n;r.left=a,sJ(i,n,o,a.boundingData,y),e(a,n,o,y,c+1);let l=new s2,h=s-o;r.right=l,sJ(i,_,h,l.boundingData,y),e(l,_,h,y,c+1)}return r}(_,r,n,y),_;function x(e){u&&u(e/g)}}(r,o,e.offset,e.count,n),s=new a(32*function e(i){return"count"in i?1:1+e(i.left)+e(i.right)}(i));return an=new Float32Array(s),as=new Uint32Array(s),aa=new Uint16Array(s),ao=new Uint8Array(s),function e(i,r){let n=i/4,s=i/2,a=r.boundingData;for(let e=0;e<6;e++)an[n+e]=a[e];if("count"in r){if(r.buffer){let e=r.buffer;ao.set(new Uint8Array(e),i);for(let r=i,s=i+e.byteLength;r<s;r+=32)s5(r/2,aa)||(as[r/4+6]+=n);return i+e.byteLength}{let e=r.offset,a=r.count;return as[n+6]=e,aa[s+14]=a,aa[s+15]=65535,i+32}}{let s=r.left,a=r.right,o=r.splitAxis,l;if((l=e(i+32,s))/4>4294967296)throw Error("MeshBVH: Cannot store child pointer greater than 32 bits.");return as[n+6]=l/4,l=e(l,a),as[n+7]=o,l}}(0,i),s}),!e.boundingBox&&i.setBoundingBox&&(e.boundingBox=this.getBoundingBox(new tQ))),this.resolveTriangleIndex=i.indirect?e=>this._indirectBuffer[e]:e=>e}refit(e=null){return(this.indirect?function(e,i=null){i&&Array.isArray(i)&&(i=new Set(i));let r=e.geometry,n=r.index?r.index.array:null,s=r.attributes.position,a,o,l,h,u=0,c=e._roots;for(let r=0,d=c.length;r<d;r++)o=new Uint32Array(a=c[r]),l=new Uint16Array(a),h=new Float32Array(a),function r(a,u,c=!1){let d=2*a;if(65535===l[d+15]){let i=o[a+6],r=l[d+14],u=1/0,c=1/0,p=1/0,f=-1/0,m=-1/0,g=-1/0;for(let a=i,o=i+r;a<o;a++){let i=3*e.resolveTriangleIndex(a);for(let e=0;e<3;e++){let r=i+e;r=n?n[r]:r;let a=s.getX(r),o=s.getY(r),l=s.getZ(r);a<u&&(u=a),a>f&&(f=a),o<c&&(c=o),o>m&&(m=o),l<p&&(p=l),l>g&&(g=l)}}return(h[a+0]!==u||h[a+1]!==c||h[a+2]!==p||h[a+3]!==f||h[a+4]!==m||h[a+5]!==g)&&(h[a+0]=u,h[a+1]=c,h[a+2]=p,h[a+3]=f,h[a+4]=m,h[a+5]=g,!0)}{let e=a+8,n=o[a+6],s=e+u,l=n+u,d=c,p=!1,f=!1;i?d||(p=i.has(s),f=i.has(l),d=!p&&!f):(p=!0,f=!0);let m=d||p,g=d||f,y=!1;m&&(y=r(e,u,d));let v=!1;g&&(v=r(n,u,d));let _=y||v;if(_)for(let i=0;i<3;i++){let r=e+i,s=n+i,o=h[r],l=h[r+3],u=h[s],c=h[s+3];h[a+i]=o<u?o:u,h[a+i+3]=l>c?l:c}return _}}(0,u),u+=a.byteLength}:function(e,i=null){i&&Array.isArray(i)&&(i=new Set(i));let r=e.geometry,n=r.index?r.index.array:null,s=r.attributes.position,a,o,l,h,u=0,c=e._roots;for(let e=0,r=c.length;e<r;e++)o=new Uint32Array(a=c[e]),l=new Uint16Array(a),h=new Float32Array(a),function e(r,a,u=!1){let c=2*r;if(65535===l[c+15]){let e=o[r+6],i=l[c+14],a=1/0,u=1/0,d=1/0,p=-1/0,f=-1/0,m=-1/0;for(let r=3*e,o=3*(e+i);r<o;r++){let e=n[r],i=s.getX(e),o=s.getY(e),l=s.getZ(e);i<a&&(a=i),i>p&&(p=i),o<u&&(u=o),o>f&&(f=o),l<d&&(d=l),l>m&&(m=l)}return(h[r+0]!==a||h[r+1]!==u||h[r+2]!==d||h[r+3]!==p||h[r+4]!==f||h[r+5]!==m)&&(h[r+0]=a,h[r+1]=u,h[r+2]=d,h[r+3]=p,h[r+4]=f,h[r+5]=m,!0)}{let n=r+8,s=o[r+6],l=n+a,c=s+a,d=u,p=!1,f=!1;i?d||(p=i.has(l),f=i.has(c),d=!p&&!f):(p=!0,f=!0);let m=d||p,g=d||f,y=!1;m&&(y=e(n,a,d));let v=!1;g&&(v=e(s,a,d));let _=y||v;if(_)for(let e=0;e<3;e++){let i=n+e,a=s+e,o=h[i],l=h[i+3],u=h[a],c=h[a+3];h[r+e]=o<u?o:u,h[r+e+3]=l>c?l:c}return _}}(0,u),u+=a.byteLength})(this,e)}traverse(e,i=0){let r=this._roots[i],n=new Uint32Array(r),s=new Uint16Array(r);!function i(a,o=0){let l=2*a,h=65535===s[l+15];if(h){let i=n[a+6],u=s[l+14];e(o,h,new Float32Array(r,4*a,6),i,u)}else{let s=n[a+6],l=n[a+7];e(o,h,new Float32Array(r,4*a,6),l)||(i(a+8,o+1),i(s,o+1))}}(0)}raycast(e,i=0,r=0,n=1/0){let s=this._roots,a=this.geometry,o=[],l=i.isMaterial,h=Array.isArray(i),u=a.groups,c=l?i.side:i,d=this.indirect?aY:aR;for(let a=0,l=s.length;a<l;a++){let s=h?i[u[a].materialIndex].side:c,l=o.length;if(d(this,a,s,e,o,r,n),h){let e=u[a].materialIndex;for(let i=l,r=o.length;i<r;i++)o[i].face.materialIndex=e}}return o}raycastFirst(e,i=0,r=0,n=1/0){let s=this._roots,a=this.geometry,o=i.isMaterial,l=Array.isArray(i),h=null,u=a.groups,c=o?i.side:i,d=this.indirect?aK:ak;for(let a=0,o=s.length;a<o;a++){let s=l?i[u[a].materialIndex].side:c,o=d(this,a,s,e,r,n);null!=o&&(null==h||o.distance<h.distance)&&(h=o,l&&(o.face.materialIndex=u[a].materialIndex))}return h}intersectsGeometry(e,i){let r=!1,n=this._roots,s=this.indirect?a4:aj;for(let a=0,o=n.length;a<o&&!(r=s(this,a,e,i));a++);return r}shapecast(e){let i=ac.getPrimitive(),r=this.indirect?az:aE,{boundsTraverseOrder:n,intersectsBounds:s,intersectsRange:a,intersectsTriangle:o}=e;if(a&&o){let e=a;a=(n,s,a,l,h)=>!!e(n,s,a,l,h)||r(n,s,this,o,a,l,i)}else a||(a=o?(e,n,s,a)=>r(e,n,this,o,s,a,i):(e,i,r)=>r);let l=!1,h=0,u=this._roots;for(let e=0,i=u.length;e<i;e++){let i=u[e];if(l=function(e,i,r,n,s,a){al=af.getPrimitive(),ah=af.getPrimitive(),ap.push(al,ah),ad.setBuffer(e._roots[i]);let o=function e(i,r,n,s,a=null,o=0,l=0){let{float32Array:h,uint16Array:u,uint32Array:c}=ad,d=2*i;if(s5(d,u)){let e=c[i+6],r=s6(d,u);return sX(i,h,al),s(e,r,!1,l,o+i,al)}{let d=function(e){let{uint16Array:i,uint32Array:r}=ad,n=2*e;for(;!s5(n,i);)e+=8,n=2*e;return r[e+6]},p=function(e){let{uint16Array:i,uint32Array:r}=ad,n=2*e;for(;!s5(n,i);)n=2*(e=r[e+6]);return r[e+6]+s6(n,i)},f=i+8,m=c[i+6],g=f,y=m,v,_,x,b;if(a&&(x=al,b=ah,sX(g,h,x),sX(y,h,b),v=a(x),(_=a(b))<v)){g=m,y=f;let e=v;v=_,_=e,x=b}x||sX(g,h,x=al);let w=n(x,s5(2*g,u),v,l+1,o+g),M;if(2===w){let e=d(g),i=p(g)-e;M=s(e,i,!0,l+1,o+g,x)}else M=w&&e(g,r,n,s,a,o,l+1);if(M)return!0;sX(y,h,b=ah);let A=n(b,s5(2*y,u),_,l+1,o+y),S;if(2===A){let e=d(y),i=p(y)-e;S=s(e,i,!0,l+1,o+y,b)}else S=A&&e(y,r,n,s,a,o,l+1);return!!S}}(0,e.geometry,r,n,s,a);ad.clearBuffer(),af.releasePrimitive(al),af.releasePrimitive(ah),ap.pop(),ap.pop();let l=ap.length;return l>0&&(ah=ap[l-1],al=ap[l-2]),o}(this,e,s,a,n,h))break;h+=i.byteLength}return ac.releasePrimitive(i),l}bvhcast(e,i,r){let{intersectsRanges:n,intersectsTriangles:s}=r,a=ac.getPrimitive(),o=this.geometry.index,l=this.geometry.attributes.position,h=this.indirect?e=>{aP(a,3*this.resolveTriangleIndex(e),o,l)}:e=>{aP(a,3*e,o,l)},u=ac.getPrimitive(),c=e.geometry.index,d=e.geometry.attributes.position,p=e.indirect?i=>{aP(u,3*e.resolveTriangleIndex(i),c,d)}:e=>{aP(u,3*e,c,d)};if(s){let e=(e,r,n,o,l,c,d,f)=>{for(let m=n,g=n+o;m<g;m++){p(m),u.a.applyMatrix4(i),u.b.applyMatrix4(i),u.c.applyMatrix4(i),u.needsUpdate=!0;for(let i=e,n=e+r;i<n;i++)if(h(i),a.needsUpdate=!0,s(a,u,i,m,l,c,d,f))return!0}return!1};if(n){let i=n;n=function(r,n,s,a,o,l,h,u){return!!i(r,n,s,a,o,l,h,u)||e(r,n,s,a,o,l,h,u)}}else n=e}return function(e,i,r,n){if(oh)throw Error("MeshBVH: Recursive calls to bvhcast not supported.");oh=!0;let s=e._roots,a=i._roots,o,l=0,h=0,u=new eg().copy(r).invert();for(let e=0,i=s.length;e<i;e++){oi.setBuffer(s[e]),h=0;let i=on.getPrimitive();sX(0,oi.float32Array,i),i.applyMatrix4(u);for(let s=0,c=a.length;s<c&&(or.setBuffer(a[e]),o=function e(i,r,n,s,a,o=0,l=0,h=0,u=0,c=null,d=!1){let p,f;d?(p=or,f=oi):(p=oi,f=or);let m=p.float32Array,g=p.uint32Array,y=p.uint16Array,v=f.float32Array,_=f.uint32Array,x=f.uint16Array,b=2*r,w=s5(2*i,y),M=s5(b,x),A=!1;if(M&&w)A=d?a(_[r+6],s6(2*r,x),g[i+6],s6(2*i,y),u,l+r,h,o+i):a(g[i+6],s6(2*i,y),_[r+6],s6(2*r,x),h,o+i,u,l+r);else if(M){let c=on.getPrimitive();sX(r,v,c),c.applyMatrix4(n);let p=i+8,f=g[i+6];sX(p,m,os),sX(f,m,oa);let y=c.intersectsBox(os),_=c.intersectsBox(oa);A=y&&e(r,p,s,n,a,l,o,u,h+1,c,!d)||_&&e(r,f,s,n,a,l,o,u,h+1,c,!d),on.releasePrimitive(c)}else{let p=r+8,f=_[r+6];sX(p,v,oo),sX(f,v,ol);let y=c.intersectsBox(oo),x=c.intersectsBox(ol);if(y&&x)A=e(i,p,n,s,a,o,l,h,u+1,c,d)||e(i,f,n,s,a,o,l,h,u+1,c,d);else if(y){if(w)A=e(i,p,n,s,a,o,l,h,u+1,c,d);else{let r=on.getPrimitive();r.copy(oo).applyMatrix4(n);let c=i+8,f=g[i+6];sX(c,m,os),sX(f,m,oa);let y=r.intersectsBox(os),v=r.intersectsBox(oa);A=y&&e(p,c,s,n,a,l,o,u,h+1,r,!d)||v&&e(p,f,s,n,a,l,o,u,h+1,r,!d),on.releasePrimitive(r)}}else if(x){if(w)A=e(i,f,n,s,a,o,l,h,u+1,c,d);else{let r=on.getPrimitive();r.copy(ol).applyMatrix4(n);let c=i+8,p=g[i+6];sX(c,m,os),sX(p,m,oa);let y=r.intersectsBox(os),v=r.intersectsBox(oa);A=y&&e(f,c,s,n,a,l,o,u,h+1,r,!d)||v&&e(f,p,s,n,a,l,o,u,h+1,r,!d),on.releasePrimitive(r)}}}return A}(0,0,r,u,n,l,h,0,0,i),or.clearBuffer(),h+=a[s].length,!o);s++);if(on.releasePrimitive(i),oi.clearBuffer(),l+=s[e].length,o)break}return oh=!1,o}(this,e,i,n)}intersectsBox(e,i){return ou.set(e.min,e.max,i),ou.needsUpdate=!0,this.shapecast({intersectsBounds:e=>ou.intersectsBox(e),intersectsTriangle:e=>ou.intersectsTriangle(e)})}intersectsSphere(e){return this.shapecast({intersectsBounds:i=>e.intersectsBox(i),intersectsTriangle:i=>i.intersectsSphere(e)})}closestPointToGeometry(e,i,r={},n={},s=0,a=1/0){return(this.indirect?function(e,i,r,n={},s={},a=0,o=1/0){i.boundingBox||i.computeBoundingBox(),a6.set(i.boundingBox.min,i.boundingBox.max,r),a6.needsUpdate=!0;let l=e.geometry,h=l.attributes.position,u=l.index,c=i.attributes.position,d=i.index,p=ac.getPrimitive(),f=ac.getPrimitive(),m=null,g=null;s&&(m=ot,g=oe);let y=1/0,v=null,_=null;return a5.copy(r).invert(),a9.matrix.copy(a5),e.shapecast({boundsTraverseOrder:e=>a6.distanceToBox(e),intersectsBounds:(e,i,r)=>r<y&&r<o&&(i&&(a9.min.copy(e.min),a9.max.copy(e.max),a9.needsUpdate=!0),!0),intersectsRange:(n,s)=>{if(i.boundsTree){let l=i.boundsTree;return l.shapecast({boundsTraverseOrder:e=>a9.distanceToBox(e),intersectsBounds:(e,i,r)=>r<y&&r<o,intersectsRange:(i,o)=>{for(let x=i,b=i+o;x<b;x++){aP(f,3*l.resolveTriangleIndex(x),d,c),f.a.applyMatrix4(r),f.b.applyMatrix4(r),f.c.applyMatrix4(r),f.needsUpdate=!0;for(let i=n,r=n+s;i<r;i++){aP(p,3*e.resolveTriangleIndex(i),u,h),p.needsUpdate=!0;let r=p.distanceToTriangle(f,a7,m);if(r<y&&(a8.copy(a7),g&&g.copy(m),y=r,v=i,_=x),r<a)return!0}}}})}{let o=sH(i);for(let i=0;i<o;i++){aP(f,3*i,d,c),f.a.applyMatrix4(r),f.b.applyMatrix4(r),f.c.applyMatrix4(r),f.needsUpdate=!0;for(let r=n,o=n+s;r<o;r++){aP(p,3*e.resolveTriangleIndex(r),u,h),p.needsUpdate=!0;let n=p.distanceToTriangle(f,a7,m);if(n<y&&(a8.copy(a7),g&&g.copy(m),y=n,v=r,_=i),n<a)return!0}}}}}),ac.releasePrimitive(p),ac.releasePrimitive(f),y===1/0?null:(n.point?n.point.copy(a8):n.point=a8.clone(),n.distance=y,n.faceIndex=v,s&&(s.point?s.point.copy(g):s.point=g.clone(),s.point.applyMatrix4(a5),a8.applyMatrix4(a5),s.distance=a8.sub(s.point).length(),s.faceIndex=_),n)}:function(e,i,r,n={},s={},a=0,o=1/0){i.boundingBox||i.computeBoundingBox(),aW.set(i.boundingBox.min,i.boundingBox.max,r),aW.needsUpdate=!0;let l=e.geometry,h=l.attributes.position,u=l.index,c=i.attributes.position,d=i.index,p=ac.getPrimitive(),f=ac.getPrimitive(),m=null,g=null;s&&(m=aJ,g=aX);let y=1/0,v=null,_=null;return aV.copy(r).invert(),aH.matrix.copy(aV),e.shapecast({boundsTraverseOrder:e=>aW.distanceToBox(e),intersectsBounds:(e,i,r)=>r<y&&r<o&&(i&&(aH.min.copy(e.min),aH.max.copy(e.max),aH.needsUpdate=!0),!0),intersectsRange:(e,n)=>{if(i.boundsTree)return i.boundsTree.shapecast({boundsTraverseOrder:e=>aH.distanceToBox(e),intersectsBounds:(e,i,r)=>r<y&&r<o,intersectsRange:(i,s)=>{for(let o=i,l=i+s;o<l;o++){aP(f,3*o,d,c),f.a.applyMatrix4(r),f.b.applyMatrix4(r),f.c.applyMatrix4(r),f.needsUpdate=!0;for(let i=e,r=e+n;i<r;i++){aP(p,3*i,u,h),p.needsUpdate=!0;let e=p.distanceToTriangle(f,aq,m);if(e<y&&(aG.copy(aq),g&&g.copy(m),y=e,v=i,_=o),e<a)return!0}}}});{let s=sH(i);for(let i=0;i<s;i++){aP(f,3*i,d,c),f.a.applyMatrix4(r),f.b.applyMatrix4(r),f.c.applyMatrix4(r),f.needsUpdate=!0;for(let r=e,s=e+n;r<s;r++){aP(p,3*r,u,h),p.needsUpdate=!0;let e=p.distanceToTriangle(f,aq,m);if(e<y&&(aG.copy(aq),g&&g.copy(m),y=e,v=r,_=i),e<a)return!0}}}}}),ac.releasePrimitive(p),ac.releasePrimitive(f),y===1/0?null:(n.point?n.point.copy(aG):n.point=aG.clone(),n.distance=y,n.faceIndex=v,s&&(s.point?s.point.copy(g):s.point=g.clone(),s.point.applyMatrix4(aV),aG.applyMatrix4(aV),s.distance=aG.sub(s.point).length(),s.faceIndex=_),n)})(this,e,i,r,n,s,a)}closestPointToPoint(e,i={},r=0,n=1/0){return function(e,i,r={},n=0,s=1/0){let a=n*n,o=s*s,l=1/0,h=null;if(e.shapecast({boundsTraverseOrder:e=>(am.copy(i).clamp(e.min,e.max),am.distanceToSquared(i)),intersectsBounds:(e,i,r)=>r<l&&r<o,intersectsTriangle:(e,r)=>{e.closestPointToPoint(i,am);let n=i.distanceToSquared(am);return n<l&&(ag.copy(am),l=n,h=r),n<a}}),l===1/0)return null;let u=Math.sqrt(l);return r.point?r.point.copy(ag):r.point=ag.clone(),r.distance=u,r.faceIndex=h,r}(this,e,i,r,n)}getBoundingBox(e){return e.makeEmpty(),this._roots.forEach(i=>{sX(0,new Float32Array(i),oc),e.union(oc)}),e}};function of(e,i,r){return null===e?null:(e.point.applyMatrix4(i.matrixWorld),e.distance=e.point.distanceTo(r.ray.origin),e.object=i,e)}var om=new em,og=new tZ,oy=new eg,ov=iB.prototype.raycast,o_=new tZ;function ox(e,i){if(this.geometry.boundsTree){if(void 0===this.material)return;oy.copy(this.matrixWorld).invert(),om.copy(e.ray).applyMatrix4(oy),function(e,i){let r=e.elements,n=i.set(r[0],r[1],r[2]).length(),s=i.set(r[4],r[5],r[6]).length(),a=i.set(r[8],r[9],r[10]).length();i.set(n,s,a)}(this.matrixWorld,o_),og.copy(om.direction).multiply(o_);let r=og.length(),n=e.near/r,s=e.far/r,a=this.geometry.boundsTree;if(!0===e.firstHitOnly){let r=of(a.raycastFirst(om,this.material,n,s),this,e);r&&i.push(r)}else{let r=a.raycast(om,this.material,n,s);for(let n=0,s=r.length;n<s;n++){let s=of(r[n],this,e);s&&i.push(s)}}}else ov.call(this,e,i)}function ob(e){return this.boundsTree=new op(this,e),this.boundsTree}function ow(){this.boundsTree=null}var oM=q(Y()),oA=class{constructor(e){this.debug=(0,oM.default)(e)}log(e,...i){this.debug(e,...i)}};function oS(e,i){if(0===i)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),e;if(2!==i&&1!==i)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",i),e;{let r=e.getIndex();if(null===r){let i=[],n=e.getAttribute("position");if(void 0===n)return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),e;for(let e=0;e<n.count;e++)i.push(e);e.setIndex(i),r=e.getIndex()}let n=r.count-2,s=[];if(2===i)for(let e=1;e<=n;e++)s.push(r.getX(0)),s.push(r.getX(e)),s.push(r.getX(e+1));else for(let e=0;e<n;e++)e%2==0?(s.push(r.getX(e)),s.push(r.getX(e+1)),s.push(r.getX(e+2))):(s.push(r.getX(e+2)),s.push(r.getX(e+1)),s.push(r.getX(e)));s.length/3!==n&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");let a=e.clone();return a.setIndex(s),a.clearGroups(),a}}var oT=class extends st{constructor(e){super(e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(e){return new oR(e)}),this.register(function(e){return new oB(e)}),this.register(function(e){return new oV(e)}),this.register(function(e){return new oW(e)}),this.register(function(e){return new oH(e)}),this.register(function(e){return new oO(e)}),this.register(function(e){return new oL(e)}),this.register(function(e){return new oN(e)}),this.register(function(e){return new oF(e)}),this.register(function(e){return new oz(e)}),this.register(function(e){return new oD(e)}),this.register(function(e){return new ok(e)}),this.register(function(e){return new oj(e)}),this.register(function(e){return new oU(e)}),this.register(function(e){return new oE(e)}),this.register(function(e){return new oq(e)}),this.register(function(e){return new oG(e)})}load(e,i,r,n){let s=this,a;if(""!==this.resourcePath)a=this.resourcePath;else if(""!==this.path){let i=sx.extractUrlBase(e);a=sx.resolveURL(i,this.path)}else a=sx.extractUrlBase(e);this.manager.itemStart(e);let o=function(i){n?n(i):console.error(i),s.manager.itemError(e),s.manager.itemEnd(e)},l=new sr(this.manager);l.setPath(this.path),l.setResponseType("arraybuffer"),l.setRequestHeader(this.requestHeader),l.setWithCredentials(this.withCredentials),l.load(e,function(r){try{s.parse(r,a,function(r){i(r),s.manager.itemEnd(e)},o)}catch(e){o(e)}},r,o)}setDRACOLoader(e){return this.dracoLoader=e,this}setDDSLoader(){throw Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(e){return this.ktx2Loader=e,this}setMeshoptDecoder(e){return this.meshoptDecoder=e,this}register(e){return -1===this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.push(e),this}unregister(e){return -1!==this.pluginCallbacks.indexOf(e)&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(e),1),this}parse(e,i,r,n){let s,a={},o={},l=new TextDecoder;if("string"==typeof e)s=JSON.parse(e);else if(e instanceof ArrayBuffer){if(l.decode(new Uint8Array(e,0,4))===oJ){try{a[oP.KHR_BINARY_GLTF]=new oY(e)}catch(e){n&&n(e);return}s=JSON.parse(a[oP.KHR_BINARY_GLTF].content)}else s=JSON.parse(l.decode(e))}else s=e;if(void 0===s.asset||s.asset.version[0]<2){n&&n(Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}let h=new la(s,{path:i||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});h.fileLoader.setRequestHeader(this.requestHeader);for(let e=0;e<this.pluginCallbacks.length;e++){let i=this.pluginCallbacks[e](h);i.name||console.error("THREE.GLTFLoader: Invalid plugin found: missing name"),o[i.name]=i,a[i.name]=!0}if(s.extensionsUsed)for(let e=0;e<s.extensionsUsed.length;++e){let i=s.extensionsUsed[e],r=s.extensionsRequired||[];switch(i){case oP.KHR_MATERIALS_UNLIT:a[i]=new oI;break;case oP.KHR_DRACO_MESH_COMPRESSION:a[i]=new oZ(s,this.dracoLoader);break;case oP.KHR_TEXTURE_TRANSFORM:a[i]=new oK;break;case oP.KHR_MESH_QUANTIZATION:a[i]=new o$;break;default:r.indexOf(i)>=0&&void 0===o[i]&&console.warn('THREE.GLTFLoader: Unknown extension "'+i+'".')}}h.setExtensions(a),h.setPlugins(o),h.parse(r,n)}parseAsync(e,i){let r=this;return new Promise(function(n,s){r.parse(e,i,n,s)})}};function oC(){let e={};return{get:function(i){return e[i]},add:function(i,r){e[i]=r},remove:function(i){delete e[i]},removeAll:function(){e={}}}}var oP={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_DISPERSION:"KHR_materials_dispersion",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_IRIDESCENCE:"KHR_materials_iridescence",KHR_MATERIALS_ANISOTROPY:"KHR_materials_anisotropy",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",KHR_MATERIALS_EMISSIVE_STRENGTH:"KHR_materials_emissive_strength",EXT_MATERIALS_BUMP:"EXT_materials_bump",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_TEXTURE_AVIF:"EXT_texture_avif",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression",EXT_MESH_GPU_INSTANCING:"EXT_mesh_gpu_instancing"},oE=class{constructor(e){this.parser=e,this.name=oP.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){let e=this.parser,i=this.parser.json.nodes||[];for(let r=0,n=i.length;r<n;r++){let n=i[r];n.extensions&&n.extensions[this.name]&&void 0!==n.extensions[this.name].light&&e._addNodeRef(this.cache,n.extensions[this.name].light)}}_loadLight(e){let i=this.parser,r="light:"+e,n=i.cache.get(r);if(n)return n;let s=i.json,a=((s.extensions&&s.extensions[this.name]||{}).lights||[])[e],o,l=new e5(16777215);void 0!==a.color&&l.setRGB(a.color[0],a.color[1],a.color[2],tf);let h=void 0!==a.range?a.range:0;switch(a.type){case"directional":(o=new s_(l)).target.position.set(0,0,-1),o.add(o.target);break;case"point":(o=new sy(l)).distance=h;break;case"spot":(o=new sd(l)).distance=h,a.spot=a.spot||{},a.spot.innerConeAngle=void 0!==a.spot.innerConeAngle?a.spot.innerConeAngle:0,a.spot.outerConeAngle=void 0!==a.spot.outerConeAngle?a.spot.outerConeAngle:Math.PI/4,o.angle=a.spot.outerConeAngle,o.penumbra=1-a.spot.innerConeAngle/a.spot.outerConeAngle,o.target.position.set(0,0,-1),o.add(o.target);break;default:throw Error("THREE.GLTFLoader: Unexpected light type: "+a.type)}return o.position.set(0,0,0),o.decay=2,li(o,a),void 0!==a.intensity&&(o.intensity=a.intensity),o.name=i.createUniqueName(a.name||"light_"+e),n=Promise.resolve(o),i.cache.add(r,n),n}getDependency(e,i){if("light"===e)return this._loadLight(i)}createNodeAttachment(e){let i=this,r=this.parser,n=r.json.nodes[e],s=(n.extensions&&n.extensions[this.name]||{}).light;return void 0===s?null:this._loadLight(s).then(function(e){return r._getNodeRef(i.cache,s,e)})}},oI=class{constructor(){this.name=oP.KHR_MATERIALS_UNLIT}getMaterialType(){return e8}extendParams(e,i,r){let n=[];e.color=new e5(1,1,1),e.opacity=1;let s=i.pbrMetallicRoughness;if(s){if(Array.isArray(s.baseColorFactor)){let i=s.baseColorFactor;e.color.setRGB(i[0],i[1],i[2],tf),e.opacity=i[3]}void 0!==s.baseColorTexture&&n.push(r.assignTexture(e,"map",s.baseColorTexture,tp))}return Promise.all(n)}},oz=class{constructor(e){this.parser=e,this.name=oP.KHR_MATERIALS_EMISSIVE_STRENGTH}extendMaterialParams(e,i){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=r.extensions[this.name].emissiveStrength;return void 0!==n&&(i.emissiveIntensity=n),Promise.resolve()}},oR=class{constructor(e){this.parser=e,this.name=oP.KHR_MATERIALS_CLEARCOAT}getMaterialType(e){let i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?nq:null}extendMaterialParams(e,i){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let s=[],a=n.extensions[this.name];if(void 0!==a.clearcoatFactor&&(i.clearcoat=a.clearcoatFactor),void 0!==a.clearcoatTexture&&s.push(r.assignTexture(i,"clearcoatMap",a.clearcoatTexture)),void 0!==a.clearcoatRoughnessFactor&&(i.clearcoatRoughness=a.clearcoatRoughnessFactor),void 0!==a.clearcoatRoughnessTexture&&s.push(r.assignTexture(i,"clearcoatRoughnessMap",a.clearcoatRoughnessTexture)),void 0!==a.clearcoatNormalTexture&&(s.push(r.assignTexture(i,"clearcoatNormalMap",a.clearcoatNormalTexture)),void 0!==a.clearcoatNormalTexture.scale)){let e=a.clearcoatNormalTexture.scale;i.clearcoatNormalScale=new tP(e,e)}return Promise.all(s)}},oB=class{constructor(e){this.parser=e,this.name=oP.KHR_MATERIALS_DISPERSION}getMaterialType(e){let i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?nq:null}extendMaterialParams(e,i){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=r.extensions[this.name];return i.dispersion=void 0!==n.dispersion?n.dispersion:0,Promise.resolve()}},ok=class{constructor(e){this.parser=e,this.name=oP.KHR_MATERIALS_IRIDESCENCE}getMaterialType(e){let i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?nq:null}extendMaterialParams(e,i){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let s=[],a=n.extensions[this.name];return void 0!==a.iridescenceFactor&&(i.iridescence=a.iridescenceFactor),void 0!==a.iridescenceTexture&&s.push(r.assignTexture(i,"iridescenceMap",a.iridescenceTexture)),void 0!==a.iridescenceIor&&(i.iridescenceIOR=a.iridescenceIor),void 0===i.iridescenceThicknessRange&&(i.iridescenceThicknessRange=[100,400]),void 0!==a.iridescenceThicknessMinimum&&(i.iridescenceThicknessRange[0]=a.iridescenceThicknessMinimum),void 0!==a.iridescenceThicknessMaximum&&(i.iridescenceThicknessRange[1]=a.iridescenceThicknessMaximum),void 0!==a.iridescenceThicknessTexture&&s.push(r.assignTexture(i,"iridescenceThicknessMap",a.iridescenceThicknessTexture)),Promise.all(s)}},oO=class{constructor(e){this.parser=e,this.name=oP.KHR_MATERIALS_SHEEN}getMaterialType(e){let i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?nq:null}extendMaterialParams(e,i){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let s=[];i.sheenColor=new e5(0,0,0),i.sheenRoughness=0,i.sheen=1;let a=n.extensions[this.name];if(void 0!==a.sheenColorFactor){let e=a.sheenColorFactor;i.sheenColor.setRGB(e[0],e[1],e[2],tf)}return void 0!==a.sheenRoughnessFactor&&(i.sheenRoughness=a.sheenRoughnessFactor),void 0!==a.sheenColorTexture&&s.push(r.assignTexture(i,"sheenColorMap",a.sheenColorTexture,tp)),void 0!==a.sheenRoughnessTexture&&s.push(r.assignTexture(i,"sheenRoughnessMap",a.sheenRoughnessTexture)),Promise.all(s)}},oL=class{constructor(e){this.parser=e,this.name=oP.KHR_MATERIALS_TRANSMISSION}getMaterialType(e){let i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?nq:null}extendMaterialParams(e,i){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let s=[],a=n.extensions[this.name];return void 0!==a.transmissionFactor&&(i.transmission=a.transmissionFactor),void 0!==a.transmissionTexture&&s.push(r.assignTexture(i,"transmissionMap",a.transmissionTexture)),Promise.all(s)}},oN=class{constructor(e){this.parser=e,this.name=oP.KHR_MATERIALS_VOLUME}getMaterialType(e){let i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?nq:null}extendMaterialParams(e,i){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let s=[],a=n.extensions[this.name];i.thickness=void 0!==a.thicknessFactor?a.thicknessFactor:0,void 0!==a.thicknessTexture&&s.push(r.assignTexture(i,"thicknessMap",a.thicknessTexture)),i.attenuationDistance=a.attenuationDistance||1/0;let o=a.attenuationColor||[1,1,1];return i.attenuationColor=new e5().setRGB(o[0],o[1],o[2],tf),Promise.all(s)}},oF=class{constructor(e){this.parser=e,this.name=oP.KHR_MATERIALS_IOR}getMaterialType(e){let i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?nq:null}extendMaterialParams(e,i){let r=this.parser.json.materials[e];if(!r.extensions||!r.extensions[this.name])return Promise.resolve();let n=r.extensions[this.name];return i.ior=void 0!==n.ior?n.ior:1.5,Promise.resolve()}},oD=class{constructor(e){this.parser=e,this.name=oP.KHR_MATERIALS_SPECULAR}getMaterialType(e){let i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?nq:null}extendMaterialParams(e,i){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let s=[],a=n.extensions[this.name];i.specularIntensity=void 0!==a.specularFactor?a.specularFactor:1,void 0!==a.specularTexture&&s.push(r.assignTexture(i,"specularIntensityMap",a.specularTexture));let o=a.specularColorFactor||[1,1,1];return i.specularColor=new e5().setRGB(o[0],o[1],o[2],tf),void 0!==a.specularColorTexture&&s.push(r.assignTexture(i,"specularColorMap",a.specularColorTexture,tp)),Promise.all(s)}},oU=class{constructor(e){this.parser=e,this.name=oP.EXT_MATERIALS_BUMP}getMaterialType(e){let i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?nq:null}extendMaterialParams(e,i){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let s=[],a=n.extensions[this.name];return i.bumpScale=void 0!==a.bumpFactor?a.bumpFactor:1,void 0!==a.bumpTexture&&s.push(r.assignTexture(i,"bumpMap",a.bumpTexture)),Promise.all(s)}},oj=class{constructor(e){this.parser=e,this.name=oP.KHR_MATERIALS_ANISOTROPY}getMaterialType(e){let i=this.parser.json.materials[e];return i.extensions&&i.extensions[this.name]?nq:null}extendMaterialParams(e,i){let r=this.parser,n=r.json.materials[e];if(!n.extensions||!n.extensions[this.name])return Promise.resolve();let s=[],a=n.extensions[this.name];return void 0!==a.anisotropyStrength&&(i.anisotropy=a.anisotropyStrength),void 0!==a.anisotropyRotation&&(i.anisotropyRotation=a.anisotropyRotation),void 0!==a.anisotropyTexture&&s.push(r.assignTexture(i,"anisotropyMap",a.anisotropyTexture)),Promise.all(s)}},oV=class{constructor(e){this.parser=e,this.name=oP.KHR_TEXTURE_BASISU}loadTexture(e){let i=this.parser,r=i.json,n=r.textures[e];if(!n.extensions||!n.extensions[this.name])return null;let s=n.extensions[this.name],a=i.options.ktx2Loader;if(!a){if(r.extensionsRequired&&r.extensionsRequired.indexOf(this.name)>=0)throw Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return i.loadTextureImage(e,s.source,a)}},oW=class{constructor(e){this.parser=e,this.name=oP.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(e){let i=this.name,r=this.parser,n=r.json,s=n.textures[e];if(!s.extensions||!s.extensions[i])return null;let a=s.extensions[i],o=n.images[a.source],l=r.textureLoader;if(o.uri){let e=r.options.manager.getHandler(o.uri);null!==e&&(l=e)}return this.detectSupport().then(function(s){if(s)return r.loadTextureImage(e,a.source,l);if(n.extensionsRequired&&n.extensionsRequired.indexOf(i)>=0)throw Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let i=new Image;i.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",i.onload=i.onerror=function(){e(1===i.height)}})),this.isSupported}},oH=class{constructor(e){this.parser=e,this.name=oP.EXT_TEXTURE_AVIF,this.isSupported=null}loadTexture(e){let i=this.name,r=this.parser,n=r.json,s=n.textures[e];if(!s.extensions||!s.extensions[i])return null;let a=s.extensions[i],o=n.images[a.source],l=r.textureLoader;if(o.uri){let e=r.options.manager.getHandler(o.uri);null!==e&&(l=e)}return this.detectSupport().then(function(s){if(s)return r.loadTextureImage(e,a.source,l);if(n.extensionsRequired&&n.extensionsRequired.indexOf(i)>=0)throw Error("THREE.GLTFLoader: AVIF required by asset but unsupported.");return r.loadTexture(e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(e){let i=new Image;i.src="data:image/avif;base64,AAAAIGZ0eXBhdmlmAAAAAGF2aWZtaWYxbWlhZk1BMUIAAADybWV0YQAAAAAAAAAoaGRscgAAAAAAAAAAcGljdAAAAAAAAAAAAAAAAGxpYmF2aWYAAAAADnBpdG0AAAAAAAEAAAAeaWxvYwAAAABEAAABAAEAAAABAAABGgAAABcAAAAoaWluZgAAAAAAAQAAABppbmZlAgAAAAABAABhdjAxQ29sb3IAAAAAamlwcnAAAABLaXBjbwAAABRpc3BlAAAAAAAAAAEAAAABAAAAEHBpeGkAAAAAAwgICAAAAAxhdjFDgQAMAAAAABNjb2xybmNseAACAAIABoAAAAAXaXBtYQAAAAAAAAABAAEEAQKDBAAAAB9tZGF0EgAKCBgABogQEDQgMgkQAAAAB8dSLfI=",i.onload=i.onerror=function(){e(1===i.height)}})),this.isSupported}},oq=class{constructor(e){this.name=oP.EXT_MESHOPT_COMPRESSION,this.parser=e}loadBufferView(e){let i=this.parser.json,r=i.bufferViews[e];if(!r.extensions||!r.extensions[this.name])return null;{let e=r.extensions[this.name],n=this.parser.getDependency("buffer",e.buffer),s=this.parser.options.meshoptDecoder;if(!s||!s.supported){if(i.extensionsRequired&&i.extensionsRequired.indexOf(this.name)>=0)throw Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return n.then(function(i){let r=e.byteOffset||0,n=e.byteLength||0,a=e.count,o=e.byteStride,l=new Uint8Array(i,r,n);return s.decodeGltfBufferAsync?s.decodeGltfBufferAsync(a,o,l,e.mode,e.filter).then(function(e){return e.buffer}):s.ready.then(function(){let i=new ArrayBuffer(a*o);return s.decodeGltfBuffer(new Uint8Array(i),a,o,l,e.mode,e.filter),i})})}}},oG=class{constructor(e){this.name=oP.EXT_MESH_GPU_INSTANCING,this.parser=e}createNodeMesh(e){let i=this.parser.json,r=i.nodes[e];if(!r.extensions||!r.extensions[this.name]||void 0===r.mesh)return null;for(let e of i.meshes[r.mesh].primitives)if(e.mode!==o2.TRIANGLES&&e.mode!==o2.TRIANGLE_STRIP&&e.mode!==o2.TRIANGLE_FAN&&void 0!==e.mode)return null;let n=r.extensions[this.name].attributes,s=[],a={};for(let e in n)s.push(this.parser.getDependency("accessor",n[e]).then(i=>(a[e]=i,a[e])));return s.length<1?null:(s.push(this.parser.createNodeMesh(e)),Promise.all(s).then(e=>{let i=e.pop(),r=i.isGroup?i.children:[i],n=e[0].count,s=[];for(let e of r){let i=new eg,r=new tZ,o=new tY,l=new tZ(1,1,1),h=new ni(e.geometry,e.material,n);for(let e=0;e<n;e++)a.TRANSLATION&&r.fromBufferAttribute(a.TRANSLATION,e),a.ROTATION&&o.fromBufferAttribute(a.ROTATION,e),a.SCALE&&l.fromBufferAttribute(a.SCALE,e),h.setMatrixAt(e,i.compose(r,o,l));for(let i in a)if("_COLOR_0"===i){let e=a[i];h.instanceColor=new r4(e.array,e.itemSize,e.normalized)}else"TRANSLATION"!==i&&"ROTATION"!==i&&"SCALE"!==i&&e.geometry.setAttribute(i,a[i]);eW.prototype.copy.call(h,e),this.parser.assignFinalMaterial(h),s.push(h)}return i.isGroup?(i.clear(),i.add(...s),i):s[0]}))}},oJ="glTF",oX={JSON:1313821514,BIN:5130562},oY=class{constructor(e){this.name=oP.KHR_BINARY_GLTF,this.content=null,this.body=null;let i=new DataView(e,0,12),r=new TextDecoder;if(this.header={magic:r.decode(new Uint8Array(e.slice(0,4))),version:i.getUint32(4,!0),length:i.getUint32(8,!0)},this.header.magic!==oJ)throw Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw Error("THREE.GLTFLoader: Legacy binary file detected.");let n=this.header.length-12,s=new DataView(e,12),a=0;for(;a<n;){let i=s.getUint32(a,!0);a+=4;let n=s.getUint32(a,!0);if(a+=4,n===oX.JSON){let n=new Uint8Array(e,12+a,i);this.content=r.decode(n)}else if(n===oX.BIN){let r=12+a;this.body=e.slice(r,r+i)}a+=i}if(null===this.content)throw Error("THREE.GLTFLoader: JSON content not found.")}},oZ=class{constructor(e,i){if(!i)throw Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=oP.KHR_DRACO_MESH_COMPRESSION,this.json=e,this.dracoLoader=i,this.dracoLoader.preload()}decodePrimitive(e,i){let r=this.json,n=this.dracoLoader,s=e.extensions[this.name].bufferView,a=e.extensions[this.name].attributes,o={},l={},h={};for(let e in a)o[o9[e]||e.toLowerCase()]=a[e];for(let i in e.attributes){let n=o9[i]||i.toLowerCase();if(void 0!==a[i]){let s=r.accessors[e.attributes[i]],a=o3[s.componentType];h[n]=a.name,l[n]=!0===s.normalized}}return i.getDependency("bufferView",s).then(function(e){return new Promise(function(i,r){n.decodeDracoFile(e,function(e){for(let i in e.attributes){let r=e.attributes[i],n=l[i];void 0!==n&&(r.normalized=n)}i(e)},o,h,tf,r)})})}},oK=class{constructor(){this.name=oP.KHR_TEXTURE_TRANSFORM}extendTexture(e,i){return(void 0===i.texCoord||i.texCoord===e.channel)&&void 0===i.offset&&void 0===i.rotation&&void 0===i.scale||(e=e.clone(),void 0!==i.texCoord&&(e.channel=i.texCoord),void 0!==i.offset&&e.offset.fromArray(i.offset),void 0!==i.rotation&&(e.rotation=i.rotation),void 0!==i.scale&&e.repeat.fromArray(i.scale),e.needsUpdate=!0),e}},o$=class{constructor(){this.name=oP.KHR_MESH_QUANTIZATION}},oQ=class extends nY{constructor(e,i,r,n){super(e,i,r,n)}copySampleValue_(e){let i=this.resultBuffer,r=this.sampleValues,n=this.valueSize,s=e*n*3+n;for(let e=0;e!==n;e++)i[e]=r[s+e];return i}interpolate_(e,i,r,n){let s=this.resultBuffer,a=this.sampleValues,o=this.valueSize,l=2*o,h=3*o,u=n-i,c=(r-i)/u,d=c*c,p=d*c,f=e*h,m=f-h,g=-2*p+3*d,y=p-d,v=1-g,_=y-d+c;for(let e=0;e!==o;e++){let i=a[m+e+o],r=a[m+e+l]*u,n=a[f+e+o],h=a[f+e]*u;s[e]=v*i+_*r+g*n+y*h}return s}},o0=new tY,o1=class extends oQ{interpolate_(e,i,r,n){let s=super.interpolate_(e,i,r,n);return o0.fromArray(s).normalize().toArray(s),s}},o2={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6},o3={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},o4={9728:1003,9729:1006,9984:1004,9985:1007,9986:1005,9987:1008},o5={33071:1001,33648:1002,10497:1e3},o6={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},o9={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv1",TEXCOORD_2:"uv2",TEXCOORD_3:"uv3",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},o7={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},o8={CUBICSPLINE:void 0,LINEAR:2301,STEP:2300},lt={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function le(e,i,r){for(let n in r.extensions)void 0===e[n]&&(i.userData.gltfExtensions=i.userData.gltfExtensions||{},i.userData.gltfExtensions[n]=r.extensions[n])}function li(e,i){void 0!==i.extras&&("object"==typeof i.extras?Object.assign(e.userData,i.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+i.extras))}function lr(e){let i="",r=Object.keys(e).sort();for(let n=0,s=r.length;n<s;n++)i+=r[n]+":"+e[r[n]]+";";return i}function ln(e){switch(e){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}var ls=new eg,la=class{constructor(e={},i={}){this.json=e,this.extensions={},this.plugins={},this.options=i,this.cache=new oC,this.associations=new Map,this.primitiveCache={},this.nodeCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.sourceCache={},this.textureCache={},this.nodeNamesUsed={};let r=!1,n=-1,s=!1,a=-1;if("u">typeof navigator){let e=navigator.userAgent;r=!0===/^((?!chrome|android).)*safari/i.test(e);let i=e.match(/Version\/(\d+)/);n=r&&i?parseInt(i[1],10):-1,a=(s=e.indexOf("Firefox")>-1)?e.match(/Firefox\/([0-9]+)\./)[1]:-1}typeof createImageBitmap>"u"||r&&n<17||s&&a<98?this.textureLoader=new ss(this.options.manager):this.textureLoader=new sb(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new sr(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),"use-credentials"===this.options.crossOrigin&&this.fileLoader.setWithCredentials(!0)}setExtensions(e){this.extensions=e}setPlugins(e){this.plugins=e}parse(e,i){let r=this,n=this.json,s=this.extensions;this.cache.removeAll(),this.nodeCache={},this._invokeAll(function(e){return e._markDefs&&e._markDefs()}),Promise.all(this._invokeAll(function(e){return e.beforeRoot&&e.beforeRoot()})).then(function(){return Promise.all([r.getDependencies("scene"),r.getDependencies("animation"),r.getDependencies("camera")])}).then(function(i){let a={scene:i[0][n.scene||0],scenes:i[0],animations:i[1],cameras:i[2],asset:n.asset,parser:r,userData:{}};return le(s,a,n),li(a,n),Promise.all(r._invokeAll(function(e){return e.afterRoot&&e.afterRoot(a)})).then(function(){for(let e of a.scenes)e.updateMatrixWorld();e(a)})}).catch(i)}_markDefs(){let e=this.json.nodes||[],i=this.json.skins||[],r=this.json.meshes||[];for(let r=0,n=i.length;r<n;r++){let n=i[r].joints;for(let i=0,r=n.length;i<r;i++)e[n[i]].isBone=!0}for(let i=0,n=e.length;i<n;i++){let n=e[i];void 0!==n.mesh&&(this._addNodeRef(this.meshCache,n.mesh),void 0!==n.skin&&(r[n.mesh].isSkinnedMesh=!0)),void 0!==n.camera&&this._addNodeRef(this.cameraCache,n.camera)}}_addNodeRef(e,i){void 0!==i&&(void 0===e.refs[i]&&(e.refs[i]=e.uses[i]=0),e.refs[i]++)}_getNodeRef(e,i,r){if(e.refs[i]<=1)return r;let n=r.clone(),s=(e,i)=>{let r=this.associations.get(e);for(let[n,a]of(null!=r&&this.associations.set(i,r),e.children.entries()))s(a,i.children[n])};return s(r,n),n.name+="_instance_"+e.uses[i]++,n}_invokeOne(e){let i=Object.values(this.plugins);i.push(this);for(let r=0;r<i.length;r++){let n=e(i[r]);if(n)return n}return null}_invokeAll(e){let i=Object.values(this.plugins);i.unshift(this);let r=[];for(let n=0;n<i.length;n++){let s=e(i[n]);s&&r.push(s)}return r}getDependency(e,i){let r=e+":"+i,n=this.cache.get(r);if(!n){switch(e){case"scene":n=this.loadScene(i);break;case"node":n=this._invokeOne(function(e){return e.loadNode&&e.loadNode(i)});break;case"mesh":n=this._invokeOne(function(e){return e.loadMesh&&e.loadMesh(i)});break;case"accessor":n=this.loadAccessor(i);break;case"bufferView":n=this._invokeOne(function(e){return e.loadBufferView&&e.loadBufferView(i)});break;case"buffer":n=this.loadBuffer(i);break;case"material":n=this._invokeOne(function(e){return e.loadMaterial&&e.loadMaterial(i)});break;case"texture":n=this._invokeOne(function(e){return e.loadTexture&&e.loadTexture(i)});break;case"skin":n=this.loadSkin(i);break;case"animation":n=this._invokeOne(function(e){return e.loadAnimation&&e.loadAnimation(i)});break;case"camera":n=this.loadCamera(i);break;default:if(!(n=this._invokeOne(function(r){return r!=this&&r.getDependency&&r.getDependency(e,i)})))throw Error("Unknown type: "+e)}this.cache.add(r,n)}return n}getDependencies(e){let i=this.cache.get(e);if(!i){let r=this;i=Promise.all((this.json[e+("mesh"===e?"es":"s")]||[]).map(function(i,n){return r.getDependency(e,n)})),this.cache.add(e,i)}return i}loadBuffer(e){let i=this.json.buffers[e],r=this.fileLoader;if(i.type&&"arraybuffer"!==i.type)throw Error("THREE.GLTFLoader: "+i.type+" buffer type is not supported.");if(void 0===i.uri&&0===e)return Promise.resolve(this.extensions[oP.KHR_BINARY_GLTF].body);let n=this.options;return new Promise(function(e,s){r.load(sx.resolveURL(i.uri,n.path),e,void 0,function(){s(Error('THREE.GLTFLoader: Failed to load buffer "'+i.uri+'".'))})})}loadBufferView(e){let i=this.json.bufferViews[e];return this.getDependency("buffer",i.buffer).then(function(e){let r=i.byteLength||0,n=i.byteOffset||0;return e.slice(n,n+r)})}loadAccessor(e){let i=this,r=this.json,n=this.json.accessors[e];if(void 0===n.bufferView&&void 0===n.sparse){let e=o6[n.type],i=o3[n.componentType],r=!0===n.normalized;return Promise.resolve(new ii(new i(n.count*e),e,r))}let s=[];return void 0!==n.bufferView?s.push(this.getDependency("bufferView",n.bufferView)):s.push(null),void 0!==n.sparse&&(s.push(this.getDependency("bufferView",n.sparse.indices.bufferView)),s.push(this.getDependency("bufferView",n.sparse.values.bufferView))),Promise.all(s).then(function(e){let s=e[0],a=o6[n.type],o=o3[n.componentType],l=o.BYTES_PER_ELEMENT,h=l*a,u=n.byteOffset||0,c=void 0!==n.bufferView?r.bufferViews[n.bufferView].byteStride:void 0,d=!0===n.normalized,p;if(c&&c!==h){let e=Math.floor(u/c),r="InterleavedBuffer:"+n.bufferView+":"+n.componentType+":"+e+":"+n.count,h=i.cache.get(r);h||(h=new rS(new o(s,e*c,n.count*c/l),c/l),i.cache.add(r,h)),p=new rC(h,a,u%c/l,d)}else p=new ii(null===s?new o(n.count*a):new o(s,u,n.count*a),a,d);if(void 0!==n.sparse){let i=o6.SCALAR,r=o3[n.sparse.indices.componentType],l=n.sparse.indices.byteOffset||0,h=n.sparse.values.byteOffset||0,u=new r(e[1],l,n.sparse.count*i),c=new o(e[2],h,n.sparse.count*a);null!==s&&(p=new ii(p.array.slice(),p.itemSize,p.normalized));for(let e=0,i=u.length;e<i;e++){let i=u[e];if(p.setX(i,c[e*a]),a>=2&&p.setY(i,c[e*a+1]),a>=3&&p.setZ(i,c[e*a+2]),a>=4&&p.setW(i,c[e*a+3]),a>=5)throw Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}}return p})}loadTexture(e){let i=this.json,r=this.options,n=i.textures[e].source,s=i.images[n],a=this.textureLoader;if(s.uri){let e=r.manager.getHandler(s.uri);null!==e&&(a=e)}return this.loadTextureImage(e,n,a)}loadTextureImage(e,i,r){let n=this,s=this.json,a=s.textures[e],o=s.images[i],l=(o.uri||o.bufferView)+":"+a.sampler;if(this.textureCache[l])return this.textureCache[l];let h=this.loadImageSource(i,r).then(function(i){i.flipY=!1,i.name=a.name||o.name||"",""===i.name&&"string"==typeof o.uri&&!1===o.uri.startsWith("data:image/")&&(i.name=o.uri);let r=(s.samplers||{})[a.sampler]||{};return i.magFilter=o4[r.magFilter]||1006,i.minFilter=o4[r.minFilter]||1008,i.wrapS=o5[r.wrapS]||1e3,i.wrapT=o5[r.wrapT]||1e3,n.associations.set(i,{textures:e}),i}).catch(function(){return null});return this.textureCache[l]=h,h}loadImageSource(e,i){let r=this.json,n=this.options;if(void 0!==this.sourceCache[e])return this.sourceCache[e].then(e=>e.clone());let s=r.images[e],a=self.URL||self.webkitURL,o=s.uri||"",l=!1;if(void 0!==s.bufferView)o=this.getDependency("bufferView",s.bufferView).then(function(e){l=!0;let i=new Blob([e],{type:s.mimeType});return o=a.createObjectURL(i)});else if(void 0===s.uri)throw Error("THREE.GLTFLoader: Image "+e+" is missing URI and bufferView");let h=Promise.resolve(o).then(function(e){return new Promise(function(r,s){let a=r;!0===i.isImageBitmapLoader&&(a=function(e){let i=new tJ(e);i.needsUpdate=!0,r(i)}),i.load(sx.resolveURL(e,n.path),a,void 0,s)})}).then(function(e){var i;return!0===l&&a.revokeObjectURL(o),li(e,s),e.userData.mimeType=s.mimeType||((i=s.uri).search(/\.jpe?g($|\?)/i)>0||0===i.search(/^data\:image\/jpeg/)?"image/jpeg":i.search(/\.webp($|\?)/i)>0||0===i.search(/^data\:image\/webp/)?"image/webp":"image/png"),e}).catch(function(e){throw console.error("THREE.GLTFLoader: Couldn't load texture",o),e});return this.sourceCache[e]=h,h}assignTexture(e,i,r,n){let s=this;return this.getDependency("texture",r.index).then(function(a){if(!a)return null;if(void 0!==r.texCoord&&r.texCoord>0&&((a=a.clone()).channel=r.texCoord),s.extensions[oP.KHR_TEXTURE_TRANSFORM]){let e=void 0!==r.extensions?r.extensions[oP.KHR_TEXTURE_TRANSFORM]:void 0;if(e){let i=s.associations.get(a);a=s.extensions[oP.KHR_TEXTURE_TRANSFORM].extendTexture(a,e),s.associations.set(a,i)}}return void 0!==n&&(a.colorSpace=n),e[i]=a,a})}assignFinalMaterial(e){let i=e.geometry,r=e.material,n=void 0===i.attributes.tangent,s=void 0!==i.attributes.color,a=void 0===i.attributes.normal;if(e.isPoints){let e="PointsMaterial:"+r.uuid,i=this.cache.get(e);i||(i=new ny,e7.prototype.copy.call(i,r),i.color.copy(r.color),i.map=r.map,i.sizeAttenuation=!1,this.cache.add(e,i)),r=i}else if(e.isLine){let e="LineBasicMaterial:"+r.uuid,i=this.cache.get(e);i||(i=new nr,e7.prototype.copy.call(i,r),i.color.copy(r.color),i.map=r.map,this.cache.add(e,i)),r=i}if(n||s||a){let e="ClonedMaterial:"+r.uuid+":";n&&(e+="derivative-tangents:"),s&&(e+="vertex-colors:"),a&&(e+="flat-shading:");let i=this.cache.get(e);i||(i=r.clone(),s&&(i.vertexColors=!0),a&&(i.flatShading=!0),n&&(i.normalScale&&(i.normalScale.y*=-1),i.clearcoatNormalScale&&(i.clearcoatNormalScale.y*=-1)),this.cache.add(e,i),this.associations.set(i,this.associations.get(r))),r=i}e.material=r}getMaterialType(){return nH}loadMaterial(e){let i=this,r=this.json,n=this.extensions,s=r.materials[e],a,o={},l=s.extensions||{},h=[];if(l[oP.KHR_MATERIALS_UNLIT]){let e=n[oP.KHR_MATERIALS_UNLIT];a=e.getMaterialType(),h.push(e.extendParams(o,s,i))}else{let r=s.pbrMetallicRoughness||{};if(o.color=new e5(1,1,1),o.opacity=1,Array.isArray(r.baseColorFactor)){let e=r.baseColorFactor;o.color.setRGB(e[0],e[1],e[2],tf),o.opacity=e[3]}void 0!==r.baseColorTexture&&h.push(i.assignTexture(o,"map",r.baseColorTexture,tp)),o.metalness=void 0!==r.metallicFactor?r.metallicFactor:1,o.roughness=void 0!==r.roughnessFactor?r.roughnessFactor:1,void 0!==r.metallicRoughnessTexture&&(h.push(i.assignTexture(o,"metalnessMap",r.metallicRoughnessTexture)),h.push(i.assignTexture(o,"roughnessMap",r.metallicRoughnessTexture))),a=this._invokeOne(function(i){return i.getMaterialType&&i.getMaterialType(e)}),h.push(Promise.all(this._invokeAll(function(i){return i.extendMaterialParams&&i.extendMaterialParams(e,o)})))}!0===s.doubleSided&&(o.side=2);let u=s.alphaMode||lt.OPAQUE;if(u===lt.BLEND?(o.transparent=!0,o.depthWrite=!1):(o.transparent=!1,u===lt.MASK&&(o.alphaTest=void 0!==s.alphaCutoff?s.alphaCutoff:.5)),void 0!==s.normalTexture&&a!==e8&&(h.push(i.assignTexture(o,"normalMap",s.normalTexture)),o.normalScale=new tP(1,1),void 0!==s.normalTexture.scale)){let e=s.normalTexture.scale;o.normalScale.set(e,e)}if(void 0!==s.occlusionTexture&&a!==e8&&(h.push(i.assignTexture(o,"aoMap",s.occlusionTexture)),void 0!==s.occlusionTexture.strength&&(o.aoMapIntensity=s.occlusionTexture.strength)),void 0!==s.emissiveFactor&&a!==e8){let e=s.emissiveFactor;o.emissive=new e5().setRGB(e[0],e[1],e[2],tf)}return void 0!==s.emissiveTexture&&a!==e8&&h.push(i.assignTexture(o,"emissiveMap",s.emissiveTexture,tp)),Promise.all(h).then(function(){let r=new a(o);return s.name&&(r.name=s.name),li(r,s),i.associations.set(r,{materials:e}),s.extensions&&le(n,r,s),r})}createUniqueName(e){let i=sR.sanitizeNodeName(e||"");return i in this.nodeNamesUsed?i+"_"+ ++this.nodeNamesUsed[i]:(this.nodeNamesUsed[i]=0,i)}loadGeometries(e){let i=this,r=this.extensions,n=this.primitiveCache,s=[];for(let a=0,o=e.length;a<o;a++){let o=e[a],l=function(e){let i,r=e.extensions&&e.extensions[oP.KHR_DRACO_MESH_COMPRESSION];if(i=r?"draco:"+r.bufferView+":"+r.indices+":"+lr(r.attributes):e.indices+":"+lr(e.attributes)+":"+e.mode,void 0!==e.targets)for(let r=0,n=e.targets.length;r<n;r++)i+=":"+lr(e.targets[r]);return i}(o),h=n[l];if(h)s.push(h.promise);else{let e;e=o.extensions&&o.extensions[oP.KHR_DRACO_MESH_COMPRESSION]?function(e){return r[oP.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(e,i).then(function(r){return lo(r,e,i)})}(o):lo(new im,o,i),n[l]={primitive:o,promise:e},s.push(e)}}return Promise.all(s)}loadMesh(e){let i=this,r=this.json,n=this.extensions,s=r.meshes[e],a=s.primitives,o=[];for(let e=0,i=a.length;e<i;e++){var l;let i=void 0===a[e].material?(void 0===(l=this.cache).DefaultMaterial&&(l.DefaultMaterial=new nH({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:0})),l.DefaultMaterial):this.getDependency("material",a[e].material);o.push(i)}return o.push(i.loadGeometries(a)),Promise.all(o).then(function(r){let o=r.slice(0,r.length-1),l=r[r.length-1],h=[];for(let r=0,u=l.length;r<u;r++){let u=l[r],c=a[r],d,p=o[r];if(c.mode===o2.TRIANGLES||c.mode===o2.TRIANGLE_STRIP||c.mode===o2.TRIANGLE_FAN||void 0===c.mode)!0===(d=!0===s.isSkinnedMesh?new r$(u,p):new iB(u,p)).isSkinnedMesh&&d.normalizeSkinWeights(),c.mode===o2.TRIANGLE_STRIP?d.geometry=oS(d.geometry,1):c.mode===o2.TRIANGLE_FAN&&(d.geometry=oS(d.geometry,2));else if(c.mode===o2.LINES)d=new nm(u,p);else if(c.mode===o2.LINE_STRIP)d=new nc(u,p);else if(c.mode===o2.LINE_LOOP)d=new ng(u,p);else if(c.mode===o2.POINTS)d=new nw(u,p);else throw Error("THREE.GLTFLoader: Primitive mode unsupported: "+c.mode);Object.keys(d.geometry.morphAttributes).length>0&&function(e,i){if(e.updateMorphTargets(),void 0!==i.weights)for(let r=0,n=i.weights.length;r<n;r++)e.morphTargetInfluences[r]=i.weights[r];if(i.extras&&Array.isArray(i.extras.targetNames)){let r=i.extras.targetNames;if(e.morphTargetInfluences.length===r.length){e.morphTargetDictionary={};for(let i=0,n=r.length;i<n;i++)e.morphTargetDictionary[r[i]]=i}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}(d,s),d.name=i.createUniqueName(s.name||"mesh_"+e),li(d,s),c.extensions&&le(n,d,c),i.assignFinalMaterial(d),h.push(d)}for(let r=0,n=h.length;r<n;r++)i.associations.set(h[r],{meshes:e,primitives:r});if(1===h.length)return s.extensions&&le(n,h[0],s),h[0];let u=new rA;s.extensions&&le(n,u,s),i.associations.set(u,{meshes:e});for(let e=0,i=h.length;e<i;e++)u.add(h[e]);return u})}loadCamera(e){let i,r=this.json.cameras[e],n=r[r.type];if(!n){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return"perspective"===r.type?i=new iU(tC.radToDeg(n.yfov),n.aspectRatio||1,n.znear||1,n.zfar||2e6):"orthographic"===r.type&&(i=new rx(-n.xmag,n.xmag,n.ymag,-n.ymag,n.znear,n.zfar)),r.name&&(i.name=this.createUniqueName(r.name)),li(i,r),Promise.resolve(i)}loadSkin(e){let i=this.json.skins[e],r=[];for(let e=0,n=i.joints.length;e<n;e++)r.push(this._loadNodeShallow(i.joints[e]));return void 0!==i.inverseBindMatrices?r.push(this.getDependency("accessor",i.inverseBindMatrices)):r.push(null),Promise.all(r).then(function(e){let r=e.pop(),n=[],s=[];for(let a=0,o=e.length;a<o;a++){let o=e[a];if(o){n.push(o);let e=new eg;null!==r&&e.fromArray(r.array,16*a),s.push(e)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',i.joints[a])}return new r3(n,s)})}loadAnimation(e){let i=this.json,r=this,n=i.animations[e],s=n.name?n.name:"animation_"+e,a=[],o=[],l=[],h=[],u=[];for(let e=0,i=n.channels.length;e<i;e++){let i=n.channels[e],r=n.samplers[i.sampler],s=i.target,c=s.node,d=void 0!==n.parameters?n.parameters[r.input]:r.input,p=void 0!==n.parameters?n.parameters[r.output]:r.output;void 0!==s.node&&(a.push(this.getDependency("node",c)),o.push(this.getDependency("accessor",d)),l.push(this.getDependency("accessor",p)),h.push(r),u.push(s))}return Promise.all([Promise.all(a),Promise.all(o),Promise.all(l),Promise.all(h),Promise.all(u)]).then(function(e){let i=e[0],n=e[1],a=e[2],o=e[3],l=e[4],h=[];for(let e=0,s=i.length;e<s;e++){let s=i[e],u=n[e],c=a[e],d=o[e],p=l[e];if(void 0===s)continue;s.updateMatrix&&s.updateMatrix();let f=r._createAnimationTracks(s,u,c,d,p);if(f)for(let e=0;e<f.length;e++)h.push(f[e])}return new n9(s,void 0,h)})}createNodeMesh(e){let i=this.json,r=this,n=i.nodes[e];return void 0===n.mesh?null:r.getDependency("mesh",n.mesh).then(function(e){let i=r._getNodeRef(r.meshCache,n.mesh,e);return void 0!==n.weights&&i.traverse(function(e){if(e.isMesh)for(let i=0,r=n.weights.length;i<r;i++)e.morphTargetInfluences[i]=n.weights[i]}),i})}loadNode(e){let i=this.json.nodes[e],r=this._loadNodeShallow(e),n=[],s=i.children||[];for(let e=0,i=s.length;e<i;e++)n.push(this.getDependency("node",s[e]));let a=void 0===i.skin?Promise.resolve(null):this.getDependency("skin",i.skin);return Promise.all([r,Promise.all(n),a]).then(function(e){let i=e[0],r=e[1],n=e[2];null!==n&&i.traverse(function(e){e.isSkinnedMesh&&e.bind(n,ls)});for(let e=0,n=r.length;e<n;e++)i.add(r[e]);return i})}_loadNodeShallow(e){let i=this.json,r=this.extensions,n=this;if(void 0!==this.nodeCache[e])return this.nodeCache[e];let s=i.nodes[e],a=s.name?n.createUniqueName(s.name):"",o=[],l=n._invokeOne(function(i){return i.createNodeMesh&&i.createNodeMesh(e)});return l&&o.push(l),void 0!==s.camera&&o.push(n.getDependency("camera",s.camera).then(function(e){return n._getNodeRef(n.cameraCache,s.camera,e)})),n._invokeAll(function(i){return i.createNodeAttachment&&i.createNodeAttachment(e)}).forEach(function(e){o.push(e)}),this.nodeCache[e]=Promise.all(o).then(function(i){let o;if((o=!0===s.isBone?new rQ:i.length>1?new rA:1===i.length?i[0]:new eW)!==i[0])for(let e=0,r=i.length;e<r;e++)o.add(i[e]);if(s.name&&(o.userData.name=s.name,o.name=a),li(o,s),s.extensions&&le(r,o,s),void 0!==s.matrix){let e=new eg;e.fromArray(s.matrix),o.applyMatrix4(e)}else void 0!==s.translation&&o.position.fromArray(s.translation),void 0!==s.rotation&&o.quaternion.fromArray(s.rotation),void 0!==s.scale&&o.scale.fromArray(s.scale);return n.associations.has(o)||n.associations.set(o,{}),n.associations.get(o).nodes=e,o}),this.nodeCache[e]}loadScene(e){let i=this.extensions,r=this.json.scenes[e],n=this,s=new rA;r.name&&(s.name=n.createUniqueName(r.name)),li(s,r),r.extensions&&le(i,s,r);let a=r.nodes||[],o=[];for(let e=0,i=a.length;e<i;e++)o.push(n.getDependency("node",a[e]));return Promise.all(o).then(function(e){for(let i=0,r=e.length;i<r;i++)s.add(e[i]);return n.associations=(e=>{let i=new Map;for(let[e,r]of n.associations)(e instanceof e7||e instanceof tJ)&&i.set(e,r);return e.traverse(e=>{let r=n.associations.get(e);null!=r&&i.set(e,r)}),i})(s),s})}_createAnimationTracks(e,i,r,n,s){let a,o=[],l=e.name?e.name:e.uuid,h=[];switch(o7[s.path]===o7.weights?e.traverse(function(e){e.morphTargetInfluences&&h.push(e.name?e.name:e.uuid)}):h.push(l),o7[s.path]){case o7.weights:a=n2;break;case o7.rotation:a=n4;break;case o7.position:case o7.scale:a=n6;break;default:a=1===r.itemSize?n2:n6}let u=void 0!==n.interpolation?o8[n.interpolation]:2301,c=this._getArrayFromAccessor(r);for(let e=0,r=h.length;e<r;e++){let r=new a(h[e]+"."+o7[s.path],i.array,c,u);"CUBICSPLINE"===n.interpolation&&this._createCubicSplineTrackInterpolant(r),o.push(r)}return o}_getArrayFromAccessor(e){let i=e.array;if(e.normalized){let e=ln(i.constructor),r=new Float32Array(i.length);for(let n=0,s=i.length;n<s;n++)r[n]=i[n]*e;i=r}return i}_createCubicSplineTrackInterpolant(e){e.createInterpolant=function(e){return new(this instanceof n4?o1:oQ)(this.times,this.values,this.getValueSize()/3,e)},e.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0}};function lo(e,i,r){let n=i.attributes,s=[];for(let i in n){let a=o9[i]||i.toLowerCase();a in e.attributes||s.push(function(i,n){return r.getDependency("accessor",i).then(function(i){e.setAttribute(n,i)})}(n[i],a))}if(void 0!==i.indices&&!e.index){let n=r.getDependency("accessor",i.indices).then(function(i){e.setIndex(i)});s.push(n)}return tF.workingColorSpace!==tf&&"COLOR_0"in n&&console.warn(`THREE.GLTFLoader: Converting vertex colors from "srgb-linear" to "${tF.workingColorSpace}" not supported.`),li(e,i),function(e,i,r){let n=i.attributes,s=new tQ;if(void 0===n.POSITION)return;{let e=r.json.accessors[n.POSITION],i=e.min,a=e.max;if(void 0!==i&&void 0!==a){if(s.set(new tZ(i[0],i[1],i[2]),new tZ(a[0],a[1],a[2])),e.normalized){let i=ln(o3[e.componentType]);s.min.multiplyScalar(i),s.max.multiplyScalar(i)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}let a=i.targets;if(void 0!==a){let e=new tZ,i=new tZ;for(let n=0,s=a.length;n<s;n++){let s=a[n];if(void 0!==s.POSITION){let n=r.json.accessors[s.POSITION],a=n.min,o=n.max;if(void 0!==a&&void 0!==o){if(i.setX(Math.max(Math.abs(a[0]),Math.abs(o[0]))),i.setY(Math.max(Math.abs(a[1]),Math.abs(o[1]))),i.setZ(Math.max(Math.abs(a[2]),Math.abs(o[2]))),n.normalized){let e=ln(o3[n.componentType]);i.multiplyScalar(e)}e.max(i)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}s.expandByVector(e)}e.boundingBox=s;let o=new eo;s.getCenter(o.center),o.radius=s.min.distanceTo(s.max)/2,e.boundingSphere=o}(e,i,r),Promise.all(s).then(function(){return void 0!==i.targets?function(e,i,r){let n=!1,s=!1,a=!1;for(let e=0,r=i.length;e<r;e++){let r=i[e];if(void 0!==r.POSITION&&(n=!0),void 0!==r.NORMAL&&(s=!0),void 0!==r.COLOR_0&&(a=!0),n&&s&&a)break}if(!n&&!s&&!a)return Promise.resolve(e);let o=[],l=[],h=[];for(let u=0,c=i.length;u<c;u++){let c=i[u];if(n){let i=void 0!==c.POSITION?r.getDependency("accessor",c.POSITION):e.attributes.position;o.push(i)}if(s){let i=void 0!==c.NORMAL?r.getDependency("accessor",c.NORMAL):e.attributes.normal;l.push(i)}if(a){let i=void 0!==c.COLOR_0?r.getDependency("accessor",c.COLOR_0):e.attributes.color;h.push(i)}}return Promise.all([Promise.all(o),Promise.all(l),Promise.all(h)]).then(function(i){let r=i[0],o=i[1],l=i[2];return n&&(e.morphAttributes.position=r),s&&(e.morphAttributes.normal=o),a&&(e.morphAttributes.color=l),e.morphTargetsRelative=!0,e})}(e,i.targets,r):e})}var ll=class{constructor(e,i,r,n){this.animations={},this.position=new tZ(0,0,0),this.lastPosition=new tZ(0,0,0),this.quaternion=null,this.isOwnAvatar=!1,this.currentAnimation=null,this.lastWorldModelPos=new tZ(0,0,0),this.worldPosition=new tZ(0,0,0),this.load=async()=>{let e=new oT;return new Promise((i,r)=>{e.load(this.url,async e=>{this.mixer=new sO(e.scene),e.animations.forEach(e=>{let i=this.mixer.clipAction(e);this.animations[e.name]=i,this.animations[e.name].paused=!0}),e.scene.scale.set(this.scale,this.scale,this.scale),e.scene.rotation.set(0,3.14,0),e.scene.position.set(0,this.height,0);let r=new eW;r.add(e.scene),this.model=e.scene,this.root=r,i(this.root)},void 0,e=>{console.error("An error happened loading the avatar",e),r(e)})})},this.url=e,this.scale=i,this.height=r,this.clock=new sw,this.mixer=null,this.isOwnAvatar=n,this.animations={},this.isMoving=!1,this.isMovingCounter=0,this.lerpAnimationFrame=requestAnimationFrame(this.animate.bind(this))}setPosition(e){this.position.set(e.x,e.y,e.z)}setQuaternion(e){this.quaternion=new tY(e.x,e.y,e.z,e.w)}destroy(){cancelAnimationFrame(this.lerpAnimationFrame),this.root.parent.remove(this.root)}animate(){if(requestAnimationFrame(this.animate.bind(this)),!this.position||!this.quaternion)return;this.lastPosition.set(this.position.x,this.position.y,this.position.z);let e=this.clock.getDelta(),i=this.isOwnAvatar?6:2,r=this.root.position.clone();r.lerp(this.position,i*e),this.root.position.set(r.x,r.y,r.z);let n=this.root.quaternion.clone();n.slerp(this.quaternion,i*e),this.root.quaternion.set(n.x,n.y,n.z,n.w),this.mixer.update(e),this.model.getWorldPosition(this.worldPosition);let s=this.isOwnAvatar?.001:.004,a=this.isOwnAvatar?10:30;this.lastWorldModelPos.distanceTo(this.worldPosition)<s?(this.isMovingCounter++,this.isMovingCounter>a&&(this.isMoving=!1,this.isMovingCounter=0)):this.isMoving=!0,this.model.getWorldPosition(this.lastWorldModelPos)}playAnimation(e){if(!this.animations[e])return;let i=this.animations[e];if(i&&this.currentAnimation!==e){if(i.paused=!1,i.enabled=!0,i.play(),this.currentAnimation&&this.animations[this.currentAnimation]){let e=this.isOwnAvatar?.3:.7;this.animations[this.currentAnimation].crossFadeTo(i,e,!0)}this.currentAnimation=e}}stopAnimation(e){this.animations[e]&&(this.animations[e].paused=!0)}stopAllAnimations(){Object.values(this.animations).forEach(e=>{e.paused=!0})}};function lh(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(lh=function(){return!!e})()}function lu(e){return(lu=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function lc(e,i){return(lc=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,i){return e.__proto__=i,e})(e,i)}function ld(e,i){return function(e){if(Array.isArray(e))return e}(e)||function(e,i){var r=null==e?null:"u">typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,s,a,o,l=[],h=!0,u=!1;try{if(a=(r=r.call(e)).next,0===i){if(Object(r)!==r)return;h=!1}else for(;!(h=(n=a.call(r)).done)&&(l.push(n.value),l.length!==i);h=!0);}catch(e){u=!0,s=e}finally{try{if(!h&&null!=r.return&&(o=r.return(),Object(o)!==o))return}finally{if(u)throw s}}return l}}(e,i)||lf(e,i)||function(){throw TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function lp(e){return function(e){if(Array.isArray(e))return lm(e)}(e)||function(e){if("u">typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||lf(e)||function(){throw TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}()}function lf(e,i){if(e){if("string"==typeof e)return lm(e,i);var r=Object.prototype.toString.call(e).slice(8,-1);if("Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return lm(e,i)}}function lm(e,i){(null==i||i>e.length)&&(i=e.length);for(var r=0,n=Array(i);r<i;r++)n[r]=e[r];return n}var lg="u">typeof window&&window.THREE?window.THREE:{LinearFilter:1006,Sprite:rj,SpriteMaterial:rP,SRGBColorSpace:tp,Texture:tJ},ly=function(e){var i;function r(){var e,i,n,s=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"rgba(255, 255, 255, 1)";return function(e,i){if(!(e instanceof i))throw TypeError("Cannot call a class as a function")}(this,r),e=r,i=[new lg.SpriteMaterial],e=lu(e),(n=function(e,i){if(i&&("object"==typeof i||"function"==typeof i))return i;if(void 0!==i)throw TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}(this,lh()?Reflect.construct(e,i||[],lu(this).constructor):e.apply(this,i)))._text="".concat(s),n._textHeight=a,n._color=o,n._backgroundColor=!1,n._padding=0,n._borderWidth=0,n._borderRadius=0,n._borderColor="white",n._strokeWidth=0,n._strokeColor="white",n._fontFace="system-ui",n._fontSize=90,n._fontWeight="normal",n._canvas=document.createElement("canvas"),n._genCanvas(),n}return!function(e,i){if("function"!=typeof i&&null!==i)throw TypeError("Super expression must either be null or a function");e.prototype=Object.create(i&&i.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),i&&lc(e,i)}(r,e),i=[{key:"text",get:function(){return this._text},set:function(e){this._text=e,this._genCanvas()}},{key:"textHeight",get:function(){return this._textHeight},set:function(e){this._textHeight=e,this._genCanvas()}},{key:"color",get:function(){return this._color},set:function(e){this._color=e,this._genCanvas()}},{key:"backgroundColor",get:function(){return this._backgroundColor},set:function(e){this._backgroundColor=e,this._genCanvas()}},{key:"padding",get:function(){return this._padding},set:function(e){this._padding=e,this._genCanvas()}},{key:"borderWidth",get:function(){return this._borderWidth},set:function(e){this._borderWidth=e,this._genCanvas()}},{key:"borderRadius",get:function(){return this._borderRadius},set:function(e){this._borderRadius=e,this._genCanvas()}},{key:"borderColor",get:function(){return this._borderColor},set:function(e){this._borderColor=e,this._genCanvas()}},{key:"fontFace",get:function(){return this._fontFace},set:function(e){this._fontFace=e,this._genCanvas()}},{key:"fontSize",get:function(){return this._fontSize},set:function(e){this._fontSize=e,this._genCanvas()}},{key:"fontWeight",get:function(){return this._fontWeight},set:function(e){this._fontWeight=e,this._genCanvas()}},{key:"strokeWidth",get:function(){return this._strokeWidth},set:function(e){this._strokeWidth=e,this._genCanvas()}},{key:"strokeColor",get:function(){return this._strokeColor},set:function(e){this._strokeColor=e,this._genCanvas()}},{key:"_genCanvas",value:function(){var e=this,i=this._canvas,r=i.getContext("2d"),n=Array.isArray(this.borderWidth)?this.borderWidth:[this.borderWidth,this.borderWidth],s=n.map(function(i){return i*e.fontSize*.1}),a=(Array.isArray(this.borderRadius)?this.borderRadius:[this.borderRadius,this.borderRadius,this.borderRadius,this.borderRadius]).map(function(i){return i*e.fontSize*.1}),o=Array.isArray(this.padding)?this.padding:[this.padding,this.padding],l=o.map(function(i){return i*e.fontSize*.1}),h=this.text.split(`
`),u="".concat(this.fontWeight," ").concat(this.fontSize,"px ").concat(this.fontFace);r.font=u;var c=Math.max.apply(Math,lp(h.map(function(e){return r.measureText(e).width}))),d=this.fontSize*h.length;if(i.width=c+2*s[0]+2*l[0],i.height=d+2*s[1]+2*l[1],this.borderWidth){if(r.strokeStyle=this.borderColor,s[0]){var p=s[0]/2;r.lineWidth=s[0],r.beginPath(),r.moveTo(p,a[0]),r.lineTo(p,i.height-a[3]),r.moveTo(i.width-p,a[1]),r.lineTo(i.width-p,i.height-a[2]),r.stroke()}if(s[1]){var f=s[1]/2;r.lineWidth=s[1],r.beginPath(),r.moveTo(Math.max(s[0],a[0]),f),r.lineTo(i.width-Math.max(s[0],a[1]),f),r.moveTo(Math.max(s[0],a[3]),i.height-f),r.lineTo(i.width-Math.max(s[0],a[2]),i.height-f),r.stroke()}if(this.borderRadius){var m=Math.max.apply(Math,lp(s)),g=m/2;r.lineWidth=m,r.beginPath(),[!!a[0]&&[a[0],g,g,a[0]],!!a[1]&&[i.width-a[1],i.width-g,g,a[1]],!!a[2]&&[i.width-a[2],i.width-g,i.height-g,i.height-a[2]],!!a[3]&&[a[3],g,i.height-g,i.height-a[3]]].filter(function(e){return e}).forEach(function(e){var i=ld(e,4),n=i[0],s=i[1],a=i[2],o=i[3];r.moveTo(n,a),r.quadraticCurveTo(s,a,s,o)}),r.stroke()}}this.backgroundColor&&(r.fillStyle=this.backgroundColor,this.borderRadius?(r.beginPath(),r.moveTo(s[0],a[0]),[[s[0],a[0],i.width-a[1],s[1],s[1],s[1]],[i.width-s[0],i.width-s[0],i.width-s[0],s[1],a[1],i.height-a[2]],[i.width-s[0],i.width-a[2],a[3],i.height-s[1],i.height-s[1],i.height-s[1]],[s[0],s[0],s[0],i.height-s[1],i.height-a[3],a[0]]].forEach(function(e){var i=ld(e,6),n=i[0],s=i[1],a=i[2],o=i[3],l=i[4],h=i[5];r.quadraticCurveTo(n,o,s,l),r.lineTo(a,h)}),r.closePath(),r.fill()):r.fillRect(s[0],s[1],i.width-2*s[0],i.height-2*s[1])),r.translate.apply(r,lp(s)),r.translate.apply(r,lp(l)),r.font=u,r.fillStyle=this.color,r.textBaseline="bottom";var y=this.strokeWidth>0;y&&(r.lineWidth=this.strokeWidth*this.fontSize/10,r.strokeStyle=this.strokeColor),h.forEach(function(i,n){var s=(c-r.measureText(i).width)/2,a=(n+1)*e.fontSize;y&&r.strokeText(i,s,a),r.fillText(i,s,a)}),this.material.map&&this.material.map.dispose();var v=this.material.map=new lg.Texture(i);v.minFilter=lg.LinearFilter,v.colorSpace=lg.SRGBColorSpace,v.needsUpdate=!0;var _=this.textHeight*h.length+2*n[1]+2*o[1];this.scale.set(_*i.width/i.height,_,0)}},{key:"clone",value:function(){return new this.constructor(this.text,this.textHeight,this.color).copy(this)}},{key:"copy",value:function(e){return lg.Sprite.prototype.copy.call(this,e),this.color=e.color,this.backgroundColor=e.backgroundColor,this.padding=e.padding,this.borderWidth=e.borderWidth,this.borderColor=e.borderColor,this.fontFace=e.fontFace,this.fontSize=e.fontSize,this.fontWeight=e.fontWeight,this.strokeWidth=e.strokeWidth,this.strokeColor=e.strokeColor,this}}],function(e,i){for(var r=0;r<i.length;r++){var n=i[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,function(e){var i=function(e,i){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var n=r.call(e,i);if("object"!=typeof n)return n;throw TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e,"string");return"symbol"==typeof i?i:String(i)}(n.key),n)}}(r.prototype,i),Object.defineProperty(r,"prototype",{writable:!1}),r}(lg.Sprite),lv=class{constructor(e,i,r,n){(this.load=async()=>{let e=this.height,i=new FontFace("OpenSans-SemiBold","url(https://superviz2homologmediaserver.s3.amazonaws.com/static/fonts/OpenSans-SemiBold.woff)");await i.load(),document.fonts.add(i);let r=this.createTextGeometry(this.name,this.color);this.text=r;let n=new eW;return n.add(r),r.position.set(0,e,0),this.model=n,this.model},this.createTextGeometry=(e,i)=>{var r;let{scale:n}=this,s=(null==(r=this.slot)?void 0:r.textColor)??"#fff",a=new ly(e,.1);return a.color=s,a.padding=2.7,a.backgroundColor=i,a.fontFace="OpenSans-SemiBold",a.fontSize=100,a.material.sizeAttenuation=!0,a.borderRadius=8,a.scale.multiplyScalar(n),a},this.destroy=()=>{this.model.remove(this.text)},this.name=e,this.scale=n,i)?this.color=i.color:this.color="#878291",this.height=r,this.slot=i}},l_=class{constructor(e,i,r){this.destPos=new tZ(0,0,0),this.curPos=new tZ(0,0,0),this.startPos=new tZ(0,0,0),this.counter=0,this.slot=null,this.lastSlot=null,this.lastDestPos=new tZ(1e3,1e3,1e3),this.lastStartPos=new tZ(1e3,1e3,1e3),this.createdMaterial=!1,this.tempStartVec=new tZ(0,0,0),this.update=(function(e,i,r,n=0){this.slot=n,this.destPos.x=i.x,this.destPos.y=i.y,this.destPos.z=i.z,this.tempStartVec.copy(this.origin),this.tempStartVec.applyQuaternion(r),this.startPos.copy(e),this.startPos.add(this.tempStartVec),this.counter=0}).bind(this),this.clock=new sw,this.origin=r,this.lerpAnimationFrame=requestAnimationFrame(this.animate.bind(this))}load(){this.createMaterial(),this.root=new eW,0===this.origin.x&&0===this.origin.y&&0===this.origin.z&&this.origin.set(0,-.1,0)}animate(){if(this.lerpAnimationFrame=requestAnimationFrame(this.animate.bind(this)),!this.createdMaterial)return;let e=this.clock.getDelta();if(!(this.counter>2&&this.lastDestPos.equals(this.destPos)&&.2>this.lastStartPos.distanceTo(this.startPos))){if(this.counter++,this.lastSlot!==this.slot){let e=this.slot.color??"#878291";this.material&&(this.material.color.set(e),this.lastSlot=this.slot)}this.curPos.lerp(this.destPos,e/1e3*1e4),this.lastDestPos.x=this.destPos.x,this.lastDestPos.y=this.destPos.y,this.lastDestPos.z=this.destPos.z,this.lastStartPos.x=this.startPos.x,this.lastStartPos.y=this.startPos.y,this.lastStartPos.z=this.startPos.z,this.updateMesh(this.startPos,this.curPos)}}destroy(){this.material&&this.material.dispose(),cancelAnimationFrame(this.lerpAnimationFrame),this.root.parent&&this.root.parent.remove(this.root)}createMaterial(){let e=new tJ(this.createTextureCanvas());e.needsUpdate=!0;let i=this.slot.color??"#878291";this.material=new e8({map:e,blending:2,color:i,side:2,depthWrite:!0,transparent:!0}),this.createdMaterial=!0}updateMesh(e,i){let r=new nD(e,i);this.mesh&&this.mesh.geometry&&(this.mesh.geometry.dispose(),this.root.remove(this.mesh));let n=new nW(r,1,.003,4,!1);this.material&&(this.mesh=new iB(n,this.material),this.root.add(this.mesh))}createTextureCanvas(){let e=document.createElement("canvas"),i=e.getContext("2d");e.width=1,e.height=64;let r=i.createLinearGradient(0,0,e.width,e.height);return r.addColorStop(0,"rgba(  0,  0,  0,0.1)"),r.addColorStop(.1,"rgba(160,160,160,0.3)"),r.addColorStop(.5,"rgba(255,255,255,0.5)"),r.addColorStop(.9,"rgba(160,160,160,0.3)"),r.addColorStop(1,"rgba(  0,  0,  0,0.1)"),i.fillStyle=r,i.fillRect(0,0,e.width,e.height),e}},lx=class{constructor(e){this.destPos=new tZ(0,0,0),this.curPos=new tZ(0,0,0),this.counter=0,this.slot=null,this.lastSlot=null,this.lastDestPos=new tZ(1e3,1e3,1e3),this.update=(function(e,i=0){e&&void 0!==i&&(this.colorIndex=i,this.destPos.x=e.x,this.destPos.y=e.y,this.destPos.z=e.z,this.counter=0)}).bind(this),this.createTextGeometry=(e,i)=>{var r;let n=(null==(r=this.slot)?void 0:r.textColor)??"#fff",s=new ly(e,.1);return s.color=n,s.padding=2.7,s.borderRadius=8,s.backgroundColor=i,s.fontFace="OpenSans-SemiBold",s.fontSize=120,s.scale.set(.005*s.scale.x,.005*s.scale.y,.005*s.scale.z),s.material.sizeAttenuation=!1,s.material.depthTest=!1,s.center.set(-.15,1),s},this.createArrowGeometry=async e=>{if(e)return new Promise(i=>{let r=`https://production.cdn.superviz.com/static/mouse-pointers/${e.colorName}.svg`;new ss().load(r,e=>{let r=new rj(new rP({map:e,color:16777215,fog:!1,sizeAttenuation:!1}));r.scale.set(.02,.02,.02),r.center.set(.2,.23),i(r)})})},this.clock=new sw,this.scene=e,this.lerpAnimationFrame=requestAnimationFrame(this.animate.bind(this))}async load(e,i){if(this.root=new eW,this.slot=i,e.trim().length){let r=new FontFace("OpenSans-SemiBold","url(https://superviz2homologmediaserver.s3.amazonaws.com/static/fonts/OpenSans-SemiBold.woff)");await r.load(),document.fonts.add(r),this.textMesh=this.createTextGeometry(e,i.color),this.textMesh.position.set(0,0,0),this.root.add(this.textMesh)}return this.arrowMesh=await this.createArrowGeometry(i),this.root.add(this.arrowMesh),this.scene.add(this.root),this.root}async animate(){var e;this.lerpAnimationFrame=requestAnimationFrame(this.animate.bind(this));let i=this.clock.getDelta();if(!(this.counter>30&&this.lastDestPos.equals(this.destPos))){if(this.counter++,void 0!==this.slot&&this.lastSlot!==this.slot&&this.backgroundMaterial){let i=new e5((null==(e=this.slot)?void 0:e.color)??"#878291");this.backgroundMaterial.color.set(i),this.lastSlot=this.slot,this.root.remove(this.arrowMesh),this.arrowMesh=await this.createArrowGeometry(this.slot),this.root.add(this.arrowMesh)}this.curPos.lerp(this.destPos,i/1e3*1e4),this.lastDestPos.x=this.destPos.x,this.lastDestPos.y=this.destPos.y,this.lastDestPos.z=this.destPos.z,this.root.position.copy(this.curPos)}}destroy(){this.backgroundMaterial&&this.backgroundMaterial.dispose(),cancelAnimationFrame(this.lerpAnimationFrame),this.root.parent&&this.root.parent.remove(this.root)}},lb=q(tu()),lw=class{constructor(e={}){this.subscribe=e=>{this.callbacks.push(e)},this.unsubscribe=e=>{this.callbacks=this.callbacks.filter(i=>i!==e)},this.publish=(...e)=>{this.callbacks&&this.callbacks.forEach(i=>{this.callListener(i,e).catch(r=>{this.logger.log("superviz-sdk:observer-helper:publish:error",`
            Failed to execute callback on publish value.
            Callback: ${i}
            Event: ${JSON.stringify(e)}
            Error: ${r}
          `)})})},this.reset=()=>{this.callbacks=[]},this.destroy=()=>{delete this.logger,delete this.callbacks},this.callListener=(e,i)=>new Promise((r,n)=>{try{let n=e(...i);r(n)}catch(e){n(e)}});let{logger:i,throttleTime:r}=e;this.logger=i??new oA("@superviz/sdk/observer-helper"),this.throttle=r,this.callbacks=[],this.throttle&&(this.publish=(0,lb.default)(this.publish,this.throttle))}},lM=class{constructor(e,i,r,n,s){this.isPinsVisible=!0,this.commentsSide="left",this.localParticipant={},this.hideTemporaryPin=e=>{var i;let r=e.target;this.showcaseDiv.contains(r)||null!=(i=this.pins.get("temporary-pin"))&&i.contains(r)||this.removeAnnotationPin("temporary-pin")},this.setPointerDownCoordinates=({x:e,y:i})=>{this.pointerDownCoordinates={x:e,y:i}},this.setCommentsMetadata=e=>{this.commentsSide=e},this.annotationSelected=({detail:e})=>{var i;let{uuid:r,haltGoToPin:n,newPin:s}=e;if(!r)return;s&&this.pins.get(r).setAttribute("newPin","");let a=JSON.parse((null==(i=this.selectedPin)?void 0:i.getAttribute("annotation"))??"{}");if(this.resetPins(),(null==a?void 0:a.uuid)===r)return;document.body.dispatchEvent(new CustomEvent("close-temporary-annotation"));let o=this.pins.get(r);if(!o)return;o.setAttribute("active",""),this.selectedPin=o;let l=JSON.parse(this.annotations.find(e=>e.uuid===r).position);l&&!n&&this.onClickedPin(l)},this.resetPins=e=>{e&&(null==e?void 0:e.key)!=="Escape"||(this.resetSelectedPin(),this.removeAnnotationPin("temporary-pin"),this.temporaryPinCoordinates=null)},this.onClick=e=>{if(!this.isActive)return;{let i=this.showcaseDiv.getBoundingClientRect(),{x:r,y:n}=this.pointerDownCoordinates,s=r-i.x,a=n-i.y;if(Math.hypot(e.clientX-i.left-s,e.clientY-i.top-a)>10)return}let i=new sN,r=new tP;this.camera.updateMatrixWorld();let n=this.showcaseDiv.getBoundingClientRect(),s=e.clientX-n.left,a=e.clientY-n.top;r.x=s/this.showcaseDiv.clientWidth*2-1,r.y=-(a/this.showcaseDiv.clientHeight*2)+1,i.setFromCamera(r,this.camera);let o=i.intersectObjects(this.scene.children,!0);if(o.length>0){let e=o.filter(e=>!e.object.isLine)[0];if(e){let i={x:e.point.x,y:e.point.y,z:e.point.z,type:"threejs"},r={position:i,camera:this.camera.position};this.resetSelectedPin(),this.onPinFixedObserver.publish(r),this.createTemporaryPin(i)}}},this.renderDivWrapper=()=>{let e=this.showcaseDiv.getBoundingClientRect(),i=this.divWrapper;i||((i=document.createElement("div")).id="superviz-autodesk-pins-wrapper"),i.style.position="absolute",i.style.top=`${this.showcaseDiv.offsetTop}px`,i.style.left=`${this.showcaseDiv.offsetLeft}px`,i.style.width=`${e.width}px`,i.style.height=`${e.height}px`,i.style.pointerEvents="none",i.style.overflow="hidden",i.style.zIndex="1","static"===this.showcaseDiv.parentElement.style.position&&(this.showcaseDiv.parentElement.style.position="relative"),document.getElementById("superviz-autodesk-pins-wrapper")||this.showcaseDiv.parentElement.appendChild(i),this.divWrapper=i},this.distanceBetween=(e,i)=>{let r=e.x-i.x,n=e.y-i.y,s=e.z-i.z;return Math.sqrt(r*r+n*n+s*s)},this.onMouseMove=e=>{let{x:i,y:r}=e;this.mouseElement||(this.mouseElement=this.createMouseElement());let n=r-this.pinHeight;this.mouseElement.setAttribute("position",JSON.stringify({x:i,y:n}))},this.onMouseLeave=()=>{this.mouseElement&&(this.mouseElement.remove(),this.mouseElement=null),this.showcaseDiv.style.cursor="default"},this.onMouseEnter=()=>{this.mouseElement||(this.mouseElement=this.createMouseElement())},this.onToggleAnnotationSidebar=({detail:e})=>{let{open:i}=e;i||(this.pins.forEach(e=>{e.removeAttribute("active")}),this.pins.has("temporary-pin")&&this.removeAnnotationPin("temporary-pin"))},this.scene=e,this.camera=r,this.showcaseDiv=i.domElement,this.controls=s,this.player?this.player=n:this.player=r,this.logger=new oA("@superviz/sdk/comments-component/three-js-adapter"),this.isActive=!1,this.pins=new Map,this.pinHeight=40,this.onClickBinded=this.onClick.bind(this),this.animateBinded=this.animate.bind(this),document.body.style.position="relative",this.onPinFixedObserver=new lw,this.annotations=[],document.body.addEventListener("select-annotation",this.annotationSelected),document.body.addEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),this.renderAnnotationsPins(),this.animFrame=requestAnimationFrame(this.animateBinded),this.showcaseSides=this.showcaseDiv.getBoundingClientRect()}destroy(){document.body.removeEventListener("select-annotation",this.annotationSelected),document.body.removeEventListener("toggle-annotation-sidebar",this.onToggleAnnotationSidebar),cancelAnimationFrame(this.animFrame),this.removeAnnotationsPins(),this.removeListeners(),this.mouseElement=null}setActive(e){if(this.isActive=e,this.isActive){this.addListeners();return}this.removeListeners()}setPinsVisibility(e){if(this.isPinsVisible=e,this.isPinsVisible){this.renderAnnotationsPins();return}this.removeAnnotationsPins()}updateAnnotations(e){this.logger.log("updateAnnotations",e),this.annotations=e,(this.isActive||this.isPinsVisible)&&(this.removeAnnotationsPins(),this.renderAnnotationsPins())}removeAnnotationPin(e){let i=this.pins.get(e);i&&(i.remove(),this.pins.delete(e),this.annotations=this.annotations.filter(i=>i.uuid!==e))}createTemporaryPin(e){let i=document.getElementById("superviz-temporary-pin");this.temporaryPinCoordinates=e,i||((i=document.createElement("superviz-comments-annotation-pin")).id="superviz-temporary-pin",i.setAttribute("type","add"),i.setAttribute("showInput",""),i.setAttribute("containerSides",JSON.stringify(this.showcaseSides)),i.setAttribute("commentsSide",this.commentsSide),i.setAttribute("position",JSON.stringify(this.temporaryPinCoordinates)),i.setAttribute("localAvatar",this.localParticipant.avatar??""),i.setAttribute("participantsList",JSON.stringify(this.participants)),i.setAttribute("localName",this.localParticipant.name??""),i.setAttribute("annotation",JSON.stringify({})),i.setAttributeNode(document.createAttribute("active")),i.style.pointerEvents="auto");let r=this.position3DToScreen(e,0,this.pinHeight),n={x:r.left,y:r.top,type:e.type};i.setAttribute("position",JSON.stringify(n)),this.divWrapper.appendChild(i),this.pins.set("temporary-pin",i),this.renderAnnotationsPins()}addListeners(){document.body.addEventListener("select-annotation",this.annotationSelected),this.showcaseDiv.addEventListener("pointerdown",this.setPointerDownCoordinates),this.showcaseDiv.addEventListener("click",this.onClickBinded),this.showcaseDiv.addEventListener("mousemove",this.onMouseMove),this.showcaseDiv.addEventListener("mouseout",this.onMouseLeave),this.showcaseDiv.addEventListener("mouseenter",this.onMouseEnter),document.body.addEventListener("keyup",this.resetPins),document.body.addEventListener("click",this.hideTemporaryPin)}removeListeners(){document.body.removeEventListener("select-annotation",this.annotationSelected),this.showcaseDiv.removeEventListener("pointerdown",this.setPointerDownCoordinates),this.showcaseDiv.removeEventListener("click",this.onClick),this.showcaseDiv.removeEventListener("mousemove",this.onMouseMove),this.showcaseDiv.removeEventListener("mouseout",this.onMouseLeave),this.showcaseDiv.removeEventListener("mouseenter",this.onMouseEnter),document.body.removeEventListener("keyup",this.resetPins),document.body.removeEventListener("click",this.hideTemporaryPin)}animate(){(this.isActive||this.isPinsVisible)&&this.renderAnnotationsPins(),this.renderDivWrapper(),this.animFrame=requestAnimationFrame(this.animateBinded)}async renderAnnotationsPins(){if(this.annotations.forEach(async e=>{var i;if(!e.position)return;let r=null==(i=JSON.parse(e.position))?void 0:i.position;if((null==r?void 0:r.type)!=="threejs"||e.resolved)return;if(!this.pins.has(e.uuid)){this.createPin(e,r);return}let n=this.position3DToScreen(r,0,this.pinHeight),s=await this.checkIsVisible(n,r),a=this.pins.get(e.uuid);s?(a.setAttribute("style","opacity: 1"),this.pins.get(e.uuid).setAttribute("position",JSON.stringify({x:n.left,y:n.top}))):a.setAttribute("style","opacity: 0")}),this.pins.get("temporary-pin")){let e=this.position3DToScreen(this.temporaryPinCoordinates,0,this.pinHeight),i=await this.checkIsVisible(e,this.temporaryPinCoordinates),r=this.pins.get("temporary-pin");i?(r.setAttribute("style","opacity: 1"),r.setAttribute("position",JSON.stringify({x:e.left,y:e.top}))):r.setAttribute("style","opacity: 0")}}createPin(e,i){let r=this.position3DToScreen(i,0,this.pinHeight),n=document.createElement("superviz-comments-annotation-pin");this.divWrapper.appendChild(n),n.setAttribute("type","show"),n.setAttribute("annotation",JSON.stringify(e)),n.setAttribute("position",JSON.stringify({x:r.left,y:r.top})),n.setAttribute("participantsList",JSON.stringify(this.participants)),n.style.pointerEvents="auto",this.pins.set(e.uuid,n)}removeAnnotationsPins(){this.pins.forEach(e=>{e.remove()}),this.pins.clear()}set participantsList(e){this.participants=e}resetSelectedPin(){this.selectedPin&&(this.selectedPin.removeAttribute("active"),this.selectedPin=null)}onClickedPin(e){let i=new tZ(e.position.x,e.position.y,e.position.z),r=new tZ(e.camera.x,e.camera.y,e.camera.z),n;n=r.distanceTo(i)>3?r.lerp(i,.8):r,this.controls&&(this.controls.target=i);let s=setInterval(()=>{let e=this.player.position.clone();e.lerp(n,.02),this.player.position.set(e.x,e.y,e.z),this.player.lookAt(i)},1);setTimeout(()=>{this.player.lookAt(i),clearInterval(s)},1e3)}position3DToScreen(e,i,r){let n=new tZ(0,0,0);n.set(e.x,e.y,e.z),this.camera.updateMatrixWorld(),n.project(this.camera),this.showcaseDiv.getBoundingClientRect();let s=this.showcaseDiv.clientWidth/2,a=this.showcaseDiv.clientHeight/2;return n.x=n.x*s+s,n.y=-(n.y*a)+a,n.z=0,{top:n.y-r,left:n.x-i}}async checkIsVisible(e,i){let r=!1,n=new sN,s=new tP,a=e.left,o=e.top+this.pinHeight;s.x=a/this.showcaseDiv.clientWidth*2-1,s.y=-(o/this.showcaseDiv.clientHeight*2)+1,n.setFromCamera(s,this.camera);let l=n.intersectObjects(this.scene.children,!0);if(l.length>0){let e=l.filter(e=>!e.object.isLine)[0];if(e){let n=e.point;.2>Math.abs(this.distanceBetween(n,i))&&(r=!0)}}return r}createMouseElement(){let e=document.createElement("superviz-comments-annotation-pin");return e.setAttribute("type","add"),e.setAttribute("annotation",JSON.stringify({})),e.setAttribute("position",JSON.stringify({x:0,y:0})),document.body.appendChild(e),this.showcaseDiv.style.cursor="none",e}},lA={model3DUrl:"https://production.storage.superviz.com/readyplayerme/1.glb"},lS={GLOBAL:"global-store",PRESENCE_3D:"presence-3d-store"},lT=class{constructor(e,i,r,n){if(this.participants=[],this.isPrivate=!1,this.isAttached=!1,this.currentLocalPointerDest=new tZ(0,0,0),this.avatars={},this.lasers={},this.mouses={},this.names={},this.positionInfos={},this.laserUpdateIntervals={},this.syncInterval=null,this.tempQuat=new tY(0,0,0,0),this.mouse=new tP(0,0),this.mouse3D=new tZ(0,0,0),this.worldPosition=new tZ(0,0,0),this.worldQuat=new tY(0,0,0,0),this.unsubscribeFrom=[],this.attach=e=>{if(Object.values(e).includes(null)||Object.values(e).includes(void 0)){let e=`${this.name} @ attach - params are required`;throw this.logger.log(e),Error(e)}this.logger.log("attached");let{eventBus:i,useStore:r,ioc:n,Presence3DManagerService:s}=e;this.isAttached=!0,this.eventBus=i,this.useStore=r.bind(this),this.room=n.createRoom(this.name),this.presence3DManager=new s(this.room,this.useStore);let{hasJoined3D:a,participants:o}=this.useStore(lS.PRESENCE_3D);a.subscribe(),o.subscribe(this.onParticipantsUpdated);let{localParticipant:l,hasJoinedRoom:h}=this.useStore(lS.GLOBAL);this.localParticipant=l.value,l.subscribe(e=>{this.localParticipant=e}),h.subscribe(),this.start()},this.detach=()=>{if(!this.isAttached){this.logger.log(`${this.name} @ detach - component is not attached}`);return}this.logger.log("detached"),this.destroy(),this.unsubscribeFrom.forEach(e=>e(this)),this.localParticipant=void 0,this.isAttached=!1},this.destroy=()=>{this.unsubscribeFromRealtimeEvents(),this.unsubscribeToEventBusEvents(),this.room.disconnect(),this.room=void 0,this.participants.forEach(e=>{this.presence3DManager.unsubscribeFromUpdates(e.id,this.onParticipantUpdated)}),this.presence3DManager=void 0,this.useStore(lS.PRESENCE_3D).destroy(),this.useStore=void 0,this.participants.forEach(e=>{this.removeParticipant(e,!0)}),Object.keys(this.laserUpdateIntervals).forEach(e=>{clearInterval(this.laserUpdateIntervals[e])}),window.removeEventListener("pointermove",this.onPointerMove),clearInterval(this.syncInterval),this.laserUpdateIntervals={},this.avatars={},this.lasers={},this.positionInfos={}},this.start=()=>{if(!this.hasJoinedRoom||!this.hasJoined3D||!this.localParticipant){this.logger.log("three js component @ start - not joined yet"),setTimeout(()=>{this.logger.log("three js component @ start - retrying"),this.start()},1e3);return}this.subscribeToRealtimeEvents(),this.subscribeToEventBusEvents()},this.subscribeToRealtimeEvents=()=>{this.logger.log("three js component @ subscribeToRealtimeEvents"),this.room.on("participant-joined",this.onParticipantJoined),this.room.on("gather",this.onGatherUpdate),this.room.on("follow-me",this.onFollowParticipantUpdate),this.room.presence.on("presence.leave",this.onParticipantLeave)},this.unsubscribeFromRealtimeEvents=()=>{this.logger.log("three js component @ unsubscribeFromRealtimeEvents"),this.room.presence.off("presence.leave"),this.room.off("participant-joined",this.onParticipantJoined),this.room.off("gather",this.onGatherUpdate),this.room.off("follow-me",this.onFollowParticipantUpdate)},this.subscribeToEventBusEvents=()=>{this.logger.log("three js component @ subscribeToEventBusEvents"),this.eventBus.subscribe("realtime.go-to-participant",this.goTo),this.eventBus.subscribe("realtime.local-follow-participant",this.localFollow),this.eventBus.subscribe("realtime.follow-participant",this.follow),this.eventBus.subscribe("realtime.private-mode",this.setPrivate)},this.unsubscribeToEventBusEvents=()=>{this.logger.log("three js component @ unsubscribeToEventBusEvents"),this.eventBus.unsubscribe("realtime.go-to-participant",this.goTo),this.eventBus.unsubscribe("realtime.local-follow-participant",this.localFollow),this.eventBus.unsubscribe("realtime.follow-participant",this.follow),this.eventBus.unsubscribe("realtime.private-mode",this.setPrivate)},this.onParticipantJoined=e=>{if(!e.data)return;this.logger.log("three js component @ onParticipantJoined",e);let{id:i,name:r,avatar:n,avatarConfig:s,type:a,slot:o}=e.data;i===this.localParticipantId&&this.onParticipantLocalJoined(e),this.addParticipant({id:i,name:r,avatar:n,avatarConfig:s,type:a,slot:o})},this.onParticipantLocalJoined=e=>{var i,r,n,s;this.createParticipantList(),this.config.avatarConfig&&this.presence3DManager.setParticipantData({avatarConfig:this.config.avatarConfig}),null!=(i=e.avatar)&&i.model3DUrl&&this.presence3DManager.setParticipantData({avatar:{model3DUrl:null==e?void 0:e.avatar.model3DUrl,imageUrl:null==(r=null==e?void 0:e.avatar)?void 0:r.imageUrl}}),null!=(n=e.avatar)&&n.model3DUrl||this.presence3DManager.setParticipantData({avatar:{model3DUrl:lA.model3DUrl,imageUrl:null==(s=null==e?void 0:e.avatar)?void 0:s.imageUrl}})},this.onParticipantLeave=e=>{this.logger.log("three js component @ onParticipantLeave",e.data);let i=this.participants.find(i=>i.id===e.id);i&&this.removeParticipant(i,!0)},this.onParticipantUpdated=e=>{this.logger.log("three js component @ onParticipantUpdated",e);let{id:i,name:r,avatar:n,avatarConfig:s,position:a,rotation:o,type:l,slot:h}=e.data??e,u=this.followParticipantId??this.localFollowParticipantId;u&&u===i&&this.moveToAnotherParticipant(u),this.updateParticipant({position:a,rotation:o,id:i,name:r,avatar:n,avatarConfig:s,type:l,slot:h})},this.updateParticipant=async e=>{var i,r,n;if(null!=e&&e.id&&!(null!=(i=this.participants)&&i.length)){this.addParticipant(e);return}if(!this.participants||0===this.participants.length||!e||!e.id)return;let s=this.participants.find(i=>i.id===e.id);if(!s&&!e.isPrivate){this.addParticipant(e);return}if((null==(r=s.avatar)?void 0:r.model3DUrl)===(null==(n=e.avatar)?void 0:n.model3DUrl)&&(0,tc.isEqual)((0,tc.pickBy)(s.avatarConfig,tc.identity),(0,tc.pickBy)(e.avatarConfig,tc.identity))&&s.name===e.name){let i=this.participants.findIndex(i=>i.id===e.id);-1!==i&&(this.participants[i]=e)}else{this.removeParticipant(e,!1);let i=this.createParticipantOn3D(e);this.participants.push(i),(s.id!==this.localParticipantId||this.config.renderLocalAvatar)&&this.create3dPresence(i)}this.logger.log("three js component @ updateParticipant",{participant:e,participants:this.participants})},this.createParticipantList=()=>{Object.values(this.useStore(lS.PRESENCE_3D).participants.value).forEach(e=>{e.isPrivate||this.addParticipant(e)}),this.logger.log("three js component @ createParticipantList",this.participants)},this.createParticipantOn3D=({id:e,name:i,avatar:r,avatarConfig:n,type:s,...a})=>{let o={id:e,name:i,avatar:r,isAudience:"audience"===s,avatarConfig:e===this.localParticipantId?this.config.avatarConfig:n,position:{x:0,y:0,z:0},rotation:{x:0,y:0},...a};return this.logger.log("three js component @ createParticipantOn3D",o),o},this.removeParticipant=(e,i)=>{var r;this.logger.log("three js component @ removeParticipant",{participant:e,unsubscribe:i}),this.participants=this.participants.filter(i=>i.id!==e.id),this.destroyAvatar(e),this.destroyLaser(e),this.destroyMouse(e),i&&(null==(r=this.presence3DManager)||r.unsubscribeFromUpdates(e.id,this.onParticipantUpdated))},this.addParticipant=async e=>{if(!e||!e.id||"audience"===e.type||!this.localParticipantId)return;let i=this.createParticipantOn3D(e);if(this.participants.find(e=>e.id===i.id)){this.logger.log("three js component @ addParticipant - participant already exists"),this.onParticipantUpdated(e);return}this.participants.push(i),this.logger.log("three js component @ addParticipant",{participant:e,participantOn3D:i,participants:this.participants}),this.presence3DManager.subscribeToUpdates(i.id,this.onParticipantUpdated),this.localParticipantId&&e.id===this.localParticipantId&&!this.config.renderLocalAvatar||this.create3dPresence(i)},this.goTo=e=>{this.logger.log("three js component @ goTo",e),this.moveToAnotherParticipant(e)},this.gather=()=>{this.logger.log("three js component @ gather"),this.room.emit("gather",{id:this.localParticipant.id})},this.setPrivate=e=>{this.logger.log("three js component @ private mode"),this.presence3DManager.updatePresence3D({id:this.localParticipantId,isPrivate:!!e}),this.isPrivate=!!e},this.follow=e=>{this.logger.log("three js component @ follow"),this.room.emit("follow-me",{id:e})},this.localFollow=e=>{this.localFollowParticipantId=e},this.onPointerMove=e=>{this.mouse.x=e.clientX/window.innerWidth*2-1,this.mouse.y=-(e.clientY/window.innerHeight*2)+1,void 0===this.raycaster&&(this.raycaster=new sN),this.raycaster.setFromCamera(this.mouse,this.camera);let i=this.raycaster.intersectObjects(this.scene.children,!0);if(i.length>0){let{point:e}=i[0];this.camera.getWorldPosition(this.mouse3D),e.lerp(this.mouse3D,.005),this.currentLocalPointerDest=e}},this.checkPlayerChanges=()=>{if(!this.hasJoined3D)return;this.player.getWorldPosition(this.worldPosition),this.player.getWorldQuaternion(this.worldQuat);let e={position:{x:this.worldPosition.x,y:this.worldPosition.y,z:this.worldPosition.z},quaternion:{x:this.worldQuat.x,y:this.worldQuat.y,z:this.worldQuat.z,w:this.worldQuat.w},pointer:{x:this.currentLocalPointerDest.x,y:this.currentLocalPointerDest.y,z:this.currentLocalPointerDest.z},isPrivate:this.isPrivate},{participants:i}=this.useStore(lS.PRESENCE_3D),r=i.value.find(e=>e.id===this.localParticipantId),n={position:null==r?void 0:r.position,quaternion:null==r?void 0:r.quaternion,pointer:null==r?void 0:r.pointer,isPrivate:null==r?void 0:r.isPrivate};(0,tc.isEqual)(e,n)||this.isPrivate||this.presence3DManager.updatePresence3D({id:this.localParticipantId,...e});let s=this.avatars[this.localParticipantId],{localParticipant:a}=this.useStore(lS.GLOBAL),{slot:o}=a.value;s&&(this.updateAvatar(s,this.worldPosition,this.worldQuat),s.model.getWorldPosition(this.worldPosition),s.model.getWorldQuaternion(this.tempQuat),this.names[this.localParticipantId]&&void 0!==o&&this.names[this.localParticipantId].slot!==o&&this.names[this.localParticipantId].text&&(this.names[this.localParticipantId].slot=o,this.names[this.localParticipantId].text.backgroundColor=o.color??"#878291")),this.lasers[this.localParticipantId]&&this.updateLaser(this.lasers[this.localParticipantId],this.worldPosition,this.currentLocalPointerDest,this.tempQuat,o),this.mouses[this.localParticipantId]&&this.mouses[this.localParticipantId].update(this.currentLocalPointerDest,o)},this.onParticipantsUpdated=e=>{this.isAttached&&(this.logger.log("three js component @ onParticipantsUpdated",e),Object.values(e).forEach(e=>{if(e.id===this.localParticipantId)return;let i=e.id,{position:r,quaternion:n,pointer:s,isPrivate:a}=e;if(!a&&!this.participants.find(i=>i.id===e.id)){this.addParticipant(e);return}let{slot:o}=e;this.positionInfos[i]={position:r,quaternion:n,pointer:s},a&&this.avatars[i]&&this.removeParticipant(e,!0),a||this.avatars[i]||this.addParticipant(e);let l=this.avatars[i];l&&(r&&n&&this.updateAvatar(l,r,n),l.root.getWorldQuaternion(this.tempQuat),this.names[i]&&void 0!==o&&this.names[i].slot.index!==o.index&&(this.names[i].destroy(),this.createName(e,this.avatars[i].root)));let h=this.lasers[i];h&&(this.laserUpdateIntervals[i]&&clearInterval(this.laserUpdateIntervals[i]),this.laserUpdateIntervals[i]=setInterval(()=>{this.updateLaser(h,r,s,this.tempQuat,o)},30)),this.mouses[i]&&this.mouses[i].update(s,o)}))},this.onFollowParticipantUpdate=e=>{e.data.id!==this.localParticipantId&&(this.logger.log("three js component @ onFollowParticipantUpdate",e.data.id),this.followParticipantId=e.data.id,this.moveToAnotherParticipant(e.data.id))},this.onGatherUpdate=e=>{this.logger.log("three js component @ onGatherUpdate",e.data.id),e.data.id!==this.localParticipantId&&this.eventBus.publish("realtime.go-to-participant",e.data.id)},typeof window>"u")throw Error("[SuperViz] Presence3D component cannot be initialized in a non-browser environment. Window is not defined");this.name="presence3dThreejs",this.logger=new oA("@superviz/sdk/three-js-component"),this.logger.log("three js component @ constructor",{scene:e,camera:i,player:r,options:n}),this.config={isAvatarsEnabled:(null==n?void 0:n.isAvatarsEnabled)??!0,isLaserEnabled:(null==n?void 0:n.isLaserEnabled)??!0,isNameEnabled:(null==n?void 0:n.isNameEnabled)??!0,isMouseEnabled:(null==n?void 0:n.isMouseEnabled)??!0,renderLocalAvatar:(null==n?void 0:n.renderLocalAvatar)??!1,avatarConfig:null==n?void 0:n.avatarConfig},this.logger.log("three js component @ constructor - config",this.config),im.prototype.computeBoundsTree=ob,im.prototype.disposeBoundsTree=ow,iB.prototype.raycast=ox,this.createdPointerMoveEvent=!1,this.scene=e,this.camera=i,this.player=r,this.syncInterval=setInterval(this.checkPlayerChanges,30)}get localParticipantId(){var e;return null==(e=this.localParticipant)?void 0:e.id}async create3dPresence(e){if(this.config.isAvatarsEnabled){let i=await this.createAvatar(e);this.config.isNameEnabled&&this.createName(e,i)}this.config.isMouseEnabled&&this.createMouse(e),this.config.isLaserEnabled&&this.createLaser(e)}async destroyAvatar(e){this.avatars[e.id]&&(this.mouses[e.id]&&this.mouses[e.id].destroy(),this.avatars[e.id].destroy(),delete this.avatars[e.id],this.avatars[e.id]=null,this.mouses[e.id]=null)}async destroyLaser(e){this.lasers[e.id]&&(this.lasers[e.id].destroy(),delete this.lasers[e.id],this.lasers[e.id]=null)}async destroyMouse(e){this.mouses[e.id]&&(this.mouses[e.id].destroy(),delete this.mouses[e.id],this.mouses[e.id]=null)}moveToAnotherParticipant(e){if(e===this.localParticipantId||!this.positionInfos[e])return;let i=this.positionInfos[e].position,r=this.positionInfos[e].quaternion,n=setInterval(()=>{let e=this.player.position.clone();e.lerp(i,.1),this.player.position.set(e.x,e.y,e.z);let n=this.player.quaternion.clone();n.slerp(r,.1),this.player.quaternion.set(n.x,n.y,n.z,n.w)},1);setTimeout(()=>{clearInterval(n)},1e3)}async createAvatar(e){var i,r,n;if(!this.isAttached)return;this.avatars[e.id]&&this.avatars[e.id].destroy();let s=e.id===this.localParticipantId;if(s&&!this.config.renderLocalAvatar)return;let a=(null==(i=e.avatarConfig)?void 0:i.scale)||1,o=(null==(r=e.avatarConfig)?void 0:r.height)||0,l=new ll((null==(n=e.avatar)?void 0:n.model3DUrl)??lA.model3DUrl,a,o,s),h=await l.load();return this.avatars[e.id]&&this.avatars[e.id].root.parent.remove(this.avatars[e.id].root),this.scene.add(h),this.avatars[e.id]=l,this.lasers[e.id]&&this.scene.add(this.lasers[e.id].root),h}async createName(e,i){var r;if(!this.isAttached||!e.name.trim().length)return;i.traverse(e=>{e.geometry&&e.geometry.computeBoundingBox()});let n=((null==(r=e.avatar)?void 0:r.model3DUrl)??lA.model3DUrl).includes("readyplayerme"),s=new tQ().setFromObject(i),a=new tZ(0,0,0);s.getSize(a);let{slot:o}=e,l=1.2*a.y;n&&(l=2.3*a.y);let h=s.max.y/50,u=new lv(e.name,o,l,h),c=await u.load();i.add(c),this.names[e.id]=u}async createLaser(e){var i;if(this.logger.log("three js component @ createLaser",e),!this.isAttached||!e.avatarConfig||e.id===this.localParticipantId&&!this.config.renderLocalAvatar)return;this.lasers[e.id]&&this.lasers[e.id].destroy();let r=new tZ(0,0,0);null!=(i=e.avatarConfig)&&i.laserOrigin&&(r=new tZ(e.avatarConfig.laserOrigin.x,e.avatarConfig.laserOrigin.y,e.avatarConfig.laserOrigin.z));let n=new l_(this.camera,this.scene,r);this.lasers[e.id]=n,n.load(),this.createdPointerMoveEvent||(this.createdPointerMoveEvent=!0,window.addEventListener("pointermove",this.onPointerMove))}createMouse(e){if(!this.isAttached||e.id===this.localParticipantId&&!this.config.renderLocalAvatar)return;this.mouses[e.id]&&this.mouses[e.id].destroy();let i=new lx(this.scene);this.mouses[e.id]=i;let{slot:r}=e;i.load(e.name,r),this.raycaster=new sN,this.createdPointerMoveEvent||(this.createdPointerMoveEvent=!0,window.addEventListener("pointermove",this.onPointerMove))}updateAvatar(e,i,r){this.isAttached&&e&&i&&r&&(e.setPosition(i),e.setQuaternion(r))}updateLaser(e,i,r,n,s){i&&r&&n&&s&&e.update(i,r,n,s)}};"u">typeof window&&(window.Presence3D=lT,window.ThreeJsPin=lM)}}]);